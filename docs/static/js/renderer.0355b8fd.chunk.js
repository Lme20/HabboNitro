(this["webpackJsonpnitro-react"]=this["webpackJsonpnitro-react"]||[]).push([[1],{2:function(t,e,s){"use strict";s.d(e,"mf",(function(){return l})),s.d(e,"vb",(function(){return u})),s.d(e,"Jb",(function(){return g})),s.d(e,"jf",(function(){return d})),s.d(e,"vf",(function(){return yU})),s.d(e,"h",(function(){return U})),s.d(e,"ff",(function(){return w})),s.d(e,"gf",(function(){return x})),s.d(e,"if",(function(){return H})),s.d(e,"kf",(function(){return V})),s.d(e,"nf",(function(){return k})),s.d(e,"of",(function(){return Y})),s.d(e,"rf",(function(){return W})),s.d(e,"sf",(function(){return K})),s.d(e,"Nf",(function(){return X})),s.d(e,"Af",(function(){return Q.a})),s.d(e,"tf",(function(){return Z})),s.d(e,"p",(function(){return ft})),s.d(e,"l",(function(){return Bt})),s.d(e,"m",(function(){return Dt})),s.d(e,"n",(function(){return XM})),s.d(e,"q",(function(){return Ct})),s.d(e,"r",(function(){return Lt})),s.d(e,"s",(function(){return Gt})),s.d(e,"Ef",(function(){return zS})),s.d(e,"Ff",(function(){return WS})),s.d(e,"Lf",(function(){return er})),s.d(e,"tg",(function(){return os})),s.d(e,"ug",(function(){return DU})),s.d(e,"hf",(function(){return Rs})),s.d(e,"de",(function(){return Mu})),s.d(e,"ee",(function(){return yu})),s.d(e,"fe",(function(){return Du})),s.d(e,"ve",(function(){return Cu})),s.d(e,"nb",(function(){return Uu})),s.d(e,"Lb",(function(){return Pu})),s.d(e,"z",(function(){return Fu})),s.d(e,"B",(function(){return xu})),s.d(e,"D",(function(){return Gu})),s.d(e,"jb",(function(){return Vs})),s.d(e,"kb",(function(){return Ys})),s.d(e,"Ph",(function(){return zs})),s.d(e,"V",(function(){return Hu})),s.d(e,"W",(function(){return Vu})),s.d(e,"X",(function(){return ju})),s.d(e,"he",(function(){return Yu})),s.d(e,"Y",(function(){return Wu})),s.d(e,"Z",(function(){return Ku})),s.d(e,"y",(function(){return Xu})),s.d(e,"F",(function(){return qu})),s.d(e,"J",(function(){return Qu})),s.d(e,"eb",(function(){return tc})),s.d(e,"fb",(function(){return ui})),s.d(e,"gb",(function(){return ec})),s.d(e,"hb",(function(){return ic})),s.d(e,"pb",(function(){return rc})),s.d(e,"rb",(function(){return nc})),s.d(e,"ac",(function(){return li})),s.d(e,"Xc",(function(){return oc})),s.d(e,"Yc",(function(){return hc})),s.d(e,"Yd",(function(){return dc})),s.d(e,"qe",(function(){return cc})),s.d(e,"Of",(function(){return Ec})),s.d(e,"Rf",(function(){return pc})),s.d(e,"Uf",(function(){return mc})),s.d(e,"Vf",(function(){return Ic})),s.d(e,"qg",(function(){return Tc})),s.d(e,"Wh",(function(){return fc})),s.d(e,"lj",(function(){return Ac})),s.d(e,"mj",(function(){return Sc})),s.d(e,"Eb",(function(){return Cc})),s.d(e,"Vb",(function(){return bc})),s.d(e,"Xb",(function(){return wc})),s.d(e,"Yb",(function(){return xc})),s.d(e,"be",(function(){return Bc})),s.d(e,"Ee",(function(){return Vc})),s.d(e,"cf",(function(){return Yc})),s.d(e,"df",(function(){return zc})),s.d(e,"Sg",(function(){return Wc})),s.d(e,"Tg",(function(){return Kc})),s.d(e,"qc",(function(){return qc})),s.d(e,"dd",(function(){return Qc})),s.d(e,"gd",(function(){return Zc})),s.d(e,"hd",(function(){return Jc})),s.d(e,"nd",(function(){return $c})),s.d(e,"qd",(function(){return tl})),s.d(e,"td",(function(){return el})),s.d(e,"Bd",(function(){return sl})),s.d(e,"Zd",(function(){return il})),s.d(e,"L",(function(){return Ml})),s.d(e,"R",(function(){return yl})),s.d(e,"S",(function(){return Dl})),s.d(e,"T",(function(){return Cl})),s.d(e,"U",(function(){return Ll})),s.d(e,"Dd",(function(){return xl})),s.d(e,"Ed",(function(){return Bl})),s.d(e,"Gd",(function(){return Gl})),s.d(e,"Hd",(function(){return Hl})),s.d(e,"Md",(function(){return jl})),s.d(e,"Od",(function(){return kl})),s.d(e,"Qd",(function(){return Yl})),s.d(e,"Sd",(function(){return zl})),s.d(e,"Ud",(function(){return Wl})),s.d(e,"ie",(function(){return Ql})),s.d(e,"b",(function(){return tg})),s.d(e,"d",(function(){return sg})),s.d(e,"e",(function(){return ig})),s.d(e,"u",(function(){return hg})),s.d(e,"v",(function(){return _g})),s.d(e,"w",(function(){return dg})),s.d(e,"Kb",(function(){return cg})),s.d(e,"cc",(function(){return lg})),s.d(e,"ec",(function(){return gg})),s.d(e,"fc",(function(){return Eg})),s.d(e,"gc",(function(){return pg})),s.d(e,"mc",(function(){return mg})),s.d(e,"Df",(function(){return Tg})),s.d(e,"Gf",(function(){return Rg})),s.d(e,"If",(function(){return fg})),s.d(e,"Jf",(function(){return Og})),s.d(e,"ji",(function(){return vg})),s.d(e,"mi",(function(){return Ag})),s.d(e,"oi",(function(){return Sg})),s.d(e,"qi",(function(){return Ng})),s.d(e,"ti",(function(){return Mg})),s.d(e,"vi",(function(){return yg})),s.d(e,"xi",(function(){return Dg})),s.d(e,"yi",(function(){return Cg})),s.d(e,"zi",(function(){return Lg})),s.d(e,"Bi",(function(){return Ug})),s.d(e,"Pf",(function(){return Pg})),s.d(e,"ye",(function(){return wg})),s.d(e,"ze",(function(){return Fg})),s.d(e,"Ae",(function(){return Bg})),s.d(e,"Be",(function(){return Hg})),s.d(e,"xe",(function(){return Vg})),s.d(e,"Ce",(function(){return jg})),s.d(e,"ib",(function(){return kg})),s.d(e,"je",(function(){return Yg})),s.d(e,"ke",(function(){return zg})),s.d(e,"me",(function(){return Wg})),s.d(e,"Ne",(function(){return Kg})),s.d(e,"Oe",(function(){return Xg})),s.d(e,"Pe",(function(){return qg})),s.d(e,"Qe",(function(){return Qg})),s.d(e,"Re",(function(){return Zg})),s.d(e,"Se",(function(){return Jg})),s.d(e,"Te",(function(){return $g})),s.d(e,"xg",(function(){return tE})),s.d(e,"Kh",(function(){return eE})),s.d(e,"Li",(function(){return sE})),s.d(e,"Mi",(function(){return iE})),s.d(e,"ab",(function(){return aE})),s.d(e,"Gb",(function(){return dE})),s.d(e,"Nb",(function(){return lE})),s.d(e,"Rb",(function(){return gE})),s.d(e,"Dc",(function(){return EE})),s.d(e,"We",(function(){return IE})),s.d(e,"Ye",(function(){return RE})),s.d(e,"Ze",(function(){return fE})),s.d(e,"bf",(function(){return vE})),s.d(e,"yh",(function(){return ME})),s.d(e,"Si",(function(){return DE})),s.d(e,"Ui",(function(){return CE})),s.d(e,"c",(function(){return UE})),s.d(e,"f",(function(){return PE})),s.d(e,"qb",(function(){return wE})),s.d(e,"Wd",(function(){return FE})),s.d(e,"ge",(function(){return xE})),s.d(e,"ue",(function(){return BE})),s.d(e,"wf",(function(){return GE})),s.d(e,"Hf",(function(){return HE})),s.d(e,"Di",(function(){return jE})),s.d(e,"Bf",(function(){return kE})),s.d(e,"tb",(function(){return ZE})),s.d(e,"Bg",(function(){return op})),s.d(e,"Lg",(function(){return up})),s.d(e,"Mg",(function(){return cp})),s.d(e,"Pg",(function(){return lp})),s.d(e,"A",(function(){return gp})),s.d(e,"wg",(function(){return Ep})),s.d(e,"Ng",(function(){return pp})),s.d(e,"gh",(function(){return mp})),s.d(e,"oc",(function(){return yp})),s.d(e,"ld",(function(){return Dp})),s.d(e,"re",(function(){return Lp})),s.d(e,"se",(function(){return Up})),s.d(e,"te",(function(){return Pp})),s.d(e,"og",(function(){return wp})),s.d(e,"uj",(function(){return Vp})),s.d(e,"vj",(function(){return jp})),s.d(e,"wj",(function(){return kp})),s.d(e,"Sb",(function(){return Yp})),s.d(e,"Og",(function(){return zp})),s.d(e,"dh",(function(){return Xp})),s.d(e,"Lh",(function(){return Zp})),s.d(e,"ub",(function(){return bd})),s.d(e,"Ci",(function(){return Fd})),s.d(e,"pj",(function(){return Ud})),s.d(e,"qj",(function(){return Tm})),s.d(e,"rj",(function(){return Rm})),s.d(e,"sj",(function(){return fm})),s.d(e,"tj",(function(){return Am})),s.d(e,"x",(function(){return Nm})),s.d(e,"Ob",(function(){return Mm})),s.d(e,"Pb",(function(){return ym})),s.d(e,"Qb",(function(){return Dm})),s.d(e,"vg",(function(){return ko})),s.d(e,"Ug",(function(){return Yo})),s.d(e,"xh",(function(){return Um})),s.d(e,"Xi",(function(){return Fm})),s.d(e,"k",(function(){return xm})),s.d(e,"eg",(function(){return Bm})),s.d(e,"Ri",(function(){return Gm})),s.d(e,"Vi",(function(){return Hm})),s.d(e,"Wi",(function(){return Vm})),s.d(e,"Zi",(function(){return jm})),s.d(e,"cj",(function(){return km})),s.d(e,"Vd",(function(){return zm})),s.d(e,"Ni",(function(){return Qm})),s.d(e,"Pi",(function(){return Zm})),s.d(e,"hj",(function(){return Jm})),s.d(e,"pg",(function(){return eI})),s.d(e,"Th",(function(){return sI})),s.d(e,"jj",(function(){return iI})),s.d(e,"ig",(function(){return aI})),s.d(e,"lb",(function(){return oI})),s.d(e,"mb",(function(){return hI})),s.d(e,"Vc",(function(){return _I})),s.d(e,"Rh",(function(){return dI})),s.d(e,"Qf",(function(){return cI})),s.d(e,"Wf",(function(){return lI})),s.d(e,"lg",(function(){return pI})),s.d(e,"yf",(function(){return mI})),s.d(e,"zf",(function(){return II})),s.d(e,"G",(function(){return TI})),s.d(e,"H",(function(){return RI})),s.d(e,"I",(function(){return fI})),s.d(e,"rc",(function(){return OI})),s.d(e,"tc",(function(){return AI})),s.d(e,"uc",(function(){return SI})),s.d(e,"xc",(function(){return yI})),s.d(e,"yc",(function(){return DI})),s.d(e,"Bc",(function(){return LI})),s.d(e,"Lc",(function(){return xI})),s.d(e,"Nc",(function(){return BI})),s.d(e,"Rc",(function(){return HI})),s.d(e,"Sf",(function(){return YI})),s.d(e,"Tf",(function(){return zI})),s.d(e,"Xf",(function(){return WI})),s.d(e,"cg",(function(){return qI})),s.d(e,"Vh",(function(){return ZI})),s.d(e,"Db",(function(){return gT})),s.d(e,"Ub",(function(){return ET})),s.d(e,"a",(function(){return pT})),s.d(e,"Ab",(function(){return mT})),s.d(e,"Tb",(function(){return TT})),s.d(e,"Wb",(function(){return RT})),s.d(e,"Ac",(function(){return fT})),s.d(e,"ae",(function(){return OT})),s.d(e,"De",(function(){return vT})),s.d(e,"hg",(function(){return AT})),s.d(e,"mg",(function(){return ST})),s.d(e,"Xh",(function(){return NT})),s.d(e,"Yh",(function(){return MT})),s.d(e,"bi",(function(){return yT})),s.d(e,"Zc",(function(){return FT})),s.d(e,"ad",(function(){return xT})),s.d(e,"cd",(function(){return BT})),s.d(e,"ed",(function(){return GT})),s.d(e,"fd",(function(){return HT})),s.d(e,"id",(function(){return VT})),s.d(e,"jd",(function(){return jT})),s.d(e,"kd",(function(){return kT})),s.d(e,"md",(function(){return YT})),s.d(e,"od",(function(){return zT})),s.d(e,"pd",(function(){return WT})),s.d(e,"rd",(function(){return KT})),s.d(e,"sd",(function(){return XT})),s.d(e,"vd",(function(){return qT})),s.d(e,"wd",(function(){return QT})),s.d(e,"xd",(function(){return ZT})),s.d(e,"yd",(function(){return JT})),s.d(e,"zd",(function(){return $T})),s.d(e,"Ad",(function(){return tR})),s.d(e,"Cd",(function(){return eR})),s.d(e,"M",(function(){return IR})),s.d(e,"N",(function(){return TR})),s.d(e,"O",(function(){return RR})),s.d(e,"P",(function(){return fR})),s.d(e,"Q",(function(){return vR})),s.d(e,"Cb",(function(){return yR})),s.d(e,"wc",(function(){return DR})),s.d(e,"Kc",(function(){return PR})),s.d(e,"Fd",(function(){return wR})),s.d(e,"Id",(function(){return FR})),s.d(e,"Jd",(function(){return xR})),s.d(e,"Kd",(function(){return BR})),s.d(e,"Ld",(function(){return GR})),s.d(e,"Nd",(function(){return VR})),s.d(e,"Pd",(function(){return jR})),s.d(e,"Rd",(function(){return YR})),s.d(e,"Td",(function(){return zR})),s.d(e,"jg",(function(){return XR})),s.d(e,"Zh",(function(){return qR})),s.d(e,"sc",(function(){return QR})),s.d(e,"dc",(function(){return JR})),s.d(e,"ng",(function(){return $R})),s.d(e,"ii",(function(){return tf})),s.d(e,"ki",(function(){return ef})),s.d(e,"li",(function(){return sf})),s.d(e,"pi",(function(){return rf})),s.d(e,"ri",(function(){return nf})),s.d(e,"si",(function(){return af})),s.d(e,"ui",(function(){return of})),s.d(e,"wi",(function(){return hf})),s.d(e,"Ai",(function(){return _f})),s.d(e,"Ei",(function(){return df})),s.d(e,"Fi",(function(){return uf})),s.d(e,"Mc",(function(){return cf})),s.d(e,"K",(function(){return gf})),s.d(e,"bb",(function(){return pf})),s.d(e,"Ec",(function(){return If})),s.d(e,"Fc",(function(){return Rf})),s.d(e,"Gc",(function(){return ff})),s.d(e,"we",(function(){return Of})),s.d(e,"bg",(function(){return vf})),s.d(e,"ob",(function(){return Sf})),s.d(e,"Bb",(function(){return Mf})),s.d(e,"vc",(function(){return yf})),s.d(e,"Hc",(function(){return Df})),s.d(e,"Ic",(function(){return Cf})),s.d(e,"Oc",(function(){return Lf})),s.d(e,"Qc",(function(){return Uf})),s.d(e,"Sc",(function(){return Pf})),s.d(e,"Fe",(function(){return bf})),s.d(e,"Ge",(function(){return Nf})),s.d(e,"Le",(function(){return wf})),s.d(e,"Me",(function(){return Ff})),s.d(e,"He",(function(){return xf})),s.d(e,"Ie",(function(){return Bf})),s.d(e,"Je",(function(){return Gf})),s.d(e,"Ke",(function(){return jf})),s.d(e,"Mf",(function(){return kf})),s.d(e,"fg",(function(){return Yf})),s.d(e,"yb",(function(){return qf})),s.d(e,"zb",(function(){return Qf})),s.d(e,"Cc",(function(){return sO})),s.d(e,"Tc",(function(){return nO})),s.d(e,"Uc",(function(){return aO})),s.d(e,"Xe",(function(){return mO})),s.d(e,"af",(function(){return TO})),s.d(e,"Zf",(function(){return AO})),s.d(e,"gi",(function(){return PO})),s.d(e,"Ji",(function(){return bO})),s.d(e,"Kf",(function(){return BO})),s.d(e,"zc",(function(){return $O})),s.d(e,"gg",(function(){return cv})),s.d(e,"Ag",(function(){return Ev})),s.d(e,"Ah",(function(){return Tv})),s.d(e,"Ch",(function(){return Rv})),s.d(e,"kg",(function(){return fv})),s.d(e,"sg",(function(){return Ov})),s.d(e,"wh",(function(){return vv})),s.d(e,"Ih",(function(){return Av})),s.d(e,"Qh",(function(){return Sv})),s.d(e,"C",(function(){return Mv})),s.d(e,"E",(function(){return yv})),s.d(e,"ai",(function(){return Bv})),s.d(e,"g",(function(){return Gv})),s.d(e,"kc",(function(){return Kv})),s.d(e,"lc",(function(){return Xv})),s.d(e,"bc",(function(){return $v})),s.d(e,"jc",(function(){return tA})),s.d(e,"nc",(function(){return iA})),s.d(e,"hc",(function(){return nA})),s.d(e,"ic",(function(){return aA})),s.d(e,"i",(function(){return hA})),s.d(e,"xb",(function(){return dA})),s.d(e,"Wc",(function(){return uA})),s.d(e,"ci",(function(){return cA})),s.d(e,"Jc",(function(){return lA})),s.d(e,"Pc",(function(){return EA})),s.d(e,"Ii",(function(){return pA})),s.d(e,"ag",(function(){return mA})),s.d(e,"Dh",(function(){return fA})),s.d(e,"Eh",(function(){return MA})),s.d(e,"Fh",(function(){return yA})),s.d(e,"Gh",(function(){return DA})),s.d(e,"Vg",(function(){return FA})),s.d(e,"Gi",(function(){return xA})),s.d(e,"Hi",(function(){return BA})),s.d(e,"Ki",(function(){return GA})),s.d(e,"j",(function(){return QA})),s.d(e,"db",(function(){return ZA})),s.d(e,"Qi",(function(){return iS})),s.d(e,"Ti",(function(){return rS})),s.d(e,"Yi",(function(){return aS})),s.d(e,"aj",(function(){return oS})),s.d(e,"Oi",(function(){return _S})),s.d(e,"gj",(function(){return dS})),s.d(e,"Sh",(function(){return uS})),s.d(e,"bj",(function(){return cS})),s.d(e,"dj",(function(){return lS})),s.d(e,"ej",(function(){return gS})),s.d(e,"fj",(function(){return ES})),s.d(e,"ud",(function(){return dn})),s.d(e,"ni",(function(){return Pa})),s.d(e,"le",(function(){return oo})),s.d(e,"Cf",(function(){return nd})),s.d(e,"cb",(function(){return Ko})),s.d(e,"zg",(function(){return zo})),s.d(e,"ij",(function(){return tr})),s.d(e,"dg",(function(){return Bi})),s.d(e,"pf",(function(){return aU})),s.d(e,"qf",(function(){return RU})),s.d(e,"uf",(function(){return qS})),s.d(e,"pe",(function(){return wS})),s.d(e,"lf",(function(){return BS})),s.d(e,"ef",(function(){return SU})),s.d(e,"Zg",(function(){return gD})),s.d(e,"rg",(function(){return $S})),s.d(e,"Cg",(function(){return tN})),s.d(e,"Dg",(function(){return eN})),s.d(e,"Eg",(function(){return YS})),s.d(e,"Fg",(function(){return sN})),s.d(e,"Gg",(function(){return iN})),s.d(e,"Hg",(function(){return aN})),s.d(e,"Ig",(function(){return hN})),s.d(e,"Jg",(function(){return _N})),s.d(e,"Xg",(function(){return EN})),s.d(e,"Oh",(function(){return MN})),s.d(e,"xf",(function(){return Ia})),s.d(e,"oe",(function(){return la})),s.d(e,"di",(function(){return pa})),s.d(e,"Wg",(function(){return st})),s.d(e,"Yg",(function(){return TD})),s.d(e,"ah",(function(){return E_})),s.d(e,"bh",(function(){return it})),s.d(e,"ch",(function(){return rt})),s.d(e,"eh",(function(){return CU})),s.d(e,"Jh",(function(){return dD})),s.d(e,"bd",(function(){return _U})),s.d(e,"yg",(function(){return Zo})),s.d(e,"Bh",(function(){return sU})),s.d(e,"Uh",(function(){return cU})),s.d(e,"t",(function(){return QS})),s.d(e,"hh",(function(){return gL})),s.d(e,"ih",(function(){return LL})),s.d(e,"jh",(function(){return TL})),s.d(e,"kh",(function(){return AL})),s.d(e,"lh",(function(){return _L})),s.d(e,"mh",(function(){return ZS})),s.d(e,"nh",(function(){return UL})),s.d(e,"oh",(function(){return GL})),s.d(e,"ph",(function(){return jL})),s.d(e,"qh",(function(){return cL})),s.d(e,"rh",(function(){return OL})),s.d(e,"sh",(function(){return YL})),s.d(e,"th",(function(){return zL})),s.d(e,"uh",(function(){return WL})),s.d(e,"vh",(function(){return qL})),s.d(e,"pc",(function(){return et})),s.d(e,"Xd",(function(){return LU})),s.d(e,"Hh",(function(){return $L})),s.d(e,"Ve",(function(){return ts})),s.d(e,"hi",(function(){return LD})),s.d(e,"o",(function(){return UD})),s.d(e,"wb",(function(){return PD})),s.d(e,"Mh",(function(){return DD})),s.d(e,"Nh",(function(){return FD})),s.d(e,"ei",(function(){return xD})),s.d(e,"Mb",(function(){return DC})),s.d(e,"Zb",(function(){return CC})),s.d(e,"ce",(function(){return LC})),s.d(e,"oj",(function(){return UC})),s.d(e,"Fb",(function(){return PU})),s.d(e,"Hb",(function(){return wU})),s.d(e,"Ib",(function(){return BU})),s.d(e,"ne",(function(){return GU})),s.d(e,"Ue",(function(){return HU})),s.d(e,"Yf",(function(){return VU})),s.d(e,"nj",(function(){return jU})),s.d(e,"sb",(function(){return Ge})),s.d(e,"Kg",(function(){return ke})),s.d(e,"Qg",(function(){return Ye})),s.d(e,"Rg",(function(){return ze})),s.d(e,"fh",(function(){return We})),s.d(e,"zh",(function(){return Ke})),s.d(e,"fi",(function(){return At})),s.d(e,"kj",(function(){return dt}));var i=s(6),r=s(24),n=s(31),a=s(33),o=s(3),h=s(10),_=s(26);class d{constructor(t){this._type=void 0,this._type=t}get type(){return this._type}}class u extends d{constructor(t){super(t)}}u.LOADED="NCE_LOADED",u.FAILED="NCE_FAILED";class c{constructor(){this._isDisposed=void 0,this._isDisposing=void 0,this._isDisposed=!1,this._isDisposing=!1}dispose(){this._isDisposed||this._isDisposing||(this._isDisposing=!0,this.onDispose(),this._isDisposed=!0,this._isDisposing=!1)}onDispose(){}get disposed(){return this._isDisposed}get isDisposing(){return this._isDisposing}}class l{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._name=void 0,this._description=void 0,this._print=void 0,this._name=t,this._description=e,this._print=!0}log(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.printMessage("log",...e)}error(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.printMessage("error",...e)}warn(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.printMessage("warn",...e)}printMessage(t){if(this._print){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];l.log(this._name,t,...s)}}static log(){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const e=`[Nitro] [${arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Nitro"}]`;for(var s=arguments.length,i=new Array(s>2?s-2:0),r=2;r<s;r++)i[r-2]=arguments[r];switch(t){case"error":console.error(e,...i);break;case"warn":console.warn(e,...i);break;default:console.log(e,...i)}}static error(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Nitro";for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];return this.log(t,"error",...s)}static warn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Nitro";for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];return this.log(t,"warn",...s)}get description(){return this._description}set description(t){this._description=t}get print(){return this._print}set print(t){this._print=t}}class g extends c{constructor(){super(),this._logger=void 0,this._listeners=void 0,this._logger=new l(this.constructor.name),this._listeners=new Map}onDispose(){this.removeAllListeners(),super.onDispose()}addEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);s?s.push(e):this._listeners.set(t,[e])}removeEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);if(s&&s.length)for(const[i,r]of s.entries())if(r&&r===e)return s.splice(i,1),void(s.length||this._listeners.delete(t))}dispatchEvent(t){return!!t&&(SU.instance.getConfiguration("system.dispatcher.log")&&this._logger.log("Dispatched Event",t.type),this.processEvent(t),!0)}processEvent(t){const e=this._listeners.get(t.type);if(!e||!e.length)return;const s=[];for(const r of e)r&&s.push(r);for(;s.length;){const e=s.shift();try{e(t)}catch(i){return void this._logger.error(i.stack)}}}removeAllListeners(){this._listeners.clear()}get logger(){return this._logger}}class E{constructor(t){this._position=void 0,this._dataView=void 0,this._position=0,this._dataView=new DataView(t)}readBytes(t){const e=new E(this._dataView.buffer.slice(this._position,this._position+t));return this._position+=t,e}readByte(){const t=this._dataView.getInt8(this._position);return this._position++,t}readShort(){const t=this._dataView.getInt16(this._position);return this._position+=2,t}readInt(){const t=this._dataView.getInt32(this._position);return this._position+=4,t}readFloat(){const t=this._dataView.getFloat32(this._position);return this._position+=4,t}readDouble(){const t=this._dataView.getFloat64(this._position);return this._position+=8,t}remaining(){return this._dataView.byteLength-this._position}toString(t){return(new TextDecoder).decode(this._dataView.buffer)}toArrayBuffer(){return this._dataView.buffer}}class p{constructor(){this._buffer=void 0,this._position=void 0,this._buffer=new Uint8Array,this._position=0}writeByte(t){const e=new Uint8Array(1);return e[0]=t,this.appendArray(e),this}writeBytes(t){const e=new Uint8Array(t);return this.appendArray(e),this}writeShort(t){const e=new Uint8Array(2);return e[0]=t>>8,e[1]=255&t,this.appendArray(e),this}writeInt(t){const e=new Uint8Array(4);return e[0]=t>>24,e[1]=t>>16,e[2]=t>>8,e[3]=255&t,this.appendArray(e),this}writeString(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const s=(new TextEncoder).encode(t);return e?(this.writeShort(s.length),this.appendArray(s)):this.appendArray(s),this}appendArray(t){if(!t)return;const e=new Uint8Array(this.position+t.length>this._buffer.length?this.position+t.length:this._buffer.length);e.set(this._buffer),e.set(t,this.position),this._buffer=e,this.position+=t.length}getBuffer(){return this._buffer.buffer}get position(){return this._position}set position(t){this._position=t}toString(t){return new TextDecoder(t).decode(this._buffer)}}class m{constructor(t){this._value=void 0,this._value=t}get value(){return this._value}}class I{constructor(t){this._value=void 0,this._value=t}get value(){return this._value}}class T{constructor(t,e){this._header=void 0,this._buffer=void 0,this._header=t,this._buffer=e}readBytes(t){return this._buffer?this._buffer.readBytes(t):null}readByte(){return this._buffer?this._buffer.readByte():-1}readBoolean(){return 1===this.readByte()}readShort(){return this._buffer?this._buffer.readShort():-1}readInt(){return this._buffer?this._buffer.readInt():-1}readFloat(){return this._buffer?this._buffer.readFloat():-1}readDouble(){return this._buffer?this._buffer.readDouble():-1}readString(){const t=this.readShort();return this._buffer.readBytes(t).toString("utf8")}get header(){return this._header}get bytesAvailable(){return this._buffer&&this._buffer.remaining()>0}}class R{encode(t,e){const s=new p;s.writeShort(t);for(const r of e){let t=typeof r;switch("object"===t&&(null===r?t="null":r instanceof m?t="byte":r instanceof I?t="short":r instanceof ArrayBuffer&&(t="arraybuffer")),t){case"undefined":case"null":s.writeShort(0);break;case"byte":s.writeByte(r.value);break;case"short":s.writeShort(r.value);break;case"number":s.writeInt(r);break;case"boolean":s.writeByte(r?1:0);break;case"string":r?s.writeString(r,!0):s.writeShort(0);break;case"arraybuffer":s.writeBytes(r)}}const i=s.getBuffer();return i?(new p).writeInt(i.byteLength).writeBytes(i):null}decode(t){if(!t||!t.dataBuffer||!t.dataBuffer.byteLength)return null;const e=[];for(;t.dataBuffer.byteLength&&!(t.dataBuffer.byteLength<4);){const s=new E(t.dataBuffer),i=s.readInt();if(i>t.dataBuffer.byteLength-4)break;const r=s.readBytes(i);e.push(new T(r.readShort(),r)),t.dataBuffer=t.dataBuffer.slice(i+4)}return e}}class f extends d{constructor(t,e,s){super(t),this._connection=void 0,this._originalEvent=void 0,this._connection=e,this._originalEvent=event}get connection(){return this._connection}get originalEvent(){return this._originalEvent}}f.CONNECTION_OPENED="SCE_OPEN",f.CONNECTION_CLOSED="SCE_CLOSED",f.CONNECTION_ERROR="SCE_ERROR",f.CONNECTION_MESSAGE="SCE_MESSAGE";class O{constructor(t,e){this._callBack=void 0,this._parserClass=void 0,this._parser=void 0,this._connection=void 0,this._callBack=t,this._parserClass=e,this._parser=null,this._connection=null}dispose(){this._callBack=null,this._parserClass=null,this._parser=null,this._connection=null}get callBack(){return this._callBack}get parserClass(){return this._parserClass}get parser(){return this._parser}set parser(t){this._parser=t}get connection(){return this._connection}set connection(t){this._connection=t}}class v{constructor(){this._messageIdByEvent=void 0,this._messageIdByComposer=void 0,this._messageInstancesById=void 0,this._messageIdByEvent=new Map,this._messageIdByComposer=new Map,this._messageInstancesById=new Map}dispose(){this._messageIdByEvent.clear(),this._messageIdByComposer.clear(),this._messageInstancesById.clear()}registerMessages(t){for(const[e,s]of t.events)this.registerMessageEventClass(e,s);for(const[e,s]of t.composers)this.registerMessageComposerClass(e,s)}registerMessageEventClass(t,e){t&&e&&this._messageIdByEvent.set(e,t)}registerMessageComposerClass(t,e){t&&e&&this._messageIdByComposer.set(e,t)}registerMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;let s=this._messageInstancesById.get(e);s&&s.length||(s=[],this._messageInstancesById.set(e,s)),s.push(t)}removeMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;const s=this._messageInstancesById.get(e);if(s)for(const[i,r]of s.entries())if(r&&r===t)return s.splice(i,1),0===s.length&&this._messageInstancesById.delete(e),void r.dispose()}getEvents(t){if(!t)return;const e=this._messageInstancesById.get(t);return e||void 0}getEventId(t){if(!t)return-1;const e=t instanceof O?t.constructor:t,s=this._messageIdByEvent.get(e);return s||-1}getComposerId(t){if(!t)return-1;const e=this._messageIdByComposer.get(t.constructor);return e||-1}}class A{}A.CONNECTION_OPENED="open",A.CONNECTION_CLOSED="close",A.CONNECTION_ERROR="error",A.CONNECTION_MESSAGE="message";class S extends g{constructor(t,e){super(),this._communicationManager=void 0,this._stateListener=void 0,this._socket=void 0,this._messages=void 0,this._codec=void 0,this._dataBuffer=void 0,this._isReady=void 0,this._pendingClientMessages=void 0,this._pendingServerMessages=void 0,this._isAuthenticated=void 0,this._communicationManager=t,this._stateListener=e,this._socket=null,this._messages=new v,this._codec=new R,this._dataBuffer=null,this._isReady=!1,this._pendingClientMessages=[],this._pendingServerMessages=[],this._isAuthenticated=!1,this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this),this.onMessage=this.onMessage.bind(this)}init(t){this._stateListener&&this._stateListener.connectionInit(t),this.createSocket(t)}onDispose(){super.onDispose(),this.destroySocket(),this._communicationManager=null,this._stateListener=null,this._messages=null,this._codec=null,this._dataBuffer=null}onReady(){this._isReady||(this._isReady=!0,this._pendingServerMessages&&this._pendingServerMessages.length&&this.processWrappers(...this._pendingServerMessages),this._pendingClientMessages&&this._pendingClientMessages.length&&this.send(...this._pendingClientMessages),this._pendingServerMessages=[],this._pendingClientMessages=[])}createSocket(t){t&&(this.destroySocket(),this._dataBuffer=new ArrayBuffer(0),this._socket=new WebSocket(t),this._socket.addEventListener(A.CONNECTION_OPENED,this.onOpen),this._socket.addEventListener(A.CONNECTION_CLOSED,this.onClose),this._socket.addEventListener(A.CONNECTION_ERROR,this.onError),this._socket.addEventListener(A.CONNECTION_MESSAGE,this.onMessage))}destroySocket(){this._socket&&(this._socket.removeEventListener(A.CONNECTION_OPENED,this.onOpen),this._socket.removeEventListener(A.CONNECTION_CLOSED,this.onClose),this._socket.removeEventListener(A.CONNECTION_ERROR,this.onError),this._socket.removeEventListener(A.CONNECTION_MESSAGE,this.onMessage),this._socket.readyState===WebSocket.OPEN&&this._socket.close(),this._socket=null)}onOpen(t){this.dispatchConnectionEvent(f.CONNECTION_OPENED,t)}onClose(t){this.dispatchConnectionEvent(f.CONNECTION_CLOSED,t)}onError(t){this.dispatchConnectionEvent(f.CONNECTION_ERROR,t)}onMessage(t){if(!t)return;const e=new FileReader;e.readAsArrayBuffer(t.data),e.onloadend=()=>{this._dataBuffer=this.concatArrayBuffers(this._dataBuffer,e.result),this.processReceivedData()}}dispatchConnectionEvent(t,e){this.dispatchEvent(new f(t,this,e))}authenticated(){this._isAuthenticated=!0}send(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];if(this.disposed||!e)return!1;if(e=[...e],this._isAuthenticated&&!this._isReady)return this._pendingClientMessages||(this._pendingClientMessages=[]),this._pendingClientMessages.push(...e),!1;for(const i of e){if(!i)continue;const t=this._messages.getComposerId(i);if(-1===t){SU.instance.getConfiguration("system.packet.log")&&this.logger.log(`Unknown Composer: ${i.constructor.name}`);continue}const e=i.getMessageArray(),s=this._codec.encode(t,e);s?(SU.instance.getConfiguration("system.packet.log")&&this.logger.log("OutgoingComposer",t,i.constructor.name,e),this.write(s.getBuffer())):SU.instance.getConfiguration("system.packet.log")&&this.logger.log("Encoding Failed",i.constructor.name)}return!0}write(t){this._socket.readyState===WebSocket.OPEN&&this._socket.send(t)}processReceivedData(){try{this.processData()}catch(t){this.logger.error(t)}}processData(){const t=this.splitReceivedMessages();if(t&&t.length)return this._isAuthenticated&&!this._isReady?(this._pendingServerMessages||(this._pendingServerMessages=[]),void this._pendingServerMessages.push(...t)):void this.processWrappers(...t)}processWrappers(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];if(e&&e.length)for(const i of e){if(!i)continue;const t=this.getMessagesForWrapper(i);t&&t.length&&(SU.instance.getConfiguration("system.packet.log")&&this.logger.log("IncomingMessage",i.header,t[0].constructor.name,t[0].parser),this.handleMessages(...t))}}splitReceivedMessages(){return this._dataBuffer&&this._dataBuffer.byteLength?this._codec.decode(this):null}concatArrayBuffers(t,e){const s=new Uint8Array(t.byteLength+e.byteLength);return s.set(new Uint8Array(t),0),s.set(new Uint8Array(e),t.byteLength),s.buffer}getMessagesForWrapper(t){if(!t)return null;const e=this._messages.getEvents(t.header);if(e&&e.length){try{const s=new e[0].parserClass;if(!s||!s.flush()||!s.parse(t))return null;for(const t of e)t.parser=s}catch(s){return this.logger.error("Error parsing message",s,e[0].constructor.name),null}return e}SU.instance.getConfiguration("system.packet.log")&&this.logger.log("IncomingMessage",t.header,"UNREGISTERED",t)}handleMessages(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];e=[...e];for(const i of e)i&&(i.connection=this,i.callBack&&i.callBack(i))}registerMessages(t){t&&this._messages.registerMessages(t)}addMessageEvent(t){t&&this._messages&&this._messages.registerMessageEvent(t)}removeMessageEvent(t){t&&this._messages&&this._messages.removeMessageEvent(t)}get isAuthenticated(){return this._isAuthenticated}get dataBuffer(){return this._dataBuffer}set dataBuffer(t){this._dataBuffer=t}}class N extends c{constructor(){super(),this._connections=void 0,this._connections=[]}onDispose(){if(this._connections&&this._connections.length)for(const t of this._connections.values())t&&t.dispose()}createConnection(){const t=new S(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:null);if(t)return this._connections.push(t),t}update(t){let e=0;for(;e<this._connections.length;){const t=this._connections[e];if(t.processReceivedData(),this.disposed)return;t.disposed?this._connections.splice(e,1):e++}}}class M extends c{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this._logger=void 0,this._events=void 0,this._isLoaded=void 0,this._isLoading=void 0,this._logger=t instanceof l?t:new l(this.constructor.name),this._events=new g,this._isLoaded=!1,this._isLoading=!1}init(){this._isLoaded||this._isLoading||this.isDisposing||(this._isLoading=!0,this.onInit(),this._isLoaded=!0,this._isLoading=!1)}onInit(){}onDispose(){this._events&&this._events.dispose(),super.onDispose()}reload(){this.dispose(),this.init()}get logger(){return this._logger}get events(){return this._events}get isLoaded(){return this._isLoaded}get isLoading(){return this._isLoading}}class y extends M{constructor(){super(),this._definitions=void 0,this._pendingUrls=void 0,this._missingKeys=void 0,this._definitions=new Map,this._pendingUrls=[],this._missingKeys=[],this.onConfigurationLoaded=this.onConfigurationLoaded.bind(this)}onInit(){this.parseConfiguration(this.getDefaultConfig(),!0),this._pendingUrls=this.getValue("config.urls").slice(),this.loadNextConfiguration()}loadNextConfiguration(){this._pendingUrls.length?this.loadConfigurationFromUrl(this._pendingUrls[0]):this.dispatchConfigurationEvent(u.LOADED)}loadConfigurationFromUrl(t){t&&""!==t?fetch(t).then((t=>t.json())).then((e=>this.onConfigurationLoaded(e,t))).catch((t=>this.onConfigurationFailed(t))):this.dispatchConfigurationEvent(u.FAILED)}onConfigurationLoaded(t,e){if(t){if(this.parseConfiguration(t)){const t=this._pendingUrls.indexOf(e);return t>=0&&this._pendingUrls.splice(t,1),void this.loadNextConfiguration()}this.dispatchConfigurationEvent(u.FAILED)}}onConfigurationFailed(t){this.dispatchConfigurationEvent(u.FAILED)}dispatchConfigurationEvent(t){this.events&&this.events.dispatchEvent(new u(t))}parseConfiguration(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return!1;try{const s=new RegExp(/\${(.*?)}/g);for(const i in t){let r=t[i];"string"===typeof r&&(r=this.interpolate(r,s)),this._definitions.has(i)?e&&this.setValue(i,r):this.setValue(i,r)}return!0}catch(s){return this.logger.error(s.stack),!1}}interpolate(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e||(e=new RegExp(/\${(.*?)}/g));const s=t.match(e);if(s&&s.length)for(const i of s){const e=this._definitions.get(this.removeInterpolateKey(i));e&&(t=t.replace(i,e))}return t}removeInterpolateKey(t){return t.replace("${","").replace("}","")}getValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this._definitions.get(t);if(void 0===s){if(this._missingKeys.indexOf(t)>=0)return e;this._missingKeys.push(t),this.logger.warn(`Missing configuration key: ${t}`),s=e}return s}setValue(t,e){this._definitions.set(t,e)}getDefaultConfig(){return NitroConfig}get definitions(){return this._definitions}}class D extends c{constructor(){super(),this._configuration=void 0,this._communication=void 0,this._asset=void 0,(()=>{if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){const t=[`\n %c %c %c Nitro ${yU.UI_VERSION} - Renderer ${yU.RENDERER_VERSION} %c %c %c https://discord.nitrodev.co %c %c \n\n`,"background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","color: #ffffff; background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;"];self.console.log(...t)}else self.console&&self.console.log(`Nitro ${yU.UI_VERSION} - Renderer ${yU.RENDERER_VERSION} `)})(),this._configuration=new y,this._communication=new N,this._asset=new MU}onDispose(){this._asset&&(this._asset.dispose(),this._asset=null),this._communication&&(this._communication.dispose(),this._communication=null)}get configuration(){return this._configuration}get communication(){return this._communication}get asset(){return this._asset}}class C{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._elapsedTime=void 0,this._percision=void 0,this._timer=void 0,this._elapsedTime=0,this._percision=t,this._timer=null,this.start()}start(){this._elapsedTime=0,this._timer||(this._timer=setInterval((()=>this.increase()),this._percision))}stop(){this._timer&&clearTimeout(this._timer)}increase(){this._elapsedTime+=this._percision}getTimer(){return this._elapsedTime}}var L=s(59);class U{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._length=void 0,this._dictionary=void 0,this._array=void 0,this._keys=void 0,this._length=0,this._dictionary=new Map,this._array=[],this._keys=[],t)for(const[e,s]of t.entries())this.add(e,s)}get length(){return this._length}get disposed(){return!this._dictionary}dispose(){if(!this._dictionary){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._dictionary=null}this._length=0,this._array=null,this._keys=null}reset(){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._length=0,this._array=[],this._keys=[]}unshift(t,e){return null===this._dictionary.get(t)&&(this._dictionary.set(t,e),this._array.unshift(e),this._keys.unshift(t),this._length++,!0)}add(t,e){return void 0===this._dictionary.get(t)&&(this._dictionary.set(t,e),this._array[this._length]=e,this._keys[this._length]=t,this._length++,!0)}remove(t){const e=this._dictionary.get(t);if(!e)return null;const s=this._array.indexOf(e);return s>=0&&(this._array.splice(s,1),this._keys.splice(s,1),this._length--),this._dictionary.delete(t),e}getWithIndex(t){return t<0||t>=this._length?null:this._array[t]}getKey(t){return t<0||t>=this._length?null:this._keys[t]}getKeys(){return this._keys.slice()}hasKey(t){return this._keys.indexOf(t)>-1}getValue(t){return this._dictionary.get(t)}getValues(){return this._array.slice()}hasValue(t){return this._array.indexOf(t)>-1}indexOf(t){return this._array.indexOf(t)}concatenate(t){for(const e of t._keys)this.add(e,t.getValue(e))}clone(){const t=new U;return t.concatenate(this),t}}const P=t=>{let e="";const s=new Uint8Array(t),i=s.byteLength;for(let r=0;r<i;r++)e+=String.fromCharCode(s[r]);return window.btoa(e)};var b=s(48);class w extends b.a{}var F=s(43);class x extends F.a{}class B extends i.c{}var G=s(12);class H extends G.b{}class V extends i.j{}var j=s(4);class k extends j.g{}j.h;class Y extends j.j{}i.o;var z=s(25);class W extends z.a{}n.a;class K extends i.t{}class X extends a.a{}var q=s(49);q.a;r.b;var Q=s(40);class Z extends Q.c{}class J{constructor(t){this._jsonFile=null,this._image=null,this._imageData=null,this._baseTexture=null,this.parse(t)}parse(t){const e=new E(t);let s=e.readShort();for(;s>0;){const t=e.readShort(),r=e.readBytes(t).toString(),n=e.readInt(),a=e.readBytes(n);if(r.endsWith(".json")){const t=Object(L.a)(a.toArrayBuffer());this._jsonFile=JSON.parse(J.TEXT_DECODER.decode(t))}else{const t=Object(L.a)(a.toArrayBuffer()),e=P(t);this._baseTexture=new i.c("data:image/png;base64,"+e)}s--}}get jsonFile(){return this._jsonFile}get baseTexture(){return this._baseTexture}}J.TEXT_DECODER=new TextDecoder("utf-8");class $ extends d{constructor(t,e){super(t),this._contentType=void 0,this._contentType=e}get contentType(){return this._contentType}}$.RCLE_SUCCESS="RCLE_SUCCESS",$.RCLE_FAILURE="RCLE_FAILURE",$.RCLE_CANCEL="RCLE_CANCEL";class tt{constructor(t,e,s){this.name=t,this.textures=e,this.durations=s}}let et;!function(t){t.FLOOR="S",t.WALL="I",t.EFFECT="E",t.BADGE="B",t.ROBOT="R",t.HABBO_CLUB="H",t.PET="P"}(et||(et={}));class st{}st.MINIMUM=-2,st.ROOM=0,st.FLOOR=10,st.WALL=20,st.UNIT=100,st.CURSOR=200;class it{static getTypeNumber(t){return it.AVATAR_TYPES[t]}static getTypeString(t){for(const e in it.AVATAR_TYPES)if(e&&it.AVATAR_TYPES[e]===t)return e;return null}static getRealType(t){switch(t){case it.BOT:case it.RENTABLE_BOT:return it.USER;default:return t}}}it.USER="user",it.PET="pet",it.BOT="bot",it.RENTABLE_BOT="rentable_bot",it.MONSTER_PLANT="monsterplant",it.AVATAR_TYPES={user:1,pet:2,bot:3,rentable_bot:4};class rt{}rt.OBJECT_ROOM_ID="object_room_id",rt.OBJECT_ACCURATE_Z_VALUE="object_accurate_z_value",rt.TILE_CURSOR_HEIGHT="tile_cursor_height",rt.FIGURE="figure",rt.GENDER="gender",rt.OWN_USER="own_user",rt.FIGURE_CAN_STAND_UP="figure_can_stand_up",rt.FIGURE_VERTICAL_OFFSET="figure_vertical_offset",rt.FIGURE_TALK="figure_talk",rt.FIGURE_DANCE="figure_dance",rt.FIGURE_SLEEP="figure_sleep",rt.FIGURE_BLINK="figure_blink",rt.FIGURE_EFFECT="figure_effect",rt.FIGURE_CARRY_OBJECT="figure_carry_object",rt.FIGURE_USE_OBJECT="figure_use_object",rt.FIGURE_GESTURE="figure_gesture",rt.FIGURE_POSTURE="figure_posture",rt.FIGURE_POSTURE_PARAMETER="figure_posture_parameter",rt.FIGURE_HIGHLIGHT_ENABLE="figure_highlight_enable",rt.FIGURE_HIGHLIGHT="figure_highlight",rt.FURNITURE_PURCHASER_NAME="furniture_purchaser_name",rt.FURNITURE_PURCHASER_FIGURE="furniture_purchaser_figure",rt.STD="std",rt.FIGURE_SIGN="figure_sign",rt.FIGURE_FLAT_CONTROL="figure_flat_control",rt.FIGURE_IS_TYPING="figure_is_typing",rt.FIGURE_IS_MUTED="figure_is_muted",rt.FIGURE_GAINED_EXPERIENCE="figure_gained_experience",rt.FIGURE_EXPERIENCE_TIMESTAMP="figure_experience_timestamp",rt.FIGURE_NUMBER_VALUE="figure_number_value",rt.FIGURE_IS_PLAYING_GAME="figure_is_playing_game",rt.FIGURE_GUIDE_STATUS="figure_guide_status",rt.FIGURE_EXPRESSION="figure_expression",rt.HEAD_DIRECTION="head_direction",rt.FURNITURE_CUSTOM_VARIABLES="furniture_custom_variables",rt.FURNITURE_AUTOMATIC_STATE_INDEX="furniture_automatic_state_index",rt.FURNITURE_ALWAYS_STACKABLE="furniture_always_stackable",rt.FURNITURE_DISABLE_PICKING_ANIMATION="furniture_disable_picking_animation",rt.FURNITURE_DATA_FORMAT="furniture_data_format",rt.FURNITURE_UNIQUE_SERIAL_NUMBER="furniture_unique_serial_number",rt.FURNITURE_UNIQUE_EDITION_SIZE="furniture_unique_edition_size",rt.FURNITURE_CRACKABLE_STATE="furniture_crackable_state",rt.FURNITURE_CRACKABLE_HITS="furniture_crackable_hits",rt.FURNITURE_CRACKABLE_TARGET="furniture_crackable_target",rt.FURNITURE_CREDIT_VALUE="furniture_credit_value",rt.FURNITURE_DATA="furniture_data",rt.FURNITURE_ITEMDATA="furniture_itemdata",rt.FURNITURE_COLOR="furniture_color",rt.FURNITURE_LIFT_AMOUNT="furniure_lift_amount",rt.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID="furniture_guild_customized_guild_id",rt.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME="furniture_guild_customized_asset_name",rt.FURNITURE_GUILD_CUSTOMIZED_COLOR_1="furniture_guild_customized_color_1",rt.FURNITURE_GUILD_CUSTOMIZED_COLOR_2="furniture_guild_customized_color_2",rt.FURNITURE_STATE_UPDATE_TIME="furniture_state_update_time",rt.FURNITURE_SELECTION_DISABLED="furniture_selection_disabled",rt.FURNITURE_SIZE_X="furniture_size_x",rt.FURNITURE_SIZE_Y="furniture_size_y",rt.FURNITURE_SIZE_Z="furniture_size_z",rt.FURNITURE_CENTER_X="furniture_center_x",rt.FURNITURE_CENTER_Y="furniture_center_y",rt.FURNITURE_CENTER_Z="furniture_center_z",rt.FURNITURE_ALLOWED_DIRECTIONS="furniture_allowed_directions",rt.FURNITURE_AD_URL="furniture_ad_url",rt.FURNITURE_TYPE_ID="furniture_type_id",rt.FURNITURE_EXTRAS="furniture_extras",rt.FURNITURE_EXPIRY_TIME="furniture_expiry_time",rt.FURNITURE_EXPIRTY_TIMESTAMP="furniture_expiry_timestamp",rt.FURNITURE_REAL_ROOM_OBJECT="furniture_real_room_object",rt.FURNITURE_IS_STICKIE="furniture_is_stickie",rt.FURNITURE_BRANDING_IMAGE_STATUS="furniture_branding_image_status",rt.FURNITURE_BRANDING_IMAGE_URL="furniture_branding_image_url",rt.FURNITURE_BRANDING_URL="furniture_branding_url",rt.FURNITURE_BRANDING_OFFSET_X="furniture_branding_offset_x",rt.FURNITURE_BRANDING_OFFSET_Y="furniture_branding_offset_y",rt.FURNITURE_BRANDING_OFFSET_Z="furniture_branding_offset_z",rt.FURNITURE_BRANDING_IS_ANIMATED="furniture_branding_is_animated",rt.FURNITURE_BADGE_IMAGE_STATUS="furniture_badge_image_status",rt.FURNITURE_BADGE_ASSET_NAME="furniture_badge_asset_name",rt.FURNITURE_BADGE_VISIBLE_IN_STATE="furniture_badge_visible_in_state",rt.FURNITURE_ALPHA_MULTIPLIER="furniture_alpha_multiplier",rt.FURNITURE_USAGE_POLICY="furniture_usage_policy",rt.FURNITURE_OWNER_ID="furniture_owner_id",rt.FURNITURE_OWNER_NAME="furniture_owner_name",rt.FURNITURE_ROOM_BACKGROUND_COLOR_HUE="furniture_room_background_color_hue",rt.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION="furniture_room_background_color_saturation",rt.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS="furniture_room_background_color_lightness",rt.FURNITURE_USES_PLANE_MASK="furniture_uses_plane_mask",rt.FURNITURE_PLANE_MASK_TYPE="furniture_plane_mask_type",rt.FURNITURE_IS_VARIABLE_HEIGHT="furniture_is_variable_height",rt.FURNITURE_VOTE_MAJORITY_RESULT="furniture_vote_majority_result",rt.FURNITURE_VOTE_COUNTER_COUNT="furniture_vote_counter_count",rt.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED="furniture_soundblock_relative_animation_speed",rt.FURNITURE_MANNEQUIN_NAME="furniture_mannequin_name",rt.FURNITURE_MANNEQUIN_GENDER="furniture_mannequin_gender",rt.FURNITURE_MANNEQUIN_FIGURE="furniture_mannequin_figure",rt.FURNITURE_HIGHSCORE_SCORE_TYPE="furniture_highscore_score_type",rt.FURNITURE_HIGHSCORE_CLEAR_TYPE="furniture_highscore_clear_type",rt.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT="furniture_highscore_data_entry_count",rt.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_="furniture_highscore_data_entry_base_users_",rt.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_="furniture_highscore_data_entry_base_score_",rt.FURNITURE_INTERNAL_LINK="furniture_internal_link",rt.FURNITURE_CLOTHING_BOY="furniture_clothing_boy",rt.FURNITURE_CLOTHING_GIRL="furniture_clothing_girl",rt.FURNITURE_PLANETSYSTEM_DATA="furniture_planetsystem_data",rt.FURNITURE_FIREWORKS_DATA="furniture_fireworks_data",rt.PET_PALETTE_INDEX="pet_palette_index",rt.PET_COLOR="pet_color",rt.PET_HEAD_ONLY="pet_head_only",rt.PET_CUSTOM_LAYER_IDS="pet_custom_layer_ids",rt.PET_CUSTOM_PARTS_IDS="pet_custom_part_ids",rt.PET_CUSTOM_PALETTE_IDS="pet_custom_palette_ids",rt.PET_IS_RIDING="pet_is_riding",rt.PET_TYPE="pet_type",rt.PET_ALLOWED_DIRECTIONS="pet_allowed_directions",rt.RACE="race",rt.ROOM_MAP_DATA="room_map_data",rt.ROOM_PLANE_MASK_XML="room_plane_mask_xml",rt.ROOM_FLOOR_TYPE="room_floor_type",rt.ROOM_WALL_TYPE="room_wall_type",rt.ROOM_LANDSCAPE_TYPE="room_landscape_type",rt.ROOM_WALL_THICKNESS="room_wall_thickness",rt.ROOM_FLOOR_THICKNESS="room_floor_thickness",rt.ROOM_FLOOR_HOLE_UPDATE_TIME="room_floor_hole_update_time",rt.ROOM_FLOOR_VISIBILITY="room_floor_visibility",rt.ROOM_WALL_VISIBILITY="room_wall_visibility",rt.ROOM_LANDSCAPE_VISIBILITY="room_landscape_visibility",rt.ROOM_DOOR_X="room_door_x",rt.ROOM_DOOR_Y="room_door_y",rt.ROOM_DOOR_Z="room_door_z",rt.ROOM_DOOR_DIR="room_door_dir",rt.ROOM_BACKGROUND_COLOR="room_background_color",rt.ROOM_COLORIZE_BG_ONLY="room_colorize_bg_only",rt.ROOM_RANDOM_SEED="room_random_seed",rt.ROOM_WORLD_TYPE="room_world_type",rt.ROOM_SELECTED_X="room_selected_x",rt.ROOM_SELECTED_Y="room_selected_y",rt.ROOM_SELECTED_Z="room_selected_z",rt.ROOM_SELECTED_PLANE="room_selected_plane",rt.IMAGE_QUERY_SCALE="image_query_scale",rt.FURNITURE_FRIENDFURNI_ENGRAVING="furniture_friendfurni_engraving_type",rt.SESSION_URL_PREFIX="session_url_prefix",rt.SESSION_CURRENT_USER_ID="session_current_user_id";class nt{}nt.FURNITURE_STATIC="furniture_static",nt.FURNITURE_ANIMATED="furniture_animated",nt.FURNITURE_RESETTING_ANIMATED="furniture_resetting_animated",nt.FURNITURE_POSTER="furniture_poster",nt.FURNITURE_EXTERNAL_IMAGE="furniture_external_image",nt.FURNITURE_HABBOWHEEL="furniture_habbowheel",nt.FURNITURE_VAL_RANDOMIZER="furniture_val_randomizer",nt.FURNITURE_BOTTLE="furniture_bottle",nt.FURNITURE_PLANET_SYSTEM="furniture_planet_system",nt.FURNITURE_QUEUE_TILE="furniture_queue_tile",nt.FURNITURE_PARTY_BEAMER="furniture_party_beamer",nt.FURNITURE_CUBOID="furniture_cuboid",nt.FURNITURE_GIFT_WRAPPED="furniture_gift_wrapped",nt.FURNITURE_GIFT_WRAPPED_FIREWORKS="furniture_gift_wrapped_fireworks",nt.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",nt.FURNITURE_WATER_AREA="furniture_water_area",nt.FURNITURE_SCORE_BOARD="furniture_score_board",nt.FURNITURE_FIREWORKS="furniture_fireworks",nt.FURNITURE_BB="furniture_bb",nt.FURNITURE_ISOMETRIC_BB="furniture_isometric_bb",nt.FURNITURE_BG="furniture_bg",nt.FURNITURE_STICKIE="furniture_stickie",nt.FURNITURE_MANNEQUIN="furniture_mannequin",nt.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",nt.FURNITURE_GUILD_ISOMETRIC_BADGE="furniture_guild_isometric_badge",nt.FURNITURE_VOTE_COUNTER="furniture_vote_counter",nt.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",nt.FURNITURE_SOUNDBLOCK="furniture_soundblock",nt.FURNITURE_BADGE_DISPLAY="furniture_badge_display",nt.FURNITURE_YOUTUBE="furniture_youtube",nt.FURNITURE_BUILDER_PLACEHOLDER="furniture_builder_placeholder",nt.ROOM="room",nt.USER="user",nt.PET_ANIMATED="pet_animated",nt.BOT="bot",nt.RENTABLE_BOT="rentable_bot",nt.TILE_CURSOR="tile_cursor";class at{constructor(t,e,s,i,r,n,a){this._breed=void 0,this._tag=void 0,this._id=void 0,this._primaryColor=void 0,this._secondaryColor=void 0,this._isMaster=void 0,this._layerTags=void 0,this._layerTags=[],this._primaryColor=16777215&t,this._secondaryColor=16777215&e,this._breed=s,this._tag=i>-1&&i<at.COLOR_TAGS.length?at.COLOR_TAGS[i]:"",this._id=r,this._isMaster=n,this._layerTags=a}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}get breed(){return this._breed}get tag(){return this._tag}get id(){return this._id}get isMaster(){return this._isMaster}get layerTags(){return this._layerTags}}at.COLOR_TAGS=["Null","Black","White","Grey","Red","Orange","Pink","Green","Lime","Blue","Light-Blue","Dark-Blue","Yellow","Brown","Dark-Brown","Beige","Cyan","Purple","Gold"];class ot{constructor(){this._logger=void 0,this._stateEvents=void 0,this._sessionDataManager=void 0,this._waitingForSessionDataManager=void 0,this._iconListener=void 0,this._collections=void 0,this._gifCollections=void 0,this._images=void 0,this._events=void 0,this._activeObjects=void 0,this._activeObjectTypes=void 0,this._activeObjectTypeIds=void 0,this._objectTypeAdUrls=void 0,this._wallItems=void 0,this._wallItemTypes=void 0,this._wallItemTypeIds=void 0,this._furniRevisions=void 0,this._pets=void 0,this._petColors=void 0,this._objectAliases=void 0,this._objectOriginalNames=void 0,this._pendingContentTypes=void 0,this._dataInitialized=void 0,this._logger=new l(this.constructor.name),this._stateEvents=null,this._sessionDataManager=null,this._waitingForSessionDataManager=!1,this._iconListener=null,this._collections=new Map,this._gifCollections=new Map,this._images=new Map,this._events=new Map,this._activeObjects={},this._activeObjectTypes=new Map,this._activeObjectTypeIds=new Map,this._objectTypeAdUrls=new Map,this._wallItems={},this._wallItemTypes=new Map,this._wallItemTypeIds=new Map,this._furniRevisions=new Map,this._pets={},this._petColors=new Map,this._objectAliases=new Map,this._objectOriginalNames=new Map,this._pendingContentTypes=[],this._dataInitialized=!1}initialize(t){this._stateEvents=t,this.setFurnitureData();for(const[e,s]of SU.instance.getConfiguration("pet.types").entries())this._pets[s]=e}dispose(){}setSessionDataManager(t){this._sessionDataManager=t,this._waitingForSessionDataManager&&(this._waitingForSessionDataManager=!1,this.setFurnitureData())}loadFurnitureData(){this.setFurnitureData()}setFurnitureData(){if(!this._sessionDataManager)return void(this._waitingForSessionDataManager=!0);const t=this._sessionDataManager.getAllFurnitureData(this);t&&(this._sessionDataManager.removePendingFurniDataListener(this),this.processFurnitureData(t),this._stateEvents.dispatchEvent(new d(ot.LOADER_READY)))}processFurnitureData(t){if(t)for(const e of t){if(!e)continue;const t=e.id;let s=e.className;e.hasIndexedColor&&(s=s+"*"+e.colorIndex);const i=e.revision,r=e.adUrl;r&&r.length>0&&this._objectTypeAdUrls.set(s,r);let n=e.className;e.type===et.FLOOR?(this._activeObjectTypes.set(t,s),this._activeObjectTypeIds.set(s,t),this._activeObjects[n]||(this._activeObjects[n]=1)):e.type===et.WALL&&("post.it"===n&&(s="post_it",n="post_it"),"post.it.vd"===n&&(s="post_it_vd",n="post_id_vd"),this._wallItemTypes.set(t,s),this._wallItemTypeIds.set(s,t),this._wallItems[n]||(this._wallItems[n]=1));i>this._furniRevisions.get(n)&&(this._furniRevisions.delete(n),this._furniRevisions.set(n,i))}}getFurnitureFloorNameForTypeId(t){const e=this._activeObjectTypes.get(t);return this.removeColorIndex(e)}getFurnitureWallNameForTypeId(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this._wallItemTypes.get(t);return"poster"===s&&null!==e&&(s+=e),this.removeColorIndex(s)}getFurnitureFloorColorIndex(t){const e=this._activeObjectTypes.get(t);return e?this.getColorIndexFromName(e):-1}getFurnitureWallColorIndex(t){const e=this._wallItemTypes.get(t);return e?this.getColorIndexFromName(e):-1}getColorIndexFromName(t){if(!t)return-1;const e=t.indexOf("*");return-1===e?0:parseInt(t.substr(e+1))}removeColorIndex(t){if(!t)return null;const e=t.indexOf("*");return-1===e?t:t.substr(0,e)}getRoomObjectAdUrl(t){const e=this._objectTypeAdUrls.get(t);return e||""}getPetColorResult(t,e){const s=this._petColors.get(t);return s?s.get(e):null}getPetColorResultsForTag(t,e){const s=this._petColors.get(t),i=[];if(s)for(const r of s.values())r.tag===e&&i.push(r);return i}getCollection(t){if(!t)return null;const e=this._collections.get(t);if(!e){const e=SU.instance.core.asset.getCollection(t);return e?(this._collections.set(t,e),e):null}return e}getGifCollection(t){return t&&this._gifCollections.get(t)||null}getImage(t){if(!t)return null;const e=this._images.get(t);if(!e)return null;const s=new Image;return s.src=e.src,s}addAssetToCollection(t,e,s){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=this.getCollection(t);return!!r&&r.addAsset(e,s,i,0,0,!1,!1)}createGifCollection(t,e,s){if(!t||!e||!s)return null;const i=new tt(t,e,s);return this._gifCollections.set(t,i),i}createCollection(t,e){if(!t||!e)return null;const s=new NU(t,e);this._collections.set(s.name,s);const i=this._pets[s.name];if(void 0!==i){const e=s.getPaletteNames(),r=new Map;for(const i of e){const e=s.getPalette(i),n=t.palettes[i],a=e.primaryColor,o=e.secondaryColor,h=void 0!==n.breed?n.breed:0,_=void 0!==n.colorTag?n.colorTag:-1,d=void 0!==n.master&&n.master,u=void 0!==n.tags?n.tags:[];r.set(parseInt(i),new at(a,o,h,_,i,d,u))}this._petColors.set(i,r)}}getPlaceholderName(t){switch(this.getCategoryForType(t)){case st.FLOOR:return ot.PLACE_HOLDER;case st.WALL:return ot.PLACE_HOLDER_WALL;default:return void 0!==this._pets[t]?ot.PLACE_HOLDER_PET:ot.PLACE_HOLDER_DEFAULT}}getCategoryForType(t){return t?void 0!==this._activeObjects[t]?st.FLOOR:void 0!==this._wallItems[t]?st.WALL:void 0!==this._pets[t]?st.UNIT:0===t.indexOf("poster")?st.WALL:"room"===t?st.ROOM:t===it.USER||t===it.PET||t===it.BOT||t===it.RENTABLE_BOT?st.UNIT:t===ot.TILE_CURSOR||t===ot.SELECTION_ARROW?st.CURSOR:st.MINIMUM:st.MINIMUM}getPetNameForType(t){return SU.instance.getConfiguration("pet.types")[t]||null}isLoaderType(t){return(t=it.getRealType(t))!==nt.USER}downloadImage(t,e,s){let i=null,r=[];if(e&&e.indexOf(",")>=0&&(i=e,e=i.split(",")[0]),r=i?this.getAssetUrls(i,s,!0):this.getAssetUrls(e,s,!0),r&&r.length){const i=r[0],n=new Image;return n.src=i,n.onload=()=>{n.onerror=null,this._images.set([e,s].join("_"),n),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!0)},n.onerror=()=>{n.onload=null,this._logger.error("Failed to download asset",i),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!1)},!0}return!1}downloadAsset(t,e){const s=this.getAssetUrls(t);if(!s||!s.length)return;if(this._pendingContentTypes.indexOf(t)>=0||this.getOrRemoveEventDispatcher(t))return;this._pendingContentTypes.push(t),this._events.set(t,e);const i=new r.b;for(const o of s)o&&o.length&&i.add({url:o,crossOrigin:"anonymous",loadType:r.c.LOAD_TYPE.XHR,xhrType:r.c.XHR_RESPONSE_TYPE.BUFFER});let n=s.length;const a=(s,r)=>{if(!s)return this._logger.error("Failed to download asset",r),i.destroy(),void e.dispatchEvent(new $($.RCLE_FAILURE,t));if(n--,n);else{i.destroy();const e=this._events.get(t);if(!e)return;e.dispatchEvent(new $($.RCLE_SUCCESS,t))}};i.load(((t,e)=>{for(const s in e){const t=e[s];if(!t||t.error||!t.xhr)return void a(!1,t.url);if("application/octet-stream"!==(t.xhr.getResponseHeader("Content-Type")||"application/octet-stream"));else{const e=new J(t.data);this.processAsset(e.baseTexture,e.jsonFile,(e=>{a(e,t.url)}))}}}))}processAsset(t,e,s){const i=e.spritesheet;if(!t||!i||!Object.keys(i).length)return this.createCollection(e,null),void s(!0);const r=()=>{const r=new n.a(t,i);r.parse((()=>{this.createCollection(e,r),s(!0)}))};t.valid?r():t.once("update",(()=>r()))}setAssetAliasName(t,e){this._objectAliases.set(t,e),this._objectOriginalNames.set(e,t)}getAssetAliasName(t){const e=this._objectAliases.get(t);return e||t}getAssetOriginalName(t){const e=this._objectOriginalNames.get(t);return e||t}getAssetUrls(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(t){case ot.PLACE_HOLDER:return[this.getAssetUrlWithGenericBase(ot.PLACE_HOLDER)];case ot.PLACE_HOLDER_WALL:return[this.getAssetUrlWithGenericBase(ot.PLACE_HOLDER_WALL)];case ot.PLACE_HOLDER_PET:return[this.getAssetUrlWithGenericBase(ot.PLACE_HOLDER_PET)];case ot.ROOM:return[this.getAssetUrlWithGenericBase("room")];case ot.TILE_CURSOR:return[this.getAssetUrlWithGenericBase(ot.TILE_CURSOR)];case ot.SELECTION_ARROW:return[this.getAssetUrlWithGenericBase(ot.SELECTION_ARROW)];default:{const i=this.getCategoryForType(t);if(i===st.FLOOR||i===st.WALL){const i=this.getAssetAliasName(t);let r=s?this.getAssetUrlWithFurniIconBase(i):this.getAssetUrlWithFurniBase(t);if(s){const t=e&&""!==e&&this._activeObjectTypeIds.has(i+"*"+e);r=r.replace(/%param%/gi,t?"_"+e:"")}return[r]}return i===st.UNIT?[this.getAssetUrlWithPetBase(t)]:null}}}getAssetIconUrl(t,e){let s=null,i=[];return t&&t.indexOf(",")>=0&&(s=t,t=s.split(",")[0]),i=s?this.getAssetUrls(s,e,!0):this.getAssetUrls(t,e,!0),i&&i.length?i[0]:null}getAssetUrlWithGenericBase(t){return SU.instance.getConfiguration("generic.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniBase(t){return SU.instance.getConfiguration("furni.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniIconBase(t){return SU.instance.getConfiguration("furni.asset.icon.url").replace(/%libname%/gi,t)}getAssetUrlWithPetBase(t){return SU.instance.getConfiguration("pet.asset.url").replace(/%libname%/gi,t)}setRoomObjectRoomId(t,e){const s=t&&t.model;s&&s.setValue(rt.OBJECT_ROOM_ID,e)}getOrRemoveEventDispatcher(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=this._events.get(t);return e&&this._events.delete(t),s}setIconListener(t){this._iconListener=t}}ot.PLACE_HOLDER="place_holder",ot.PLACE_HOLDER_WALL="place_holder_wall",ot.PLACE_HOLDER_PET="place_holder_pet",ot.PLACE_HOLDER_DEFAULT=ot.PLACE_HOLDER,ot.ROOM="room",ot.TILE_CURSOR="tile_cursor",ot.SELECTION_ARROW="selection_arrow",ot.LOADER_READY="RCL_LOADER_READY",ot.MANDATORY_LIBRARIES=[ot.PLACE_HOLDER,ot.PLACE_HOLDER_WALL,ot.PLACE_HOLDER_PET,ot.ROOM,ot.TILE_CURSOR,ot.SELECTION_ARROW];class ht{constructor(){this._map=void 0,this._updateCounter=void 0,this._map=new Map,this._updateCounter=0}dispose(){this._map.clear(),this._updateCounter=0}getValue(t){return this._map.get(t)}setValue(t,e){this._map.has(t)&&this._map.get(t)===e||(this._map.set(t,e),this._updateCounter++)}removeKey(t){t&&(this._map.delete(t),this._updateCounter++)}get updateCounter(){return this._updateCounter}}class _t extends c{constructor(t,e){super(),this._id=void 0,this._container=void 0,this._renderer=void 0,this._managers=void 0,this._updateCategories=void 0,this._model=void 0,this._id=t,this._container=e,this._renderer=null,this._managers=new Map,this._updateCategories=[],this._model=new ht}onDispose(){this.removeAllManagers(),this.destroyRenderer(),this._container=null,this._model.dispose()}setRenderer(t){if(t!==this._renderer&&(this._renderer&&this.destroyRenderer(),this._renderer=t,this._renderer&&(this._renderer.reset(),this._managers.size)))for(const e of this._managers.values()){if(!e)continue;const t=e.objects;if(t.length)for(const e of t.getValues())e&&this._renderer.addObject(e)}}destroyRenderer(){this._renderer&&(this._renderer.dispose(),this._renderer=null)}getManager(t){const e=this._managers.get(t);return e||null}getManagerOrCreate(t){let e=this.getManager(t);return e||(e=this._container.createRoomObjectManager(t),e?(this._managers.set(t,e),e):null)}getTotalObjectsForManager(t){const e=this.getManager(t);return e?e.totalObjects:0}getRoomObject(t,e){const s=this.getManager(e);if(!s)return null;const i=s.getObject(t);return i||null}getRoomObjectsForCategory(t){const e=this.getManager(t);return e?e.objects.getValues():[]}getRoomObjectByIndex(t,e){const s=this.getManager(e);if(!s)return null;const i=s.getObjectByIndex(t);return i||null}createRoomObject(t,e,s,i){const r=this.getManagerOrCreate(i);if(!r)return null;const n=r.createObject(t,e,s);return n?(this._renderer&&this._renderer.addObject(n),n):null}createRoomObjectAndInitalize(t,e,s){return this._container?this._container.createRoomObjectAndInitalize(this._id,t,e,s):null}removeRoomObject(t,e){const s=this.getManager(e);if(!s)return;const i=s.getObject(t);i&&(i.tearDown(),this._renderer&&this._renderer.removeObject(i),s.removeObject(t))}removeAllManagers(){for(const t of this._managers.values())if(t){if(this._renderer){const e=t.objects;if(e.length)for(const t of e.getValues())t&&this._renderer.removeObject(t)}t.dispose()}this._managers.clear()}addUpdateCategory(t){this._updateCategories.indexOf(t)>=0||this._updateCategories.push(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);-1!==e&&this._updateCategories.splice(e,1)}update(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const s of this._updateCategories){const e=this.getManager(s);if(!e)continue;const i=e.objects;if(i.length)for(const s of i.getValues()){if(!s)continue;const e=s.logic;e&&e.update(t)}}this._renderer&&this._renderer.update(t,e)}hasUninitializedObjects(){for(const t of this._managers.values())if(t)for(const e of t.objects.getValues())if(e&&!e.isReady)return!0;return!1}get id(){return this._id}get container(){return this._container}get renderer(){return this._renderer}get managers(){return this._managers}get model(){return this._model}}class dt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._x=void 0,this._y=void 0,this._z=void 0,this._length=void 0,this._x=t,this._y=e,this._z=s,this._length=NaN}static sum(t,e){return t&&e?new dt(t.x+e.x,t.y+e.y,t.z+e.z):null}static dif(t,e){return t&&e?new dt(t.x-e.x,t.y-e.y,t.z-e.z):null}static product(t,e){return t?new dt(t.x*e,t.y*e,t.z*e):null}static dotProduct(t,e){return t&&e?t.x*e.x+t.y*e.y+t.z*e.z:0}static crossProduct(t,e){return t&&e?new dt(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x):null}static scalarProjection(t,e){if(!t||!e)return-1;const s=e.length;return s>0?(t.x*e.x+t.y*e.y+t.z*e.z)/s:-1}static cosAngle(t,e){if(!t||!e)return 0;const s=t.length*e.length;return s?dt.dotProduct(t,e)/s:0}static isEqual(t,e){return!(!t||!e)&&(t.x===e.x&&t.y===e.y&&t.z===e.z)}negate(){this._x=-this._x,this._y=-this._y,this._z=-this._z}add(t){t&&(this._x+=t.x,this._y+=t.y,this._z+=t.z,this._length=NaN)}subtract(t){t&&(this._x-=t.x,this._y-=t.y,this._z-=t.z,this._length=NaN)}multiply(t){this._x*=t,this._y*=t,this._z*=t,this._length=NaN}divide(t){t&&(this._x/=t,this._y/=t,this._z/=t,this._length=NaN)}assign(t){t&&(this._x=t.x,this._y=t.y,this._z=t.z,this._length=NaN)}get x(){return this._x}set x(t){this._x=t,this._length=NaN}get y(){return this._y}set y(t){this._y=t,this._length=NaN}get z(){return this._z}set z(t){this._z=t,this._length=NaN}get length(){return isNaN(this._length)&&(this._length=Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)),this._length}toString(){return`[Vector3d: ${this._x}, ${this._y}, ${this._z}]`}}class ut extends c{constructor(t,e,s){super(),this._id=void 0,this._instanceId=void 0,this._type=void 0,this._model=void 0,this._location=void 0,this._direction=void 0,this._states=void 0,this._visualization=void 0,this._logic=void 0,this._pendingLogicMessages=void 0,this._updateCounter=void 0,this._isReady=void 0,this._id=t,this._instanceId=ut.OBJECT_COUNTER++,this._type=s,this._model=new ht,this._location=new dt,this._direction=new dt,this._states=[],this._visualization=null,this._logic=null,this._pendingLogicMessages=[],this._updateCounter=0,this._isReady=!1;let i=e-1;for(;i>=0;)this._states[i]=0,i--}onDispose(){this._pendingLogicMessages=[],this.setVisualization(null),this.setLogic(null),this._model&&this._model.dispose(),super.onDispose()}getLocation(){return this._location}setLocation(t){t&&(t.x===this._location.x&&t.y===this._location.y&&t.z===this._location.z||(this._location.x=t.x,this._location.y=t.y,this._location.z=t.z,this._updateCounter++))}getDirection(){return this._direction}setDirection(t){t&&(t.x===this._direction.x&&t.y===this._direction.y&&t.z===this._direction.z||(this._direction.x=(t.x%360+360)%360,this._direction.y=(t.y%360+360)%360,this._direction.z=(t.z%360+360)%360,this._updateCounter++))}getState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t>=0&&t<this._states.length?this._states[t]:-1}setState(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e>=0&&e<this._states.length&&(this._states[e]!==t&&(this._states[e]=t,this._updateCounter++),!0)}setVisualization(t){this._visualization!==t&&(this._visualization&&this._visualization.dispose(),this._visualization=t,this._visualization&&(this._visualization.object=this))}setLogic(t){if(this._logic===t)return;const e=this._logic;if(e&&(this._logic=null,e.setObject(null)),this._logic=t,this._logic)for(this._logic.setObject(this);this._pendingLogicMessages.length;){const t=this._pendingLogicMessages.shift();this._logic.processUpdateMessage(t)}}processUpdateMessage(t){if(this._logic)return this._logic.processUpdateMessage(t);this._pendingLogicMessages.push(t)}tearDown(){this._logic&&this._logic.tearDown()}get id(){return this._id}get instanceId(){return this._instanceId}get type(){return this._type}get model(){return this._model}get visualization(){return this._visualization}get mouseHandler(){return this._logic}get logic(){return this._logic}get location(){return this._location}get direction(){return this._direction}get updateCounter(){return this._updateCounter}set updateCounter(t){this._updateCounter=t}get isReady(){return this._isReady}set isReady(t){this._isReady=t}}ut.OBJECT_COUNTER=0;class ct{constructor(){this._objects=void 0,this._objectsPerType=void 0,this._objects=new U,this._objectsPerType=new U}dispose(){this.removeAllObjects()}getObject(t){const e=this._objects.getValue(t);return e||null}getObjectByIndex(t){const e=this._objects.getWithIndex(t);return e||null}createObject(t,e,s){const i=new ut(t,e,s);return this.addObject(t,s,i)}addObject(t,e,s){if(this._objects.getValue(t))return s.dispose(),null;this._objects.add(t,s);const i=this.getTypeMap(e);return i&&i.add(t,s),s}removeObject(t){const e=this._objects.remove(t);if(e){const t=this.getTypeMap(e.type);t&&t.remove(e.id),e.dispose()}}removeAllObjects(){let t=0;for(;t<this._objects.length;){const e=this._objects.getWithIndex(t);e&&e.dispose(),t++}for(this._objects.reset(),t=0;t<this._objectsPerType.length;){const e=this._objectsPerType.getWithIndex(t);e&&e.dispose(),t++}this._objectsPerType.reset()}getTypeMap(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=this._objectsPerType.getValue(t);return!s&&e&&(s=new U,this._objectsPerType.add(t,s)),s}get objects(){return this._objects}get totalObjects(){return this._objects.length}}class lt extends M{constructor(t,e,s){super(),this._state=void 0,this._rooms=void 0,this._contentLoader=void 0,this._updateCategories=void 0,this._listener=void 0,this._visualizationFactory=void 0,this._logicFactory=void 0,this._initialLoadList=void 0,this._pendingContentTypes=void 0,this._skipContentProcessing=void 0,this._disposed=void 0,this._state=lt.ROOM_MANAGER_LOADED,this._rooms=new Map,this._contentLoader=null,this._updateCategories=[],this._listener=t,this._visualizationFactory=e,this._logicFactory=s,this._initialLoadList=[],this._pendingContentTypes=[],this._skipContentProcessing=!1,this._disposed=!1,this.onRoomContentLoadedEvent=this.onRoomContentLoadedEvent.bind(this),this.events.addEventListener($.RCLE_SUCCESS,this.onRoomContentLoadedEvent),this.events.addEventListener($.RCLE_FAILURE,this.onRoomContentLoadedEvent),this.events.addEventListener($.RCLE_CANCEL,this.onRoomContentLoadedEvent)}onInit(){if(this._state>=lt.ROOM_MANAGER_INITIALIZING||!this._contentLoader)return;const t=ot.MANDATORY_LIBRARIES;for(const e of t)e&&-1===this._initialLoadList.indexOf(e)&&(this._contentLoader.downloadAsset(e,this.events),this._initialLoadList.push(e));this._state=lt.ROOM_MANAGER_INITIALIZING}getRoomInstance(t){const e=this._rooms.get(t);return e||null}createRoomInstance(t){if(this._rooms.get(t))return null;const e=new _t(t,this);if(this._rooms.set(e.id,e),this._updateCategories.length)for(const s of this._updateCategories)e.addUpdateCategory(s);return e}removeRoomInstance(t){const e=this._rooms.get(t);return!!e&&(this._rooms.delete(t),e.dispose(),!0)}createRoomObjectAndInitalize(t,e,s,i){const r=this.getRoomInstance(t);if(!r)return null;let n=s,a=s,o=s,h=null,_=!1;if(this._contentLoader.isLoaderType(s)){if(h=this._contentLoader.getCollection(s),!h&&(_=!0,this._contentLoader.downloadAsset(s,this.events),o=this._contentLoader.getPlaceholderName(s),h=this._contentLoader.getCollection(o),!h))return null;n=h.data.visualizationType,a=h.data.logicType}const d=r.createRoomObject(e,1,s,i);if(!d)return null;if(this._visualizationFactory){const t=this._visualizationFactory.getVisualization(n);if(!t)return r.removeRoomObject(e,i),null;t.asset=h;const s=this._visualizationFactory.getVisualizationData(o,n,h&&h.data||null);if(!s||!t.initialize(s))return r.removeRoomObject(e,i),null;d.setVisualization(t)}if(this._logicFactory){const t=this._logicFactory.getLogic(a);d.setLogic(t),t&&t.initialize(h&&h.data||null)}return _||(d.isReady=!0),this._contentLoader.setRoomObjectRoomId(d,t),d}reinitializeRoomObjectsByType(t){if(!t||!this._contentLoader||!this._visualizationFactory||!this._logicFactory)return;const e=this._contentLoader.getCollection(t);if(!e)return;const s=e.data.visualizationType,i=e.data.logicType,r=this._visualizationFactory.getVisualizationData(t,s,e.data);for(const n of this._rooms.values())if(n)for(const[a,o]of n.managers.entries())if(o)for(const h of o.objects.getValues()){if(!h||h.type!==t)continue;const _=this._visualizationFactory.getVisualization(s);if(_)if(_.asset=e,r&&_.initialize(r)){h.setVisualization(_);const t=this._logicFactory.getLogic(i);h.setLogic(t),t&&t.initialize(e.data),h.isReady=!0,this._listener&&this._listener.objectInitialized(n.id,h.id,a)}else o.removeObject(h.id);else o.removeObject(h.id)}}addUpdateCategory(t){if(!(this._updateCategories.indexOf(t)>=0)&&(this._updateCategories.push(t),this._rooms.size))for(const e of this._rooms.values())e&&e.addUpdateCategory(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);if(-1!==e&&(this._updateCategories.splice(e,1),this._rooms.size))for(const s of this._rooms.values())s&&s.removeUpdateCategory(t)}setContentLoader(t){this._contentLoader&&this._contentLoader.dispose(),this._contentLoader=t}processPendingContentTypes(t){if(this._skipContentProcessing)this._skipContentProcessing=!1;else for(;this._pendingContentTypes.length;){const t=this._pendingContentTypes.shift();this._contentLoader.getCollection(t)?(this.reinitializeRoomObjectsByType(t),this._listener&&this._listener.initalizeTemporaryObjectsByType(t,!0),this._initialLoadList.length>0&&this.removeFromInitialLoad(t)):(this._listener&&this._listener.initalizeTemporaryObjectsByType(t,!1),this.logger.log(`Invalid Collection: ${t}`))}}removeFromInitialLoad(t){if(t&&this._state!==lt.ROOM_MANAGER_ERROR)if(this._contentLoader||(this._state=lt.ROOM_MANAGER_ERROR),this._contentLoader.getCollection(t)){const e=this._initialLoadList.indexOf(t);e>=0&&this._initialLoadList.splice(e,1),this._initialLoadList.length||(this._state=lt.ROOM_MANAGER_INITIALIZED,this._listener&&this._listener.onRoomEngineInitalized(!0))}else this._state=lt.ROOM_MANAGER_ERROR,this._listener&&this._listener.onRoomEngineInitalized(!1)}onRoomContentLoadedEvent(t){if(!this._contentLoader)return;const e=t.contentType;this._pendingContentTypes.indexOf(e)>=0||this._pendingContentTypes.push(e)}update(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.processPendingContentTypes(t),this._rooms.size)for(const s of this._rooms.values())s&&s.update(t,e)}createRoomObjectManager(t){return new ct}get rooms(){return this._rooms}get disposed(){return this._disposed}}lt.ROOM_MANAGER_ERROR=-1,lt.ROOM_MANAGER_LOADING=0,lt.ROOM_MANAGER_LOADED=1,lt.ROOM_MANAGER_INITIALIZING=2,lt.ROOM_MANAGER_INITIALIZED=3,lt.CONTENT_PROCESSING_TIME_LIMIT_MILLISECONDS=40;class gt{constructor(){this._data=void 0,this._colors=void 0,this._gender="M",this._isDisposed=void 0,this._avatarEffectType=-1}loadAvatarData(t,e){this._data=new Map,this._colors=new Map,this._gender=e,this.parseFigureString(t)}dispose(){this._data=null,this._colors=null,this._isDisposed=!0}get disposed(){return this._isDisposed}parseFigureString(t){if(t)for(const e of t.split(".")){const t=e.split("-");if(t.length>0){const e=t[0],s=parseInt(t[1]),i=[];let r=2;for(;r<t.length;)i.push(parseInt(t[r])),r++;i.length||i.push(0),this.savePartSetId(e,s,!1),this.savePartSetColourId(e,i,!1)}}}hasSetType(t){return!!this._data.get(t)}getPartSetId(t){return this.hasSetType(t)?this._data.get(t):-1}getColourIds(t){return this._colors.get(t)?this._colors.get(t):[]}getFigureString(){let t="";const e=[];for(const[i,r]of this._data.entries()){let t=i+"-"+r;const s=this._colors.get(i);if(s)for(const e of s)t=t+"-"+e;e.push(t)}let s=0;for(;s<e.length;)t+=e[s],s<e.length-1&&(t+="."),s++;return t}savePartData(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.savePartSetId(t,e,i),this.savePartSetColourId(t,s,i)}savePartSetId(t,e){switch(t){case gt.HD:case gt.HAIR:case gt.HAT:case gt.HEAD_ACCESSORIES:case gt.EYE_ACCESSORIES:case gt.FACE_ACCESSORIES:case gt.SHIRT:case gt.JACKET:case gt.CHEST_ACCESSORIES:case gt.CHEST_PRINTS:case gt.TROUSERS:case gt.SHOES:case gt.TROUSER_ACCESSORIES:e>=0?this._data.set(t,e):this._data.delete(t)}}savePartSetColourId(t,e){switch(t){case gt.HD:case gt.HAIR:case gt.HAT:case gt.HEAD_ACCESSORIES:case gt.EYE_ACCESSORIES:case gt.FACE_ACCESSORIES:case gt.SHIRT:case gt.JACKET:case gt.CHEST_ACCESSORIES:case gt.CHEST_PRINTS:case gt.TROUSERS:case gt.SHOES:case gt.TROUSER_ACCESSORIES:return void this._colors.set(t,e)}}getFigureStringWithFace(t){const e=[gt.HD];let s="";const i=[];for(const n of e){const e=this._colors.get(n);if(e){let s=this._data.get(n);n===gt.HD&&(s=t);let r=n+"-"+s;if(s>=0){let t=0;for(;t<e.length;)r=r+"-"+e[t],t++}i.push(r)}}let r=0;for(;r<i.length;)s+=i[r],r<i.length-1&&(s+="."),r++;return s}get gender(){return this._gender}}gt.MALE="M",gt.FEMALE="F",gt.UNISEX="U",gt.SCALE="h",gt.STD="std",gt.DEFAULT_FRAME="0",gt.HD="hd",gt.HAIR="hr",gt.HAT="ha",gt.HEAD_ACCESSORIES="he",gt.EYE_ACCESSORIES="ea",gt.FACE_ACCESSORIES="fa",gt.JACKET="cc",gt.SHIRT="ch",gt.CHEST_ACCESSORIES="ca",gt.CHEST_PRINTS="cp",gt.TROUSERS="lg",gt.SHOES="sh",gt.TROUSER_ACCESSORIES="wa",gt.BLOCKED_FX_TYPES=[28,29,30,33,34,35,36,37,38,39,40,41,42,43,68];class Et{constructor(t,e){this._name=void 0,this._link=void 0,this._flipH=void 0,this._flipV=void 0,this._name=t,this._link=e.link,this._flipH=e.flipH,this._flipV=e.flipV}get name(){return this._name}get link(){return this._link}get flipH(){return this._flipH}get flipV(){return this._flipV}}class pt{constructor(t,e){this._assets=void 0,this._aliases=void 0,this._avatarRenderManager=void 0,this._missingAssetNames=void 0,this._avatarRenderManager=t,this._aliases=new Map,this._assets=e,this._missingAssetNames=[]}dispose(){this._assets=null,this._aliases=null}reset(){this.init()}init(){for(const t of this._assets.collections.values()){if(!t)continue;const e=t.data&&t.data.aliases;if(e)for(const t in e){const s=e[t];s&&this._aliases.set(t,new Et(t,s))}}}hasAlias(t){return!!this._aliases.get(t)}getAssetName(t){let e=t,s=5;for(;this.hasAlias(e)&&s>=0;){e=this._aliases.get(e).link,s--}return e}getAsset(t){if(!this._assets)return null;t=this.getAssetName(t);const e=this._assets.getAsset(t);return e||null}}class mt extends d{constructor(t,e){super(t),this._library=void 0,this._library=e}get library(){return this._library}}mt.DOWNLOAD_COMPLETE="ARLE_DOWNLOAD_COMPLETE";class It extends g{constructor(t,e,s,i){super(),this._state=void 0,this._libraryName=void 0,this._revision=void 0,this._downloadUrl=void 0,this._assets=void 0,this._state=It.NOT_LOADED,this._libraryName=t,this._revision=e,this._downloadUrl=i,this._assets=s,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision);this._assets.getCollection(this._libraryName)&&(this._state=It.LOADED)}downloadAsset(){if(!this._assets||this._state===It.LOADING||this._state===It.LOADED)return;if(this._assets.getCollection(this._libraryName))return this._state=It.LOADED,void this.dispatchEvent(new mt(mt.DOWNLOAD_COMPLETE,this));this._state=It.LOADING,this._assets.downloadAsset(this._downloadUrl,(t=>{t&&(this._state=It.LOADED,this.dispatchEvent(new mt(mt.DOWNLOAD_COMPLETE,this)))}))}get libraryName(){return this._libraryName}get isLoaded(){return this._state===It.LOADED}}It.DOWNLOAD_COMPLETE="AADL_DOWNLOAD_COMPLETE",It.NOT_LOADED=0,It.LOADING=1,It.LOADED=2;class Tt{}Tt.AVATAR_RENDER_READY="AVATAR_RENDER_READY";class Rt extends g{constructor(t,e){super(),this._assets=void 0,this._structure=void 0,this._missingMandatoryLibs=void 0,this._figureMap=void 0,this._pendingContainers=void 0,this._figureListeners=void 0,this._incompleteFigures=void 0,this._pendingDownloadQueue=void 0,this._currentDownloads=void 0,this._libraryNames=void 0,this._isReady=void 0,this._assets=t,this._structure=e,this._missingMandatoryLibs=SU.instance.getConfiguration("avatar.mandatory.libraries"),this._figureMap=new Map,this._pendingContainers=[],this._figureListeners=new Map,this._incompleteFigures=new Map,this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadFigureMap(),this._structure.renderManager.events.addEventListener(Tt.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadFigureMap(){const t=new XMLHttpRequest;try{t.open("GET",SU.instance.getConfiguration("avatar.figuremap.url")),t.send(),t.onloadend=e=>{if(t.responseText){const e=JSON.parse(t.responseText);this.processFigureMap(e.libraries),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new d(Rt.DOWNLOADER_READY))}},t.onerror=t=>{throw new Error("invalid_avatar_figure_map")}}catch(e){this.logger.error(e)}}processFigureMap(t){if(t)for(const e of t){if(!e)continue;const t=e.id,s=e.revision||"";if(this._libraryNames.indexOf(t)>=0)continue;this._libraryNames.push(t);const i=new It(t,s,this._assets,SU.instance.getConfiguration("avatar.asset.url"));i.addEventListener(mt.DOWNLOAD_COMPLETE,this.onLibraryLoaded);for(const r of e.parts){const t=r.id,e=r.type+":"+t;let s=this._figureMap.get(e);s||(s=[]),s.push(i),this._figureMap.set(e,s)}}}onAvatarRenderReady(t){if(t){for(const[t,e]of this._pendingContainers)this.downloadAvatarFigure(t,e);this._pendingContainers=[]}}onLibraryLoaded(t){if(!t||!t.library)return;const e=[];for(const[i,r]of this._incompleteFigures.entries()){let t=!0;for(const e of r)if(e&&!e.isLoaded){t=!1;break}if(t){e.push(i);const t=this._figureListeners.get(i);if(t)for(const e of t)e&&!e.disposed&&e.resetFigure(i);this._figureListeners.delete(i),this.dispatchEvent(new d(Rt.LIBRARY_LOADED))}}for(const i of e)i&&this._incompleteFigures.delete(i);let s=0;for(;s<this._currentDownloads.length;){const e=this._currentDownloads[s];e&&e.libraryName===t.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const t=this._missingMandatoryLibs.slice();for(const e of t){if(!e)continue;const t=this._figureMap.get(e);if(t)for(const e of t)e&&this.downloadLibrary(e)}}isAvatarFigureContainerReady(t){if(!this._isReady||!this._structure.renderManager.isReady)return!1;return!this.getAvatarFigurePendingLibraries(t).length}getAvatarFigurePendingLibraries(t){const e=[];if(!t||!this._structure)return e;const s=this._structure.figureData;if(!s)return e;const i=t.getPartTypeIds();for(const r of i){const i=s.getSetType(r);if(!i)continue;const n=i.getPartSet(t.getPartSetId(r));if(n)for(const t of n.parts){if(!t)continue;const s=t.type+":"+t.id,i=this._figureMap.get(s);if(void 0!==i)for(const t of i)t&&!t.isLoaded&&(e.indexOf(t)>=0||e.push(t))}}return e}downloadAvatarFigure(t,e){if(!this._isReady||!this._structure.renderManager.isReady)return void this._pendingContainers.push([t,e]);const s=t.getFigureString(),i=this.getAvatarFigurePendingLibraries(t);if(i&&i.length){if(e&&!e.disposed){let t=this._figureListeners.get(s);t||(t=[],this._figureListeners.set(s,t)),t.push(e)}this._incompleteFigures.set(s,i);for(const t of i)t&&this.downloadLibrary(t)}else e&&!e.disposed&&e.resetFigure(s)}downloadLibrary(t){t&&!t.isLoaded&&(this._pendingDownloadQueue.indexOf(t)>=0||this._currentDownloads.indexOf(t)>=0||(this._pendingDownloadQueue.push(t),this.processDownloadQueue()))}processDownloadQueue(){for(;this._pendingDownloadQueue.length;){this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}}}Rt.DOWNLOADER_READY="AADM_DOWNLOADER_READY",Rt.LIBRARY_LOADED="AADM_LIBRARY_LOADED",Rt.MAX_DOWNLOADS=2;class ft{constructor(t){this._parts=void 0,this._parts=new Map,this.parseFigure(t)}getPartTypeIds(){return this.partSets().keys()}hasPartType(t){return!!this.partSets().get(t)}getPartSetId(t){const e=this.partSets().get(t);return e?e.get("setid"):0}getPartColorIds(t){const e=this.partSets().get(t);return e?e.get("colorids"):null}updatePart(t,e,s){const i=new Map;i.set("type",t),i.set("setid",e),i.set("colorids",s);const r=this.partSets();r.delete(t),r.set(t,i)}removePart(t){this.partSets().delete(t)}getFigureString(){const t=[];for(const e of this.partSets().keys()){if(!e)continue;let s=[];s.push(e),s.push(this.getPartSetId(e)),s=s.concat(this.getPartColorIds(e)),t.push(s.join("-"))}return t.join(".")}partSets(){return this._parts||(this._parts=new Map),this._parts}parseFigure(t){t||(t="");for(const e of t.split(".")){const t=e.split("-");if(t.length>=2){const e=t[0],s=parseInt(t[1]),i=[];let r=2;for(;r<t.length;)i.push(parseInt(t[r])),r++;this.updatePart(e,s,i)}}}}var Ot=s(50);class vt extends V{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vt.CHANNEL_RED;super("\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D lut;\nuniform int channel;\n\nvoid main(void) {\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n    vec4 adjusted = currentColor;\n\n    if(currentColor.a > 0.0)\n    {\n        if(channel == 0)\n        {\n            adjusted = texture2D(lut, vec2((currentColor.r * 255.0 + 0.5) / 256.0, 0.5));\n        } else if(channel == 1) {\n            adjusted = texture2D(lut, vec2((currentColor.g * 255.0 + 0.5) / 256.0, 0.5));\n        } else if(channel == 2) {\n            adjusted = texture2D(lut, vec2((currentColor.b * 255.0 + 0.5) / 256.0, 0.5));\n        } else if(channel == 3) {\n            adjusted = texture2D(lut, vec2((currentColor.a * 255.0 + 0.5) / 256.0, 0.5));\n        }\n    }\n\n    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, currentColor.a);\n}"),this._lut=void 0,this._channel=void 0,this._channel=e;let s=[];s=this.getLutForPalette(t),this._lut=B.fromBuffer(Uint8Array.from(s),s.length/4,1,{mipmap:0,scaleMode:0}),this.uniforms.lut=this._lut,this.uniforms.channel=this._channel}getLutForPalette(t){const e=[];for(let s=0;s<t.length;s++)e[4*s+vt.CHANNEL_RED]=t[s]>>16&255,e[4*s+vt.CHANNEL_GREEN]=t[s]>>8&255,e[4*s+vt.CHANNEL_BLUE]=255&t[s],e[4*s+vt.CHANNEL_ALPHA]=t[s]>>24&255;return e}get lut(){return this._lut}get channel(){return this._channel}}vt.CHANNEL_RED=0,vt.CHANNEL_GREEN=1,vt.CHANNEL_BLUE=2,vt.CHANNEL_ALPHA=3;class At{static generateTexture(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.p.NEAREST,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return t?this.getRenderer().generateTexture(t,{scaleMode:s,resolution:i,region:e}):null}static generateTextureFromImage(t){return t?i.t.from(t):null}static generateImage(t){return t?this.getExtractor().image(t):null}static generateImageUrl(t){return t?this.getExtractor().base64(t):null}static generateCanvas(t){return t?this.getExtractor().canvas(t):null}static getRenderer(){return SU.instance.renderer}static getExtractor(){return this.getRenderer().plugins.extract}}class St{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._actionType=void 0,this._actionParameter=void 0,this._definition=void 0,this._startFrame=void 0,this._overridingAction=void 0,this._actionType=t||"",this._actionParameter=e||"",this._definition=null,this._startFrame=s||0,this._overridingAction=null}dispose(){this._actionType=null,this._actionParameter=null,this._definition=null}get id(){return this._definition?this._definition.id+"_"+this._actionParameter:""}get actionType(){return this._actionType}get actionParameter(){return this._actionParameter}set actionParameter(t){this._actionParameter=t}get definition(){return this._definition}set definition(t){this._definition=t}get startFrame(){return this._startFrame}get overridingAction(){return this._overridingAction}set overridingAction(t){this._overridingAction=t}}class Nt{constructor(){this.objectId=void 0,this.x=void 0,this.y=void 0,this.z=void 0,this.name=void 0,this.blendMode=void 0,this.flipH=void 0,this.skew=void 0,this.frame=void 0,this.color=void 0,this.alpha=void 0,this.width=void 0,this.height=void 0,this.type=void 0,this.posture=void 0}}class Mt{constructor(t,e,s){if(this._id=void 0,this._action=void 0,this._animationFrame=void 0,this._dx=void 0,this._dy=void 0,this._dz=void 0,this._directionOffset=void 0,this._type=void 0,this._base=void 0,this._items=void 0,this._id=t.id,this._animationFrame=t.frame||0,this._dx=t.dx||0,this._dy=t.dy||0,this._dz=t.dz||0,this._directionOffset=t.dd||0,this._type=e,this._base=t.base||"",this._items=new Map,t.items)for(const r of t.items)this._items.set(r.id,r.base);let i="";""!==this._base&&this.baseAsInt().toString(),s&&(this._action=new St(s.state,this.base),this._action.definition=s)}get items(){return this._items}baseAsInt(){let t=0,e=0;for(;e<this._base.length;)t+=this._base.charCodeAt(e),e++;return t}get id(){return this._id}get animationFrame(){return this._animationFrame}get dx(){return this._dx}get dy(){return this._dy}get dz(){return this._dz}get dd(){return this._directionOffset}get type(){return this._type}get base(){return this._base}get action(){return this._action}}Mt.BODYPART="bodypart",Mt.FX="fx";class yt{constructor(t,e,s){this._image=void 0,this._regPoint=void 0,this._offset=void 0,this._isCacheable=void 0,this._image=t,this._regPoint=e,this._offset=new j.g(0,0),this._regPoint=e,this._isCacheable=s,this.cleanPoints()}dispose(){this._image&&this._image.destroy({children:!0}),this._image=null,this._regPoint=null,this._offset=null}cleanPoints(){}setRegPoint(t){this._regPoint=t,this.cleanPoints()}get image(){return this._image}set image(t){this._image&&this._image!==t&&this._image.destroy({children:!0}),this._image=t}get regPoint(){const t=this._regPoint.clone();return t.x+=this._offset.x,t.y+=this._offset.y,t}set offset(t){this._offset=t,this.cleanPoints()}get isCacheable(){return this._isCacheable}}class Dt{}Dt.DIRECTION_TO_ANGLE=[45,90,135,180,225,270,315,0],Dt.DIRECTION_IS_FLIPPED=[!1,!1,!1,!1,!0,!0,!0,!1],Dt.MIN_DIRECTION=0,Dt.MAX_DIRECTION=7;class Ct{}Ct.BODY="bd",Ct.SHOES="sh",Ct.LEGS="lg",Ct.CHEST="ch",Ct.WAIST_ACCESSORY="wa",Ct.CHEST_ACCESSORY="ca",Ct.HEAD="hd",Ct.HAIR="hr",Ct.FACE_ACCESSORY="fa",Ct.EYE_ACCESSORY="ea",Ct.HEAD_ACCESSORY="ha",Ct.HEAD_ACCESSORY_EXTRA="he",Ct.COAT_CHEST="cc",Ct.CHEST_PRINT="cp",Ct.LEFT_HAND_ITEM="li",Ct.LEFT_HAND="lh",Ct.LEFT_SLEEVE="ls",Ct.RIGHT_HAND="rh",Ct.RIGHT_SLEEVE="rs",Ct.FACE="fc",Ct.EYES="ey",Ct.HAIR_BIG="hrb",Ct.RIGHT_HAND_ITEM="ri",Ct.LEFT_COAT_SLEEVE="lc",Ct.RIGHT_COAT_SLEEVE="rc",Ct.FIGURE_SETS=[Ct.SHOES,Ct.LEGS,Ct.CHEST,Ct.WAIST_ACCESSORY,Ct.CHEST_ACCESSORY,Ct.HEAD,Ct.HAIR,Ct.FACE_ACCESSORY,Ct.EYE_ACCESSORY,Ct.HEAD_ACCESSORY,Ct.HEAD_ACCESSORY_EXTRA,Ct.COAT_CHEST,Ct.CHEST_PRINT];class Lt{}Lt.LARGE="h",Lt.SMALL="sh";class Ut{}Ut.VERTICAL="vertical",Ut.SITTING="sitting",Ut.HORIZONTAL="horizontal",Ut.SWIM="swim",Ut.SNOWWARS_HORIZONTAL="swhorizontal";class Pt{constructor(){this._cache=void 0,this._lastAccessTime=void 0,this._cache=new Map,this.setLastAccessTime(SU.instance.time)}dispose(){if(this.debugInfo("[dispose]"),this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache.clear()}}getDirectionCache(t){const e=this._cache.get(t.toString());return e||null}updateDirectionCache(t,e){this._cache.set(t.toString(),e)}setLastAccessTime(t){this._lastAccessTime=t}getLastAccessTime(){return this._lastAccessTime}debugInfo(t){}}class bt{constructor(){this._cache=void 0,this._currentAction=void 0,this._currentDirection=void 0,this._disposed=void 0,this._cache=new Map}setAction(t,e){this._currentAction||(this._currentAction=t);const s=this.getActionCache(this._currentAction);s&&s.setLastAccessTime(e),this._currentAction=t}dispose(){if(!this._disposed){if(!this._cache)return;this.disposeActions(0,2147483647),this._cache.clear(),this._cache=null,this._disposed=!0}}disposeActions(t,e){if(this._cache&&!this._disposed)for(const[s,i]of this._cache.entries()){if(!i)continue;e-i.getLastAccessTime()>=t&&(i.dispose(),this._cache.delete(s))}}getAction(){return this._currentAction}setDirection(t){this._currentDirection=t}getDirection(){return this._currentDirection}getActionCache(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._currentAction?(t||(t=this._currentAction),t.overridingAction?this._cache.get(t.overridingAction):this._cache.get(t.id)):null}updateActionCache(t,e){t.overridingAction?this._cache.set(t.overridingAction,e):this._cache.set(t.id,e)}debugInfo(t){}}class wt{constructor(t){this._partList=void 0,this._images=void 0,this._partList=t,this._images=new Map}dispose(){for(const t of this._images.values())t&&t.dispose();this._images=null}getPartList(){return this._partList}getImageContainer(t){const e=this._images.get(this.getCacheKey(t));return e||null}updateImageContainer(t,e){const s=this.getCacheKey(e),i=this._images.get(s);i&&i.dispose(),this._images.set(s,t)}getCacheKey(t){let e="";for(const s of this._partList)e+=s.getCacheableKey(t)+"/";return e}debugInfo(t){}}class Ft{constructor(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this._texture=void 0,this._container=void 0,this._rect=void 0,this._regPoint=void 0,this._flipH=void 0,this._colorTransform=void 0,this._texture=t,this._container=n,this._rect=e,this._regPoint=s,this._flipH=i,this._colorTransform=r,i&&(this._regPoint.x=-this._regPoint.x+e.width)}dispose(){this._texture=null,this._regPoint=null,this._colorTransform=null}get texture(){return this._texture}get container(){return this._container}get rect(){return this._rect}get regPoint(){return this._regPoint}get flipH(){return this._flipH}get colorTransform(){return this._colorTransform}get offsetRect(){return new j.j(-this._regPoint.x,-this._regPoint.y,this._rect.width,this._rect.height)}}class xt{constructor(t,e,s,i){this._structure=void 0,this._avatar=void 0,this._assets=void 0,this._scale=void 0,this._cache=void 0,this._canvas=void 0,this._disposed=void 0,this._geometryType=void 0,this._unionImages=void 0,this._matrix=void 0,this._serverRenderData=void 0,this._structure=t,this._avatar=e,this._assets=s,this._scale=i,this._cache=new Map,this._canvas=null,this._disposed=!1,this._unionImages=[],this._matrix=new j.d,this._serverRenderData=[]}dispose(){if(!this._disposed){if(this._structure=null,this._avatar=null,this._assets=null,this._canvas=null,this._disposed=!0,this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache=null}if(this._unionImages){for(const t of this._unionImages)t&&t.dispose();this._unionImages=[]}}}disposeInactiveActions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e4;const e=SU.instance.time;if(this._cache)for(const s of this._cache.values())s&&s.disposeActions(t,e)}resetBodyPartCache(t){if(this._cache)for(const e of this._cache.values())e&&e.setAction(t,0)}setDirection(t,e){const s=this._structure.getBodyPartsUnordered(t);if(s)for(const i of s){const t=this.getBodyPartCache(i);t&&t.setDirection(e)}}setAction(t,e){const s=this._structure.getActiveBodyPartIds(t,this._avatar);for(const i of s){const s=this.getBodyPartCache(i);s&&s.setAction(t,e)}}setGeometryType(t){if(this._geometryType!==t){if(this._geometryType===Ut.SITTING&&t===Ut.VERTICAL||this._geometryType===Ut.VERTICAL&&t===Ut.SITTING||this._geometryType===Ut.SNOWWARS_HORIZONTAL&&(t=Ut.SNOWWARS_HORIZONTAL))return this._geometryType=t,void(this._canvas=null);this.disposeInactiveActions(0),this._geometryType=t,this._canvas=null}}getImageContainer(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getBodyPartCache(t);i||(i=new bt,this._cache.set(t,i));let r=i.getDirection(),n=i.getAction(),a=e;n.definition.startFromFrameZero&&(a-=n.startFrame);let o=n,h=[],_=new Map;const d=new j.g;if(n&&n.definition&&n.definition.isAnimation){let s=r;const i=this._structure.getAnimation(n.definition.state+"."+n.actionParameter),u=e-n.startFrame;if(i){const e=i.getLayerData(u,t,n.overridingAction);e&&(s=r+e.dd,e.dd<0?s<0?s=8+s:s>7&&(s=8-s):s<0?s+=8:s>7&&(s-=8),this._scale===Lt.LARGE?(d.x=e.dx,d.y=e.dy):(d.x=e.dx/2,d.y=e.dy/2),a=e.animationFrame,e.action&&(n=e.action),e.type===Mt.BODYPART?(null!=e.action&&(o=e.action),r=s):e.type===Mt.FX&&(r=s),_=e.items),h=i.removeData}}let u=i.getActionCache(o);u&&!s||(u=new Pt,i.updateActionCache(o,u));let c=u.getDirectionCache(r);if(!c||s){const e=this._structure.getParts(t,this._avatar.getFigure(),o,this._geometryType,r,h,this._avatar,_);c=new wt(e),u.updateDirectionCache(r,c)}let l=c.getImageContainer(a);if(!l||s){const t=c.getPartList();if(l=this.renderBodyPart(r,t,a,n,s),!l||s)return null;l.isCacheable&&c.updateImageContainer(l,a)}const g=this._structure.getFrameBodyPartOffset(o,r,a,t);return d.x+=g.x,d.y+=g.y,l.offset=d,l}getServerRenderData(){return this._serverRenderData=[],this._serverRenderData}getBodyPartCache(t){let e=this._cache.get(t);return e||(e=new bt,this._cache.set(t,e)),e}renderBodyPart(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!e||!e.length)return null;if(!this._canvas&&(this._canvas=this._structure.getCanvas(this._scale,this._geometryType),!this._canvas))return null;const n=Dt.DIRECTION_IS_FLIPPED[t]||!1;let a=i.definition.assetPartDefinition,o=!0,h=e.length-1;for(;h>=0;){const i=e[h];let _=16777215;if((7!=t||"fc"!==i.partType&&"ey"!==i.partType)&&("ri"!==i.partType||i.partId)){const e=i.partId,h=i.getFrameDefinition(s);let d=i.partType,u=0;h?(u=h.number,h.assetPartDefinition&&""!==h.assetPartDefinition&&(a=h.assetPartDefinition)):u=i.getFrameIndex(s);let c=t,l=!1;n&&("wav"===a&&(d===Ct.LEFT_HAND||d===Ct.LEFT_SLEEVE||d===Ct.LEFT_COAT_SLEEVE)||"drk"===a&&(d===Ct.RIGHT_HAND||d===Ct.RIGHT_SLEEVE||d===Ct.RIGHT_COAT_SLEEVE)||"blw"===a&&d===Ct.RIGHT_HAND||"sig"===a&&d===Ct.LEFT_HAND||"respect"===a&&d===Ct.LEFT_HAND||d===Ct.RIGHT_HAND_ITEM||d===Ct.LEFT_HAND_ITEM||d===Ct.CHEST_PRINT?l=!0:(4===t?c=2:5===t?c=1:6===t&&(c=0),i.flippedPartType!==d&&(d=i.flippedPartType)));let g=this._scale+"_"+a+"_"+d+"_"+e+"_"+c+"_"+u,E=this._assets.getAsset(g);if(E||(g=this._scale+"_std_"+d+"_"+e+"_"+c+"_0",E=this._assets.getAsset(g)),E){const t=E.texture;if(t&&t.valid&&t.baseTexture){i.isColorable&&i.color&&(_=i.color.rgb);const e=new j.g(-E.x,-E.y);if(l&&(e.x=e.x+(this._scale===Lt.LARGE?65:31)),r){const s=new Nt;s.name=this._assets.getAssetName(g),s.x=-e.x-33,s.y=-e.y,s.z=-1e-4*this._serverRenderData.length,s.width=E.rectangle.width,s.height=E.rectangle.height,s.flipH=l,"lay"===a&&(s.x=s.x+53),n&&(s.flipH=!s.flipH,s.flipH?s.x=-s.x-t.width:s.x=s.x+65),i.isColorable&&(s.color=`${_}`),this._serverRenderData.push(s)}this._unionImages.push(new Ft(t,E.rectangle,e,l,_))}else o=!1}}h--}if(!this._unionImages.length)return null;const _=this.createUnionImage(this._unionImages,n),d=this._scale===Lt.LARGE?this._canvas.height-16:this._canvas.height-8,u=new j.g(-_.regPoint.x,d-_.regPoint.y);n&&"lay"!==a&&(u.x=u.x+(this._scale===Lt.LARGE?67:31));let c=this._unionImages.length-1;for(;c>=0;){const t=this._unionImages.pop();t&&t.dispose(),c--}return new yt(_.container,u,o)}convertColorToHex(t){let e=(255*t).toString(16);return e.length<2&&(e="0"+e),e}createUnionImage(t,e){const s=new j.j;for(const i of t)i&&s.enlarge(i.offsetRect);const r=new j.g(-s.x,-s.y),n=new H,a=new W(i.t.EMPTY);a.width=s.width,a.height=s.height,n.addChild(a);for(const i of t){if(!i)continue;const t=i.texture,s=i.colorTransform,a=!(e&&i.flipH)&&(e||i.flipH),o=r.clone();o.x-=i.regPoint.x,o.y-=i.regPoint.y,e&&(o.x=n.width-(o.x+i.rect.width)),a?(this._matrix.a=-1,this._matrix.tx=i.rect.x+i.rect.width+o.x,this._matrix.ty=o.y-i.rect.y):(this._matrix.a=1,this._matrix.tx=o.x-i.rect.x,this._matrix.ty=o.y-i.rect.y);const h=new W(t);h.tint=s,h.transform.setFromMatrix(this._matrix),n.addChild(h)}return new Ft(null,n.getLocalBounds(),r,e,null,n)}}xt.DEFAULT_MAX_CACHE_STORAGE_TIME_MS=6e4;class Bt{static getExpressionTimeout(t){switch(t=parseInt(t)){case 1:return 5e3;case 2:return 1400;case 3:case 4:case 7:return 2e3;case 5:default:return 0;case 6:return 700;case 8:case 9:case 10:return 1500}}static getExpressionId(t){return Bt.EXPRESSION_MAP.indexOf(t)}static getExpression(t){return t>Bt.EXPRESSION_MAP.length?null:Bt.EXPRESSION_MAP[t]}static getGestureId(t){return Bt.GESTURE_MAP.indexOf(t)}static getGesture(t){return t>Bt.GESTURE_MAP.length?null:Bt.GESTURE_MAP[t]}static idToAvatarActionState(t){return"Lay"===t?"lay":"Float"===t?"float":"Swim"===t?"swim":"Sit"===t?"sit":"Respect"===t?"respect":"Wave"===t?"wave":"Idle"===t?"idle":"Dance"===t?"dance":"UseItem"===t?"usei":"CarryItem"===t?"cri":"Talk"===t?"talk":"Sleep"===t?"Sleep":"Move"===t?"mv":"std"}}Bt.CARRY_OBJECT="cri",Bt.DANCE="dance",Bt.EFFECT="fx",Bt.EXPRESSION="expression",Bt.EXPRESSION_BLOW_A_KISS="blow",Bt.EXPRESSION_CRY="cry",Bt.EXPRESSION_IDLE="idle",Bt.EXPRESSION_LAUGH="laugh",Bt.EXPRESSION_RESPECT="respect",Bt.EXPRESSION_RIDE_JUMP="ridejump",Bt.EXPRESSION_SNOWBOARD_OLLIE="sbollie",Bt.EXPRESSION_SNOWBORD_360="sb360",Bt.EXPRESSION_WAVE="wave",Bt.GESTURE="gest",Bt.GESTURE_AGGRAVATED="agr",Bt.GESTURE_SAD="sad",Bt.GESTURE_SMILE="sml",Bt.GESTURE_SURPRISED="srp",Bt.GUIDE_STATUS="guide",Bt.MUTED="muted",Bt.PET_GESTURE_BLINK="eyb",Bt.PET_GESTURE_CRAZY="crz",Bt.PET_GESTURE_JOY="joy",Bt.PET_GESTURE_MISERABLE="mis",Bt.PET_GESTURE_PUZZLED="puz",Bt.PET_GESTURE_TONGUE="tng",Bt.PLAYING_GAME="playing_game",Bt.POSTURE="posture",Bt.POSTURE_FLOAT="float",Bt.POSTURE_LAY="lay",Bt.POSTURE_SIT="sit",Bt.POSTURE_STAND="std",Bt.POSTURE_SWIM="swim",Bt.POSTURE_WALK="mv",Bt.SIGN="sign",Bt.SLEEP="sleep",Bt.SNOWWAR_DIE_BACK="swdieback",Bt.SNOWWAR_DIE_FRONT="swdiefront",Bt.SNOWWAR_PICK="swpick",Bt.SNOWWAR_RUN="swrun",Bt.SNOWWAR_THROW="swthrow",Bt.TALK="talk",Bt.BLINK="blink",Bt.TYPING="typing",Bt.USE_OBJECT="usei",Bt.VOTE="vote",Bt.GESTURE_MAP=["",Bt.GESTURE_SMILE,Bt.GESTURE_AGGRAVATED,Bt.GESTURE_SURPRISED,Bt.GESTURE_SAD,Bt.PET_GESTURE_JOY,Bt.PET_GESTURE_CRAZY,Bt.PET_GESTURE_TONGUE,Bt.PET_GESTURE_BLINK,Bt.PET_GESTURE_MISERABLE,Bt.PET_GESTURE_PUZZLED],Bt.EXPRESSION_MAP=["",Bt.EXPRESSION_WAVE,Bt.EXPRESSION_BLOW_A_KISS,Bt.EXPRESSION_LAUGH,Bt.EXPRESSION_CRY,Bt.EXPRESSION_IDLE,Bt.DANCE,Bt.EXPRESSION_RESPECT,Bt.EXPRESSION_SNOWBOARD_OLLIE,Bt.EXPRESSION_SNOWBORD_360,Bt.EXPRESSION_RIDE_JUMP];class Gt{}Gt.FULL="full",Gt.HEAD="head",Gt.BODY="body";class Ht{constructor(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this._structure=void 0,this._scale=void 0,this._mainDirection=void 0,this._headDirection=void 0,this._mainAction=void 0,this._disposed=void 0,this._canvasOffsets=void 0,this._assets=void 0,this._cache=void 0,this._figure=void 0,this._avatarSpriteData=void 0,this._actions=void 0,this._image=void 0,this._reusableTexture=void 0,this._defaultAction=void 0,this._frameCounter=0,this._directionOffset=0,this._changes=void 0,this._sprites=void 0,this._isAnimating=!1,this._animationHasResetOnToggle=!1,this._actionsSorted=!1,this._sortedActions=void 0,this._lastActionsString=void 0,this._currentActionsString=void 0,this._fullImageCache=void 0,this._fullImageCacheSize=5,this._isCachedImage=!1,this._useFullImageCache=!1,this._effectIdInUse=-1,this._animationFrameCount=void 0,this._cachedBodyParts=void 0,this._cachedBodyPartsDirection=-1,this._cachedBodyPartsGeometryType=null,this._cachedBodyPartsAvatarSet=null,this._effectManager=void 0,this._effectListener=void 0,this._canvasOffsets=[],this._actions=[],this._cachedBodyParts=[],this._changes=!0,this._disposed=!1,this._effectManager=r,this._structure=t,this._assets=e,this._scale=i,this._effectListener=n,null==this._scale&&(this._scale=Lt.LARGE),null==s&&(s=new ft("hr-893-45.hd-180-2.ch-210-66.lg-270-82.sh-300-91.wa-2007-.ri-1-")),this._figure=s,this._cache=new xt(this._structure,this,this._assets,this._scale),this.setDirection(Ht.DEFAULT_AVATAR_SET,Ht.DEFAULT_DIRECTION),this._actions=[],this._defaultAction=new St(Bt.POSTURE_STAND),this._defaultAction.definition=this._structure.getActionDefinition(Ht.DEFAULT_ACTION),this.resetActions(),this._fullImageCache=new U,this._animationFrameCount=0}getServerRenderData(){return this.getAvatarPartsForCamera(Gt.FULL),this._cache.getServerRenderData()}dispose(){if(!this._disposed){if(this._structure=null,this._assets=null,this._mainAction=null,this._figure=null,this._avatarSpriteData=null,this._actions=null,this._image&&(this._image.destroy(),this._image=null),this._cache&&(this._cache.dispose(),this._cache=null),this._fullImageCache){for(const t of this._fullImageCache.getValues())t&&t.destroy();this._fullImageCache=null}this._image=null,this._canvasOffsets=null,this._disposed=!0}}get disposed(){return this._disposed}getFigure(){return this._figure}getScale(){return this._scale}getPartColor(t){return this._structure.getPartColor(this._figure,t)}setDirection(t,e){(e+=this._directionOffset)<Dt.MIN_DIRECTION&&(e=Dt.MAX_DIRECTION+(e+1)),e>Dt.MAX_DIRECTION&&(e-=Dt.MAX_DIRECTION+1),this._structure.isMainAvatarSet(t)&&(this._mainDirection=e),t!==Gt.HEAD&&t!==Gt.FULL||(t===Gt.HEAD&&this.isHeadTurnPreventedByAction()&&(e=this._mainDirection),this._headDirection=e),this._cache.setDirection(t,e),this._changes=!0}setDirectionAngle(t,e){this.setDirection(t,Math.floor(e/45))}getSprites(){return this._sprites}getCanvasOffsets(){return this._canvasOffsets}getLayerData(t){return this._structure.getBodyPartData(t.animation.id,this._frameCounter,t.id)}updateAnimationByFrames(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._frameCounter+=t,this._changes=!0}resetAnimationFrameCounter(){this._frameCounter=0,this._changes=!0}getFullImageCacheKey(){if(!this._useFullImageCache)return null;if(1==this._sortedActions.length&&this._mainDirection==this._headDirection)return this._mainDirection+this._currentActionsString+this._frameCounter%4;if(2==this._sortedActions.length)for(const t of this._sortedActions){if("fx"==t.actionType&&("33"==t.actionParameter||"34"==t.actionParameter||"35"==t.actionParameter||"36"==t.actionParameter))return this._mainDirection+this._currentActionsString+0;if("fx"==t.actionType&&("38"==t.actionParameter||"39"==t.actionParameter))return this._mainDirection+"_"+this._headDirection+this._currentActionsString+this._frameCounter%11;if("dance"===t.actionType&&("1"===t.actionParameter||"2"===t.actionParameter||"3"===t.actionParameter||"4"===t.actionParameter)){let e=this._frameCounter%8;return"3"===t.actionParameter&&(e=this._frameCounter%10),"4"===t.actionParameter&&(e=this._frameCounter%16),this._mainDirection+t.actionType+t.actionParameter+e}}return null}getBodyParts(t,e,s){return s==this._cachedBodyPartsDirection&&e==this._cachedBodyPartsGeometryType&&t==this._cachedBodyPartsAvatarSet||(this._cachedBodyPartsDirection=s,this._cachedBodyPartsGeometryType=e,this._cachedBodyPartsAvatarSet=t,this._cachedBodyParts=this._structure.getBodyParts(t,e,s)),this._cachedBodyParts}getAvatarPartsForCamera(t){let e;if(null==this._mainAction)return;if(null==this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType))return;const s=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection);let i=s.length-1;for(;i>=0;){e=s[i];this._cache.getImageContainer(e,this._frameCounter,!0);i--}}getImage(t,e){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!this._changes)return this._image;if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const i=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!i)return null;!this._image||this._image.width===i.width&&this._image.height===i.height||(this._reusableTexture&&(this._reusableTexture.destroy(!0),this._reusableTexture=null),this._image=null,this._isCachedImage=!1);const r=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection);this._image=null;const n=new H;let a=!0,o=r.length-1;for(;o>=0;){const t=r[o],e=this._cache.getImageContainer(t,this._frameCounter);if(e){const t=e.image;if(!t)return n.destroy({children:!0}),null;a=a&&e.isCacheable;const s=e.regPoint.clone();if(s){s.x+=i.offset.x,s.y+=i.offset.y,s.x+=i.regPoint.x,s.y+=i.regPoint.y;const e=new H;e.addChild(t),e&&(e.position.set(s.x,s.y),n.addChild(e))}}o--}return this._avatarSpriteData&&(n.filters||(n.filters=[]),this._avatarSpriteData.colorTransform&&n.filters.push(this._avatarSpriteData.colorTransform),this._avatarSpriteData.paletteIsGrayscale&&(this.convertToGrayscale(n),n.filters.push(new vt(this._avatarSpriteData.reds,vt.CHANNEL_RED)))),s?(this._reusableTexture?SU.instance.renderer.render(n,{renderTexture:this._reusableTexture,clear:!0}):this._reusableTexture=At.generateTexture(n,new j.j(0,0,i.width,i.height)),this._reusableTexture?(this._image=this._reusableTexture,this._changes=!1,this._image):null):At.generateTexture(n,new j.j(0,0,i.width,i.height))}applyPalette(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const n=At.generateCanvas(t),a=n.getContext("2d"),o=a.getImageData(0,0,n.width,n.height),h=o.data;for(let i=0;i<h.length;i+=4){if(256==e.length){let t=e[h[i]];void 0===t&&(t=0),h[i]=t>>16&255,h[i+1]=t>>8&255,h[i+2]=255&t}if(256==s.length){let t=s[h[i+1]];void 0===t&&(t=0),h[i]=t>>16&255,h[i+1]=t>>8&255,h[i+2]=255&t}if(256==r.length){let t=s[h[i+2]];void 0===t&&(t=0),h[i]=t>>16&255,h[i+1]=t>>8&255,h[i+2]=255&t}}a.putImageData(o,0,0);const _=new z.a(i.t.from(n));return SU.instance.renderer.render(_,{renderTexture:t,clear:!0}),t}getImageAsSprite(t){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const e=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!e)return null;const s=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection),r=new W,n=new W(i.t.EMPTY);n.width=e.width,n.height=e.height,r.addChild(n);let a=s.length-1;for(;a>=0;){const t=s[a],i=this._cache.getImageContainer(t,this._frameCounter);if(i){const t=i.image;if(!t)return r.destroy({children:!0}),null;const s=i.regPoint.clone();if(s){s.x+=e.offset.x,s.y+=e.offset.y,s.x+=e.regPoint.x,s.y+=e.regPoint.y;const i=new H;i.addChild(t),i.position.set(s.x,s.y),r.addChild(i)}}a--}return r}getCroppedImage(t){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const e=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!e)return null;const s=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection),i=new H;let r=s.length-1;for(;r>=0;){const t=s[r],n=this._cache.getImageContainer(t,this._frameCounter);if(n){const t=n.image;if(!t)return i.destroy({children:!0}),null;const s=n.regPoint.clone();if(s){s.x+=e.offset.x,s.y+=e.offset.y,s.x+=e.regPoint.x,s.y+=e.regPoint.y;const r=new H;r.addChild(t),r&&(r.position.set(s.x,s.y),i.addChild(r))}}r--}const n=At.generateTexture(i,new j.j(0,0,e.width,e.height)),a=At.generateImage(n);return a||null}getFullImage(t){const e=this._fullImageCache.getValue(t);return e?(e.valid||(this._fullImageCache.remove(t),e.destroy(!0)),e):null}cacheFullImage(t,e){const s=this._fullImageCache.getValue(t);if(s&&(this._fullImageCache.remove(t),s.destroy(!0)),this._fullImageCache.length===this._fullImageCacheSize){const t=this._fullImageCache.getKey(0);if(t){this._fullImageCache.remove(t).destroy(!0)}}this._fullImageCache.add(t,e)}getAsset(t){return this._assets.getAsset(t)}getDirection(){return this._mainDirection}initActionAppends(){this._actions=[],this._actionsSorted=!1,this._currentActionsString="",this._useFullImageCache=!1}endActionAppends(){if(this.sortActions()){for(const t of this._sortedActions)t.actionType===Bt.EFFECT&&(this._effectManager.isAvatarEffectReady(parseInt(t.actionParameter))||this._effectManager.downloadAvatarEffect(parseInt(t.actionParameter),this));this.resetActions(),this.setActionsToParts()}}appendAction(t){let e="";this._actionsSorted=!1;for(var s=arguments.length,i=new Array(s>1?s-1:0),r=1;r<s;r++)i[r-1]=arguments[r];switch(i&&i.length>0&&(e=i[0]),void 0!==e&&null!==e&&(e=e.toString()),t){case Bt.POSTURE:switch(e){case Bt.POSTURE_LAY:case Bt.POSTURE_WALK:case Bt.POSTURE_STAND:case Bt.POSTURE_SWIM:case Bt.POSTURE_FLOAT:case Bt.POSTURE_SIT:case Bt.SNOWWAR_RUN:case Bt.SNOWWAR_DIE_FRONT:case Bt.SNOWWAR_DIE_BACK:case Bt.SNOWWAR_PICK:case Bt.SNOWWAR_THROW:e!==Bt.POSTURE_LAY&&e!==Bt.POSTURE_LAY&&e!==Bt.POSTURE_LAY||(e===Bt.POSTURE_LAY&&(0==this._mainDirection?this.setDirection(Gt.FULL,4):this.setDirection(Gt.FULL,2)),this._useFullImageCache=!0,this._useFullImageCache=!0),this.addActionData(e)}break;case Bt.GESTURE:switch(e){case Bt.GESTURE_AGGRAVATED:case Bt.GESTURE_SAD:case Bt.GESTURE_SMILE:case Bt.GESTURE_SURPRISED:this.addActionData(e)}break;case Bt.EFFECT:case Bt.DANCE:case Bt.TALK:case Bt.EXPRESSION_WAVE:case Bt.SLEEP:case Bt.SIGN:case Bt.EXPRESSION_RESPECT:case Bt.EXPRESSION_BLOW_A_KISS:case Bt.EXPRESSION_LAUGH:case Bt.EXPRESSION_CRY:case Bt.EXPRESSION_IDLE:case Bt.EXPRESSION_SNOWBOARD_OLLIE:case Bt.EXPRESSION_SNOWBORD_360:case Bt.EXPRESSION_RIDE_JUMP:e===Bt.EFFECT&&("33"!==e&&"34"!==e&&"35"!==e&&"36"!==e&&"38"!==e&&"39"!==e||(this._useFullImageCache=!0)),this.addActionData(t,e);break;case Bt.CARRY_OBJECT:case Bt.USE_OBJECT:{const s=this._structure.getActionDefinitionWithState(t);s&&(e=s.getParameterValue(e)),this.addActionData(t,e);break}}return!0}addActionData(t){let e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this._actions||(this._actions=[]);let i=0;for(;i<this._actions.length;){if(e=this._actions[i],e.actionType==t&&e.actionParameter==s)return;i++}this._actions.push(new St(t,s,this._frameCounter))}isAnimating(){return this._isAnimating||this._animationFrameCount>1}resetActions(){return this._animationHasResetOnToggle=!1,this._isAnimating=!1,this._sprites=[],this._avatarSpriteData=null,this._directionOffset=0,this._structure.removeDynamicItems(this),this._mainAction=this._defaultAction,this._mainAction.definition=this._defaultAction.definition,this.resetBodyPartCache(this._defaultAction),!0}isHeadTurnPreventedByAction(){let t,e;if(null==this._sortedActions)return!1;for(const s of this._sortedActions)t=this._structure.getActionDefinitionWithState(s.actionType),null!=t&&t.getPreventHeadTurn(s.actionParameter)&&(e=!0);return e}sortActions(){let t,e,s;if(this._currentActionsString="",this._sortedActions=this._structure.sortActions(this._actions),this._animationFrameCount=this._structure.maxFrames(this._sortedActions),this._sortedActions){this._canvasOffsets=this._structure.getCanvasOffsets(this._sortedActions,this._scale,this._mainDirection);for(const s of this._sortedActions)if(this._currentActionsString=this._currentActionsString+(s.actionType+s.actionParameter),s.actionType===Bt.EFFECT){const i=parseInt(s.actionParameter);this._effectIdInUse!==i&&(t=!0),this._effectIdInUse=i,e=!0}e||(this._effectIdInUse>-1&&(t=!0),this._effectIdInUse=-1),t&&this._cache.disposeInactiveActions(0),this._lastActionsString!=this._currentActionsString&&(s=!0,this._lastActionsString=this._currentActionsString)}else this._canvasOffsets=[0,0,0],""!==this._lastActionsString&&(s=!0,this._lastActionsString="");return this._actionsSorted=!0,s}setActionsToParts(){if(null==!this._sortedActions)return;const t=SU.instance.time,e=[];for(const s of this._sortedActions)e.push(s.actionType);for(const s of this._sortedActions)if(s&&s.definition&&s.definition.isAnimation){const t=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);if(t&&t.hasOverriddenActions()){const i=t.overriddenActionNames();if(i)for(const r of i)e.indexOf(r)>=0&&(s.overridingAction=t.overridingAction(r))}t&&t.resetOnToggle&&(this._animationHasResetOnToggle=!0)}for(const s of this._sortedActions)if(s&&s.definition&&(s.definition.isAnimation&&""===s.actionParameter&&(s.actionParameter="1"),this.setActionToParts(s,t),s.definition.isAnimation)){this._isAnimating=s.definition.isAnimated(s.actionParameter);const t=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);t&&(this._sprites=this._sprites.concat(t.spriteData),t.hasDirectionData()&&(this._directionOffset=t.directionData.offset),t.hasAvatarData()&&(this._avatarSpriteData=t.avatarData))}}setActionToParts(t,e){null!=t&&null!=t.definition&&""!=t.definition.assetPartDefinition&&(t.definition.isMain&&(this._mainAction=t,this._cache.setGeometryType(t.definition.geometryType)),this._cache.setAction(t,e),this._changes=!0)}resetBodyPartCache(t){t&&""!==t.definition.assetPartDefinition&&(t.definition.isMain&&(this._mainAction=t,this._cache.setGeometryType(t.definition.geometryType)),this._cache.resetBodyPartCache(t),this._changes=!0)}get avatarSpriteData(){return this._avatarSpriteData}convertToGrayscale(t){let e=.33,s=.33,i=.33;switch(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CHANNELS_EQUAL"){case Ht.CHANNELS_UNIQUE:e=.3,s=.59,i=.11;break;case Ht.CHANNELS_RED:e=1,s=0,i=0;break;case Ht.CHANNELS_GREEN:e=0,s=1,i=0;break;case Ht.CHANNELS_BLUE:e=0,s=0,i=1;break;case Ht.CHANNELS_DESATURATED:e=.3086,s=.6094,i=.082}const r=new Ot.a;return r.matrix=[e,s,i,0,0,e,s,i,0,0,e,s,i,0,0,0,0,0,1,0],t.filters.push(r),t}errorThis(t){}logThis(t){}isPlaceholder(){return!1}forceActionUpdate(){this._lastActionsString=""}get animationHasResetOnToggle(){return this._animationHasResetOnToggle}get mainAction(){return this._mainAction.actionType}resetEffect(t){t===this._effectIdInUse&&(this.resetActions(),this.setActionsToParts(),this._animationHasResetOnToggle=!0,this._changes=!0,this._effectListener&&this._effectListener.resetEffect(t))}}Ht.CHANNELS_EQUAL="CHANNELS_EQUAL",Ht.CHANNELS_UNIQUE="CHANNELS_UNIQUE",Ht.CHANNELS_RED="CHANNELS_RED",Ht.CHANNELS_GREEN="CHANNELS_GREEN",Ht.CHANNELS_BLUE="CHANNELS_BLUE",Ht.CHANNELS_DESATURATED="CHANNELS_DESATURATED",Ht.DEFAULT_ACTION="Default",Ht.DEFAULT_DIRECTION=2,Ht.DEFAULT_AVATAR_SET=Gt.FULL;class Vt{constructor(t){this._id=void 0,this._value=void 0,this._prevents=void 0,this._preventHeadTurn=void 0,this._isAnimated=void 0,this._id=parseInt(t.id),this._value=parseInt(t.id),this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._isAnimated=!0,void 0!==t.animated&&!1===t.animated&&(this._isAnimated=!1)}get id(){return this._id}get value(){return this._value}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get isAnimated(){return this._isAnimated}}class jt{constructor(t){if(this._id=void 0,this._state=void 0,this._precedence=void 0,this._activePartSet=void 0,this._assetPartDefinition=void 0,this._lay=void 0,this._geometryType=void 0,this._isMain=void 0,this._isDefault=void 0,this._isAnimation=void 0,this._startFromFrameZero=void 0,this._prevents=void 0,this._preventHeadTurn=void 0,this._types=void 0,this._params=void 0,this._defaultParameterValue=void 0,this._canvasOffsets=void 0,this._id=t.id,this._state=t.state,this._precedence=t.precedence,this._activePartSet=t.activePartSet,this._assetPartDefinition=t.assetPartDefinition,this._lay=t.lay,this._geometryType=t.geometryType,this._isMain=t.main||!1,this._isDefault=t.isDefault||!1,this._isAnimation=t.animation||!1,this._startFromFrameZero=t.startFromFrameZero||!1,this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._types=new Map,this._params=new Map,this._defaultParameterValue="",this._canvasOffsets=null,t.params&&t.params.length>0)for(const e of t.params)e&&("default"===e.id?this._defaultParameterValue=e.value:this._params.set(e.id,e.value));if(t.types&&t.types.length>0)for(const e of t.types){if(!e)continue;const t=new Vt(e);this._types.set(t.id,t)}}setOffsets(t,e,s){this._canvasOffsets||(this._canvasOffsets=new Map);let i=this._canvasOffsets.get(t);i||(i=new Map,this._canvasOffsets.set(t,i)),i.set(e,s)}getOffsets(t,e){if(!this._canvasOffsets)return null;const s=this._canvasOffsets.get(t);return s?s.get(e):null}getType(t){if(!t)return null;const e=this._types.get(parseInt(t));return e||null}getParameterValue(t){if(!t)return"";const e=this._params.get(t);return e||this._defaultParameterValue}getPrevents(t){return this._prevents.concat(this.getTypePrevents(t))}getTypePrevents(t){if(!t)return[];const e=this._types.get(parseInt(t));return e?e.prevents:[]}getPreventHeadTurn(t){if(!t)return this._preventHeadTurn;const e=this.getType(t);return e?e.preventHeadTurn:this._preventHeadTurn}isAnimated(t){if(!t)return!0;const e=this.getType(t);return!e||e.isAnimated}get id(){return this._id}get state(){return this._state}get precedence(){return this._precedence}get activePartSet(){return this._activePartSet}get assetPartDefinition(){return this._assetPartDefinition}get lay(){return this._lay}get geometryType(){return this._geometryType}get isMain(){return this._isMain}get isDefault(){return this._isDefault}get isAnimation(){return this._isAnimation}get startFromFrameZero(){return this._startFromFrameZero}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get params(){return this._params}}class kt{constructor(t,e){this._assets=void 0,this._actions=void 0,this._defaultAction=void 0,this._assets=t,this._actions=new Map,this._defaultAction=null,this.updateActions(e)}updateActions(t){if(t){for(const e of t.actions){if(!e||!e.state)continue;const t=new jt(e);this._actions.set(t.state,t)}t.actionOffsets&&this.parseActionOffsets(t.actionOffsets)}}parseActionOffsets(t){if(t&&t.length)for(const e of t){const t=this._actions.get(e.action);if(t)for(const s of e.offsets){const e=s.size||"",i=s.direction;if(""===e||void 0===i)continue;const r=s.x||0,n=s.y||0,a=s.z||0;t.setOffsets(e,i,[r,n,a])}}}getActionDefinition(t){if(!t)return null;for(const e of this._actions.values())if(e&&e.id===t)return e;return null}getActionDefinitionWithState(t){const e=this._actions.get(t);return e||null}getDefaultAction(){if(this._defaultAction)return this._defaultAction;for(const t of this._actions.values())if(t&&t.isDefault)return this._defaultAction=t,t;return null}getCanvasOffsets(t,e,s){let i=[];for(const r of t){if(!r)continue;const t=this._actions.get(r.actionType),n=t&&t.getOffsets(e,s);n&&(i=n)}return i}sortActions(t){if(!t)return null;t=this.filterActions(t);const e=[];for(const s of t){if(!s)continue;const t=this._actions.get(s.actionType);t&&(s.definition=t,e.push(s))}return e.sort(this.sortByPrecedence),e}filterActions(t){let e=[];const s=[];for(const i of t){if(!i)continue;const t=this._actions.get(i.actionType);t&&(e=e.concat(t.getPrevents(i.actionParameter)))}for(const i of t){if(!i)continue;let t=i.actionType;"fx"===i.actionType&&(t=t+"."+i.actionParameter),e.indexOf(t)>=0||s.push(i)}return s}sortByPrecedence(t,e){if(!t||!e)return 0;const s=t.definition.precedence,i=e.definition.precedence;return s<i?1:s>i?-1:0}}class Yt{constructor(t){this._id=void 0,this._align=void 0,this._base=void 0,this._ink=void 0,this._blend=void 0,this._id=t.id||"",this._align=t.align||"",this._base=t.base||"",this._ink=t.ink||0,this._blend=0;const e=t.blend;e&&e.length>0&&(this._blend=parseInt(e),this._blend>1&&(this._blend=this._blend/100))}get id(){return this._id}get align(){return this._align}get base(){return this._base}get ink(){return this._ink}get blend(){return this._blend}get isBlended(){return 1!==this._blend}}class zt{constructor(t){this._ink=void 0,this._foreGround=void 0,this._backGround=void 0,this._colorTransform=void 0,this._rgb=void 0,this._r=void 0,this._g=void 0,this._b=void 0,this._redMultiplier=void 0,this._greenMultiplier=void 0,this._blueMultiplier=void 0,this._alphaMultiplier=void 0,this._colorMap=void 0,this._paletteIsGrayscale=void 0,this._ink=t.ink;let e=t.foreground,s=t.background;e=e.replace("#",""),s=s.replace("#",""),this._foreGround=parseInt(e,16),this._backGround=parseInt(s,16),this._colorTransform=null,this._rgb=parseInt(e,16),this._r=this._rgb>>16&255,this._g=this._rgb>>8&255,this._b=this._rgb>>0&255,this._redMultiplier=this._r/255*1,this._greenMultiplier=this._g/255*1,this._blueMultiplier=this._b/255*1,this._alphaMultiplier=1,this._paletteIsGrayscale=!0,37===this._ink&&(this._alphaMultiplier=.5,this._paletteIsGrayscale=!1),this._colorTransform=new b.a({red:this._r/255,green:this._g/255,blue:this._b/255,alpha:this._alphaMultiplier}),this._colorMap=this.generatePaletteMapForGrayscale(this._backGround,this._foreGround)}get ink(){return this._ink}get colorTransform(){return this._colorTransform}get reds(){return this._colorMap.get("reds")}get greens(){return this._colorMap.get("greens")}get blues(){return this._colorMap.get("blues")}get alphas(){return this._colorMap.get("alphas")}get paletteIsGrayscale(){return this._paletteIsGrayscale}generatePaletteMapForGrayscale(t,e){const s=t>>24&255,i=t>>16&255,r=t>>8&255,n=t>>0&255,a=((e>>24&255)-s)/255,o=((e>>16&255)-i)/255,h=((e>>8&255)-r)/255,_=((e>>0&255)-n)/255,d=new Map,u=[],c=[],l=[],g=[];let E=s,p=i,m=r,I=n;for(let T=0;T<256;T++)p==i&&m==r&&I==n&&(E=0),E+=a,p+=o,m+=h,I+=_,g.push(E<<24),u.push(E<<24|p<<16|m<<8|I),c.push(E<<24|p<<16|m<<8|I),l.push(E<<24|p<<16|m<<8|I);return d.set("alphas",u),d.set("reds",u),d.set("greens",c),d.set("blues",l),d}}class Wt{constructor(t){this._offset=void 0,this._offset=t.offset}get offset(){return this._offset}}class Kt{constructor(t,e){this._animation=void 0,this._id=void 0,this._ink=void 0,this._member=void 0,this._hasDirections=void 0,this._hasStaticY=void 0,this._dx=void 0,this._dy=void 0,this._dz=void 0,this._animation=t,this._id=e.id,this._ink=e.ink,this._member=e.member,this._hasStaticY=!!e.staticY,this._hasDirections=!!e.directions,this._dx=[],this._dy=[],this._dz=[];const s=e.directionList;if(s&&s.length)for(const i of s){const t=i.id;void 0!==t&&(this._dx[t]=i.dx||0,this._dy[t]=i.dy||0,this._dz[t]=i.dz||0)}}getDirectionOffsetX(t){return t<this._dx.length?this._dx[t]:0}getDirectionOffsetY(t){return t<this._dy.length?this._dy[t]:0}getDirectionOffsetZ(t){return t<this._dz.length?this._dz[t]:0}get animation(){return this._animation}get id(){return this._id}get ink(){return this._ink}get member(){return this._member}get hasDirections(){return this._hasDirections}get hasStaticY(){return this._hasStaticY}}class Xt{constructor(t,e){if(this._id=void 0,this._description=void 0,this._frames=void 0,this._spriteData=void 0,this._avatarData=void 0,this._directionData=void 0,this._removeData=void 0,this._addData=void 0,this._overriddenActions=void 0,this._overrideFrames=void 0,this._resetOnToggle=void 0,this._id=e.name,this._description=this._id,this._frames=[],this._spriteData=null,this._avatarData=null,this._directionData=null,this._removeData=null,this._addData=null,this._overriddenActions=null,this._overrideFrames=null,this._resetOnToggle=e.resetOnToggle||!1,e.sprites&&e.sprites.length){this._spriteData=[];for(const t of e.sprites)this._spriteData.push(new Kt(this,t))}if(e.avatars&&e.avatars.length&&(this._avatarData=new zt(e.avatars[0])),e.directions&&e.directions.length&&(this._directionData=new Wt(e.directions[0])),e.removes&&e.removes.length){this._removeData=[];for(const t of e.removes)this._removeData.push(t.id)}if(e.adds&&e.adds.length){this._addData=[];for(const t of e.adds)this._addData.push(new Yt(t))}if(e.overrides&&e.overrides.length){this._overrideFrames=new Map,this._overriddenActions=new Map;for(const s of e.overrides){const e=s.name,i=s.override;this._overriddenActions.set(i,e);const r=[];this.parseFrames(r,s.frames,t),this._overrideFrames.set(e,r)}}this.parseFrames(this._frames,e.frames,t)}parseFrames(t,e,s){if(e&&e.length)for(const i of e){let e=1;i.repeats&&i.repeats>1&&(e=i.repeats);let r=0;for(;r<e;){const e=[];if(i.bodyparts&&i.bodyparts.length)for(const t of i.bodyparts){const i=s.getActionDefinition(t.action),r=new Mt(t,Mt.BODYPART,i);e.push(r)}if(i.fxs&&i.fxs.length)for(const t of i.fxs){const i=s.getActionDefinition(t.action),r=new Mt(t,Mt.FX,i);e.push(r)}t.push(e),r++}}}frameCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!t)return this._frames.length;if(this._overrideFrames){const e=this._overrideFrames.get(t);if(e)return e.length}return 0}hasOverriddenActions(){return!!this._overriddenActions&&this._overriddenActions.size>0}overriddenActionNames(){if(!this._overriddenActions)return null;const t=[];for(const e of this._overriddenActions.keys())t.push(e);return t}overridingAction(t){return this._overriddenActions?this._overriddenActions.get(t):null}getFrame(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t<0&&(t=0);let s=[];if(e){const i=this._overrideFrames.get(e);i&&i.length>0&&(s=i[t%i.length])}else this._frames.length>0&&(s=this._frames[t%this._frames.length]);return s}getAnimatedBodyPartIds(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=[];for(const i of this.getFrame(t,e))if(i.type===Mt.BODYPART)s.push(i.id);else if(i.type===Mt.FX&&this._addData&&this._addData.length)for(const t of this._addData)t.id===i.id&&s.push(t.align);return s}getLayerData(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(const i of this.getFrame(t,s)){if(i.id===e)return i;if(i.type===Mt.FX&&this._addData&&this._addData.length)for(const t of this._addData)if(t.align===e&&t.id===i.id)return i}return null}hasAvatarData(){return null!==this._avatarData}hasDirectionData(){return null!==this._directionData}hasAddData(){return null!==this._addData}getAddData(t){if(this._addData)for(const e of this._addData)if(e.id===t)return e;return null}get id(){return this._id}get spriteData(){return this._spriteData||Xt.EMPTY_ARRAY}get avatarData(){return this._avatarData}get directionData(){return this._directionData}get removeData(){return this._removeData||Xt.EMPTY_ARRAY}get addData(){return this._addData||Xt.EMPTY_ARRAY}toString(){return this._description}get resetOnToggle(){return this._resetOnToggle}}Xt.EMPTY_ARRAY=[];class qt{constructor(){this._animations=void 0,this._animations=new Map}registerAnimation(t,e){const s=e[Object.keys(e)[0]],i=new Xt(t,s);return this._animations.set(s.name,i),!0}getAnimation(t){const e=this._animations.get(t);return e||null}getLayerData(t,e,s){const i=this.getAnimation(t);return i?i.getLayerData(e,s):null}get animations(){return this._animations}}class Qt{constructor(t){this._number=void 0,this._assetPartDefinition=void 0,this._number=t.number,this._assetPartDefinition=t.assetPartDefinition||null}get number(){return this._number}get assetPartDefinition(){return this._assetPartDefinition}}class Zt{constructor(t,e,s,i,r,n,a,o){let h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"",_=arguments.length>9&&void 0!==arguments[9]&&arguments[9];this._bodyPartId=void 0,this._partType=void 0,this._flippedPartType=void 0,this._partId=void 0,this._color=void 0,this._frames=void 0,this._action=void 0,this._isColorable=void 0,this._isBlendable=void 0,this._blendTransform=void 0,this._paletteMapId=void 0,this._bodyPartId=t,this._partType=e,this._partId=s,this._color=i,this._frames=r,this._action=n,this._isColorable=a,this._paletteMapId=o,this._flippedPartType=h,this._isBlendable=_,this._blendTransform=null,"ey"===this._partType&&(this._isColorable=!1)}getFrameIndex(t){if(!this._frames||!this._frames.length)return 0;const e=t%this._frames.length;return this._frames[e]instanceof Qt?this._frames[e].number:e}getFrameDefinition(t){const e=t%this._frames.length;return this._frames&&this._frames.length>e&&this._frames[e]instanceof Qt?this._frames[e]:null}getCacheableKey(t){const e=t%this._frames.length;if(this._frames&&this._frames.length>e&&this._frames[e]instanceof Qt){const t=this._frames[e];return this.partId+":"+t.assetPartDefinition+":"+t.number}return this.partId+":"+e}get bodyPartId(){return this._bodyPartId}get partType(){return this._partType}get partId(){return this._partId}get color(){return this._color}get action(){return this._action}get isColorable(){return this._isColorable}set isColorable(t){this._isColorable=t}get paletteMapId(){return this._paletteMapId}get flippedPartType(){return this._flippedPartType}get isBlendable(){return this._isBlendable}toString(){return[this._bodyPartId,this._partType,this._partId].join(":")}}class Jt{constructor(t,e){this._id=void 0,this._width=void 0,this._height=void 0,this._offset=void 0,this._regPoint=void 0,this._id=t.id,this._width=t.width,this._height=t.height,this._offset=new j.g(t.dx,t.dy),e==Lt.LARGE?this._regPoint=new j.g((this._width-64)/2,0):this._regPoint=new j.g((this._width-32)/2,0)}get width(){return this._width}get height(){return this._height}get offset(){return this._offset}get id(){return this._id}get regPoint(){return this._regPoint}}class $t{constructor(t){if(this._id=void 0,this._isMain=void 0,this._avatarSets=void 0,this._bodyParts=void 0,this._allBodyParts=void 0,this._id=t.id,this._isMain=t.main||!1,this._avatarSets=new Map,this._bodyParts=[],this._allBodyParts=[],t.avatarSets&&t.avatarSets.length>0)for(const s of t.avatarSets){if(!s)continue;const t=new $t(s);this._avatarSets.set(t.id,t)}if(t.bodyParts&&t.bodyParts.length>0)for(const s of t.bodyParts)s&&this._bodyParts.push(s.id);let e=this._bodyParts.concat();for(const s of this._avatarSets.values())s&&(e=e.concat(s.getBodyParts()));this._allBodyParts=e}findAvatarSet(t){if(t===this._id)return this;for(const e of this._avatarSets.values())if(e&&e.findAvatarSet(t))return e;return null}getBodyParts(){return this._allBodyParts.concat()}get id(){return this._id}get isMain(){if(this._isMain)return!0;for(const t of this._avatarSets.values())if(t&&t.isMain)return!0;return!1}}class te{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._x=void 0,this._y=void 0,this._z=void 0,this._x=t,this._y=e,this._z=s}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static cross(t,e){const s=new te;return s.x=t.y*e.z-t.z*e.y,s.y=t.z*e.x-t.x*e.z,s.z=t.x*e.y-t.y*e.x,s}static subtract(t,e){return new te(t.x-e.x,t.y-e.y,t.z-e.z)}dot(t){return this._x*t.x+this._y*t.y+this._z*t.z}cross(t){const e=new te;return e.x=this._y*t.z-this._z*t.y,e.y=this._z*t.x-this._x*t.z,e.z=this._x*t.y-this._y*t.x,e}subtract(t){this._x=this._x-t.x,this._y=this._y-t.y,this._z=this._z-t.z}add(t){this._x=this._x+t.x,this._y=this._y+t.y,this._z=this._z+t.z}normalize(){const t=1/this.length();this._x=this._x*t,this._y=this._y*t,this._z=this._z*t}scaleBy(t){this._x*=t,this._y*=t,this._z*=t}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}toString(){return"Vector3D: ("+this._x+","+this._y+","+this._z+")"}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}}class ee{constructor(t,e,s){this._location=void 0,this._transformedLocation=void 0,this._needsTransformation=void 0,this._location=new te(t,e,s),this._transformedLocation=new te,this._needsTransformation=!1,0==t&&0==e&&0==s||(this._needsTransformation=!0)}get location(){return this._location}get transformedLocation(){return this._transformedLocation}applyTransform(t){this._needsTransformation&&(this._transformedLocation=t.vectorMultiplication(this._location))}}class se extends ee{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=void 0,this._radius=void 0,this._normal=void 0,this._isDoubleSided=void 0,this._isDynamic=void 0,this._id=t.id,this._radius=parseFloat(t.radius),this._normal=new te(parseFloat(t.nx),parseFloat(t.ny),parseFloat(t.nz)),this._isDoubleSided=t.double||!1,this._isDynamic=e}getDistance(t){const e=Math.abs(t.z-this.transformedLocation.z-this._radius),s=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(e,s)}get id(){return this._id}get normal(){return this._normal}get isDoubleSided(){return this._isDoubleSided}toString(){return this._id+": "+this.location+" - "+this.transformedLocation}get isDynamic(){return this._isDynamic}}class ie extends ee{constructor(t){if(super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=void 0,this._radius=void 0,this._parts=void 0,this._dynamicParts=void 0,this._id=t.id,this._radius=parseFloat(t.radius),this._parts=new Map,this._dynamicParts=new Map,t.items&&t.items.length>0)for(const e of t.items){if(!e)continue;const t=new se(e);this._parts.set(t.id,t)}}getDynamicParts(t){const e=this._dynamicParts.get(t),s=[];if(e)for(const i in e){const t=e[i];t&&s.push(t)}return s}getPartIds(t){const e=[];for(const s of this._parts.values())s&&e.push(s.id);if(t){const s=this._dynamicParts.get(t);if(s)for(const t in s){const i=s[t];i&&e.push(i.id)}}return e}removeDynamicParts(t){return this._dynamicParts.delete(t),!0}addPart(t,e){if(this.hasPart(t.id,e))return!1;let s=this._dynamicParts.get(e);return s||(s={},this._dynamicParts.set(e,s)),s[t.id]=new se(t,!0),!0}hasPart(t,e){let s=this._parts.get(t)||null;return s||void 0===this._dynamicParts.get(e)||(s=this._dynamicParts.get(e)[t]||null),null!==s}getParts(t,e,s,i){const r=[];for(const o of this._parts.values())o&&(o.applyTransform(t),r.push([o.getDistance(e),o]));const n=this._dynamicParts.get(i);if(n)for(const o in n){const s=n[o];s&&(s.applyTransform(t),r.push([s.getDistance(e),s]))}r.sort(((t,e)=>{const s=t[0],i=e[0];return s<i?-1:s>i?1:0}));const a=[];for(const o of r)o&&a.push(o[1].id);return a}getDistance(t){const e=Math.abs(t.z-this.transformedLocation.z-this._radius),s=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(e,s)}get id(){return this._id}get radius(){return this._radius}}class re{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;this._data=void 0,this._data=[t,e,s,i,r,n,a,o,h]}static getXRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new re(1,0,0,0,s,-i,0,i,s)}static getYRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new re(s,0,i,0,1,0,-i,0,s)}static getZRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new re(s,-i,0,i,s,0,0,0,1)}identity(){return this._data=[1,0,0,0,1,0,0,0,1],this}vectorMultiplication(t){const e=t.x*this._data[0]+t.y*this._data[3]+t.z*this._data[6],s=t.x*this._data[1]+t.y*this._data[4]+t.z*this._data[7],i=t.x*this._data[2]+t.y*this._data[5]+t.z*this._data[8];return new te(e,s,i)}multiply(t){const e=this._data[0]*t.data[0]+this._data[1]*t.data[3]+this._data[2]*t.data[6],s=this._data[0]*t.data[1]+this._data[1]*t.data[4]+this._data[2]*t.data[7],i=this._data[0]*t.data[2]+this._data[1]*t.data[5]+this._data[2]*t.data[8],r=this._data[3]*t.data[0]+this._data[4]*t.data[3]+this._data[5]*t.data[6],n=this._data[3]*t.data[1]+this._data[4]*t.data[4]+this._data[5]*t.data[7],a=this._data[3]*t.data[2]+this._data[4]*t.data[5]+this._data[5]*t.data[8],o=this._data[6]*t.data[0]+this._data[7]*t.data[3]+this._data[8]*t.data[6],h=this._data[6]*t.data[1]+this._data[7]*t.data[4]+this._data[8]*t.data[7],_=this._data[6]*t.data[2]+this._data[7]*t.data[5]+this._data[8]*t.data[8];return new re(e,s,i,r,n,a,o,h,_)}scalarMultiply(t){let e=0;for(;e<this._data.length;)this._data[e]=this._data[e]*t,e++}rotateX(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new re(1,0,0,0,s,-i,0,i,s).multiply(this)}rotateY(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new re(s,0,i,0,1,0,-i,0,s).multiply(this)}rotateZ(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new re(s,-i,0,i,s,0,0,0,1).multiply(this)}skew(){}transpose(){return new re(this._data[0],this._data[3],this._data[6],this._data[1],this._data[4],this._data[7],this._data[2],this._data[5],this._data[8])}equals(t){return!1}get data(){return this._data}}re.IDENTITY=new re(1,0,0,0,1,0,0,0,1),re.TOLERANS=1e-18;class ne{constructor(t){this._camera=void 0,this._avatarSet=void 0,this._geometryTypes=void 0,this._itemIdToBodyPartMap=void 0,this._transformation=void 0,this._canvases=void 0,this._camera=new te(0,0,10),this._avatarSet=new $t(t.avatarSets[0]),this._geometryTypes=new Map,this._itemIdToBodyPartMap=new Map,this._transformation=new re,this._canvases=new Map;const e=t.camera;if(e&&(this._camera.x=parseFloat(e.x),this._camera.y=parseFloat(e.y),this._camera.z=parseFloat(e.z)),t.canvases&&t.canvases.length>0)for(const s of t.canvases){if(!s)continue;const t=s.scale,e=new Map;if(s.geometries&&s.geometries.length>0)for(const i of s.geometries){if(!i)continue;const s=new Jt(i,t);e.set(s.id,s)}this._canvases.set(t,e)}if(t.types&&t.types.length>0)for(const s of t.types){if(!s)continue;const t=new Map,e=new Map;if(s.bodyParts&&s.bodyParts.length>0)for(const i of s.bodyParts){if(!i)continue;const s=new ie(i);t.set(s.id,s);for(const t of s.getPartIds(null))e.set(t,s)}this._geometryTypes.set(s.id,t),this._itemIdToBodyPartMap.set(s.id,e)}}removeDynamicItems(t){for(const e of this._geometryTypes.values())if(e)for(const s of e.values())s&&s.removeDynamicParts(t)}getBodyPartIdsInAvatarSet(t){const e=this._avatarSet.findAvatarSet(t);return e?e.getBodyParts():[]}isMainAvatarSet(t){const e=this._avatarSet.findAvatarSet(t);return!!e&&e.isMain}getCanvas(t,e){const s=this._canvases.get(t);return s&&s.get(e)||null}typeExists(t){return!!this._geometryTypes.get(t)}hasBodyPart(t,e){if(this.typeExists(t)){const s=this._geometryTypes.get(t);if(s&&s.get(e))return!0}return!1}getBodyPartIDs(t){const e=this.getBodyPartsOfType(t),s=[];if(e)for(const i of e.values())i&&s.push(i.id);return s}getBodyPartsOfType(t){return this.typeExists(t)?this._geometryTypes.get(t):new Map}getBodyPart(t,e){return this.getBodyPartsOfType(t).get(e)||null}getBodyPartOfItem(t,e,s){const i=this._itemIdToBodyPartMap.get(t);if(i){const r=i.get(e);if(r)return r;const n=this.getBodyPartsOfType(t);if(n)for(const t of n.values())if(t&&t.hasPart(e,s))return t}return null}getBodyPartsInAvatarSet(t,e){const s=this.getBodyPartIdsInAvatarSet(e),i=[];for(const r of s){if(!r)continue;const e=t.get(r);e&&i.push(e)}return i}getBodyPartsAtAngle(t,e,s){if(!s)return[];const i=this.getBodyPartsOfType(s),r=this.getBodyPartsInAvatarSet(i,t),n=[],a=[];this._transformation=re.getYRotationMatrix(e);for(const o of r.values())o&&(o.applyTransform(this._transformation),n.push([o.getDistance(this._camera),o]));n.sort(((t,e)=>{const s=t[0],i=e[0];return s<i?-1:s>i?1:0}));for(const o of n)o&&a.push(o[1].id);return a}getParts(t,e,s,i,r){if(this.hasBodyPart(t,e)){const n=this.getBodyPartsOfType(t).get(e);return this._transformation=re.getYRotationMatrix(s),n.getParts(this._transformation,this._camera,i,r)}return[]}}class ae{constructor(t){if(this._frames=void 0,this._frames=[],t.frames&&t.frames.length>0)for(const e of t.frames){if(!e)continue;this._frames.push(new Qt(e));let t=e.repeats||0;if(t>1)for(;--t>0;)this._frames.push(this._frames[this._frames.length-1])}}get frames(){return this._frames}}class oe{constructor(t){if(this._id=void 0,this._actionParts=void 0,this._bodyPartOffsets=void 0,this._frameCount=void 0,this._frameIndexes=void 0,this._id=t.id,this._actionParts=new Map,this._bodyPartOffsets=new Map,this._frameCount=0,this._frameIndexes=[],t.parts&&t.parts.length>0)for(const e of t.parts){if(!e)continue;const t=new ae(e);this._actionParts.set(e.setType,t),this._frameCount=Math.max(this._frameCount,t.frames.length)}if(t.offsets&&t.offsets.frames&&t.offsets.frames.length>0)for(const e of t.offsets.frames){if(!e)continue;const t=e.id;this._frameCount=Math.max(this._frameCount,t);const s=new Map;if(this._bodyPartOffsets.set(t,s),e.directions&&e.directions.length>0)for(const i of e.directions){if(!i)continue;const t=i.id,e=new Map;if(s.set(t,e),i.bodyParts&&i.bodyParts.length>0)for(const s of i.bodyParts){if(!s)continue;const t=s.id;let i=0,r=0;void 0!==s.dx&&(i=s.dx),void 0!==s.dy&&(r=s.dy),e.set(t,new j.g(i,r))}}if(this._frameIndexes.push(t),void 0!==e.repeats){let s=e.repeats||0;if(s>1)for(;--s>0;)this._frameIndexes.push(t)}}}getPart(t){if(!t)return null;const e=this._actionParts.get(t);return e||null}getFrameBodyPartOffset(t,e,s){const i=e%this._frameIndexes.length,r=this._frameIndexes[i],n=this._bodyPartOffsets.get(r);if(!n)return oe.DEFAULT_OFFSET;const a=n.get(t);if(!a)return oe.DEFAULT_OFFSET;const o=a.get(s);return o||oe.DEFAULT_OFFSET}get id(){return this._id}get parts(){return this._actionParts}get frameCount(){return this._frameCount}}oe.DEFAULT_OFFSET=new j.g(0,0);class he{constructor(){this._actions=void 0,this._actions=new Map}parse(t){if(t&&t.length>0)for(const e of t){if(!e)continue;const t=new oe(e);this._actions.set(t.id,t)}return!0}appendJSON(t){for(const e of t.action)this._actions.set(e.id,new oe(e));return!0}getAction(t){const e=this._actions.get(t.id);return e||null}getFrameCount(t){const e=this.getAction(t);return e?e.frameCount:0}}class _e{constructor(t){if(this._id=void 0,this._index=void 0,this._clubLevel=void 0,this._isSelectable=void 0,this._rgb=void 0,!t)throw new Error("invalid_data");this._id=t.id,this._index=t.index,this._clubLevel=t.club||0,this._isSelectable=t.selectable,this._rgb=parseInt("0x"+t.hexCode,16)}get id(){return this._id}get index(){return this._index}get clubLevel(){return this._clubLevel}get isSelectable(){return this._isSelectable}get rgb(){return this._rgb}}class de{constructor(t){if(this._id=void 0,this._colors=void 0,!t)throw new Error("invalid_data");this._id=t.id,this._colors=new U,this.append(t)}append(t){for(const e of t.colors){const t=new _e(e);this._colors.add(e.id.toString(),t)}}getColor(t){return void 0===t||t<0?null:this._colors.getValue(t.toString())||null}get id(){return this._id}get colors(){return this._colors}}class ue{constructor(t){if(this._id=void 0,this._type=void 0,this._breed=void 0,this._index=void 0,this._colorLayerIndex=void 0,this._paletteMapId=void 0,!t)throw new Error("invalid_data");this._id=t.id,this._type=t.type,this._index=t.index,this._colorLayerIndex=t.colorindex,this._paletteMapId=-1,this._breed=-1}dispose(){}get id(){return this._id}get type(){return this._type}get breed(){return this._breed}get index(){return this._index}get colorLayerIndex(){return this._colorLayerIndex}get paletteMap(){return this._paletteMapId}}class ce{constructor(t,e){if(this._id=void 0,this._type=void 0,this._gender=void 0,this._clubLevel=void 0,this._isColorable=void 0,this._isSelectable=void 0,this._parts=void 0,this._hiddenLayers=void 0,this._isPreSelectable=void 0,this._isSellable=void 0,!t||!e)throw new Error("invalid_data");this._id=e.id,this._type=t,this._gender=e.gender,this._clubLevel=e.club,this._isColorable=e.colorable,this._isSelectable=e.selectable,this._parts=[],this._hiddenLayers=[],this._isPreSelectable=e.preselectable,this._isSellable=e.sellable;for(const s of e.parts){const t=new ue(s),e=this.getPartIndex(t);-1!==e?this._parts.splice(e,0,t):this._parts.push(t)}if(e.hiddenLayers)for(const s of e.hiddenLayers)this._hiddenLayers.push(s.partType)}dispose(){for(const t of this._parts){t.dispose()}this._parts=null,this._hiddenLayers=null}getPartIndex(t){const e=this._parts.length;if(!e)return-1;for(let s=0;s<e;s++){const e=this._parts[s];if(e&&!(e.type!==t.type||e.index>t.index))return s}return-1}getPart(t,e){for(const s of this._parts)if(s.type===t&&s.id===e)return s;return null}get id(){return this._id}get type(){return this._type}get gender(){return this._gender}get clubLevel(){return this._clubLevel}get isColorable(){return this._isColorable}get isSelectable(){return this._isSelectable}get parts(){return this._parts}get hiddenLayers(){return this._hiddenLayers}get isPreSelectable(){return this._isPreSelectable}get isSellable(){return this._isSellable}}class le{constructor(t){if(this._type=void 0,this._paletteId=void 0,this._isMandatory=void 0,this._partSets=void 0,!t)throw new Error("invalid_data");this._type=t.type,this._paletteId=t.paletteId,this._isMandatory={},this._isMandatory.F=[t.mandatory_f_0,t.mandatory_f_1],this._isMandatory.M=[t.mandatory_m_0,t.mandatory_m_1],this._partSets=new U,this.append(t)}dispose(){for(const t of this._partSets.getValues()){t.dispose()}this._partSets=null}cleanUp(t){for(const e of t.sets){const t=e.id.toString(),s=this._partSets.getValue(t);s&&(s.dispose(),this._partSets.remove(t))}}append(t){if(t&&t.sets)for(const e of t.sets)this._partSets.add(e.id.toString(),new ce(this._type,e))}getDefaultPartSet(t){for(const e of this._partSets.getValues())if(e&&0===e.clubLevel&&(e.gender===t||"U"===e.gender))return e;return null}getPartSet(t){return this._partSets.getValue(t.toString())}get type(){return this._type}get paletteID(){return this._paletteId}isMandatory(t,e){return this._isMandatory[t.toUpperCase()][Math.min(e,1)]}optionalFromClubLevel(t){return this._isMandatory[t.toUpperCase()].indexOf(!1)}get partSets(){return this._partSets}}class ge{constructor(){this._palettes=void 0,this._setTypes=void 0,this._palettes=new Map,this._setTypes=new Map}dispose(){}parse(t){if(!t)return!1;for(const e of t.palettes){const t=new de(e);t&&this._palettes.set(t.id.toString(),t)}for(const e of t.setTypes){const t=new le(e);t&&this._setTypes.set(t.type,t)}return!0}injectJSON(t){for(const e of t.setTypes){const t=this._setTypes.get(e.type);t?t.cleanUp(e):this._setTypes.set(e.type,new le(e))}this.appendJSON(t)}appendJSON(t){if(!t)return!1;for(const e of t.palettes){const t=e.id.toString(),s=this._palettes.get(t);s?s.append(e):this._palettes.set(t,new de(e))}for(const e of t.setTypes){const t=e.type,s=this._setTypes.get(t);s?s.append(e):this._setTypes.set(t,new le(e))}return!1}getMandatorySetTypeIds(t,e){const s=[];for(const i of this._setTypes.values())i&&i.isMandatory(t,e)&&s.push(i.type);return s}getDefaultPartSet(t,e){const s=this._setTypes.get(t);return s?s.getDefaultPartSet(e):null}getSetType(t){return this._setTypes.get(t)||null}getPalette(t){return this._palettes.get(t.toString())||null}getFigurePartSet(t){for(const e of this._setTypes.values()){const s=e.getPartSet(t);if(s)return s}return null}}class Ee{constructor(t){if(this._id=void 0,this._parts=void 0,this._id=t.id,this._parts=[],t.activeParts&&t.activeParts.length>0)for(const e of t.activeParts)e&&this._parts.push(e.setType)}get parts(){return this._parts}}class pe{constructor(t){if(this._setType=void 0,this._flippedSetType=void 0,this._removeSetType=void 0,this._appendToFigure=void 0,this._staticId=void 0,!t)throw new Error("invalid_data");this._setType=t.setType,this._flippedSetType=t.flippedSetType||null,this._removeSetType=t.removeSetType||null,this._appendToFigure=!1,this._staticId=-1}hasStaticId(){return this._staticId>=0}get staticId(){return this._staticId}set staticId(t){this._staticId=t}get setType(){return this._setType}get flippedSetType(){return this._flippedSetType}set flippedSetType(t){this._flippedSetType=t}get removeSetType(){return this._removeSetType}get appendToFigure(){return this._appendToFigure}set appendToFigure(t){this._appendToFigure=t}}class me{constructor(){this._parts=void 0,this._activePartSets=void 0,this._parts=new Map,this._activePartSets=new Map}parse(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new pe(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new Ee(e));return!0}appendJSON(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new pe(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new Ee(e));return!1}getActiveParts(t){const e=this._activePartSets.get(t.activePartSet);return e?e.parts:[]}getPartDefinition(t){const e=this._parts.get(t);return e||null}addPartDefinition(t){const e=t.setType;let s=this._parts.get(e);return s||(s=new pe(t),this._parts.set(e,s)),s}getActivePartSet(t){const e=this._activePartSets.get(t.activePartSet);return e||null}get parts(){return this._parts}get activePartSets(){return this._activePartSets}}class Ie extends g{constructor(t){super(),this._renderManager=void 0,this._geometry=void 0,this._figureData=void 0,this._partSetsData=void 0,this._animationData=void 0,this._animationManager=void 0,this._mandatorySetTypeIds=void 0,this._actionManager=void 0,this._defaultAction=void 0,this._renderManager=t,this._geometry=null,this._figureData=new ge,this._partSetsData=new me,this._animationData=new he,this._animationManager=new qt,this._mandatorySetTypeIds={},this._actionManager=null,this._defaultAction=null}init(){}dispose(){this.disposed||(super.dispose(),this._renderManager=null,this._figureData=null,this._partSetsData=null,this._animationData=null,this._mandatorySetTypeIds=null)}initGeometry(t){t&&(this._geometry=new ne(t))}initActions(t,e){e&&(this._actionManager=new kt(t,e),this._defaultAction=this._actionManager.getDefaultAction())}updateActions(t){this._actionManager.updateActions(t),this._defaultAction=this._actionManager.getDefaultAction()}initPartSets(t){return!!t&&(!!this._partSetsData.parse(t)&&(this._partSetsData.getPartDefinition("ri").appendToFigure=!0,this._partSetsData.getPartDefinition("li").appendToFigure=!0,!0))}initAnimation(t){return!!t&&this._animationData.parse(t)}initFigureData(t){return!!t&&this._figureData.parse(t)}injectFigureData(t){this._figureData.injectJSON(t)}registerAnimations(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fx",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,i=0;for(;i<s;){const s=t.getCollection(e+i);if(s){const t=s.data;this._animationManager.registerAnimation(this,t.animations)}i++}}registerAnimation(t){this._animationManager.registerAnimation(this,t)}getPartColor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=t.getPartColorIds(e);if(!i||i.length<s)return null;const r=this._figureData.getSetType(e);if(null==r)return null;const n=this._figureData.getPalette(r.paletteID);return n?n.getColor(i[s]):null}getBodyPartData(t,e,s){return this._animationManager.getLayerData(t,e,s)}getAnimation(t){return this._animationManager.getAnimation(t)}getActionDefinition(t){return this._actionManager.getActionDefinition(t)}getActionDefinitionWithState(t){return this._actionManager.getActionDefinitionWithState(t)}isMainAvatarSet(t){return this._geometry.isMainAvatarSet(t)}sortActions(t){return this._actionManager.sortActions(t)}maxFrames(t){let e=0;for(const s of t)e=Math.max(e,this._animationData.getFrameCount(s.definition));return e}getMandatorySetTypeIds(t,e){return this._mandatorySetTypeIds[t]||(this._mandatorySetTypeIds[t]=[]),this._mandatorySetTypeIds[t][e]||(this._mandatorySetTypeIds[t][e]=this._figureData.getMandatorySetTypeIds(t,e)),this._mandatorySetTypeIds[t][e]}getDefaultPartSet(t,e){return this._figureData.getDefaultPartSet(t,e)}getCanvasOffsets(t,e,s){return this._actionManager.getCanvasOffsets(t,e,s)}getCanvas(t,e){return this._geometry.getCanvas(t,e)}removeDynamicItems(t){this._geometry.removeDynamicItems(t)}getActiveBodyPartIds(t,e){let s=[];const i=[],r=t.definition.geometryType;if(t.definition.isAnimation){const n=t.definition.state+"."+t.actionParameter,a=this._animationManager.getAnimation(n);if(a&&(s=a.getAnimatedBodyPartIds(0,t.overridingAction),a.hasAddData())){const t={id:"",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:1},s={setType:""};for(const n of a.addData){const a=this._geometry.getBodyPart(r,n.align);if(a){t.id=n.id,a.addPart(t,e),s.setType=n.id;const r=this._partSetsData.addPartDefinition(s);r.appendToFigure=!0,""===n.base&&(r.staticId=1),-1===i.indexOf(a.id)&&i.push(a.id)}}}for(const t of s){const e=this._geometry.getBodyPart(r,t);e&&-1===i.indexOf(e.id)&&i.push(e.id)}}else{s=this._partSetsData.getActiveParts(t.definition);for(const t of s){const s=this._geometry.getBodyPartOfItem(r,t,e);s&&-1===i.indexOf(s.id)&&i.push(s.id)}}return i}getBodyPartsUnordered(t){return this._geometry.getBodyPartIdsInAvatarSet(t)}getBodyParts(t,e,s){const i=Dt.DIRECTION_TO_ANGLE[s];return this._geometry.getBodyPartsAtAngle(t,i,e)}getFrameBodyPartOffset(t,e,s,i){const r=this._animationData.getAction(t.definition);return r?r.getFrameBodyPartOffset(e,s,i):oe.DEFAULT_OFFSET}getParts(t,e,s,i,r,n,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;let h=null,_=[],d=null;if(null==!s)return[];const u=this._partSetsData.getActiveParts(s.definition),c=[];let l=[0];const g=this._animationData.getAction(s.definition);if(s.definition.isAnimation){const e=s.definition.state+"."+s.actionParameter,r=this._animationManager.getAnimation(e);if(r){l=this.getPopulatedArray(r.frameCount(s.overridingAction));for(const e of r.getAnimatedBodyPartIds(0,s.overridingAction))if(e===t){const t=this._geometry.getBodyPart(i,e);if(t)for(const e of t.getDynamicParts(a))u.push(e.id)}}}const E=this._geometry.getParts(i,t,r,u,a),p=e.getPartTypeIds();for(const I of p){if(o&&o.get(I))continue;const i=e.getPartSetId(I),r=e.getPartColorIds(I),a=this._figureData.getSetType(I);if(a){const e=this._figureData.getPalette(a.paletteID);if(e){const o=a.getPartSet(i);if(o){n=n.concat(o.hiddenLayers);for(const i of o.parts)if(E.indexOf(i.type)>-1){if(g){const t=g.getPart(i.type);_=t?t.frames:l}else _=l;h=s.definition,-1===u.indexOf(i.type)&&(h=this._defaultAction);const n=this._partSetsData.getPartDefinition(i.type);let a=n?n.flippedSetType:i.type;a&&""!==a||(a=i.type),r&&r.length>i.colorLayerIndex-1&&(d=e.getColor(r[i.colorLayerIndex-1]));const o=i.colorLayerIndex>0,E=new Zt(t,i.type,i.id.toString(),d,_,h,o,i.paletteMap,a);c.push(E)}}}}}const m=[];for(const I of E){let e=null,r=!1;const h=o&&o.get(I);for(const t of c)t.partType===I&&(h?e=t.color:(r=!0,-1===n.indexOf(I)&&m.push(t)));if(!r)if(h){const i=o.get(I);let r=0,n=0;for(;n<i.length;)r+=i.charCodeAt(n),n++;if(g){const t=g.getPart(I);_=t?t.frames:l}else _=l;const a=new Zt(t,I,i,e,_,s.definition,!(null==e),-1,I,!1,1);m.push(a)}else if(u.indexOf(I)>-1){if(t!==this._geometry.getBodyPartOfItem(i,I,a).id);else{const e=this._partSetsData.getPartDefinition(I);let i=!1,r=1;if(e.appendToFigure){let n="1";if(""!==s.actionParameter&&(n=s.actionParameter),e.hasStaticId()&&(n=e.staticId.toString()),g){const t=g.getPart(I);_=t?t.frames:l}else _=l;const a=new Zt(t,I,n,null,_,s.definition,!1,-1,I,i,r);m.push(a)}}}}return m}getPopulatedArray(t){const e=[];let s=0;for(;s<t;)e.push(s),s++;return e}getItemIds(){if(this._actionManager){const t=this._actionManager.getActionDefinition("CarryItem").params,e=[];for(const s of t.values())e.push(s);return e}return[]}get renderManager(){return this._renderManager}get figureData(){return this._figureData}get partData(){return this._partSetsData}get animationManager(){return this._animationManager}}const Te=[{id:"Move",parts:[{setType:"bd",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"bds",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ss",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lg",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"sh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]}]},{id:"Wave",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"},{number:2,assetPartDefinition:"wav"},{number:3,assetPartDefinition:"wav"}]}]},{id:"Talk",parts:[{setType:"hd",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fa",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]}]},{id:"Sign",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"li",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"}]}]},{id:"Respect",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"respect",repeats:15},{number:1,assetPartDefinition:"respect",repeats:15}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]}]},{id:"Blow",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw",repeats:10},{number:1,assetPartDefinition:"blw",repeats:10}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"eyb",repeats:10}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"blw",repeats:10}]}]},{id:"Laugh",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:2}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"sml"}]}],offsets:{frames:[{id:0,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:1}]},{id:1,bodyParts:[{id:"head",dx:0,dy:1}]},{id:2,bodyParts:[{id:"head",dx:0,dy:1}]},{id:3,bodyParts:[{id:"head",dx:0,dy:1}]},{id:4,bodyParts:[{id:"head",dx:0,dy:1}]},{id:5,bodyParts:[{id:"head",dx:0,dy:1}]},{id:6,bodyParts:[{id:"head",dx:0,dy:1}]},{id:7,bodyParts:[{id:"head",dx:0,dy:1}]}]},{id:1,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:0}]},{id:1,bodyParts:[{id:"head",dx:0,dy:0}]},{id:2,bodyParts:[{id:"head",dx:0,dy:0}]},{id:3,bodyParts:[{id:"head",dx:0,dy:0}]},{id:4,bodyParts:[{id:"head",dx:0,dy:0}]},{id:5,bodyParts:[{id:"head",dx:0,dy:0}]},{id:6,bodyParts:[{id:"head",dx:0,dy:0}]},{id:7,bodyParts:[{id:"head",dx:0,dy:0}]}]}]}}],Re={direction:0,camera:{x:0,y:0,z:10},canvases:[{scale:"h",geometries:[{id:"vertical",width:90,height:130,dx:0,dy:0},{id:"sitting",width:90,height:130,dx:0,dy:0},{id:"horizontal",width:128,height:80,dx:30,dy:0},{id:"swhorizontal",width:192,height:120,dx:0,dy:-40}]},{scale:"sh",geometries:[{id:"vertical",width:45,height:72,dx:0,dy:0},{id:"sitting",width:45,height:72,dx:0,dy:0},{id:"horizontal",width:64,height:50,dx:15,dy:-10},{id:"swhorizontal",width:96,height:70,dx:0,dy:-20},{id:"swim",width:64,height:70,dx:25,dy:10}]}],avatarSets:[{id:"full",avatarSets:[{id:"body",main:!0,bodyParts:[{id:"top"},{id:"bottom"},{id:"behind"},{id:"torso"},{id:"leftitem"},{id:"rightitem"},{id:"leftarm"},{id:"rightarm"}]},{id:"head",bodyParts:[{id:"head"}]}]}],types:[{id:"vertical",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"sitting",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"horizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swhorizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swim",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]}]},fe={partSet:[{setType:"ri",flippedSetType:"ri"},{setType:"ri",flippedSetType:"ri"},{setType:"rh",flippedSetType:"lh"},{setType:"rhs",flippedSetType:"lhs"},{setType:"rs",swim:"0",flippedSetType:"ls"},{setType:"rc",flippedSetType:"lc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb",removeSetType:"hr"},{setType:"li",flippedSetType:"li"},{setType:"lh",flippedSetType:"rh"},{setType:"lhs",flippedSetType:"rhs"},{setType:"ls",flippedSetType:"rs"},{setType:"lc",flippedSetType:"rc"},{setType:"wa"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}],activePartSets:[{id:"figure",activeParts:[{setType:"rh"},{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"wa"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"head",activeParts:[{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"ea"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"speak",activeParts:[{setType:"hd"},{setType:"hr"},{setType:"hrb"},{setType:"fc"},{setType:"fa"},{setType:"ha"}]},{id:"gesture",activeParts:[{setType:"ey"},{setType:"fc"}]},{id:"eye",activeParts:[{setType:"ey"}]},{id:"handRight",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"}]},{id:"handRightAndHead",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"},{setType:"ey"},{setType:"fc"},{setType:"hd"}]},{id:"handLeft",activeParts:[{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"li"}]},{id:"walk",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"lh"},{setType:"lhs"},{setType:"rh"},{setType:"rhs"},{setType:"ls"},{setType:"lc"},{setType:"rs"},{setType:"rc"},{setType:"sh"}]},{id:"sit",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"sh"},{setType:"cc"}]},{id:"itemRight",activeParts:[{setType:"ri"}]}]};class Oe extends d{constructor(t,e){super(t),this._library=void 0,this._library=e}get library(){return this._library}}Oe.DOWNLOAD_COMPLETE="ARELE_DOWNLOAD_COMPLETE";class ve extends g{constructor(t,e,s,i){super(),this._state=void 0,this._libraryName=void 0,this._revision=void 0,this._downloadUrl=void 0,this._assets=void 0,this._animation=void 0,this._state=ve.NOT_LOADED,this._libraryName=t,this._revision=e,this._downloadUrl=i,this._assets=s,this._animation=null,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision);this._assets.getCollection(this._libraryName)&&(this._state=ve.LOADED)}downloadAsset(){if(!this._assets||this._state===ve.LOADING||this._state===ve.LOADED)return;if(this._assets.getCollection(this._libraryName))return this._state=ve.LOADED,void this.dispatchEvent(new Oe(Oe.DOWNLOAD_COMPLETE,this));this._state=ve.LOADING,this._assets.downloadAsset(this._downloadUrl,(t=>{if(t){this._state=ve.LOADED;const t=this._assets.getCollection(this._libraryName);t&&(this._animation=t.data.animations),this.dispatchEvent(new Oe(Oe.DOWNLOAD_COMPLETE,this))}}))}get libraryName(){return this._libraryName}get animation(){return this._animation}get isLoaded(){return this._state===ve.LOADED}}ve.DOWNLOAD_COMPLETE="EADL_DOWNLOAD_COMPLETE",ve.NOT_LOADED=0,ve.LOADING=1,ve.LOADED=2;class Ae extends g{constructor(t,e){super(),this._assets=void 0,this._structure=void 0,this._missingMandatoryLibs=void 0,this._effectMap=void 0,this._initDownloadBuffer=void 0,this._effectListeners=void 0,this._incompleteEffects=void 0,this._pendingDownloadQueue=void 0,this._currentDownloads=void 0,this._libraryNames=void 0,this._isReady=void 0,this._assets=t,this._structure=e,this._missingMandatoryLibs=SU.instance.getConfiguration("avatar.mandatory.effect.libraries"),this._effectMap=new Map,this._effectListeners=new Map,this._incompleteEffects=new Map,this._initDownloadBuffer=[],this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadEffectMap(),this._structure.renderManager.events.addEventListener(Tt.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadEffectMap(){const t=new XMLHttpRequest;try{t.open("GET",SU.instance.getConfiguration("avatar.effectmap.url")),t.send(),t.onloadend=e=>{if(t.responseText){const e=JSON.parse(t.responseText);this.processEffectMap(e.effects),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new d(Ae.DOWNLOADER_READY))}},t.onerror=t=>{throw new Error("invalid_avatar_effect_map")}}catch(e){this.logger.error(e)}}processEffectMap(t){if(t)for(const e of t){if(!e)continue;const t=e.id,s=e.lib,i=e.revision||"";if(this._libraryNames.indexOf(s)>=0)continue;this._libraryNames.push(s);const r=new ve(s,i,this._assets,SU.instance.getConfiguration("avatar.asset.effect.url"));r.addEventListener(Oe.DOWNLOAD_COMPLETE,this.onLibraryLoaded);let n=this._effectMap.get(t);n||(n=[]),n.push(r),this._effectMap.set(t,n)}}downloadAvatarEffect(t,e){if(!this._isReady||!this._structure.renderManager.isReady)return void this._initDownloadBuffer.push([t,e]);const s=this.getAvatarEffectPendingLibraries(t);if(s&&s.length){if(e&&!e.disposed){let s=this._effectListeners.get(t.toString());s||(s=[]),s.push(e),this._effectListeners.set(t.toString(),s)}this._incompleteEffects.set(t.toString(),s);for(const t of s)t&&this.downloadLibrary(t)}else e&&!e.disposed&&e.resetEffect(t)}onAvatarRenderReady(t){if(t){for(const[t,e]of this._initDownloadBuffer)this.downloadAvatarEffect(t,e);this._initDownloadBuffer=[]}}onLibraryLoaded(t){if(!t||!t.library)return;const e=[];this._structure.registerAnimation(t.library.animation);for(const[i,r]of this._incompleteEffects.entries()){let t=!0;for(const e of r)if(e&&!e.isLoaded){t=!1;break}if(t){e.push(i);const t=this._effectListeners.get(i);for(const e of t)e&&!e.disposed&&e.resetEffect(parseInt(i));this._effectListeners.delete(i),this.dispatchEvent(new d(Ae.LIBRARY_LOADED))}}for(const i of e)this._incompleteEffects.delete(i);let s=0;for(;s<this._currentDownloads.length;){const e=this._currentDownloads[s];e&&e.libraryName===t.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const t=this._missingMandatoryLibs.slice();for(const e of t){if(!e)continue;const t=this._effectMap.get(e);if(t)for(const e of t)e&&this.downloadLibrary(e)}}isAvatarEffectReady(t){if(!this._isReady||!this._structure.renderManager.isReady)return!1;return!this.getAvatarEffectPendingLibraries(t).length}getAvatarEffectPendingLibraries(t){const e=[];if(!this._structure)return e;const s=this._effectMap.get(t.toString());if(s)for(const i of s)i&&!i.isLoaded&&-1===e.indexOf(i)&&e.push(i);return e}downloadLibrary(t){t&&!t.isLoaded&&(this._pendingDownloadQueue.indexOf(t)>=0||this._currentDownloads.indexOf(t)>=0||(this._pendingDownloadQueue.push(t),this.processDownloadQueue()))}processDownloadQueue(){for(;this._pendingDownloadQueue.length;){this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}}}Ae.DOWNLOADER_READY="EADM_DOWNLOADER_READY",Ae.LIBRARY_LOADED="EADM_LIBRARY_LOADED",Ae.MAX_DOWNLOADS=2;class Se extends Ht{constructor(t,e,s,i,r){super(t,e,s,i,r,null)}isPlaceholder(){return!0}}class Ne extends g{constructor(t,e){super(),this._dataReceiver=void 0,this._dataReceiver=e,this.download(t)}download(t){const e=new XMLHttpRequest;try{e.open("GET",t),e.send(),e.onloadend=t=>{const s=e.responseText;if(!s||!s.length)throw new Error("invalid_figure_data");this._dataReceiver&&this._dataReceiver.appendJSON(JSON.parse(s)),this.dispatchEvent(new d(Ne.AVATAR_STRUCTURE_DONE))},e.onerror=t=>{throw new Error("invalid_avatar_figure_data")}}catch(s){this.logger.error(s)}}}Ne.AVATAR_STRUCTURE_DONE="AVATAR_STRUCTURE_DONE";class Me extends M{constructor(){super(),this._aliasCollection=void 0,this._structure=void 0,this._avatarAssetDownloadManager=void 0,this._effectAssetDownloadManager=void 0,this._placeHolderFigure=void 0,this._figureMapReady=void 0,this._effectMapReady=void 0,this._actionsReady=void 0,this._structureReady=void 0,this._geometryReady=void 0,this._partSetsReady=void 0,this._animationsReady=void 0,this._isReady=void 0,this._structure=null,this._avatarAssetDownloadManager=null,this._placeHolderFigure=null,this._figureMapReady=!1,this._effectMapReady=!1,this._actionsReady=!1,this._geometryReady=!1,this._partSetsReady=!1,this._animationsReady=!1,this._isReady=!1,this.onAvatarAssetDownloaderReady=this.onAvatarAssetDownloaderReady.bind(this),this.onAvatarAssetDownloaded=this.onAvatarAssetDownloaded.bind(this),this.onEffectAssetDownloaderReady=this.onEffectAssetDownloaderReady.bind(this),this.onEffectAssetDownloaded=this.onEffectAssetDownloaded.bind(this),this.onAvatarStructureDownloadDone=this.onAvatarStructureDownloadDone.bind(this)}onInit(){this._structure=new Ie(this),this.loadGeometry(),this.loadPartSets(),this.loadActions(),this.loadAnimations(),this.loadFigureData(),this._aliasCollection=new pt(this,SU.instance.core.asset),this._aliasCollection.init(),this._avatarAssetDownloadManager||(this._avatarAssetDownloadManager=new Rt(SU.instance.core.asset,this._structure),this._avatarAssetDownloadManager.addEventListener(Rt.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.addEventListener(Rt.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager||(this._effectAssetDownloadManager=new Ae(SU.instance.core.asset,this._structure),this._effectAssetDownloadManager.addEventListener(Ae.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.addEventListener(Ae.LIBRARY_LOADED,this.onEffectAssetDownloaded)),this.checkReady()}onDispose(){this._avatarAssetDownloadManager&&(this._avatarAssetDownloadManager.removeEventListener(Rt.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.removeEventListener(Rt.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager&&(this._effectAssetDownloadManager.removeEventListener(Ae.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.removeEventListener(Ae.LIBRARY_LOADED,this.onEffectAssetDownloaded))}loadGeometry(){this._structure&&(this._structure.initGeometry(Re),this._geometryReady=!0,this.checkReady())}loadPartSets(){this._structure&&(this._structure.initPartSets(fe),this._partSetsReady=!0,this.checkReady())}loadActions(){const t=SU.instance.getConfiguration("avatar.default.actions");t&&this._structure.initActions(SU.instance.core.asset,t);const e=new XMLHttpRequest;try{e.open("GET",SU.instance.getConfiguration("avatar.actions.url")),e.send(),e.onloadend=t=>{this._structure&&(this._structure.updateActions(JSON.parse(e.responseText)),this._actionsReady=!0,this.checkReady())},e.onerror=t=>{throw new Error("invalid_avatar_actions")}}catch(s){this.logger.error(s)}}loadAnimations(){this._structure&&(this._structure.initAnimation(Te),this._animationsReady=!0,this.checkReady())}loadFigureData(){const t=SU.instance.getConfiguration("avatar.default.figuredata");if(!t||"string"===typeof t)return void this.logger.error("XML figuredata is no longer supported");this._structure&&this._structure.initFigureData(t);new Ne(SU.instance.getConfiguration("avatar.figuredata.url"),this._structure.figureData).addEventListener(Ne.AVATAR_STRUCTURE_DONE,this.onAvatarStructureDownloadDone)}onAvatarStructureDownloadDone(t){this._structureReady=!0,this._structure.init(),this.checkReady()}onAvatarAssetDownloaderReady(t){t&&(this._figureMapReady=!0,this.checkReady())}onAvatarAssetDownloaded(t){t&&this._aliasCollection.reset()}onEffectAssetDownloaderReady(t){t&&(this._effectMapReady=!0,this.checkReady())}onEffectAssetDownloaded(t){t&&this._aliasCollection.reset()}checkReady(){this._isReady||this._geometryReady&&this._partSetsReady&&this._actionsReady&&this._animationsReady&&this._figureMapReady&&this._effectMapReady&&this._structureReady&&(this._isReady=!0,this.events&&this.events.dispatchEvent(new d(Tt.AVATAR_RENDER_READY)))}createFigureContainer(t){return new ft(t)}isFigureContainerReady(t){return!!this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.isAvatarFigureContainerReady(t)}createAvatarImage(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!this._structure||!this._avatarAssetDownloadManager)return null;const n=new ft(t);return s&&this.validateAvatarFigure(n,s),this._avatarAssetDownloadManager.isAvatarFigureContainerReady(n)?new Ht(this._structure,this._aliasCollection,n,e,this._effectAssetDownloadManager,r):(this._placeHolderFigure||(this._placeHolderFigure=new ft(Me.DEFAULT_FIGURE)),this._avatarAssetDownloadManager.downloadAvatarFigure(n,i),new Se(this._structure,this._aliasCollection,this._placeHolderFigure,e,this._effectAssetDownloadManager))}downloadAvatarFigure(t,e){this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.downloadAvatarFigure(t,e)}validateAvatarFigure(t,e){let s=!1;const i=this._structure.getMandatorySetTypeIds(e,2);if(i){const r=this._structure.figureData;for(const n of i)if(t.hasPartType(n)){const i=r.getSetType(n);if(i){if(!i.getPartSet(t.getPartSetId(n))){const i=this._structure.getDefaultPartSet(n,e);i&&(t.updatePart(n,i.id,[0]),s=!0)}}}else{const i=this._structure.getDefaultPartSet(n,e);i&&(t.updatePart(n,i.id,[0]),s=!0)}}return!s}getFigureClubLevel(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this._structure)return 0;const i=this._structure.figureData,r=Array.from(t.getPartTypeIds());let n=0;for(const a of r){const e=i.getSetType(a);if(!e)continue;const s=t.getPartSetId(a),r=e.getPartSet(s);if(r){n=Math.max(r.clubLevel,n);const s=i.getPalette(e.paletteID),o=t.getPartColorIds(a);for(const t of o){const e=s.getColor(t);e&&(n=Math.max(e.clubLevel,n))}}}s||(s=this._structure.getBodyPartsUnordered(Gt.FULL));for(const a of s){const t=i.getSetType(a);t&&(-1===r.indexOf(a)&&(n=Math.max(t.optionalFromClubLevel(e),n)))}return n}isValidFigureSetForGender(t,e){const s=this.structureData.getFigurePartSet(t);return!(!s||"U"!==s.gender.toUpperCase()&&s.gender.toUpperCase()!==e.toUpperCase())}getFigureStringWithFigureIds(t,e,s){const i=new gt;i.loadAvatarData(t,e);const r=this.resolveFigureSets(s);for(const n of r)i.savePartData(n.type,n.id,i.getColourIds(n.type));return i.getFigureString()}resolveFigureSets(t){const e=this.structureData,s=[];for(const i of t){const t=e.getFigurePartSet(i);t&&s.push(t)}return s}getMandatoryAvatarPartSetIds(t,e){return this._structure?this._structure.getMandatorySetTypeIds(t,e):null}getAssetByName(t){return this._aliasCollection.getAsset(t)}get assets(){return SU.instance.core.asset}get isReady(){return this._isReady}get structure(){return this._structure}get structureData(){return this._structure?this._structure.figureData:null}get downloadManager(){return this._avatarAssetDownloadManager}}Me.DEFAULT_FIGURE="hd-99999-99999";class ye extends d{constructor(t,e){super(t),this._object=void 0,this._object=e}get object(){return this._object}get objectId(){return this._object?this._object.id:-1}get objectType(){return this._object?this._object.type:null}}class De extends ye{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];super(t,e),this._eventId="",this._altKey=void 0,this._ctrlKey=void 0,this._shiftKey=void 0,this._buttonDown=void 0,this._localX=void 0,this._localY=void 0,this._spriteOffsetX=void 0,this._spriteOffsetY=void 0,this._eventId=s,this._altKey=i,this._ctrlKey=r,this._shiftKey=n,this._buttonDown=a}get eventId(){return this._eventId}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get localX(){return this._localX}set localX(t){this._localX=t}get localY(){return this._localY}set localY(t){this._localY=t}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}De.CLICK="ROE_MOUSE_CLICK",De.DOUBLE_CLICK="ROE_MOUSE_DOUBLE_CLICK",De.MOUSE_MOVE="ROE_MOUSE_MOVE",De.MOUSE_DOWN="ROE_MOUSE_DOWN",De.MOUSE_DOWN_LONG="ROE_MOUSE_DOWN_LONG",De.MOUSE_UP="ROE_MOUSE_UP",De.MOUSE_ENTER="ROE_MOUSE_ENTER",De.MOUSE_LEAVE="ROE_MOUSE_LEAVE";class Ce{constructor(t,e,s,i,r,n){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]&&arguments[8],_=arguments.length>9&&void 0!==arguments[9]&&arguments[9],d=arguments.length>10&&void 0!==arguments[10]&&arguments[10],u=arguments.length>11&&void 0!==arguments[11]&&arguments[11];this._type=void 0,this._eventId=void 0,this._canvasId=void 0,this._spriteTag=void 0,this._screenX=void 0,this._screenY=void 0,this._localX=void 0,this._localY=void 0,this._ctrlKey=void 0,this._altKey=void 0,this._shiftKey=void 0,this._buttonDown=void 0,this._spriteOffsetX=void 0,this._spriteOffsetY=void 0,this._type=t,this._eventId=e,this._canvasId=s,this._spriteTag=i,this._screenX=r,this._screenY=n,this._localX=a,this._localY=o,this._ctrlKey=h,this._altKey=_,this._shiftKey=d,this._buttonDown=u,this._spriteOffsetX=0,this._spriteOffsetY=0}get type(){return this._type}get eventId(){return this._eventId}get canvasId(){return this._canvasId}get spriteTag(){return this._spriteTag}get screenX(){return this._screenX}get screenY(){return this._screenY}get localX(){return this._localX}get localY(){return this._localY}get ctrlKey(){return this._ctrlKey}get altKey(){return this._altKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}class Le extends d{constructor(t){super(t)}}class Ue{constructor(t,e){this._location=void 0,this._direction=void 0,this._location=t,this._direction=e}get location(){return this._location}get direction(){return this._direction}}class Pe{}Pe.MATCH_ALL_PIXELS=-1,Pe.MATCH_OPAQUE_PIXELS=128,Pe.MATCH_NOTHING=256;class be{}be.DEFAULT=1,be.ROOM_PLANE=2,be.AVATAR=3,be.AVATAR_OWN=4;class we extends c{constructor(){super(),this._events=void 0,this._object=void 0,this._time=void 0,this._object=null,this._events=null,this._time=0}initialize(t){}onDispose(){this._object=null}update(t){this._time=t}processUpdateMessage(t){t&&this._object&&(this._object.setLocation(t.location),this._object.setDirection(t.direction))}getEventTypes(){return[]}mergeTypes(t,e){const s=t.concat();for(const i of e)!i||s.indexOf(i)>=0||s.push(i);return s}mouseEvent(t,e){}useObject(){}setObject(t){if(this._object!==t){if(this._object&&this._object.setLogic(null),!t)return this.dispose(),void(this._object=null);this._object=t,this._object.setLogic(this)}}tearDown(){}get object(){return this._object}get eventDispatcher(){return this._events}set eventDispatcher(t){this._events=t}get widget(){return null}get contextMenu(){return null}get time(){return this._time}}class Fe{constructor(){this._id=void 0,this._name=void 0,this._type=void 0,this._spriteType=void 0,this._texture=void 0,this._container=void 0,this._width=void 0,this._height=void 0,this._offsetX=void 0,this._offsetY=void 0,this._flipH=void 0,this._flipV=void 0,this._direction=void 0,this._alpha=void 0,this._blendMode=void 0,this._color=void 0,this._relativeDepth=void 0,this._varyingDepth=void 0,this._libraryAssetName=void 0,this._clickHandling=void 0,this._visible=void 0,this._tag=void 0,this._posture=void 0,this._alphaTolerance=void 0,this._filters=void 0,this._updateCounter=void 0,this._updateContainer=void 0,this._id=Fe.SPRITE_COUNTER++,this._name="",this._type="",this._spriteType=be.DEFAULT,this._texture=null,this._container=null,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._flipH=!1,this._flipV=!1,this._direction=0,this._alpha=255,this._blendMode=o.b.NORMAL,this._color=16777215,this._relativeDepth=0,this._varyingDepth=!1,this._libraryAssetName="",this._clickHandling=!1,this._visible=!0,this._tag="",this._posture=null,this._alphaTolerance=Pe.MATCH_OPAQUE_PIXELS,this._filters=[],this._updateCounter=0,this._updateContainer=!1}dispose(){this._texture=null,this._width=0,this._height=0}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name!==t&&(this._name=t,this._updateCounter++)}get type(){return this._type}set type(t){this._type=t}get spriteType(){return this._spriteType}set spriteType(t){this._spriteType=t}get texture(){return this._texture}set texture(t){this._texture!==t&&(t&&(this._width=t.width,this._height=t.height),this._texture=t,this._updateCounter++)}get container(){return this._container}set container(t){this._container!==t&&(this.texture=i.t.EMPTY,t&&(this._width=t.width,this._height=t.height),this._container=t,this._updateCounter++,this._updateContainer=!0)}get width(){return this._width}get height(){return this._height}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX!==t&&(this._offsetX=t,this._updateCounter++)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY!==t&&(this._offsetY=t,this._updateCounter++)}get flipH(){return this._flipH}set flipH(t){this._flipH!==t&&(this._flipH=t,this._updateCounter++)}get flipV(){return this._flipV}set flipV(t){this._flipV!==t&&(this._flipV=t,this._updateCounter++)}get direction(){return this._direction}set direction(t){this._direction=t}get alpha(){return this._alpha}set alpha(t){t&=255,this._alpha!==t&&(this._alpha=t,this._updateCounter++)}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode!==t&&(this._blendMode=t,this._updateCounter++)}get color(){return this._color}set color(t){t&=16777215,this._color!==t&&(this._color=t,this._updateCounter++)}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth!==t&&(this._relativeDepth=t,this._updateCounter++)}get varyingDepth(){return this._varyingDepth}set varyingDepth(t){t!==this._varyingDepth&&(this._varyingDepth=t,this._updateCounter++)}get libraryAssetName(){return this._libraryAssetName}set libraryAssetName(t){this._libraryAssetName=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}get visible(){return this._visible}set visible(t){this._visible!==t&&(this._visible=t,this._updateCounter++)}get tag(){return this._tag}set tag(t){this._tag!==t&&(this._tag=t,this._updateCounter++)}get posture(){return this._posture}set posture(t){this._posture!==t&&(this._posture=t,this._updateCounter++)}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance!==t&&(this._alphaTolerance=t,this._updateCounter++)}get filters(){return this._filters}set filters(t){this._filters=t,this._updateCounter++}get updateCounter(){return this._updateCounter}get updateContainer(){return this._updateContainer}set updateContainer(t){this._updateContainer=t}}Fe.SPRITE_COUNTER=0;class xe{constructor(){this._id=void 0,this._object=void 0,this._asset=void 0,this._sprites=void 0,this._scale=void 0,this._updateObjectCounter=void 0,this._updateModelCounter=void 0,this._updateSpriteCounter=void 0,this._id=xe.VISUALIZATION_COUNTER++,this._object=null,this._asset=null,this._sprites=[],this._scale=-1,this._updateObjectCounter=-1,this._updateModelCounter=-1,this._updateSpriteCounter=-1}initialize(t){return!1}update(t,e,s,i){}reset(){this._scale=-1}dispose(){if(this._sprites){for(;this._sprites.length;){const t=this._sprites[0];t&&t.dispose(),this._sprites.pop()}this._sprites=null}this._object=null,this._asset=null}getSprite(t){return t>=0&&t<this._sprites.length?this._sprites[t]:null}getSpriteList(){return null}createSprite(){return this.createSpriteAtIndex(this._sprites.length)}createSpriteAtIndex(t){const e=new Fe;return t>=this._sprites.length?this._sprites.push(e):this._sprites.splice(t,0,e),e}createSprites(t){for(;this._sprites.length>t;){const t=this._sprites[this._sprites.length-1];t&&t.dispose(),this._sprites.pop()}for(;this._sprites.length<t;)this._sprites.push(new Fe)}get image(){return this.getImage(0,-1)}getImage(t,e){const s=this.getBoundingRectangle();if(s.width*s.height===0)return null;const i=this.totalSprites,r=[];let n=0;for(;n<i;){const t=this.getSprite(n);t&&t.visible&&t.texture&&r.push(t),n++}r.sort(((t,e)=>e.relativeDepth-t.relativeDepth));const a=new H;for(n=0;n<r.length;){const t=r[n],e=t.texture;if(e){const s=new W(e);s.alpha=t.alpha/255,s.tint=t.color,s.x=t.offsetX,s.y=t.offsetY,s.blendMode=t.blendMode,s.filters=t.filters,t.flipH&&(s.scale.x=-1),t.flipV&&(s.scale.y=-1),a.addChild(s)}n++}const o=At.generateTexture(a);return o||null}getBoundingRectangle(){const t=this.totalSprites,e=new j.j;let s=0;for(;s<t;){const t=this.getSprite(s);if(t&&t.texture&&t.visible){const i=t.flipH?-t.width+t.offsetX:t.offsetX,r=t.flipV?-t.height+t.offsetY:t.offsetY,n=new j.g(i,r);0===s?(e.x=n.x,e.y=n.y,e.width=t.width,e.height=t.height):(n.x<e.x&&(e.x=n.x),n.y<e.y&&(e.y=n.y),n.x+t.width>e.right&&(e.width=n.x+t.width-e.x),n.y+t.height>e.bottom&&(e.height=n.y+t.height-e.y))}s++}return e}get instanceId(){return this._id}get object(){return this._object}set object(t){this._object=t}get asset(){return this._asset}set asset(t){this._asset&&this._asset.removeReference(),this._asset=t,this._asset&&this._asset.addReference()}get sprites(){return this._sprites}get totalSprites(){return this._sprites.length}get updateObjectCounter(){return this._updateObjectCounter}set updateObjectCounter(t){this._updateObjectCounter=t}get updateModelCounter(){return this._updateModelCounter}set updateModelCounter(t){this._updateModelCounter=t}get updateSpriteCounter(){return this._updateSpriteCounter}set updateSpriteCounter(t){this._updateSpriteCounter=t}get spriteCount(){return this._sprites.length}}xe.VISUALIZATION_COUNTER=0;class Be{constructor(){this._name=void 0,this._source=void 0,this._texture=void 0,this._usesPalette=void 0,this._x=void 0,this._y=void 0,this._width=void 0,this._height=void 0,this._flipH=void 0,this._flipV=void 0,this._rectangle=void 0,this._initialized=void 0}static createAsset(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const h=Be.GRAPHIC_POOL.length?Be.GRAPHIC_POOL.pop():new Be;return h._name=t,h._source=e||null,s?(h._texture=s,h._initialized=!1):(h._texture=null,h._initialized=!0),h._usesPalette=o,h._x=i,h._y=r,h._flipH=n,h._flipV=a,h._rectangle=null,h}recycle(){this._texture=null,Be.GRAPHIC_POOL.push(this)}initialize(){!this._initialized&&this._texture&&(this._width=this._texture.width,this._height=this._texture.height,this._initialized=!0)}get name(){return this._name}get source(){return this._source}get texture(){return this._texture}get usesPalette(){return this._usesPalette}get x(){return this._x}get y(){return this._y}get width(){return this.initialize(),this._width}get height(){return this.initialize(),this._height}get offsetX(){return this._flipH?-this._x:this._x}get offsetY(){return this._flipV?-this._y:this._y}get flipH(){return this._flipH}get flipV(){return this._flipV}get rectangle(){return this._rectangle||(this._rectangle=new j.j(0,0,this.width,this.height)),this._rectangle}}Be.GRAPHIC_POOL=[];class Ge{static hex2rgb(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}static hex2rgba(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e[3]=255&t,e}static rgb2hex(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)}static rgba2hex(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)+(0|t[3])}static rgbStringToHex(t){const e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+Ge.getHex(e[1])+Ge.getHex(e[2])+Ge.getHex(e[3])}static getHex(t){return isNaN(t)?"00":Ge.HEX_DIGITS[(t-t%16)/16]+Ge.HEX_DIGITS[t%16]}static int2rgb(t){t>>>=0;return"rgba("+[(16711680&t)>>>16,(65280&t)>>>8,255&t,1].join(",")+")"}static rgbToHSL(t){const e=(t>>16&255)/255,s=(t>>8&255)/255,i=(255&t)/255,r=Math.max(e,s,i),n=Math.min(e,s,i),a=r-n;let o=0,h=0,_=0;0==a?o=0:r==e?o=s>i?60*(s-i)/a:60*(s-i)/a+360:r==s?o=60*(i-e)/a+120:r==i&&(o=60*(e-s)/a+240),h=.5*(r+n),_=0==a?0:h<=.5?a/h*.5:a/(1-h)*.5;return(Math.round(o/360*255)<<16)+(Math.round(255*_)<<8)+Math.round(255*h)}static hslToRGB(t){let e,s,i,r,n;const a=(t>>16&255)/255,o=(t>>8&255)/255,h=(255&t)/255;let _=0,d=0,u=0;o>0?(e=0,s=0,e=h<.5?h*(1+o):h+o-h*o,s=2*h-e,i=a+1/3,r=a,n=a-1/3,i<0?i+=1:i>1&&i--,r<0?r+=1:r>1&&r--,n<0?n+=1:n>1&&n--,_=6*i<1?s+6*(e-s)*i:2*i<1?e:3*i<2?s+6*(e-s)*(2/3-i):s,d=6*r<1?s+6*(e-s)*r:2*r<1?e:3*r<2?s+6*(e-s)*(2/3-r):s,u=6*n<1?s+6*(e-s)*n:2*n<1?e:3*n<2?s+6*(e-s)*(2/3-n):s):(_=h,d=h,u=h);return(Math.round(255*_)<<16)+(Math.round(255*d)<<8)+Math.round(255*u)}static rgb2xyz(t){let e=(t>>16&255)/255,s=(t>>8&255)/255,i=(t>>0&255)/255;return e>.04045?e=Math.pow((e+.055)/1.055,2.4):e/=12.92,s>.04045?s=Math.pow((s+.055)/1.055,2.4):s/=12.92,i>.04045?i=Math.pow((i+.055)/1.055,2.4):i/=12.92,e*=100,s*=100,i*=100,new dt(.4124*e+.3576*s+.1805*i,.2126*e+.7152*s+.0722*i,.0193*e+.1192*s+.9505*i)}static xyz2CieLab(t){let e=t.x/95.047,s=t.y/100,i=t.z/108.883;return e=e>.008856?Math.pow(e,1/3):7.787*e+16/116,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,new dt(116*s-16,500*(e-s),200*(s-i))}static rgb2CieLab(t){return Ge.xyz2CieLab(Ge.rgb2xyz(t))}}Ge.HEX_DIGITS=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];class He{constructor(t){this._reservedNumbers=void 0,this._freeNumbers=void 0,t<0&&(t=0),this._reservedNumbers=[],this._freeNumbers=[];let e=0;for(;e<t;)this._freeNumbers.push(e),e++}dispose(){this._reservedNumbers=null,this._freeNumbers=null}reserveNumber(){if(this._freeNumbers.length>0){const t=this._freeNumbers.pop();return this._reservedNumbers.push(t),t}return-1}freeNumber(t){const e=this._reservedNumbers.indexOf(t);e>=0&&(this._reservedNumbers.splice(e,1),this._freeNumbers.push(t))}}var Ve=s(20);class je{static getFlipHBitmapData(t){if(!t)return null;const e=new j.d;e.scale(-1,1),e.translate(t.width,0);const s=new Ve.a;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),At.generateTexture(s)}static getFlipVBitmapData(t){if(!t)return null;const e=new j.d;e.scale(1,-1),e.translate(0,t.height);const s=new Ve.a;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),At.generateTexture(s)}static getFlipHVBitmapData(t){if(!t)return null;const e=new j.d;e.scale(-1,-1),e.translate(t.width,t.height);const s=new Ve.a;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),At.generateTexture(s)}}class ke{static init(t,e){ke._currentDelta=0,ke._startDelayMs=t,ke._effectDurationMs=e,ke._initializationTimeMs=SU.instance.time,ke._state=ke.STATE_START_DELAY}static turnVisualizationOn(){if(ke._state===ke.STATE_NOT_INITIALIZED||ke._state===ke.STATE_OVER)return;const t=SU.instance.time-ke._initializationTimeMs;t>ke._startDelayMs+ke._effectDurationMs?ke._state=ke.STATE_OVER:(ke._visualizationOn=!0,t<ke._startDelayMs?ke._state=ke.STATE_START_DELAY:(ke._state=ke.STATE_RUNNING,ke._currentDelta=(t-ke._startDelayMs)/ke._effectDurationMs))}static turnVisualizationOff(){ke._visualizationOn=!1}static isVisualizationOn(){return ke._visualizationOn&&ke.isRunning()}static isRunning(){return ke._state===ke.STATE_START_DELAY||ke._state===ke.STATE_RUNNING}static getDelta(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.min(Math.max(ke._currentDelta,t),e)}static get totalRunningTime(){return ke._startDelayMs+ke._effectDurationMs}}ke.STATE_NOT_INITIALIZED=0,ke.STATE_START_DELAY=1,ke.STATE_RUNNING=2,ke.STATE_OVER=3,ke._state=ke.STATE_NOT_INITIALIZED,ke._visualizationOn=!1,ke._currentDelta=0,ke._initializationTimeMs=0,ke._startDelayMs=2e4,ke._effectDurationMs=2e3;class Ye{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._updateId=0,this._x=void 0,this._y=void 0,this._z=void 0,this._directionAxis=void 0,this._location=void 0,this._direction=void 0,this._depth=void 0,this._scale=1,this._x_scale=1,this._y_scale=1,this._z_scale=1,this._x_scale_internal=1,this._y_scale_internal=1,this._z_scale_internal=1,this._loc=void 0,this._dir=void 0,this._clipNear=-500,this._clipFar=500,this._displacements=null,this.scale=t,this._x=new dt,this._y=new dt,this._z=new dt,this._directionAxis=new dt,this._location=new dt,this._direction=new dt,this._depth=new dt,this._x_scale_internal=1,this._y_scale_internal=1,this.x_scale=1,this.y_scale=1,this._z_scale_internal=Math.sqrt(.5)/Math.sqrt(3/4),this.z_scale=1,this.location=new dt(s.x,s.y,s.z),this.direction=new dt(e.x,e.y,e.z),null!=i?this.setDepthVector(i):this.setDepthVector(e),this._displacements=new Map}static getIntersectionVector(t,e,s,i){const r=dt.dotProduct(e,i);if(Math.abs(r)<1e-5)return null;const n=dt.dif(t,s),a=-dt.dotProduct(i,n)/r;return dt.sum(t,dt.product(e,a))}get updateId(){return this._updateId}get scale(){return this._scale/Math.sqrt(.5)}set scale(t){t<=1&&(t=1),(t*=Math.sqrt(.5))!=this._scale&&(this._scale=t,this._updateId++)}get directionAxis(){return this._directionAxis}get location(){return this._location.assign(this._loc),this._location.x=this._location.x*this._x_scale,this._location.y=this._location.y*this._y_scale,this._location.z=this._location.z*this._z_scale,this._location}set location(t){if(null==t)return;null==this._loc&&(this._loc=new dt);const e=this._loc.x,s=this._loc.y,i=this._loc.z;this._loc.assign(t),this._loc.x=this._loc.x/this._x_scale,this._loc.y=this._loc.y/this._y_scale,this._loc.z=this._loc.z/this._z_scale,this._loc.x==e&&this._loc.y==s&&this._loc.z==i||this._updateId++}get direction(){return this._direction}set direction(t){let e,s,i,r,n;if(null==t)return;null==this._dir&&(this._dir=new dt);const a=this._dir.x,o=this._dir.y,h=this._dir.z;this._dir.assign(t),this._direction.assign(t),this._dir.x==a&&this._dir.y==o&&this._dir.z==h||this._updateId++;const _=new dt(0,1,0),d=new dt(0,0,1),u=new dt(1,0,0),c=t.x/180*Math.PI,l=t.y/180*Math.PI,g=t.z/180*Math.PI,E=Math.cos(c),p=Math.sin(c),m=dt.sum(dt.product(_,E),dt.product(u,-p)),I=new dt(d.x,d.y,d.z),T=dt.sum(dt.product(_,p),dt.product(u,E)),R=Math.cos(l),f=Math.sin(l),O=new dt(m.x,m.y,m.z),v=dt.sum(dt.product(I,R),dt.product(T,f)),A=dt.sum(dt.product(I,-f),dt.product(T,R));0!=g?(e=Math.cos(g),s=Math.sin(g),i=dt.sum(dt.product(O,e),dt.product(v,s)),r=dt.sum(dt.product(O,-s),dt.product(v,e)),n=new dt(A.x,A.y,A.z),this._x.assign(i),this._y.assign(r),this._z.assign(n),this._directionAxis.assign(this._z)):(this._x.assign(O),this._y.assign(v),this._z.assign(A),this._directionAxis.assign(this._z))}set x_scale(t){this._x_scale!=t*this._x_scale_internal&&(this._x_scale=t*this._x_scale_internal,this._updateId++)}set y_scale(t){this._y_scale!=t*this._y_scale_internal&&(this._y_scale=t*this._y_scale_internal,this._updateId++)}set z_scale(t){this._z_scale!=t*this._z_scale_internal&&(this._z_scale=t*this._z_scale_internal,this._updateId++)}dispose(){this._x=null,this._y=null,this._z=null,this._loc=null,this._dir=null,this._directionAxis=null,this._location=null,null!=this._displacements&&(this._displacements.clear(),this._displacements=null)}setDisplacement(t,e){let s,i;null!=t&&null!=e&&null!=this._displacements&&(s=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.delete(s),i=new dt,i.assign(e),this._displacements.set(s,i),this._updateId++)}getDisplacenent(t){let e;return null!=this._displacements?(e=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.get(e)):null}setDepthVector(t){let e,s,i,r,n;const a=new dt(0,1,0),o=new dt(0,0,1),h=new dt(1,0,0),_=t.x/180*Math.PI,d=t.y/180*Math.PI,u=t.z/180*Math.PI,c=Math.cos(_),l=Math.sin(_),g=dt.sum(dt.product(a,c),dt.product(h,-l)),E=new dt(o.x,o.y,o.z),p=dt.sum(dt.product(a,l),dt.product(h,c)),m=Math.cos(d),I=Math.sin(d),T=new dt(g.x,g.y,g.z),R=dt.sum(dt.product(E,m),dt.product(p,I)),f=dt.sum(dt.product(E,-I),dt.product(p,m));0!=u?(e=Math.cos(u),s=Math.sin(u),i=dt.sum(dt.product(T,e),dt.product(R,s)),r=dt.sum(dt.product(T,-s),dt.product(R,e)),n=new dt(f.x,f.y,f.z),this._depth.assign(n)):this._depth.assign(f),this._updateId++}adjustLocation(t,e){if(null==t||null==this._z)return;const s=dt.product(this._z,-e),i=new dt(t.x+s.x,t.y+s.y,t.z+s.z);this.location=i}getCoordinatePosition(t){if(null==t)return null;const e=dt.scalarProjection(t,this._x),s=dt.scalarProjection(t,this._y),i=dt.scalarProjection(t,this._z);return new dt(e,s,i)}getScreenPosition(t){let e=dt.dif(t,this._loc);e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale;let s=dt.scalarProjection(e,this._depth);if(s<this._clipNear||s>this._clipFar)return null;let i=dt.scalarProjection(e,this._x),r=-dt.scalarProjection(e,this._y);i*=this._scale,r*=this._scale;const n=this.getDisplacenent(t);return null!=n&&(e=dt.dif(t,this._loc),e.add(n),e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale,s=dt.scalarProjection(e,this._depth)),e.x=i,e.y=r,e.z=s,e}getScreenPoint(t){const e=this.getScreenPosition(t);if(null==e)return null;return new j.g(e.x,e.y)}getPlanePosition(t,e,s,i){let r,n;const a=t.x/this._scale,o=-t.y/this._scale,h=dt.product(this._x,a);h.add(dt.product(this._y,o));const _=new dt(this._loc.x*this._x_scale,this._loc.y*this._y_scale,this._loc.z*this._z_scale);_.add(h);const d=this._z,u=new dt(e.x*this._x_scale,e.y*this._y_scale,e.z*this._z_scale),c=new dt(s.x*this._x_scale,s.y*this._y_scale,s.z*this._z_scale),l=new dt(i.x*this._x_scale,i.y*this._y_scale,i.z*this._z_scale),g=dt.crossProduct(c,l),E=new dt;return E.assign(Ye.getIntersectionVector(_,d,u,g)),null!=E?(E.subtract(u),r=dt.scalarProjection(E,s)/c.length*s.length,n=dt.scalarProjection(E,i)/l.length*i.length,new j.g(r,n)):null}performZoom(){this.isZoomedIn()?this.scale=Ye.SCALE_ZOOMED_OUT:this.scale=Ye.SCALE_ZOOMED_IN}isZoomedIn(){return this.scale==Ye.SCALE_ZOOMED_IN}performZoomOut(){this.scale=Ye.SCALE_ZOOMED_OUT}performZoomIn(){this.scale=Ye.SCALE_ZOOMED_IN}}Ye.SCALE_ZOOMED_IN=64,Ye.SCALE_ZOOMED_OUT=32;class ze{static makeRoomPreviewerId(t){return(65535&t)+ze.PREVIEW_ROOM_ID_BASE}static isRoomPreviewerId(t){return t>=ze.PREVIEW_ROOM_ID_BASE}}ze.PREVIEW_ROOM_ID_BASE=2147418112;class We{static init(t,e){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=e,this._SafeStr_4514=SU.instance.time,this._SafeStr_448=1}static turnVisualizationOn(){if(0===this._SafeStr_448||3===this._SafeStr_448)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout((()=>this.turnVisualizationOff()),this._SafeStr_4516));const t=SU.instance.time-this._SafeStr_4514;t>this._SafeStr_4515+this._SafeStr_4516?this._SafeStr_448=3:(this._SafeStr_4512=!0,t<this._SafeStr_4515?this._SafeStr_448=1:(this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516))}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return 1===this._SafeStr_448||2===this._SafeStr_448}}We.STATE_NOT_INITIALIZED=0,We.STATE_START_DELAY=1,We.STATE_RUNNING=2,We.STATE_OVER=3,We._SafeStr_448=0,We._SafeStr_4512=!1,We._SafeStr_4513=0,We._SafeStr_4514=0,We._SafeStr_4515=2e4,We._SafeStr_4516=5e3,We._SafeStr_4524=void 0;class Ke{static init(t,e){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=e,this._SafeStr_4514=SU.instance.time,this._SafeStr_448=1}static turnVisualizationOn(){if(0===this._SafeStr_448||3===this._SafeStr_448)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout((()=>this.turnVisualizationOff()),this._SafeStr_4516));const t=SU.instance.time-this._SafeStr_4514;t>this._SafeStr_4515+this._SafeStr_4516?this._SafeStr_448=3:(this._SafeStr_4512=!0,t<this._SafeStr_4515?this._SafeStr_448=1:(this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516))}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return 1===this._SafeStr_448||2===this._SafeStr_448}}Ke.STATE_NOT_INITIALIZED=0,Ke.STATE_START_DELAY=1,Ke.STATE_RUNNING=2,Ke.STATE_OVER=3,Ke._SafeStr_448=0,Ke._SafeStr_4512=!1,Ke._SafeStr_4513=void 0,Ke._SafeStr_4514=0,Ke._SafeStr_4515=2e4,Ke._SafeStr_4516=5e3,Ke._SafeStr_4524=void 0;class Xe{static hex2int(t){return parseInt(t,16)}static inkToBlendMode(t){return"ADD"==t||33==t?o.b.ADD:"SUBTRACT"==t?o.b.SUBTRACT:"DARKEN"==t?o.b.DARKEN:o.b.NORMAL}}class qe{constructor(t,e,s){for(this._palette=void 0,this._primaryColor=void 0,this._secondaryColor=void 0,this._palette=t;this._palette.length<256;)this._palette.push([0,0,0]);this._primaryColor=e,this._secondaryColor=s}dispose(){}applyPalette(t){const e=new W(t),s=At.generateCanvas(e),r=s.getContext("2d"),n=r.getImageData(0,0,s.width,s.height),a=n.data;for(let i=0;i<a.length;i+=4){let t=this._palette[a[i+1]];void 0===t&&(t=[0,0,0]),a[i]=t[0],a[i+1]=t[1],a[i+2]=t[2]}return r.putImageData(n,0,0),i.t.from(s)}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}}class Qe{constructor(t){this._roomObjectVariableAccurateZ=void 0,this._location=void 0,this._screenLocation=void 0,this._locationChanged=void 0,this._geometryUpdateId=void 0,this._objectUpdateId=void 0,this._roomObjectVariableAccurateZ=t||"",this._location=new dt,this._screenLocation=new dt,this._locationChanged=!1,this._geometryUpdateId=-1,this._objectUpdateId=-1}dispose(){this._screenLocation=null}updateLocation(t,e){if(!t||!e)return null;let s=!1;const i=t.getLocation();if(e.updateId===this._geometryUpdateId&&t.updateCounter===this._objectUpdateId||(this._objectUpdateId=t.updateCounter,e.updateId===this._geometryUpdateId&&i.x===this._location.x&&i.y===this._location.y&&i.z===this._location.z||(this._geometryUpdateId=e.updateId,this._location.assign(i),s=!0)),this._locationChanged=s,this._locationChanged){const s=e.getScreenPosition(i);if(!s)return null;const r=t.model.getValue(this._roomObjectVariableAccurateZ);if(isNaN(r)||0===r){const t=new dt(Math.round(i.x),Math.round(i.y),i.z);if(t.x!==i.x||t.y!==i.y){const i=e.getScreenPosition(t);this._screenLocation.assign(s),i&&(this._screenLocation.z=i.z)}else this._screenLocation.assign(s)}else this._screenLocation.assign(s);this._screenLocation.x=Math.round(this._screenLocation.x),this._screenLocation.y=Math.round(this._screenLocation.y)}return this._screenLocation}get locationChanged(){return this._locationChanged}}class Ze{constructor(){this._sprites=void 0,this._updateId1=void 0,this._updateId2=void 0,this._isEmpty=void 0,this._sprites=[],this._updateId1=-1,this._updateId2=-1,this._isEmpty=!1}get spriteCount(){return this._sprites.length}get isEmpty(){return this._isEmpty}dispose(){this.setSpriteCount(0)}addSprite(t){this._sprites.push(t)}getSprite(t){return this._sprites[t]}get sprites(){return this._sprites}needsUpdate(t,e){return(t!==this._updateId1||e!==this._updateId2)&&(this._updateId1=t,this._updateId2=e,!0)}setSpriteCount(t){if(t<this._sprites.length){let e=t;for(;e<this._sprites.length;){const t=this._sprites[e];t&&t.dispose(),e++}this._sprites.splice(t,this._sprites.length-t)}this._isEmpty=!this._sprites.length}}class Je{constructor(t){this._objectId=void 0,this._location=void 0,this._sprites=void 0,this._location=new Qe(t),this._sprites=new Ze}get location(){return this._location}get sprites(){return this._sprites}dispose(){this._location&&(this._location.dispose(),this._location=null),this._sprites&&(this._sprites.dispose(),this._sprites=null)}get objectId(){return this._objectId}set objectId(t){this._objectId=t}}class $e{constructor(t){this._data=void 0,this._roomObjectVariableAccurateZ=void 0,this._data=new Map,this._roomObjectVariableAccurateZ=t}dispose(){if(this._data){for(const[t,e]of this._data.entries())e&&(this._data.delete(t),e.dispose());this._data=null}}getObjectCache(t){let e=this._data.get(t);return e||(e=new Je(this._roomObjectVariableAccurateZ),this._data.set(t,e)),e}removeObjectCache(t){const e=this._data.get(t);e&&(this._data.delete(t),e.dispose())}getSortableSpriteList(){const t=[];for(const e of this._data.values()){if(!e)continue;const s=e.sprites&&e.sprites.sprites;if(s&&s.length)for(const i of s)if(i&&i.sprite.spriteType!==be.ROOM_PLANE&&""!==i.sprite.name){const s=new Nt;s.objectId=e.objectId,s.x=i.x,s.y=i.y,s.z=i.z,s.name=i.sprite.name||"",s.flipH=i.sprite.flipH,s.alpha=i.sprite.alpha,s.color=i.sprite.color.toString(),s.blendMode=i.sprite.blendMode.toString(),s.width=i.sprite.width,s.height=i.sprite.height,s.type=i.sprite.type,s.posture=i.sprite.posture;const r=this.isSkewedSprite(i.sprite);r&&(s.skew=i.sprite.direction%4===0?-.5:.5),(r||i.name.indexOf("%image.library.url%")>=0||i.name.indexOf("%group.badge.url%")>=0)&&s.width<=$e.MAX_SIZE_FOR_AVG_COLOR&&s.height<=$e.MAX_SIZE_FOR_AVG_COLOR&&0===i.sprite.name.indexOf("external_image_wallitem")&&(s.frame=!0),t.push(s)}}return t&&t.length?t:null}isSkewedSprite(t){return!!t.type&&(0===t.type.indexOf("external_image_wallitem")&&"THUMBNAIL"===t.tag||0===t.type.indexOf("guild_forum")&&"THUMBNAIL"===t.tag)}getPlaneSortableSprites(){const t=[];for(const e of this._data.values())for(const s of e.sprites.sprites)s.sprite.spriteType===be.ROOM_PLANE&&t.push(s);return t}}$e.MAX_SIZE_FOR_AVG_COLOR=200;class ts{}ts.MOUSE_CLICK="click",ts.DOUBLE_CLICK="double_click",ts.MOUSE_MOVE="mousemove",ts.MOUSE_DOWN="mousedown",ts.MOUSE_DOWN_LONG="mousedown_long",ts.MOUSE_UP="mouseup",ts.ROLL_OVER="mouseover",ts.ROLL_OUT="mouseout",ts.RIGHT_CLICK="contextmenu";class es extends z.a{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),this._offsetX=void 0,this._offsetY=void 0,this._tag=void 0,this._alphaTolerance=void 0,this._varyingDepth=void 0,this._clickHandling=void 0,this._pairedSpriteId=void 0,this._pairedSpriteUpdateCounter=void 0,this.name=void 0,this._offsetX=0,this._offsetY=0,this._tag="",this._alphaTolerance=128,this._varyingDepth=!1,this._clickHandling=!1,this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1}needsUpdate(t,e){return(this._pairedSpriteId!==t||this._pairedSpriteUpdateCounter!==e)&&(this._pairedSpriteId=t,this._pairedSpriteUpdateCounter=e,!0)}calculateVertices(){this.texture.orig&&super.calculateVertices()}setTexture(t){t||(t=i.t.EMPTY),t!==this.texture&&(t===i.t.EMPTY&&(this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1),this.texture=t)}containsPoint(t){return es.containsPoint(this,t)}static containsPoint(t,e){if(!t||!e||t.alphaTolerance>255)return!1;if(!(t instanceof z.a))return!1;if(t.texture===i.t.EMPTY||t.blendMode!==o.b.NORMAL)return;const s=t.texture,r=s.baseTexture;if(!s||!r||!r.valid)return!1;const n=e.x*t.scale.x,a=e.y*t.scale.y;if(!t.getLocalBounds().contains(n,a))return!1;if(!r.hitMap){let t=null;if(!r.resource)if(s.getLocalBounds)t=At.generateCanvas(s);else{const e=new W(s);t=At.generateCanvas(e),e.destroy()}if(!es.generateHitMap(r,t))return!1}const h=r.hitMap;let _=n+s.frame.x,d=a+s.frame.y;s.trim&&(_-=s.trim.x,d-=s.trim.y),_=Math.round(_)*r.resolution,d=Math.round(d)*r.resolution;const u=_+d*r.realWidth,c=u%32;return 0!==(h[u/32|0]&1<<c)}static generateHitMap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=null,i=null;if(e)s=e,i=s.getContext("2d");else{if(!t.resource)return!1;const e=t.resource.source;if(!e)return!1;if(e.getContext)s=e,i=s.getContext("2d");else{if(!(e instanceof Image))return!1;s=document.createElement("canvas"),s.width=e.width,s.height=e.height,i=s.getContext("2d"),i.drawImage(e,0,0)}}const r=s.width,n=s.height,a=i.getImageData(0,0,r,n),o=new Uint32Array(Math.ceil(r*n/32));for(let h=0;h<r*n;h++){const t=h%32,e=h/32|0;a.data[4*h+3]>=128&&(o[e]=o[e]|1<<t)}return t.hitMap=o,!0}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t}get tag(){return this._tag}set tag(t){this._tag=t}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance=t}get varyingDepth(){return this._varyingDepth}set varyingDepth(t){this._varyingDepth=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}}class ss{constructor(){this._objectId=void 0,this._spriteTag=void 0,this._objectId="",this._spriteTag=""}get objectId(){return this._objectId}set objectId(t){this._objectId=t}get spriteTag(){return this._spriteTag}set spriteTag(t){this._spriteTag=t}}class is{constructor(){this._name=void 0,this._sprite=void 0,this._x=void 0,this._y=void 0,this._z=void 0,this._name="",this._sprite=null,this._x=0,this._y=0,this._z=0}dispose(){this._z=-is.Z_INFINITY,this._sprite=null}get name(){return this._name}set name(t){this._name=t}get sprite(){return this._sprite}set sprite(t){this._sprite=t}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}}is.Z_INFINITY=1e8;class rs{constructor(t,e,s,i,r){this._id=void 0,this._container=void 0,this._geometry=void 0,this._animationFPS=void 0,this._renderTimestamp=void 0,this._totalTimeRunning=void 0,this._lastFrame=void 0,this._master=void 0,this._display=void 0,this._mask=void 0,this._sortableSprites=void 0,this._spriteCount=void 0,this._activeSpriteCount=void 0,this._spritePool=void 0,this._skipObjectUpdate=void 0,this._runningSlow=void 0,this._width=void 0,this._height=void 0,this._renderedWidth=void 0,this._renderedHeight=void 0,this._screenOffsetX=void 0,this._screenOffsetY=void 0,this._mouseLocation=void 0,this._mouseOldX=void 0,this._mouseOldY=void 0,this._mouseCheckCount=void 0,this._mouseSpriteWasHit=void 0,this._mouseActiveObjects=void 0,this._eventCache=void 0,this._eventId=void 0,this._scale=void 0,this._SafeStr_4507=!1,this._rotation=0,this._rotationOrigin=null,this._rotationRodLength=0,this._effectDirection=void 0,this._effectLocation=void 0,this._SafeStr_795=0,this._restrictsScaling=void 0,this._noSpriteVisibilityChecking=void 0,this._usesExclusionRectangles=void 0,this._usesMask=void 0,this._canvasUpdated=void 0,this._objectCache=void 0,this._mouseListener=void 0,this._id=e,this._container=t,this._geometry=new Ye(r,new dt(-135,30,0),new dt(11,11,5),new dt(-135,.5,0)),this._animationFPS=SU.instance.getConfiguration("system.animation.fps",24),this._renderTimestamp=0,this._totalTimeRunning=0,this._lastFrame=0,this._master=null,this._display=null,this._mask=null,this._sortableSprites=[],this._spriteCount=0,this._activeSpriteCount=0,this._spritePool=[],this._skipObjectUpdate=!1,this._runningSlow=!1,this._width=0,this._height=0,this._renderedWidth=0,this._renderedHeight=0,this._screenOffsetX=0,this._screenOffsetY=0,this._mouseLocation=new j.g,this._mouseOldX=0,this._mouseOldY=0,this._mouseCheckCount=0,this._mouseSpriteWasHit=!1,this._mouseActiveObjects=new Map,this._eventCache=new Map,this._eventId=0,this._scale=1,this._restrictsScaling=!1,this._noSpriteVisibilityChecking=!1,this._usesExclusionRectangles=!1,this._usesMask=!0,this._canvasUpdated=!1,this._objectCache=new $e(this._container.roomObjectVariableAccurateZ),this._mouseListener=null,this.setupCanvas(),this.initialize(s,i)}setupCanvas(){if(this._master||(this._master=new W,this._master.interactiveChildren=!1),!this._display){const t=new H;this._master.addChild(t),this._display=t}}dispose(){if(this.cleanSprites(0,!0),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._mask&&(this._mask=null),this._objectCache&&(this._objectCache.dispose(),this._objectCache=null),this._master){for(;this._master.children.length;){this._master.removeChildAt(0).destroy()}this._master.parent&&this._master.parent.removeChild(this._master),this._master.destroy(),this._master=null}if(this._display=null,this._sortableSprites=[],this._mouseActiveObjects&&(this._mouseActiveObjects.clear(),this._mouseActiveObjects=null),this._spritePool){for(const t of this._spritePool)this.cleanSprite(t,!0);this._spritePool=[]}this._eventCache&&(this._eventCache.clear(),this._eventCache=null),this._mouseListener=null}initialize(t,e){if(t=t<1?1:t,e=e<1?1:e,this._usesMask&&(this._mask?this._mask.clear().beginFill(16711680).drawRect(0,0,t,e).endFill():(this._mask=(new Ve.a).beginFill(16711680).drawRect(0,0,t,e).endFill(),this._master&&(this._master.addChild(this._mask),this._display&&(this._display.mask=this._mask)))),this._master){if(this._master.hitArea){const s=this._master.hitArea;s.width=t,s.height=e}else this._master.hitArea=new j.j(0,0,t,e);if(this._master.filterArea){const s=this._master.filterArea;s.width=t,s.height=e}else this._master.filterArea=new j.j(0,0,t,e)}this._width=t,this._height=e}setMask(t){t&&!this._usesMask?(this._usesMask=!0,this._mask&&this._mask.parent!==this._master&&(this._master.addChild(this._mask),this._display.mask=this._mask)):!t&&this._usesMask&&(this._usesMask=!1,this._mask&&this._mask.parent===this._master&&(this._master.removeChild(this._mask),this._display.mask=null))}setScale(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this._master&&this._display&&(this._restrictsScaling&&!i||(e||(e=new j.g(this._width/2,this._height/2)),s||(s=e),e=this._display.toLocal(e),r?this._scale*=t:this._scale=t,this.screenOffsetX=s.x-e.x*this._scale,this.screenOffsetY=s.y-e.y*this._scale))}render(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._canvasUpdated=!1,this._totalTimeRunning+=SU.instance.ticker.deltaTime,this._totalTimeRunning===this._renderTimestamp)return;if(-1===t&&(t=this._renderTimestamp+1),!this._container||!this._geometry)return;this._width===this._renderedWidth&&this._height===this._renderedHeight||(e=!0),this._display.x===this._screenOffsetX&&this._display.y===this._screenOffsetY||(this._display.x=this._screenOffsetX,this._display.y=this._screenOffsetY,e=!0),this._display.scale.x!==this._scale&&(this._display.scale.set(this._scale),e=!0),this.doMagic();const s=Math.round(this._totalTimeRunning/(60/this._animationFPS));let i=!1;s!==this._lastFrame&&(this._lastFrame=s,i=!0);let r=0;const n=this._container.objects;if(n.size)for(const o of n.values())o&&(r+=this.renderObject(o,o.instanceId.toString(),t,e,i,r));this._sortableSprites.sort(((t,e)=>e.z-t.z)),r<this._sortableSprites.length&&this._sortableSprites.splice(r);let a=0;for(;a<r;){const t=this._sortableSprites[a];t&&t.sprite&&this.renderSprite(a,t),a++}this.cleanSprites(r),(e||i)&&(this._canvasUpdated=!0),this._renderTimestamp=this._totalTimeRunning,this._renderedWidth=this._width,this._renderedHeight=this._height}skipSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!0,this.render(-1,!0)}resumeSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!1}getSortableSpriteList(){return this._objectCache.getSortableSpriteList()}getPlaneSortableSprites(){return this._objectCache.getPlaneSortableSprites()}removeFromCache(t){this._objectCache.removeObjectCache(t)}renderObject(t,e,s,i,r,n){if(!t)return 0;const a=t.visualization;if(!a)return this.removeFromCache(e),0;const o=this.getCacheItem(e);o.objectId=t.instanceId;const h=o.location,_=o.sprites,d=h.updateLocation(t,this._geometry);if(!d)return this.removeFromCache(e),0;if(r&&a.update(this._geometry,s,!_.isEmpty||i,this._skipObjectUpdate&&this._runningSlow),h.locationChanged&&(i=!0),!_.needsUpdate(a.instanceId,a.updateSpriteCounter)&&!i)return _.spriteCount;let u=d.x,c=d.y,l=d.z;l+=u>0?12e-8*u:12e-8*-u,u+=Math.trunc(this._width/2),c+=Math.trunc(this._height/2);let g=0;for(const E of a.sprites.values()){if(!E||!E.visible)continue;const s=E.texture,i=s&&s.baseTexture;if(!s||!i)continue;const r=u+E.offsetX+this._screenOffsetX,a=c+E.offsetY+this._screenOffsetY;if(E.flipH){const t=u+-(s.width+-E.offsetX)+this._screenOffsetX;if(!this.isSpriteVisible(t,a,s.width,s.height))continue}else if(E.flipV){const t=c+-(s.height+-E.offsetY)+this._screenOffsetY;if(!this.isSpriteVisible(r,t,s.width,s.height))continue}else if(!this.isSpriteVisible(r,a,s.width,s.height))continue;let o=_.getSprite(g);o||(o=new is,_.addSprite(o),this._sortableSprites.push(o),o.name=e),o.sprite=E,E.spriteType!==be.AVATAR&&E.spriteType!==be.AVATAR_OWN||(o.sprite.libraryAssetName="avatar_"+t.id),o.x=r-this._screenOffsetX,o.y=a-this._screenOffsetY,o.z=l+E.relativeDepth+37e-12*n,g++,n++}return _.setSpriteCount(g),this._canvasUpdated=!0,g}getExtendedSprite(t){if(t<0||t>=this._spriteCount)return null;const e=this._display.getChildAt(t);return e||null}getExtendedSpriteIdentifier(t){return t?t.name:""}renderSprite(t,e){if(t>=this._spriteCount)return this.createAndAddSprite(e),!0;if(!e)return!1;const s=e.sprite,i=this.getExtendedSprite(t);if(!s||!i)return!1;if(i.varyingDepth!==s.varyingDepth)return i.varyingDepth&&!s.varyingDepth?(this._display.removeChildAt(t),this._spritePool.push(i),this.renderSprite(t,e)):(this.createAndAddSprite(e,t),!0);if(i.needsUpdate(s.id,s.updateCounter)||ke.isVisualizationOn()){i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.name=e.name,i.varyingDepth=s.varyingDepth,i.clickHandling=s.clickHandling,i.filters=s.filters;const t=s.alpha/255;if(i.alpha!==t&&(i.alpha=t),i.tint!==s.color&&(i.tint=s.color),i.blendMode!==s.blendMode&&(i.blendMode=s.blendMode),i.texture!==s.texture&&i.setTexture(s.texture),s.updateContainer){1===i.children.length&&i.removeChildAt(0),i.addChild(s.container),s.updateContainer=!1}s.flipH?-1!==i.scale.x&&(i.scale.x=-1):1!==i.scale.x&&(i.scale.x=1),s.flipV?-1!==i.scale.y&&(i.scale.y=-1):1!==i.scale.y&&(i.scale.y=1),this.updateEnterRoomEffect(i,s)}return i.x!==e.x&&(i.x=e.x),i.y!==e.y&&(i.y=e.y),i.offsetX=s.offsetX,i.offsetY=s.offsetY,!0}createAndAddSprite(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const s=t.sprite;if(!s)return;let i=null;this._spritePool.length>0&&(i=this._spritePool.pop()),i||(i=new es),i.children.length&&i.removeChildren(),i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.alpha=s.alpha/255,i.tint=s.color,i.x=t.x,i.y=t.y,i.offsetX=s.offsetX,i.offsetY=s.offsetY,i.name=s.name,i.varyingDepth=s.varyingDepth,i.clickHandling=s.clickHandling,i.blendMode=s.blendMode,i.filters=s.filters,i.setTexture(s.texture),s.updateContainer&&(i.addChild(s.container),s.updateContainer=!1),s.flipH&&(i.scale.x=-1),s.flipV&&(i.scale.y=-1),this.updateEnterRoomEffect(i,s),e<0||e>=this._spriteCount?(this._display.addChild(i),this._spriteCount++):this._display.addChildAt(i,e),this._activeSpriteCount++}cleanSprites(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._display){if(t<0&&(t=0),t<this._activeSpriteCount||!this._activeSpriteCount){let s=this._spriteCount-1;for(;s>=t;)this.cleanSprite(this.getExtendedSprite(s),e),s--}this._activeSpriteCount=t}}updateEnterRoomEffect(t,e){if(ke.isVisualizationOn()&&e)switch(e.spriteType){case be.AVATAR_OWN:return;case be.ROOM_PLANE:return void(t.alpha=ke.getDelta(.9));case be.AVATAR:return void(t.alpha=ke.getDelta(.5));default:t.alpha=ke.getDelta(.1)}}cleanSprite(t,e){t&&(e?(t.parent&&t.parent.removeChild(t),t.destroy({children:!0})):t.setTexture(null))}update(){this._mouseCheckCount,this._mouseCheckCount=0,this._eventId++}setMouseListener(t){this._mouseListener=t}getCacheItem(t){return this._objectCache.getObjectCache(t)}isSpriteVisible(t,e,s,i){return!!this._noSpriteVisibilityChecking||(t=(t-this._screenOffsetX)*this._scale+this._screenOffsetX,e=(e-this._screenOffsetY)*this._scale+this._screenOffsetY,s*=this._scale,i*=this._scale,t<this._width&&t+s>=0&&e<this._height&&e+i>=0&&!this._usesExclusionRectangles)}handleMouseEvent(t,e,s,i,r,n,a){return t-=this._screenOffsetX,e-=this._screenOffsetY,this._mouseLocation.x=t/this._scale,this._mouseLocation.y=e/this._scale,this._mouseCheckCount>0&&s==ts.MOUSE_MOVE||(this._mouseSpriteWasHit=this.checkMouseHits(Math.trunc(t/this._scale),Math.trunc(e/this._scale),s,i,r,n,a),this._mouseCheckCount++),this._mouseSpriteWasHit}checkMouseHits(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];const o=[];let h=!1,_=null,d=this._activeSpriteCount-1;for(;d>=0;){const u=this.getExtendedSprite(d);if(u&&u.containsPoint(new j.g(t-u.x,e-u.y)))if(!u.clickHandling||s!==ts.MOUSE_CLICK&&s!==ts.DOUBLE_CLICK){const d=this.getExtendedSpriteIdentifier(u);if(-1===o.indexOf(d)){const h=u.tag;let c=this._mouseActiveObjects.get(d);c&&c.spriteTag!==h&&(_=this.createMouseEvent(0,0,0,0,ts.ROLL_OUT,c.spriteTag,i,r,n,a),this.bufferMouseEvent(_,d)),s!==ts.MOUSE_MOVE||c&&c.spriteTag===h?(_=this.createMouseEvent(t,e,t-u.x,e-u.y,s,h,i,r,n,a),_.spriteOffsetX=u.offsetX,_.spriteOffsetY=u.offsetY):_=this.createMouseEvent(t,e,t-u.x,e-u.y,ts.ROLL_OVER,h,i,r,n,a),c||(c=new ss,c.objectId=d,this._mouseActiveObjects.set(d,c)),c.spriteTag=h,s===ts.MOUSE_MOVE&&t===this._mouseOldX&&e===this._mouseOldY||this.bufferMouseEvent(_,d),o.push(d)}h=!0}else;d--}const u=[];for(const l of this._mouseActiveObjects.keys())l&&u.push(l);let c=0;for(;c<u.length;){const t=u[c];o.indexOf(t)>=0&&(u[c]=null),c++}for(c=0;c<u.length;){const t=u[c];if(null!==t){const e=this._mouseActiveObjects.get(t);e&&this._mouseActiveObjects.delete(t);const s=this.createMouseEvent(0,0,0,0,ts.ROLL_OUT,e.spriteTag,i,r,n,a);this.bufferMouseEvent(s,t)}c++}return this.processMouseEvents(),this._mouseOldX=t,this._mouseOldY=e,h}createMouseEvent(t,e,s,i,r,n,a,o,h,_){const d=t-this._width/2,u=e-this._height/2,c=`canvas_${this._id}`;return new Ce(r,c+"_"+this._eventId,c,n,d,u,s,i,o,a,h,_)}bufferMouseEvent(t,e){t&&this._eventCache&&(this._eventCache.delete(e),this._eventCache.set(e,t))}processMouseEvents(){if(this._container&&this._eventCache){for(const[t,e]of this._eventCache.entries()){if(!this._eventCache)return;if(!e)continue;const s=this._container.getRoomObject(parseInt(t));if(s)if(this._mouseListener)this._mouseListener.processRoomCanvasMouseEvent(e,s,this._geometry);else{const t=s.mouseHandler;t&&t.mouseEvent(e,this._geometry)}}this._eventCache&&this._eventCache.clear()}}getDisplayAsTexture(){this._noSpriteVisibilityChecking=!0;const t=this._scale,e=this._screenOffsetX,s=this._screenOffsetY;this.setScale(1,null,null,!0),this._screenOffsetX=0,this._screenOffsetY=0,this.render(-1,!0),this._display.mask=null;const r=this._display.getBounds(),n=i.o.create({width:this._display.width,height:this._display.height});return SU.instance.renderer.render(this._display,{renderTexture:n,clear:!0,transform:new j.d(1,0,0,1,-r.x,-r.y)}),this._display.mask=this._mask,this._noSpriteVisibilityChecking=!1,this.setScale(t,null,null,!0),this._screenOffsetX=e,this._screenOffsetY=s,n}doMagic(){const t=this.geometry;if(0!==this._rotation){let e=this._effectDirection;t.direction=new dt(e.x+this._rotation,e.y,e.z),e=t.direction,t.setDepthVector(new dt(e.x,e.y,5));const s=new dt;s.assign(this._rotationOrigin),s.x=s.x+this._rotationRodLength*Math.cos((e.x+180)/180*3.14159265358979)*Math.cos(e.y/180*3.14159265358979),s.y=s.y+this._rotationRodLength*Math.sin((e.x+180)/180*3.14159265358979)*Math.cos(e.y/180*3.14159265358979),s.z=s.z+this._rotationRodLength*Math.sin(e.y/180*3.14159265358979),t.location=s,this._effectLocation=new dt,this._effectLocation.assign(s),this._effectDirection=new dt,this._effectDirection.assign(t.direction)}if((Ke.isVisualizationOn()&&!this._SafeStr_4507||!Ke.isVisualizationOn()&&this._SafeStr_4507)&&this.changeShaking(),We.isVisualizationOn()&&this.changeRotation(),this._SafeStr_4507){this._SafeStr_795++;const e=this._effectDirection,s=dt.sum(e,new dt(2*Math.sin(5*this._SafeStr_795/180*3.14159265358979),5*Math.sin(this._SafeStr_795/180*3.14159265358979),2*Math.sin(10*this._SafeStr_795/180*3.14159265358979)));t.direction=s}else this._SafeStr_795=0,t.direction=this._effectDirection}changeShaking(){if(this._SafeStr_4507=!this._SafeStr_4507,this._SafeStr_4507){const t=this.geometry.direction;this._effectDirection=new dt(t.x,t.y,t.z)}}changeRotation(){if(this._SafeStr_4507)return;const t=this.geometry;if(t)if(0!==this._rotation)this._rotation=0,t.location=this._effectLocation,t.direction=this._effectDirection,t.setDepthVector(new dt(this._effectDirection.x,this._effectDirection.y,5));else{const e=t.location,s=t.directionAxis;this._effectLocation=new dt,this._effectLocation.assign(e),this._effectDirection=new dt,this._effectDirection.assign(t.direction);const i=Ye.getIntersectionVector(e,s,new dt(0,0,0),new dt(0,0,1));null!==i&&(this._rotationOrigin=new dt(i.x,i.y,i.z),this._rotationRodLength=dt.dif(i,e).length,this._rotation=1)}}moveLeft(){if(0!==this._rotation)return void(1===this._rotation?this._rotation=-1:this._rotation=this._rotation-1);const t=this.geometry,e=(t.direction.x-90)/180*3.14159265358979;t.location=dt.sum(t.location,new dt(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveRight(){if(0!==this._rotation)return void(-1===this._rotation?this._rotation=1:this._rotation=this._rotation+1);const t=this.geometry,e=(t.direction.x+90)/180*3.14159265358979;t.location=dt.sum(t.location,new dt(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveUp(){if(0!==this._rotation)return;const t=this.geometry,e=t.direction.x/180*3.14159265358979;t.location=dt.sum(t.location,new dt(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveDown(){if(0!==this._rotation)return;const t=this.geometry,e=(t.direction.x+180)/180*3.14159265358979;t.location=dt.sum(t.location,new dt(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}get id(){return this._id}get geometry(){return this._geometry}get master(){return this._master}get display(){return this._display}get screenOffsetX(){return this._screenOffsetX}set screenOffsetX(t){t=Math.trunc(t),this._mouseLocation.x=this._mouseLocation.x-(t-this._screenOffsetX),this._screenOffsetX=t}get screenOffsetY(){return this._screenOffsetY}set screenOffsetY(t){t=Math.trunc(t),this._mouseLocation.y=this._mouseLocation.y-(t-this._screenOffsetY),this._screenOffsetY=t}get scale(){return this._scale}get width(){return this._width*this._scale}get height(){return this._height*this._scale}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get canvasUpdated(){return this._canvasUpdated}set canvasUpdated(t){this._canvasUpdated=t}}class ns{constructor(){this._objects=void 0,this._canvases=void 0,this._disposed=void 0,this._roomObjectVariableAccurateZ=void 0,this._objects=new Map,this._canvases=new Map,this._disposed=!1,this._roomObjectVariableAccurateZ=null}dispose(){if(!this._disposed){if(this._canvases){for(const[t,e]of this._canvases.entries())this._canvases.delete(t),e&&e.dispose();this._canvases=null}this._objects&&(this._objects=null),this._disposed=!0}}reset(){this._objects.clear()}getInstanceId(t){return t?t.instanceId:-1}getRoomObject(t){return this._objects.get(t)}addObject(t){t&&this._objects.set(this.getInstanceId(t),t)}removeObject(t){const e=this.getInstanceId(t);this._objects.delete(e);for(const s of this._canvases.values()){if(!s)continue;s.removeFromCache(e.toString())}}render(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._canvases&&this._canvases.size)for(const s of this._canvases.values())s&&s.render(t,e)}update(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._canvases&&this._canvases.size){this.render(t,e);for(const t of this._canvases.values())t&&t.update()}}getCanvas(t){const e=this._canvases.get(t);return e||null}createCanvas(t,e,s,i){const r=this._canvases.get(t);if(r)return r.initialize(e,s),r.geometry&&(r.geometry.scale=i),r;const n=this.createSpriteCanvas(t,e,s,i);return n?(this._canvases.set(t,n),n):void 0}createSpriteCanvas(t,e,s,i){return new rs(this,t,e,s,i)}removeCanvas(t){const e=this._canvases.get(t);e&&(this._canvases.delete(t),e.dispose())}get objects(){return this._objects}get disposed(){return this._disposed}get roomObjectVariableAccurateZ(){return this._roomObjectVariableAccurateZ}set roomObjectVariableAccurateZ(t){this._roomObjectVariableAccurateZ=t}}class as{createRenderer(){return new ns}}class os extends d{constructor(t){super(t)}}os.INITIALIZED="RCWM_INITIALIZED";class hs{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._name=void 0,this._minLevel=-1,this._texture=null,this._colorMatrix=null,this._blendMode=null,this._name=t,this._minLevel=e,this._texture=s,this._colorMatrix=i,this._blendMode=r}get name(){return this._name}get texture(){return this._texture}set texture(t){this._texture=t}get colorMatrix(){return this._colorMatrix}set colorMatrix(t){this._colorMatrix=t}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode=t}get minLevel(){return this._minLevel}}class _s{constructor(){this._effects=void 0,this._events=void 0,this._isLoaded=void 0,this._effects=new Map,this._events=new g,this._isLoaded=!1}init(){if(this._isLoaded)return;this._isLoaded=!0;const t=SU.instance.getConfiguration("image.library.url")+"Habbo-Stories/",e=SU.instance.getConfiguration("camera.available.effects");for(const s of e){if(!s.enabled)continue;const e=new hs(s.name,s.minLevel);s.colorMatrix.length?e.colorMatrix=s.colorMatrix:(e.texture=i.t.from(t+s.name+".png"),e.blendMode=s.blendMode),this._effects.set(e.name,e)}this.events.dispatchEvent(new os(os.INITIALIZED))}applyEffects(t,e,s){const i=new H,r=new W(t);i.addChild(r);for(const n of e){const t=n.effect;if(t)if(t.colorMatrix){const e=new Ot.a;e.matrix=t.colorMatrix,e.alpha=n.alpha,r.filters||(r.filters=[]),r.filters.push(e)}else{const e=new W(t.texture);e.alpha=n.alpha,e.blendMode=t.blendMode,i.addChild(e)}}return At.generateImage(i)}get effects(){return this._effects}get events(){return this._events}get isLoaded(){return this._isLoaded}}class ds{flush(){return!0}parse(t){return!!t}}class us extends O{constructor(t){super(t,ds)}getParser(){return this.parser}}class cs{flush(){return!0}parse(t){return!!t}}class ls extends O{constructor(t){super(t,cs)}getParser(){return this.parser}}class gs{}gs.UNKNOWN=0,gs.BROWSER=1;class Es{}Es.UNKNOWN=0,Es.FLASH=1,Es.HTML5=2;class ps{constructor(t,e,s,i){this._data=void 0,this._data=[`NITRO-${yU.RENDERER_VERSION.replaceAll(".","-")}`,"HTML5",Es.HTML5,gs.BROWSER]}getMessageArray(){return this._data}dispose(){}}class ms{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class Is{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ts{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Rs extends d{constructor(t,e){super(t),this._connection=void 0,this._connection=e}get connection(){return this._connection}}Rs.CONNECTION_ESTABLISHED="NCE_ESTABLISHED",Rs.CONNECTION_CLOSED="NCE_CLOSED",Rs.CONNECTION_ERROR="NCE_ERROR",Rs.CONNECTION_HANDSHAKING="NCE_HANDSHAKING",Rs.CONNECTION_HANDSHAKED="NCE_HANDSHAKED",Rs.CONNECTION_HANDSHAKE_FAILED="NCE_HANDSHAKE_FAILED",Rs.CONNECTION_AUTHENTICATED="NCE_AUTHENTICATED";class fs extends M{constructor(t){super(),this._communication=void 0,this._handShaking=void 0,this._didConnect=void 0,this._pongInterval=void 0,this._communication=t,this._handShaking=!1,this._didConnect=!1,this._pongInterval=null,this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.sendPong=this.sendPong.bind(this)}onInit(){const t=this._communication.connection;t&&(t.addEventListener(f.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.addEventListener(f.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.addEventListener(f.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._communication.registerMessageEvent(new us(this.onClientPingEvent.bind(this))),this._communication.registerMessageEvent(new ls(this.onAuthenticatedEvent.bind(this)))}onDispose(){const t=this._communication.connection;t&&(t.removeEventListener(f.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.removeEventListener(f.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.removeEventListener(f.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._handShaking=!1,this.stopPonging(),super.onDispose()}onConnectionOpenedEvent(t){const e=this._communication.connection;e&&(this._didConnect=!0,this.dispatchCommunicationDemoEvent(Rs.CONNECTION_ESTABLISHED,e),SU.instance.getConfiguration("system.pong.manually",!1)&&this.startPonging(),this.startHandshake(e),e.send(new ps(null,null,null,null)),this.tryAuthentication(e))}onConnectionClosedEvent(t){const e=this._communication.connection;e&&(this.stopPonging(),this._didConnect&&this.dispatchCommunicationDemoEvent(Rs.CONNECTION_CLOSED,e))}onConnectionErrorEvent(t){const e=this._communication.connection;e&&(this.stopPonging(),this.dispatchCommunicationDemoEvent(Rs.CONNECTION_ERROR,e))}tryAuthentication(t){if(!t||!this.getSSO())return this.getSSO()||this.logger.error("Login without an SSO ticket is not supported"),void this.dispatchCommunicationDemoEvent(Rs.CONNECTION_HANDSHAKE_FAILED,t);t.send(new Ts(this.getSSO(),SU.instance.time))}onClientPingEvent(t){t&&t.connection&&this.sendPong(t.connection)}onAuthenticatedEvent(t){t&&t.connection&&(this.completeHandshake(t.connection),this.dispatchCommunicationDemoEvent(Rs.CONNECTION_AUTHENTICATED,t.connection),t.connection.send(new ms))}startHandshake(t){this.dispatchCommunicationDemoEvent(Rs.CONNECTION_HANDSHAKING,t),this._handShaking=!0}completeHandshake(t){this.dispatchCommunicationDemoEvent(Rs.CONNECTION_HANDSHAKED,t),this._handShaking=!1}startPonging(){this.stopPonging(),this._pongInterval=setInterval(this.sendPong,SU.instance.getConfiguration("system.pong.interval.ms",2e4))}stopPonging(){this._pongInterval&&(clearInterval(this._pongInterval),this._pongInterval=null)}sendPong(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=t||this._communication.connection||null,t&&t.send(new Is)}dispatchCommunicationDemoEvent(t,e){SU.instance.events.dispatchEvent(new Rs(t,e))}getSSO(){return SU.instance.getConfiguration("sso.ticket",null)}}class Os{constructor(){this._canShowInterstitial=void 0}flush(){return this._canShowInterstitial=!1,!0}parse(t){return!!t&&(this._canShowInterstitial=t.readBoolean(),!0)}get canShowInterstitial(){return this._canShowInterstitial}}class vs{constructor(){this._errorCode=void 0,this._filteredText=void 0}flush(){return this._errorCode=0,this._filteredText=null,!0}parse(t){return!!t&&(this._errorCode=t.readInt(),this._filteredText=t.readString(),!0)}get errorCode(){return this._errorCode}get filteredText(){return this._filteredText}}class As{constructor(){this._isOpen=void 0,this._onShutdown=void 0,this._isAuthenticUser=void 0}flush(){return this._isOpen=!1,this._onShutdown=!1,this._isAuthenticUser=!1,!0}parse(t){return!!t&&(this._isOpen=t.readBoolean(),this._onShutdown=t.readBoolean(),t.bytesAvailable&&(this._isAuthenticUser=t.readBoolean()),!0)}get isOpen(){return this._isOpen}get onShutdown(){return this._onShutdown}get isAuthenticUser(){return this._isAuthenticUser}}class Ss{constructor(){this._isOpen=void 0,this._minutesUntilChange=void 0}flush(){return this._isOpen=!1,this._minutesUntilChange=0,!0}parse(t){return!!t&&(this._isOpen=t.readInt()>0,this._minutesUntilChange=t.readInt(),!0)}get isOpen(){return this._isOpen}get minutesUntilChange(){return this._minutesUntilChange}}class Ns{constructor(){this._openHour=void 0,this._openMinute=void 0}flush(){return this._openHour=0,this._openMinute=0,!0}parse(t){return!!t&&(this._openHour=t.readInt(),this._openMinute=t.readInt(),!0)}get openHour(){return this._openHour}get openMinute(){return this._openMinute}}class Ms{constructor(){this._openHour=void 0,this._openMinute=void 0,this._userThrownOutAtClose=void 0}flush(){return this._openHour=0,this._openMinute=0,this._userThrownOutAtClose=!1,!0}parse(t){return!!t&&(this._openHour=t.readInt(),this._openMinute=t.readInt(),this._userThrownOutAtClose=t.readBoolean(),!0)}get openHour(){return this._openHour}get openMinute(){return this._openMinute}get userThrowOutAtClose(){return this._userThrownOutAtClose}}class ys{constructor(){this._minutes=void 0}flush(){return this._minutes=0,!0}parse(t){return!!t&&(this._minutes=t.readInt(),!0)}get openMinute(){return this._minutes}}class Ds{constructor(){this._isInMaintenance=void 0,this._minutesUntilMaintenance=void 0,this._duration=void 0}flush(){return this._isInMaintenance=!1,this._minutesUntilMaintenance=0,this._duration=15,!0}parse(t){return!!t&&(this._isInMaintenance=t.readBoolean(),this._minutesUntilMaintenance=t.readInt(),t.bytesAvailable&&(this._duration=t.readInt()),!0)}get isInMaintenance(){return this._isInMaintenance}get minutesUntilMaintenance(){return this._minutesUntilMaintenance}get duration(){return this._duration}}class Cs{constructor(){this._resultCode=void 0,this._name=void 0,this._nameSuggestions=void 0}flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let e=t.readInt();for(;e>0;)this._nameSuggestions.push(t.readString()),e--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class Ls{constructor(){this._resultCode=void 0,this._name=void 0,this._nameSuggestions=void 0}flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let e=t.readInt();for(;e>0;)this._nameSuggestions.push(t.readString()),e--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class Us{constructor(){this._figure=void 0,this._gender=void 0}flush(){return this._figure="",this._gender="",!0}parse(t){return!!t&&(this._figure=t.readString(),this._gender=t.readString(),this._gender&&(this._gender=this._gender.toUpperCase()),!0)}get figure(){return this._figure}get gender(){return this._gender}}class Ps{constructor(){this._state=void 0,this._outfits=void 0}flush(){return this._state=0,this._outfits=[],!0}parse(t){if(!t)return!1;this._state=t.readInt();let e=t.readInt();for(;e>0;)this._outfits.push(new bu(t)),e--;return!0}get state(){return this._state}get outfits(){return this._outfits}}class bs{constructor(t){if(this._id=void 0,this._name=void 0,this._motto=void 0,this._gender=void 0,this._figure=void 0,!t)throw new Error("invalid_parser");this._id=t.readInt(),this._name=t.readString(),this._motto=t.readString(),this._gender=t.readString(),this._figure=t.readString()}get id(){return this._id}get name(){return this._name}get motto(){return this._motto}get figure(){return this._figure}get gender(){return this._gender}}class ws{constructor(){this._item=void 0,this._openInventory=void 0}flush(){return this._item=null,this._openInventory=!1,!0}parse(t){return!!t&&(this._item=new bs(t),this._openInventory=t.readBoolean(),!0)}get item(){return this._item}openInventory(){return this._openInventory}}class Fs{constructor(){this._items=void 0}flush(){return this._items=null,!0}parse(t){this._items=new Map;let e=t.readInt();for(;e>0;){const s=new bs(t);this._items.set(s.id,s),e--}return!0}get items(){return this._items}}class xs{constructor(){this._boughtAsGift=void 0,this._item=void 0}flush(){return this._boughtAsGift=!1,this._item=null,!0}parse(t){return!!t&&(this._boughtAsGift=t.readBoolean(),this._item=new bs(t),!0)}get boughtAsGift(){return this._boughtAsGift}get item(){return this._item}}class Bs{constructor(){this._itemId=void 0}flush(){return this._itemId=0,!0}parse(t){return!!t&&(this._itemId=t.readInt(),!0)}get itemId(){return this._itemId}}class Gs{constructor(t){this._name=void 0,this._id=void 0,this._consequence=void 0,this._name=t.readString(),this._id=t.readInt(),this._consequence=t.readString()}get name(){return this._name}get id(){return this._id}get consequence(){return this._consequence}}class Hs{constructor(t){this._name=void 0,this._topics=void 0,this._disposed=void 0,this._topics=[],this._name=t.readString();let e=t.readInt();for(;e>0;)this._topics.push(new Gs(t)),e--}dispose(){this._disposed||(this._disposed=!0,this._topics=null)}get disposed(){return this._disposed}get name(){return this._name}get topics(){return this._topics}}class Vs extends O{constructor(t){super(t,Ws)}getParser(){return this.parser}}class js{constructor(t){this._name=void 0,this._sanctionLengthInHours=void 0,this._probationDays=void 0,this._avatarOnly=void 0,this._tradeLockInfo="",this._machineBanInfo="",this._name=t.readString(),this._sanctionLengthInHours=t.readInt(),this._probationDays=t.readInt(),this._avatarOnly=t.readBoolean(),t.bytesAvailable&&(this._tradeLockInfo=t.readString()),t.bytesAvailable&&(this._machineBanInfo=t.readString())}get name(){return this._name}get sanctionLengthInHours(){return this._sanctionLengthInHours}get avatarOnly(){return this._avatarOnly}get tradeLockInfo(){return this._tradeLockInfo}get machineBanInfo(){return this._machineBanInfo}}class ks{constructor(){this._callForHelpCategories=void 0}flush(){return this._callForHelpCategories=null,!0}parse(t){if(!t)return!1;this._callForHelpCategories=[];let e=t.readInt();for(;e>0;)this._callForHelpCategories.push(new Hs(t)),e--;return!0}get callForHelpCategories(){return this._callForHelpCategories}}class Ys extends O{constructor(t){super(t,ks)}getParser(){return this.parser}}class zs extends O{constructor(t){super(t,Ks)}getParser(){return this.parser}}class Ws{constructor(){this._issueId=void 0,this._accountId=void 0,this._sanctionType=void 0}flush(){return this._issueId=-1,this._accountId=1,this._sanctionType=null,!0}parse(t){return!!t&&(this._issueId=t.readInt(),this._accountId=t.readInt(),this._sanctionType=new js(t),!0)}get issueId(){return this._issueId}get accountId(){return this._accountId}get sanctionType(){return this._sanctionType}}class Ks{constructor(){this._isSanctionNew=void 0,this._isSanctionActive=void 0,this._sanctionName=void 0,this._sanctionLengthHours=void 0,this._sanctionReason=void 0,this._sanctionCreationTime=void 0,this._probationHoursLeft=void 0,this._nextSanctionName=void 0,this._nextSanctionLengthHours=void 0,this._hasCustomMute=void 0,this._tradeLockExpiryTime=void 0}flush(){return this._isSanctionNew=!1,this._isSanctionActive=!1,this._sanctionName=null,this._sanctionLengthHours=0,this._sanctionReason=null,this._sanctionCreationTime=null,this._probationHoursLeft=0,this._nextSanctionName=null,this._nextSanctionLengthHours=0,this._hasCustomMute=!1,this._tradeLockExpiryTime=null,!0}parse(t){return!!t&&(this._isSanctionNew=t.readBoolean(),this._isSanctionActive=t.readBoolean(),this._sanctionName=t.readString(),this._sanctionLengthHours=t.readInt(),t.readInt(),this._sanctionReason=t.readString(),this._sanctionCreationTime=t.readString(),this._probationHoursLeft=t.readInt(),this._nextSanctionName=t.readString(),this._nextSanctionLengthHours=t.readInt(),t.readInt(),this._hasCustomMute=t.readBoolean(),t.bytesAvailable&&(this._tradeLockExpiryTime=t.readString()),!0)}get isSanctionNew(){return this._isSanctionNew}get isSanctionActive(){return this._isSanctionActive}get sanctionName(){return this._sanctionName}get sanctionLengthHours(){return this._sanctionLengthHours}get sanctionReason(){return this._sanctionReason}get sanctionCreationTime(){return this._sanctionCreationTime}get probationHoursLeft(){return this._probationHoursLeft}get nextSanctionName(){return this._nextSanctionName}get nextSanctionLengthHours(){return this._nextSanctionLengthHours}get hasCustomMute(){return this._hasCustomMute}get tradeLockExpiryTime(){return this._tradeLockExpiryTime}}class Xs{constructor(){this._ok=!1,this._secondsToWait=0,this._extraDataId=void 0}flush(){return this._ok=!1,this._secondsToWait=0,this._extraDataId=null,!0}parse(t){return!!t&&(this._ok=t.readBoolean(),this._secondsToWait=t.readInt(),this._ok&&t.bytesAvailable&&(this._extraDataId=t.readString()),!0)}get ok(){return this._ok}get secondsToWait(){return this._secondsToWait}get extraDataId(){return this._extraDataId}}class qs{flush(){return!0}parse(t){return!!t}}class Qs{constructor(){this._url=void 0}flush(){return this._url="",!0}parse(t){return!!t&&(this._url=t.readString(),!0)}get url(){return this._url}}class Zs{constructor(){this._ok=!1,this._errorReason=null}flush(){return this._ok=!1,this._errorReason=null,!0}parse(t){return!!t&&(this._ok=t.readBoolean(),this._errorReason=t.readString(),!0)}get ok(){return this._ok}get errorReason(){return this._errorReason}}class Js{constructor(){this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0}flush(){return this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0,!0}parse(t){return!!t&&(this._creditPrice=t.readInt(),this._ducketPrice=t.readInt(),t.bytesAvailable&&(this._publishDucketPrice=t.readInt()),!0)}get creditPrice(){return this._creditPrice}get ducketPrice(){return this._ducketPrice}get publishDucketPrice(){return this._publishDucketPrice}}class $s{constructor(){this._ok=!0,this._renderLimitHit=!1}flush(){return this._ok=!0,this._renderLimitHit=!1,!0}parse(t){return!!t&&(t.bytesAvailable&&(this._ok=t.readBoolean(),this._renderLimitHit=t.readBoolean()),!0)}get ok(){return this._ok}get isRenderLimitHit(){return this._renderLimitHit}}class ti{constructor(){this._campaignName=void 0,this._campaignImage=void 0,this._currentDay=void 0,this._campaignDays=void 0,this._openedDays=void 0,this._missedDays=void 0}parse(t){if(!t)return!1;this._campaignName=t.readString(),this._campaignImage=t.readString(),this._currentDay=t.readInt(),this._campaignDays=t.readInt(),this._openedDays=[];let e=t.readInt();for(let s=0;s<e;s++)this._openedDays.push(t.readInt());this._missedDays=[],e=t.readInt();for(let s=0;s<e;s++)this._missedDays.push(t.readInt());return!0}clone(){const t=new ti;return t.campaignDays=this._campaignDays,t.campaignImage=this._campaignImage,t.campaignName=this._campaignName,t.currentDay=this._currentDay,t.missedDays=this._missedDays,t.openedDays=this._openedDays,t}get campaignName(){return this._campaignName}set campaignName(t){this._campaignName=t}get campaignImage(){return this._campaignImage}set campaignImage(t){this._campaignImage=t}get currentDay(){return this._currentDay}set currentDay(t){this._currentDay=t}get campaignDays(){return this._campaignDays}set campaignDays(t){this._campaignDays=t}get openedDays(){return this._openedDays}set openedDays(t){this._openedDays=t}get missedDays(){return this._missedDays}set missedDays(t){this._missedDays=t}}class ei{constructor(){this._calendarData=void 0}flush(){return this._calendarData=null,!0}parse(t){return!!t&&(this._calendarData=new ti,this._calendarData.parse(t),!0)}get calendarData(){return this._calendarData}}class si{constructor(){this._doorOpened=void 0,this._productName=void 0,this._customImage=void 0,this._furnitureClassName=void 0}flush(){return this._doorOpened=!1,this._productName=null,this._customImage=null,this._furnitureClassName=null,!0}parse(t){return!!t&&(this._doorOpened=t.readBoolean(),this._productName=t.readString(),this._customImage=t.readString(),this._furnitureClassName=t.readString(),!0)}get doorOpened(){return this._doorOpened}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}class ii{constructor(){this._productType=void 0,this._productClassId=void 0,this._totalCoinsForBonus=void 0,this._coinsStillRequiredToBuy=void 0}flush(){return this._totalCoinsForBonus=-1,this._coinsStillRequiredToBuy=-1,this._productType="",this._productClassId=-1,!0}parse(t){return!!t&&(this._productType=t.readString(),this._productClassId=t.readInt(),this._totalCoinsForBonus=t.readInt(),this._coinsStillRequiredToBuy=t.readInt(),!0)}get totalCoinsForBonus(){return this._totalCoinsForBonus}get coinsStillRequiredToBuy(){return this._coinsStillRequiredToBuy}get productType(){return this._productType}get productClassId(){return this._productClassId}}class ri{constructor(){this._furniCount=void 0}flush(){return this._furniCount=0,!0}parse(t){return!!t&&(this._furniCount=t.readInt(),!0)}get furniCount(){return this._furniCount}}class ni{constructor(){this._Str_16456=void 0,this._Str_12494=void 0,this._Str_19123=void 0,this._Str_17298=void 0}flush(){return this._Str_16456=0,this._Str_12494=0,this._Str_19123=0,this._Str_17298=0,!0}parse(t){return!!t&&(this._Str_16456=t.readInt(),this._Str_12494=t.readInt(),this._Str_19123=t.readInt(),t.bytesAvailable?this._Str_17298=t.readInt():this._Str_17298=this._Str_16456,!0)}get _Str_3709(){return this._Str_16456}get _Str_15864(){return this._Str_12494}get _Str_24094(){return this._Str_19123}get _Str_24379(){return this._Str_17298}}class ai{constructor(){this._bundleDiscountRuleset=void 0}flush(){return this._bundleDiscountRuleset=null,!0}parse(t){return!!t&&(this._bundleDiscountRuleset=new Zu(t),!0)}get bundleDiscountRuleset(){return this._bundleDiscountRuleset}}class oi{constructor(t){if(this._visible=void 0,this._icon=void 0,this._pageId=void 0,this._pageName=void 0,this._localization=void 0,this._children=void 0,this._offerIds=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._visible=!1,this._icon=0,this._pageId=-1,this._pageName=null,this._localization=null,this._children=[],this._offerIds=[],!0}parse(t){if(!t)return!1;this._visible=t.readBoolean(),this._icon=t.readInt(),this._pageId=t.readInt(),this._pageName=t.readString(),this._localization=t.readString();let e=t.readInt();for(;e>0;)this._offerIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._children.push(new oi(t)),s--;return!0}get visible(){return this._visible}get icon(){return this._icon}get pageId(){return this._pageId}get pageName(){return this._pageName}get localization(){return this._localization}get children(){return this._children}get offerIds(){return this._offerIds}}class hi{constructor(){this._root=void 0,this._newAdditionsAvailable=void 0,this._catalogType=void 0}flush(){return this._root=null,!0}parse(t){return!!t&&(this._root=new oi(t),this._newAdditionsAvailable=t.readBoolean(),this._catalogType=t.readString(),!0)}get root(){return this._root}get newAdditionsAvailable(){return this._newAdditionsAvailable}get catalogType(){return this._catalogType}}class _i{constructor(){this._pageName=void 0,this._pageId=void 0,this._Str_5158=void 0,this._image=void 0}flush(){return this._pageName=null,this._pageId=0,this._Str_5158=0,this._image=null,!0}parse(t){return!!t&&(this._pageId=t.readInt(),this._pageName=t.readString(),this._Str_5158=t.readInt(),this._image=t.readString(),!0)}get pageName(){return this._pageName}get pageId(){return this._pageId}get _Str_17123(){return this._Str_5158}get image(){return this._image}}class di{constructor(t){this._images=void 0,this._texts=void 0,this._images=[],this._texts=[];let e=t.readInt();for(;e>0;)this._images.push(t.readString()),e--;let s=t.readInt();for(;s>0;)this._texts.push(t.readString()),s--}get images(){return this._images}get texts(){return this._texts}}class ui{constructor(t){if(this._productType=void 0,this._furniClassId=void 0,this._extraParam=void 0,this._productCount=void 0,this._uniqueLimitedItem=void 0,this._uniqueLimitedItemSeriesSize=void 0,this._uniqueLimitedItemsLeft=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._productType=null,this._furniClassId=-1,this._extraParam=null,this._productCount=0,this._uniqueLimitedItem=!1,this._uniqueLimitedItemSeriesSize=0,this._uniqueLimitedItemsLeft=0,!0}parse(t){return this._productType=t.readString(),this._productType===ui.B?(this._extraParam=t.readString(),this._productCount=1,!0):(this._furniClassId=t.readInt(),this._extraParam=t.readString(),this._productCount=t.readInt(),this._uniqueLimitedItem=t.readBoolean(),this._uniqueLimitedItem&&(this._uniqueLimitedItemSeriesSize=t.readInt(),this._uniqueLimitedItemsLeft=t.readInt()),!0)}get productType(){return this._productType}get furniClassId(){return this._furniClassId}get extraParam(){return this._extraParam}get productCount(){return this._productCount}get uniqueLimitedItem(){return this._uniqueLimitedItem}get uniqueLimitedSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}}ui.I="i",ui.S="s",ui.E="e",ui.B="b";class ci{constructor(t){this._offerId=void 0,this._localizationId=void 0,this._rent=void 0,this._priceCredits=void 0,this._priceActivityPoints=void 0,this._priceActivityPointsType=void 0,this._clubLevel=void 0,this._giftable=void 0,this._bundlePurchaseAllowed=void 0,this._isPet=void 0,this._previewImage=void 0,this._products=void 0,this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean(),this._products=[];let e=t.readInt();for(;e>0;)this._products.push(new ui(t)),e--;this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),this._isPet=t.readBoolean(),this._previewImage=t.readString()}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isPet(){return this._isPet}get previewImage(){return this._previewImage}get products(){return this._products}}class li{constructor(t){if(this._type=void 0,this._position=void 0,this._itemName=void 0,this._itemPromoImage=void 0,this._catalogPageLocation=void 0,this._productCode=void 0,this._productOfferId=void 0,this._expirationTime=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._position=null,this._itemName=null,this._itemPromoImage=null,this._catalogPageLocation=null,this._productCode=null,this._productOfferId=0,this._expirationTime=0,!0}parse(t){if(!t)return!1;switch(this._position=t.readInt(),this._itemName=t.readString(),this._itemPromoImage=t.readString(),this._type=t.readInt(),this._type){case li.ITEM_CATALOGUE_PAGE:this._catalogPageLocation=t.readString();break;case li.ITEM_PRODUCT_OFFER:this._productOfferId=t.readInt();break;case li.ITEM_IAP:this._productCode=t.readString()}const e=t.readInt();return this._expirationTime=e>0?1e3*e+SU.instance.time:0,!0}get type(){return this._type}get position(){return this._position}get itemName(){return this._itemName}get itemPromoImage(){return this._itemPromoImage}get catalogPageLocation(){return this._catalogPageLocation}get productCode(){return this._productCode}get productOfferId(){return this._productOfferId}get expirationTime(){return this._expirationTime}}li.ITEM_CATALOGUE_PAGE=0,li.ITEM_PRODUCT_OFFER=1,li.ITEM_IAP=2;class gi{constructor(){this._pageId=void 0,this._catalogType=void 0,this._layoutCode=void 0,this._localization=void 0,this._offers=void 0,this._offerId=void 0,this._acceptSeasonCurrencyAsCredits=void 0,this._frontPageItems=void 0}flush(){return this._pageId=-1,this._catalogType=null,this._layoutCode=null,this._localization=null,this._offers=[],this._offerId=-1,this._acceptSeasonCurrencyAsCredits=!1,this._frontPageItems=[],!0}parse(t){if(!t)return!1;this._pageId=t.readInt(),this._catalogType=t.readString(),this._layoutCode=t.readString(),this._localization=new di(t);let e=t.readInt();for(;e>0;)this._offers.push(new ci(t)),e--;if(this._offerId=t.readInt(),this._acceptSeasonCurrencyAsCredits=t.readBoolean(),t.bytesAvailable){let e=t.readInt();for(;e>0;)this._frontPageItems.push(new li(t)),e--}return!0}get pageId(){return this._pageId}get catalogType(){return this._catalogType}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get offerId(){return this._offerId}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get frontPageItems(){return this._frontPageItems}}class Ei{constructor(){this._pageName=void 0,this._Str_5158=void 0,this._image=void 0}flush(){return this._pageName=null,this._Str_5158=0,this._image=null,!0}parse(t){return!!t&&(this._pageName=t.readString(),this._Str_5158=t.readInt(),this._image=t.readString(),!0)}get pageName(){return this._pageName}get _Str_17123(){return this._Str_5158}get image(){return this._image}}class pi{constructor(){this._instantlyRefreshCatalogue=void 0,this._newFurniDataHash=void 0}flush(){return this._instantlyRefreshCatalogue=!1,this._newFurniDataHash=null,!0}parse(t){return!!t&&(this._instantlyRefreshCatalogue=t.readBoolean(),t.bytesAvailable&&(this._newFurniDataHash=t.readString()),!0)}get instantlyRefreshCatalogue(){return this._instantlyRefreshCatalogue}get newFurniDataHash(){return this._newFurniDataHash}}class mi{constructor(t){this._offerId=void 0,this._isVip=void 0,this._isSelectable=void 0,this._daysRequired=void 0,this._offerId=t.readInt(),this._isVip=t.readBoolean(),this._daysRequired=t.readInt(),this._isSelectable=t.readBoolean()}get offerId(){return this._offerId}get isVip(){return this._isVip}get isSelectable(){return this._isSelectable}get daysRequired(){return this._daysRequired}}class Ii{constructor(){this._daysUntilNextGift=void 0,this._giftsAvailable=void 0,this._offers=void 0,this._giftData=void 0}flush(){return!0}parse(t){if(!t)return!1;this._offers=[],this._giftData=new Map,this._daysUntilNextGift=t.readInt(),this._giftsAvailable=t.readInt();const e=t.readInt();for(let i=0;i<e;i++)this._offers.push(new ci(t));const s=t.readInt();for(let i=0;i<s;i++){const e=new mi(t);this._giftData.set(e.offerId,e)}return!0}get offers(){return this._offers}get daysUntilNextGift(){return this._daysUntilNextGift}get giftsAvailable(){return this._giftsAvailable}set giftsAvailable(t){this._giftsAvailable=t}getOfferExtraData(t){return t?this._giftData.get(t):null}get giftData(){return this._giftData}}class Ti{constructor(){this._productCode=void 0,this._products=void 0}flush(){return this._productCode=null,this._products=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let e=t.readInt();for(;e>0;)this._products.push(new ui(t)),e--;return!0}get productCode(){return this._productCode}get products(){return this._products}}class Ri{constructor(){this._available=void 0,this._Str_16515=void 0,this._Str_22121=void 0,this._Str_21897=void 0}flush(){return this._available=!1,this._Str_16515=null,this._Str_22121=null,this._Str_21897=0,!0}parse(t){return!!t&&(this._Str_16515=t.readString(),""!==this._Str_16515&&(this._available=!0),this._Str_22121=t.readString(),this._Str_21897=t.readInt(),!0)}get available(){return this._available}get _Str_26301(){return this._Str_16515}get _Str_26118(){return this._Str_22121}get _Str_26380(){return this._Str_21897}}class fi{flush(){return!0}parse(t){return!!t}}class Oi{constructor(){this._isEnabled=!1,this._price=null,this._giftWrappers=null,this._boxTypes=null,this._ribbonTypes=null,this._giftFurnis=null}flush(){return this._boxTypes=null,this._giftFurnis=null,this._giftWrappers=null,this._ribbonTypes=null,this._isEnabled=null,this._price=null,!0}parse(t){if(!t)return!1;const e=[],s=[],i=[],r=[];this._isEnabled=t.readBoolean(),this._price=t.readInt();let n=t.readInt(),a=0;for(;a<n;)e.push(t.readInt()),a++;for(n=t.readInt(),a=0;a<n;)s.push(t.readInt()),a++;for(n=t.readInt(),a=0;a<n;)i.push(t.readInt()),a++;for(n=t.readInt(),a=0;a<n;)r.push(t.readInt()),a++;return this._giftWrappers=e,this._ribbonTypes=i,this._giftFurnis=r,this._boxTypes=s,!0}get giftWrappers(){return this._giftWrappers}get ribbonTypes(){return this._ribbonTypes}get giftFurnis(){return this._giftFurnis}get boxTypes(){return this._boxTypes}get isEnabled(){return this._isEnabled}get price(){return this._price}}class vi{constructor(t){if(this._offerId=void 0,this._productCode=void 0,this._priceCredits=void 0,this._priceActivityPoints=void 0,this._priceActivityPointsType=void 0,this._vip=void 0,this._months=void 0,this._extraDays=void 0,this._daysLeftAfterPurchase=void 0,this._year=void 0,this._month=void 0,this._day=void 0,this._giftable=void 0,!t)throw new Error("invalid_wrapper");this._offerId=t.readInt(),this._productCode=t.readString(),t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._vip=t.readBoolean(),this._months=t.readInt(),this._extraDays=t.readInt(),this._giftable=t.readBoolean(),this._daysLeftAfterPurchase=t.readInt(),this._year=t.readInt(),this._month=t.readInt(),this._day=t.readInt()}get offerId(){return this._offerId}get productCode(){return this._productCode}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get vip(){return this._vip}get months(){return this._months}get extraDays(){return this._extraDays}get daysLeftAfterPurchase(){return this._daysLeftAfterPurchase}get year(){return this._year}get month(){return this._month}get day(){return this._day}get giftable(){return this._giftable}}class Ai extends vi{constructor(t){super(t),this._Str_16193=void 0,this._Str_22071=void 0,this._Str_21178=void 0,this._Str_21024=void 0,this._Str_16193=t.readInt(),this._Str_22071=t.readInt(),this._Str_21178=t.readInt(),this._Str_21024=t.readInt()}get _Str_23477(){return this._Str_16193*this.months}get _Str_21585(){return this._Str_22071*this.months}get _Str_22469(){return this._Str_21178}get _Str_24050(){return this._Str_16193*this.months-this.priceCredits}get _Str_22280(){return this._Str_21585*this.months-this.priceActivityPoints}get _Str_21229(){return this._Str_21024}}class Si{constructor(){this._offer=void 0}flush(){return this._offer=null,!0}parse(t){return!!t&&(this._offer=new Ai(t),!0)}get offer(){return this._offer}}class Ni{constructor(){this._offers=void 0}flush(){return this._offers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._offers.push(new vi(t)),e--;return!0}get offers(){return this._offers}}class Mi{constructor(){this._offerId=void 0,this._Str_21271=void 0}flush(){return this._offerId=0,this._Str_21271=!1,!0}parse(t){return!!t&&(this._offerId=t.readInt(),this._Str_21271=t.readBoolean(),!0)}get offerId(){return this._offerId}get _Str_18028(){return this._Str_21271}}class yi{flush(){return!0}parse(t){return!!t}}class Di{constructor(){this._Str_6800=void 0,this._pageId=void 0,this._offerId=void 0,this._productType=void 0}flush(){return this._Str_6800=-1,this._pageId=-1,this._offerId=-1,this._productType="",!0}parse(t){return!!t&&(this._Str_6800=t.readInt(),this._pageId=t.readInt(),this._offerId=t.readInt(),this._productType=t.readString(),!0)}get _Str_23051(){return this._Str_6800}get pageId(){return this._pageId}get offerId(){return this._offerId}get productType(){return this._productType}}class Ci{constructor(){this._Str_17433=!1,this._Str_19031=!1,this._activityPointType=0}flush(){return this._Str_17433=!1,this._Str_19031=!1,this._activityPointType=0,!0}parse(t){return!!t&&(this._Str_17433=t.readBoolean(),this._Str_19031=t.readBoolean(),t.bytesAvailable&&(this._activityPointType=t.readInt()),!0)}get notEnoughCredits(){return this._Str_17433}get _Str_24352(){return this._Str_19031}get activityPointType(){return this._activityPointType}}class Li{constructor(){this._offer=void 0}flush(){return this._offer=null,!0}parse(t){return!!t&&(this._offer=new ci(t),!0)}get offer(){return this._offer}}class Ui{constructor(){this._code=void 0}flush(){return this._code=0,!0}parse(t){return!!t&&(this._code=t.readInt(),!0)}get code(){return this._code}}class Pi{constructor(){this._code=void 0}flush(){return this._code=0,!0}parse(t){return!!t&&(this._code=t.readInt(),!0)}get code(){return this._code}}class bi{constructor(t){if(this._offerId=void 0,this._localizationId=void 0,this._rent=void 0,this._priceCredits=void 0,this._priceActivityPoints=void 0,this._priceActivityPointsType=void 0,this._clubLevel=void 0,this._giftable=void 0,this._bundlePurchaseAllowed=void 0,this._products=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._offerId=-1,this._localizationId=null,this._rent=!1,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._clubLevel=0,this._giftable=!1,this._bundlePurchaseAllowed=!1,this._products=[],!0}parse(t){if(!t)return!1;this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean();let e=t.readInt();for(;e>0;)this._products.push(new ui(t)),e--;return this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),!0}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get products(){return this._products}}class wi{constructor(){this._offer=void 0}flush(){return this._offer=null,!0}parse(t){return!!t&&(this._offer=new bi(t),!0)}get offer(){return this._offer}}class Fi{constructor(){this._clubLevel=void 0,this._securityLevel=void 0,this._isAmbassador=void 0}flush(){return this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,!0}parse(t){return!!t&&(this._clubLevel=t.readInt(),this._securityLevel=t.readInt(),this._isAmbassador=t.readBoolean(),!0)}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}}class xi{constructor(){this._result=void 0,this._validationInfo=void 0}flush(){return this._result=-1,this._validationInfo="",!0}parse(t){return!!t&&(this._result=t.readInt(),this._validationInfo=t.readString(),!0)}get result(){return this._result}get validationInfo(){return this._validationInfo}}class Bi{}Bi.NONE=0,Bi.HEART=1,Bi.SMILE=2,Bi.BOBBA=3,Bi.RELATIONSHIP_TYPES=[0,1,2,3],Bi.RELATIONSHIP_NAMES=["None","Heart","Smile","Bobba"];class Gi{constructor(t){if(this._relationshipStatusType=void 0,this._friendCount=void 0,this._randomFriendId=void 0,this._randomFriendName=void 0,this._randomFriendFigure=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._relationshipStatusType=Bi.NONE,this._friendCount=0,this._randomFriendId=0,this._randomFriendFigure=null,this._randomFriendName=null,!0}parse(t){return!!t&&(this._relationshipStatusType=t.readInt(),this._friendCount=t.readInt(),this._randomFriendId=t.readInt(),this._randomFriendName=t.readString(),this._randomFriendFigure=t.readString(),!0)}get relationshipStatusType(){return this._relationshipStatusType}get friendCount(){return this._friendCount}get randomFriendId(){return this._randomFriendId}get randomFriendName(){return this._randomFriendName}get randomFriendFigure(){return this._randomFriendFigure}}class Hi{constructor(){this._userId=void 0,this._relationshipStatusMap=void 0}flush(){return this._userId=0,this._relationshipStatusMap=null,!0}parse(t){if(!t)return!1;this._userId=t.readInt(),this._relationshipStatusMap=new U;const e=t.readInt();for(let s=0;s<e;s++){const e=new Gi(t);this._relationshipStatusMap.add(e.relationshipStatusType,e)}return!0}get userId(){return this._userId}get relationshipStatusMap(){return this._relationshipStatusMap}}class Vi{constructor(){this._userId=void 0,this._badges=void 0}flush(){return this._userId=null,this._badges=[],!0}parse(t){if(!t)return!1;this._userId=t.readInt();let e=t.readInt();for(;e>0;){t.readInt();const s=t.readString();this._badges.push(s),e--}return!0}get userId(){return this._userId}get badges(){return this._badges}}class ji{constructor(t){if(this._userId=void 0,this._username=void 0,this._figure=void 0,this._gender=void 0,this._motto=void 0,this._realName=void 0,this._directMail=void 0,this._respectsReceived=void 0,this._respectsRemaining=void 0,this._respectsPetRemaining=void 0,this._streamPublishingAllowed=void 0,this._lastAccessDate=void 0,this._canChangeName=void 0,this._safetyLocked=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._userId=0,this._username=null,this._figure=null,this._gender=null,this._motto=null,this._realName=null,this._directMail=!1,this._respectsReceived=0,this._respectsRemaining=0,this._respectsPetRemaining=0,this._streamPublishingAllowed=!1,this._lastAccessDate=null,this._canChangeName=!1,this._safetyLocked=!1,!0}parse(t){return!!t&&(this._userId=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._motto=t.readString(),this._realName=t.readString(),this._directMail=t.readBoolean(),this._respectsReceived=t.readInt(),this._respectsRemaining=t.readInt(),this._respectsPetRemaining=t.readInt(),this._streamPublishingAllowed=t.readBoolean(),this._lastAccessDate=t.readString(),this._canChangeName=t.readBoolean(),this._safetyLocked=t.readBoolean(),!0)}get userId(){return this._userId}get username(){return this._username}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get realName(){return this._realName}get directMail(){return this._directMail}get respectsReceived(){return this._respectsReceived}get respectsRemaining(){return this._respectsRemaining}get respectsPetRemaining(){return this._respectsPetRemaining}get streamPublishingAllowed(){return this._streamPublishingAllowed}get lastAccessedDate(){return this._lastAccessDate}get canChangeName(){return this._canChangeName}get safetyLocked(){return this._safetyLocked}}class ki{constructor(){this._userInfo=void 0}flush(){return this._userInfo=null,!0}parse(t){return!!t&&(this._userInfo=new ji(t),!!this._userInfo)}get userInfo(){return this._userInfo}}class Yi{constructor(){this._webId=void 0,this._id=void 0,this._newName=void 0}flush(){return this._webId=-1,this._id=-1,this._newName="",!0}parse(t){return!!t&&(this._webId=t.readInt(),this._id=t.readInt(),this._newName=t.readString(),!0)}get webId(){return this._webId}get id(){return this._id}get newName(){return this._newName}}class zi{constructor(t){this._groupId=void 0,this._groupName=void 0,this._badgeCode=void 0,this._colorA=void 0,this._colorB=void 0,this._favourite=void 0,this._ownerId=void 0,this._hasForum=void 0,this._groupId=t.readInt(),this._groupName=t.readString(),this._badgeCode=t.readString(),this._colorA=t.readString(),this._colorB=t.readString(),this._favourite=t.readBoolean(),this._ownerId=t.readInt(),this._hasForum=t.readBoolean()}get groupId(){return this._groupId}get groupName(){return this._groupName}get badgeCode(){return this._badgeCode}get colorA(){return this._colorA}get colorB(){return this._colorB}get favourite(){return this._favourite}get ownerId(){return this._ownerId}get hasForum(){return this._hasForum}}class Wi{constructor(){this._id=void 0,this._username=void 0,this._figure=void 0,this._motto=void 0,this._registration=void 0,this._achievementPoints=void 0,this._friendsCount=void 0,this._isMyFriend=void 0,this._requestSent=void 0,this._isOnline=void 0,this._groups=void 0,this._secondsSinceLastVisit=void 0,this._openProfileWindow=void 0}flush(){return this._id=0,this._username=null,this._figure=null,this._motto=null,this._registration=null,this._achievementPoints=0,this._friendsCount=0,this._isMyFriend=!1,this._requestSent=!1,this._isOnline=!1,this._groups=[],this._secondsSinceLastVisit=0,this._openProfileWindow=!1,!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._motto=t.readString(),this._registration=t.readString(),this._achievementPoints=t.readInt(),this._friendsCount=t.readInt(),this._isMyFriend=t.readBoolean(),this._requestSent=t.readBoolean(),this._isOnline=t.readBoolean();const e=t.readInt();for(let s=0;s<e;s++)this._groups.push(new zi(t));return this._secondsSinceLastVisit=t.readInt(),this._openProfileWindow=t.readBoolean(),!0}get id(){return this._id}get username(){return this._username}get figure(){return this._figure}get motto(){return this._motto}get registration(){return this._registration}get achievementPoints(){return this._achievementPoints}get friendsCount(){return this._friendsCount}get isMyFriend(){return this._isMyFriend}get requestSent(){return this._requestSent}get isOnline(){return this._isOnline}get groups(){return this._groups}get secondsSinceLastVisit(){return this._secondsSinceLastVisit}get openProfileWindow(){return this._openProfileWindow}}class Ki{constructor(){this._volumeSystem=void 0,this._volumeFurni=void 0,this._volumeTrax=void 0,this._oldChat=void 0,this._roomInvites=void 0,this._cameraFollow=void 0,this._flags=void 0,this._chatType=void 0}flush(){return this._volumeSystem=0,this._volumeFurni=0,this._volumeTrax=0,this._oldChat=!1,this._roomInvites=!1,this._cameraFollow=!1,this._flags=0,this._chatType=0,!0}parse(t){return!!t&&(this._volumeSystem=t.readInt(),this._volumeFurni=t.readInt(),this._volumeTrax=t.readInt(),this._oldChat=t.readBoolean(),this._roomInvites=t.readBoolean(),this._cameraFollow=t.readBoolean(),this._flags=t.readInt(),this._chatType=t.readInt(),!0)}get volumeSystem(){return this._volumeSystem}get volumeFurni(){return this._volumeFurni}get volumeTrax(){return this._volumeTrax}get oldChat(){return this._oldChat}get roomInvites(){return this._roomInvites}get cameraFollow(){return this._cameraFollow}get flags(){return this._flags}get chatType(){return this._chatType}}class Xi{constructor(){this._badges=void 0}flush(){return this._badges=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._badges.set(s,i),e--}return!0}get badges(){return this._badges}}class qi{constructor(){this._ignoredUsers=void 0}flush(){return this._ignoredUsers=[],!0}parse(t){if(!t)return!1;this._ignoredUsers=[];let e=t.readInt();for(;e>0;)this._ignoredUsers.push(t.readString()),e--;return!0}get ignoredUsers(){return this._ignoredUsers}}class Qi{constructor(){this._result=void 0,this._name=void 0}flush(){return this._result=-1,this._name=null,!0}parse(t){return!!t&&(this._result=t.readInt(),this._name=t.readString(),!0)}get result(){return this._result}get name(){return this._name}}class Zi{constructor(){this._link=void 0}flush(){return this._link=null,!0}parse(t){return!!t&&(this._link=t.readString(),!0)}get link(){return this._link}}class Ji{constructor(){this._credits=void 0}flush(){return this._credits=null,!0}parse(t){return!!t&&(this._credits=t.readString(),!0)}get credits(){return this._credits}}class $i{constructor(){this._currencies=void 0}flush(){return this._currencies=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._currencies.set(t.readInt(),t.readInt()),e--;return!0}get currencies(){return this._currencies}}class tr{constructor(){this._productName=void 0,this._daysToPeriodEnd=void 0,this._memberPeriods=void 0,this._periodsSubscribedAhead=void 0,this._responseType=void 0,this._hasEverBeenMember=void 0,this._isVip=void 0,this._pastClubDays=void 0,this._pastVipDays=void 0,this._minutesUntilExpiration=void 0,this._minutesSinceLastModified=void 0}flush(){return this._productName=null,this._daysToPeriodEnd=0,this._memberPeriods=0,this._periodsSubscribedAhead=0,this._responseType=0,this._hasEverBeenMember=!1,this._isVip=!1,this._pastClubDays=0,this._pastVipDays=0,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,!0}parse(t){return!!t&&(this._productName=t.readString(),this._daysToPeriodEnd=t.readInt(),this._memberPeriods=t.readInt(),this._periodsSubscribedAhead=t.readInt(),this._responseType=t.readInt(),this._hasEverBeenMember=t.readBoolean(),this._isVip=t.readBoolean(),this._pastClubDays=t.readInt(),this._pastVipDays=t.readInt(),this._minutesUntilExpiration=t.readInt(),t.bytesAvailable&&(this._minutesSinceLastModified=t.readInt()),!0)}get productName(){return this._productName}get daysToPeriodEnd(){return this._daysToPeriodEnd}get memberPeriods(){return this._memberPeriods}get periodsSubscribedAhead(){return this._periodsSubscribedAhead}get responseType(){return this._responseType}get hasEverBeenMember(){return this._hasEverBeenMember}get isVip(){return this._isVip}get pastClubDays(){return this._pastClubDays}get pastVipDays(){return this._pastVipDays}get minutesUntilExpiration(){return this._minutesUntilExpiration}get minutesSinceLastModified(){return this._minutesSinceLastModified}}tr.RESPONSE_TYPE_LOGIN=1,tr.RESPONSE_TYPE_PURCHASE=2,tr.RESPONSE_TYPE_DISCOUNT_AVAILABLE=3,tr.RESPONSE_TYPE_CITIZENSHIP_DISCOUNT=4;class er{}er.DOG=0,er.CAT=1,er.CROCODILE=2,er.TERRIER=3,er.BEAR=4,er.PIG=5,er.LION=6,er.RHINO=7,er.SPIDER=8,er.TURTLE=9,er.CHICKEN=10,er.FROG=11,er.DRAGON=12,er.MONSTER=13,er.MONKEY=14,er.HORSE=15,er.MONSTERPLANT=16,er.BUNNY=17,er.BUNNYEVIL=18,er.BUNNYDEPRESSED=19,er.BUNNYLOVE=20,er.PIGEONGOOD=21,er.PIGEONEVIL=22,er.DEMONMONKEY=23,er.BABYBEAR=24,er.BABYTERRIER=25,er.GNOME=26,er.LEPRECHAUN=27,er.KITTENBABY=28,er.PUPPYBABY=29,er.PIGLETNBABY=30,er.HALOOMPA=31,er.FOOLS=32,er.PTEROSAUR=33,er.VELOCIRAPTOR=34;class sr{constructor(t){this._typeId=void 0,this._paletteId=void 0,this._color=void 0,this._breedId=void 0,this._customPartCount=void 0,this._customParts=void 0,this._typeId=t.readInt(),this._paletteId=t.readInt(),this._color=t.readString(),this._breedId=t.readInt(),this._customParts=[],this._customPartCount=t.readInt();let e=0;for(;e<this._customPartCount;)this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),e++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get breedId(){return this._breedId}get figuredata(){let t=this.typeId+" "+this.paletteId+" "+this.color;t=t+" "+this.custompartCount;for(const e of this.customParts)t=t+" "+e;return t}get customParts(){return this._customParts}get custompartCount(){return this._customPartCount}}class ir{constructor(t){if(this._id=void 0,this._name=void 0,this._figureData=void 0,this._level=void 0,!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._figureData=new sr(t),this._level=t.readInt()}get id(){return this._id}get name(){return this._name}get typeId(){return this._figureData.typeId}get paletteId(){return this._figureData.paletteId}get color(){return this._figureData.color}get breedId(){return this._figureData.breedId}get customPartCount(){return this._figureData.custompartCount}get figureString(){return this._figureData.figuredata}get figureData(){return this._figureData}get level(){return this._level}}class rr{constructor(){this._respect=void 0,this._petOwnerId=void 0,this._petData=void 0}flush(){return this._respect=0,this._petOwnerId=0,this._petData=null,!0}parse(t){return!!t&&(this._respect=t.readInt(),this._petOwnerId=t.readInt(),this._petData=new ir(t),!0)}get respect(){return this._respect}get petOwnerId(){return this._petOwnerId}get petData(){return this._petData}get isTreat(){return this._petData.typeId===er.MONSTERPLANT}}class nr{constructor(){this._petId=void 0,this._userId=void 0,this._supplementType=void 0}flush(){return this._petId=0,this._userId=0,this._supplementType=0,!0}parse(t){return!!t&&(this._petId=t.readInt(),this._userId=t.readInt(),this._supplementType=t.readInt(),!0)}get petId(){return this._petId}get userId(){return this._userId}get supplementType(){return this._supplementType}}class ar{constructor(){this._userId=void 0,this._respectsReceived=void 0}flush(){return this._userId=0,this._respectsReceived=0,!0}parse(t){return!!t&&(this._userId=t.readInt(),this._respectsReceived=t.readInt(),!0)}get userId(){return this._userId}get respectsReceived(){return this._respectsReceived}}class or{constructor(t,e,s){this._roomId=void 0,this._roomName=void 0,this._hasControllers=!1,this._roomId=t,this._roomName=e,this._hasControllers=s}get roomId(){return this._roomId}get roomName(){return this._roomName}get _Str_22776(){return this._hasControllers}}class hr{constructor(t){this._currentHcStreak=void 0,this._firstSubscriptionDate=void 0,this._kickbackPercentage=void 0,this._totalCreditsMissed=void 0,this._totalCreditsRewarded=void 0,this._totalCreditsSpent=void 0,this._creditRewardForStreakBonus=void 0,this._creditRewardForMonthlySpent=void 0,this._timeUntilPayday=void 0,this._currentHcStreak=t.readInt(),this._firstSubscriptionDate=t.readString(),this._kickbackPercentage=t.readDouble(),this._totalCreditsMissed=t.readInt(),this._totalCreditsRewarded=t.readInt(),this._totalCreditsSpent=t.readInt(),this._creditRewardForStreakBonus=t.readInt(),this._creditRewardForMonthlySpent=t.readInt(),this._timeUntilPayday=t.readInt()}get currentHcStreak(){return this._currentHcStreak}get firstSubscriptionDate(){return this._firstSubscriptionDate}get kickbackPercentage(){return this._kickbackPercentage}get totalCreditsMissed(){return this._totalCreditsMissed}get totalCreditsRewarded(){return this._totalCreditsRewarded}get totalCreditsSpent(){return this._totalCreditsSpent}get creditRewardForStreakBonus(){return this._creditRewardForStreakBonus}get creditRewardForMonthlySpent(){return this._creditRewardForMonthlySpent}get timeUntilPayday(){return this._timeUntilPayday}}class _r{constructor(){this._data=void 0}flush(){return this._data=null,!0}parse(t){return this._data=new hr(t),!0}get data(){return this._data}}class dr{constructor(){this._looks=void 0}flush(){return this._looks=new Map,!0}parse(t){if(!t)return!1;t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString(),r=t.readString();this._looks.set(s,[i,r]),e--}return!0}get looks(){return this._looks}}class ur{constructor(){this._isVip=void 0,this._rooms=void 0}flush(){return this._isVip=!1,this._rooms=[],!0}parse(t){if(!t)return!1;this._isVip=t.readBoolean();let e=t.readInt();for(;e>0;)this._rooms.push(new or(t.readInt(),t.readString(),t.readBoolean())),e--;return!0}get isVip(){return this._isVip}get rooms(){return this._rooms}}class cr{constructor(){this._pageId=void 0,this._data=void 0}flush(){return this._pageId=-1,this._data=null,!0}parse(t){return!!t&&(this._pageId=t.readInt(),this._data=new ci(t),!0)}get pageId(){return this._pageId}get data(){return this._data}}class lr{constructor(t){if(this._type=void 0,this._breedId=void 0,this._paletteId=void 0,this._sellable=void 0,this._rare=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._breedId=-1,this._paletteId=-1,this._sellable=!1,this._rare=!1,!0}parse(t){return!!t&&(this._type=t.readInt(),this._breedId=t.readInt(),this._paletteId=t.readInt(),this._sellable=t.readBoolean(),this._rare=t.readBoolean(),!0)}get type(){return this._type}get breedId(){return this._breedId}get paletteId(){return this._paletteId}get sellable(){return this._sellable}get rare(){return this._rare}}class gr{constructor(){this._productCode=void 0,this._palettes=void 0}flush(){return this._productCode="",this._palettes=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let e=t.readInt();for(;e>0;)this._palettes.push(new lr(t)),e--;return!0}get productCode(){return this._productCode}get palettes(){return this._palettes}}class Er{flush(){return!0}parse(t){return!!t}}class pr{constructor(t){this._id=void 0,this._identifier=void 0,this._type=void 0,this._title=void 0,this._Str_1858=void 0,this._Str_2991=void 0,this._Str_18782=void 0,this._productCode=void 0,this._Str_9772=void 0,this._expirationTime=void 0,this._Str_3594=void 0,this._Str_3539=void 0,this._Str_2956=void 0,this._Str_11962=void 0,this._Str_9163=void 0,this._Str_9163=t.readInt(),this._id=t.readInt(),this._identifier=t.readString(),this._productCode=t.readString(),this._Str_3594=t.readInt(),this._Str_3539=t.readInt(),this._Str_2956=t.readInt(),this._Str_9772=t.readInt();const e=t.readInt();this._expirationTime=e>0?1e3*e+SU.instance.time:0,this._title=t.readString(),this._Str_1858=t.readString(),this._Str_2991=t.readString(),this._Str_18782=t.readString(),this._type=t.readInt(),this._Str_11962=[];let s=t.readInt();for(;s>0;)this._Str_11962.push(t.readString()),s--;return this}populate(t){t&&(this._id=t.id,this._identifier=t.identifier,this._type=t.type,this._title=t.title,this._Str_1858=t.description,this._Str_2991=t.imageUrl,this._Str_18782=t._Str_13452,this._productCode=t.productCode,this._Str_9772=t.purchaseLimit,this._expirationTime=t.expirationTime,this._Str_3594=t.priceInCredits,this._Str_3539=t.priceInActivityPoints,this._Str_2956=t.activityPointType,this._Str_11962=t._Str_24978,this._Str_9163=t._Str_11180)}_Str_24338(t){this._Str_9772=this._Str_9772-t}get id(){return this._id}get identifier(){return this._identifier}get type(){return this._type}get title(){return this._title}get description(){return this._Str_1858}get imageUrl(){return this._Str_2991}get _Str_13452(){return this._Str_18782}get productCode(){return this._productCode}get purchaseLimit(){return this._Str_9772}get expirationTime(){return this._expirationTime}get priceInCredits(){return this._Str_3594}get priceInActivityPoints(){return this._Str_3539}get activityPointType(){return this._Str_2956}get _Str_24978(){return this._Str_11962}get _Str_11180(){return this._Str_9163}}class mr{constructor(){this._data=void 0}flush(){return this._data=null,!0}parse(t){return!!t&&(this._data=new pr(t),!0)}get data(){return this._data}}class Ir{constructor(){this._errorCode=""}flush(){return this._errorCode="",!0}parse(t){return!!t&&(this._errorCode=t.readString(),!0)}get errorCode(){return this._errorCode}}class Tr{constructor(){this._productName="",this._productDescription=""}flush(){return this._productDescription="",this._productName="",!0}parse(t){return!!t&&(this._productDescription=t.readString(),this._productName=t.readString(),!0)}get productName(){return this._productName}get productDescription(){return this._productDescription}}class Rr{constructor(){this._goalId=void 0,this._goalCode=void 0,this._result=void 0,this._requiredFurnis=void 0,this._missingFurnis=void 0}flush(){return this._goalId=0,this._goalCode=null,this._result=0,this._requiredFurnis=null,this._missingFurnis=null,!0}parse(t){this._goalId=t.readInt(),this._goalCode=t.readString(),this._result=t.readInt(),this._requiredFurnis=[];let e=t.readInt();for(;e>0;)this._requiredFurnis.push(t.readString()),e--;for(e=t.readInt();e>0;)this._missingFurnis[t.readString()]="",e--;return!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get result(){return this._result}get requiredFurnis(){return this._requiredFurnis}isMissing(t){return!!this._missingFurnis[t]}}Rr.SUBMITTED=0,Rr.ASK_FOR_SUBMIT=1,Rr.ASK_FOR_CONFIRM=2,Rr.PREREQUISITES_NOT_MET=3,Rr.ROOM_DOOR_NOT_OPEN=4,Rr.ROOM_TOO_OLD=5,Rr.ASK_FOR_ACCEPT_RULES=6;class fr{}fr.ALLOWED=0,fr.REQUIRED_PERK_MISSING=1,fr.REQUIRED_BADGE_MISSING=2;class Or{constructor(){this._goalId=void 0,this._goalCode=void 0,this._resultCode=void 0,this._votesRemaining=void 0}flush(){return this._goalId=0,this._goalCode=null,this._resultCode=0,this._votesRemaining=0,!0}parse(t){return this._goalId=t.readInt(),this._goalCode=t.readString(),this._resultCode=t.readInt(),this._votesRemaining=t.readInt(),!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get isVotingAllowedForUser(){return this._resultCode===fr.ALLOWED}get votesRemaining(){return this._votesRemaining}get resultCode(){return this._resultCode}}class vr{constructor(){this._schedulingStr=void 0,this._code=void 0}flush(){return this._schedulingStr=null,this._code=null,!0}parse(t){return this._schedulingStr=t.readString(),this._code=t.readString(),!0}get schedulingStr(){return this._schedulingStr}get code(){return this._code}}class Ar{constructor(){this._Str_8579=void 0,this._Str_6987=void 0}flush(){return this._Str_8579=!1,this._Str_6987=0,!0}parse(t){return this._Str_8579=t.readBoolean(),this._Str_6987=t.readInt(),!0}get _Str_25348(){return this._Str_8579}get _Str_10760(){return this._Str_6987}}class Sr{flush(){return!0}parse(t){return!0}}class Nr{constructor(){this._Str_8997=void 0,this._Str_21095=void 0}flush(){return this._Str_8997=null,this._Str_21095=0,!0}parse(t){return this._Str_8997=t.readString(),this._Str_21095=t.readInt(),!0}get _Str_23288(){return this._Str_8997}get _Str_25497(){return this._Str_21095}}class Mr{constructor(t){this._recipeName=void 0,this._itemName=void 0,this._recipeName=t.readString(),this._itemName=t.readString()}get recipeName(){return this._recipeName}get itemName(){return this._itemName}}class yr{constructor(){this._recipes=void 0,this._ingredients=void 0,this._recipes=[],this._ingredients=[]}flush(){return this._recipes=[],this._ingredients=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let i=0;i<e;i++)this._recipes.push(new Mr(t));const s=t.readInt();for(let i=0;i<s;i++)this._ingredients.push(t.readString());return!0}get recipes(){return this._recipes}get ingredients(){return this._ingredients}isActive(){return this._recipes.length>0||this._ingredients.length>0}}class Dr{constructor(t){this._count=void 0,this._itemName=void 0,this._count=t.readInt(),this._itemName=t.readString()}get count(){return this._count}get itemName(){return this._itemName}}class Cr{constructor(){this._ingredients=void 0,this._ingredients=[]}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._ingredients.push(new Dr(t));return!0}flush(){return this._ingredients=[],!0}get ingredients(){return this._ingredients}}class Lr{constructor(){this._hasRecipes=void 0,this._count=void 0}parse(t){return!!t&&(this._count=t.readInt(),this._hasRecipes=t.readBoolean(),!0)}flush(){return this._count=0,this._hasRecipes=!1,!0}get count(){return this._count}get hasRecipes(){return this._hasRecipes}}class Ur{constructor(){this._success=void 0,this._result=void 0}parse(t){return!!t&&(this._success=t.readBoolean(),this._success&&(this._result=new Mr(t)),!0)}flush(){return this._success=!1,!0}get success(){return this._success}get result(){return this._result}}class Pr{flush(){return!0}parse(t){return!!t}}class br{constructor(t){if(this._senderId=void 0,this._errorCode=void 0,!t)throw new Error("invalid_wrapper");this._senderId=t.readInt(),this._errorCode=t.readInt()}get senderId(){return this._senderId}get errorCode(){return this._errorCode}}class wr{constructor(){this._failuers=void 0}flush(){return this._failuers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._failuers.push(new br(t)),e--;return!0}get failures(){return this._failuers}}class Fr{constructor(){this._success=void 0}flush(){return this._success=!1,!0}parse(t){return!!t&&(this._success=t.readBoolean(),!0)}get success(){return this._success}}class xr{constructor(){this._errorCode=void 0}flush(){return this._errorCode=0,!0}parse(t){return!!t&&(this._errorCode=t.readInt(),!0)}get errorCode(){return this._errorCode}}class Br{constructor(t){if(this._id=void 0,this._name=void 0,this._gender=void 0,this._online=void 0,this._followingAllowed=void 0,this._figure=void 0,this._categoryId=void 0,this._motto=void 0,this._realName=void 0,this._lastAccess=void 0,this._persistedMessageUser=void 0,this._vipMember=void 0,this._pocketHabboUser=void 0,this._relationshipStatus=void 0,!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._gender=t.readInt(),this._online=t.readBoolean(),this._followingAllowed=t.readBoolean(),this._figure=t.readString(),this._categoryId=t.readInt(),this._motto=t.readString(),this._realName=t.readString(),this._lastAccess=t.readString(),this._persistedMessageUser=t.readBoolean(),this._vipMember=t.readBoolean(),this._pocketHabboUser=t.readBoolean(),this._relationshipStatus=t.readShort()}get id(){return this._id}get name(){return this._name}get gender(){return this._gender}get online(){return this._online}get followingAllowed(){return this._followingAllowed}get figure(){return this._figure}get categoryId(){return this._categoryId}get motto(){return this._motto}get lastAccess(){return this._lastAccess}get realName(){return this._realName}get persistedMessageUser(){return this._persistedMessageUser}get vipMember(){return this._vipMember}get pocketHabboUser(){return this._pocketHabboUser}get relationshipStatus(){return this._relationshipStatus}}class Gr{constructor(){this._totalFragments=void 0,this._fragmentNumber=void 0,this._fragment=void 0}flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=[],!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;)this._fragment.push(new Br(t)),e--;return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class Hr{constructor(t){if(this._id=void 0,this._name=void 0,!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString()}get id(){return this._id}get name(){return this._name}}class Vr{constructor(){this._categories=void 0,this._removedFriendIds=void 0,this._addedFriends=void 0,this._updatedFriends=void 0}flush(){return this._categories=[],this._removedFriendIds=[],this._addedFriends=[],this._updatedFriends=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new Hr(t)),e--;let s=t.readInt();for(;s>0;){const e=t.readInt();-1===e?this._removedFriendIds.push(t.readInt()):0===e?this._updatedFriends.push(new Br(t)):1===e&&this._addedFriends.push(new Br(t)),s--}return!0}get categories(){return this._categories}get removedFriendIds(){return this._removedFriendIds}get addedFriends(){return this._addedFriends}get updatedFriends(){return this._updatedFriends}}class jr{constructor(){this._typeCode=void 0,this._avatarId=void 0,this._message=void 0}flush(){return this._typeCode=-1,this._avatarId=0,this._message=null,!0}parse(t){return!!t&&(this._typeCode=t.readInt(),this._avatarId=t.readInt(),this._message=t.readString(),!0)}get typeCode(){return this._typeCode}get avatarId(){return this._avatarId}get message(){return this._message}}class kr{constructor(t){if(this._requestId=void 0,this._requesterName=void 0,this._requesterUserId=void 0,this._figureString=void 0,!t)throw new Error("invalid_wrapper");this._requestId=t.readInt(),this._requesterName=t.readString(),this._figureString=t.readString(),this._requesterUserId=this._requestId}get requestId(){return this._requestId}get requesterName(){return this._requesterName}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class Yr{constructor(){this._totalRequests=void 0,this._requests=void 0}flush(){return this._totalRequests=0,this._requests=[],!0}parse(t){if(!t)return!1;this._totalRequests=t.readInt();let e=t.readInt();for(;e>0;)this._requests.push(new kr(t)),e--;return!0}get totalRequests(){return this._totalRequests}get requests(){return this._requests}}class zr{constructor(t){if(this._avatarId=void 0,this._avatarName=void 0,this._avatarMotto=void 0,this._isAvatarOnline=void 0,this._canFollow=void 0,this._avatarGender=void 0,this._avatarFigure=void 0,this._lastOnlineData=void 0,this._realName=void 0,!t)throw new Error("invalid_wrapper");this._avatarId=t.readInt(),this._avatarName=t.readString(),this._avatarMotto=t.readString(),this._isAvatarOnline=t.readBoolean(),this._canFollow=t.readBoolean(),this._lastOnlineData=t.readString(),this._avatarGender=t.readInt(),this._avatarFigure=t.readString(),this._realName=t.readString()}get avatarId(){return this._avatarId}get avatarName(){return this._avatarName}get avatarMotto(){return this._avatarMotto}get isAvatarOnline(){return this._isAvatarOnline}get canFollow(){return this._canFollow}get avatarGender(){return this._avatarGender}get avatarFigure(){return this._avatarFigure}get lastOnlineData(){return this._lastOnlineData}get realName(){return this._realName}}class Wr{constructor(){this._friends=void 0,this._others=void 0}flush(){return this._friends=[],this._others=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._friends.push(new zr(t)),e--;let s=t.readInt();for(;s>0;)this._others.push(new zr(t)),s--;return!0}get friends(){return this._friends}get others(){return this._others}}class Kr{constructor(){this._errorCode=void 0,this._userId=void 0,this._message=void 0}flush(){return this._errorCode=0,this._userId=0,this._message=null,!0}parse(t){return!!t&&(this._errorCode=t.readInt(),this._userId=t.readInt(),this._message=t.readString(),!0)}get errorCode(){return this._errorCode}get userId(){return this._userId}get message(){return this._message}}class Xr{constructor(){this._clientMessageId=void 0,this._errorCode=void 0}flush(){return this._clientMessageId=0,this._errorCode=0,!0}parse(t){return!!t&&(this._clientMessageId=t.readInt(),this._errorCode=t.readInt(),!0)}get clientMessageId(){return this._clientMessageId}get errorCode(){return this._errorCode}}class qr{constructor(){this._userFriendLimit=void 0,this._normalFriendLimit=void 0,this._extendedFriendLimit=void 0,this._categories=void 0}flush(){return this._userFriendLimit=0,this._normalFriendLimit=0,this._extendedFriendLimit=0,this._categories=[],!0}parse(t){if(!t)return!1;this._userFriendLimit=t.readInt(),this._normalFriendLimit=t.readInt(),this._extendedFriendLimit=t.readInt();let e=t.readInt();for(;e>0;)this._categories.push(new Hr(t)),e--;return!0}get userFriendLimit(){return this._userFriendLimit}get normalFriendLimit(){return this._normalFriendLimit}get extendedFriendLimit(){return this._extendedFriendLimit}get categories(){return this._categories}}class Qr{flush(){return!0}parse(t){return!!t}}class Zr{constructor(){this._count=void 0}flush(){return this._count=0,!0}parse(t){return!!t&&(this._count=t.readInt(),!0)}get count(){return this._count}}class Jr{constructor(){this._senderId=void 0,this._messageText=void 0,this._secondsSinceSent=void 0,this._extraData=void 0}flush(){return this._senderId=0,this._messageText=null,this._secondsSinceSent=0,this._extraData=null,!0}parse(t){return!!t&&(this._senderId=t.readInt(),this._messageText=t.readString(),this._secondsSinceSent=t.readInt(),t.bytesAvailable&&(this._extraData=t.readString()),!0)}get senderId(){return this._senderId}get messageText(){return this._messageText}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}}class $r{constructor(){this._request=void 0}flush(){return this._request=null,!0}parse(t){return!!t&&(this._request=new kr(t),!0)}get request(){return this._request}}class tn{constructor(){this._errorCode=void 0,this._failedRecipients=void 0}flush(){return this._errorCode=0,this._failedRecipients=[],!0}parse(t){if(!t)return!1;this._errorCode=t.readInt();let e=t.readInt();for(;e>0;)this._failedRecipients.push(t.readInt()),e--;return!0}get errorCode(){return this._errorCode}get failedRecipients(){return this._failedRecipients}}class en{constructor(){this._senderId=void 0,this._messageText=void 0}flush(){return this._senderId=0,this._messageText=null,!0}parse(t){return!!t&&(this._senderId=t.readInt(),this._messageText=t.readString(),!0)}get senderId(){return this._senderId}get messageText(){return this._messageText}}class sn{constructor(){this._gameTypeId=void 0,this._url=void 0,this._gameClientId=void 0}flush(){return this._gameTypeId=0,this._url=null,this._gameClientId=null,!0}parse(t){return!!t&&(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),!0)}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get gameClientId(){return this._gameClientId}}class rn{constructor(){this._errorCode=void 0}flush(){return this._errorCode=0,!0}parse(t){return!!t&&(this._errorCode=t.readInt(),!0)}get errorCode(){return this._errorCode}}class nn{constructor(){this._bases=void 0,this._symbols=void 0,this._partColors=void 0,this._colorsA=void 0,this._colorsB=void 0}flush(){return this._bases=new Map,this._symbols=new Map,this._partColors=new Map,this._colorsA=new Map,this._colorsB=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString(),r=t.readString();this._bases.set(s,[i,r]),e--}let s=t.readInt();for(;s>0;){const e=t.readInt(),i=t.readString(),r=t.readString();this._symbols.set(e,[i,r]),s--}let i=t.readInt();for(;i>0;){const e=t.readInt(),s=t.readString();this._partColors.set(e,s),i--}let r=t.readInt();for(;r>0;){const e=t.readInt(),s=t.readString();this._colorsA.set(e,s),r--}let n=t.readInt();for(;n>0;){const e=t.readInt(),s=t.readString();this._colorsB.set(e,s),n--}return!0}get bases(){return this._bases}get symbols(){return this._symbols}get partColors(){return this._partColors}get colorsA(){return this._colorsA}get colorsB(){return this._colorsB}}class an{constructor(){this._groupCost=void 0,this._availableRooms=void 0}flush(){return this._groupCost=0,this._availableRooms=new Map,!0}parse(t){if(!t)return!1;this._groupCost=t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();t.readBoolean(),this._availableRooms.set(s,i),e--}return!0}get groupCost(){return this._groupCost}get availableRooms(){return this._availableRooms}}class on{constructor(){this._userId=void 0,this._furnitureCount=void 0}flush(){return this._userId=0,this._furnitureCount=0,!0}parse(t){return!!t&&(this._userId=t.readInt(),this._furnitureCount=t.readInt(),!0)}get userId(){return this._userId}get furnitureCount(){return this._furnitureCount}}class hn{constructor(){this._id=void 0,this._type=void 0,this._title=void 0,this._description=void 0,this._badge=void 0,this._roomId=void 0,this._roomName=void 0,this._membershipType=void 0,this._membersCount=void 0,this._isFavorite=void 0,this._createdAt=void 0,this._isOwner=void 0,this._isAdmin=void 0,this._ownerName=void 0,this._flag=void 0,this._canMembersDecorate=void 0,this._pendingRequestsCount=void 0}flush(){return this._id=0,this._type=0,this._title=null,this._description=null,this._badge=null,this._roomId=0,this._roomName=null,this._membershipType=0,this._membersCount=0,this._isFavorite=!1,this._createdAt=null,this._isOwner=!1,this._isAdmin=!1,this._ownerName=null,this._flag=!1,this._canMembersDecorate=!1,this._pendingRequestsCount=0,!0}parse(t){return!!t&&(this._id=t.readInt(),t.readBoolean(),this._type=t.readInt(),this._title=t.readString(),this._description=t.readString(),this._badge=t.readString(),this._roomId=t.readInt(),this._roomName=t.readString(),this._membershipType=t.readInt(),this._membersCount=t.readInt(),this._isFavorite=t.readBoolean(),this._createdAt=t.readString(),this._isOwner=t.readBoolean(),this._isAdmin=t.readBoolean(),this._ownerName=t.readString(),this._flag=t.readBoolean(),this._canMembersDecorate=t.readBoolean(),this._pendingRequestsCount=t.readInt(),!0)}get id(){return this._id}get type(){return this._type}get title(){return this._title}get description(){return this._description}get badge(){return this._badge}get roomId(){return this._roomId}get roomName(){return this._roomName}get membershipType(){return this._membershipType}get membersCount(){return this._membersCount}get isFavorite(){return this._isFavorite}get createdAt(){return this._createdAt}get isOwner(){return this._isOwner}get isAdmin(){return this._isAdmin}get ownerName(){return this._ownerName}get flag(){return this._flag}get canMembersDecorate(){return this._canMembersDecorate}get pendingRequestsCount(){return this._pendingRequestsCount}}class _n{constructor(t){this.isBase=void 0,this.key=void 0,this.color=void 0,this.position=void 0,this.isBase=t,this.key=0,this.color=0,this.position=4}get code(){return 0===this.key?null:(this.isBase?"b":"s")+(this.key<100?"0":"")+(this.key<10?"0":"")+this.key+(this.color<10?"0":"")+this.color+this.position}}class dn{}dn.OWNER=0,dn.ADMIN=1,dn.MEMBER=2,dn.REQUESTED=3,dn.DELETED=4;class un{constructor(t){if(this._rank=void 0,this._id=void 0,this._name=void 0,this._figure=void 0,this._joinedAt=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rank=-1,this._id=0,this._name=null,this._figure=null,this._joinedAt=null,!0}parse(t){return!!t&&(this._rank=t.readInt(),this._id=t.readInt(),this._name=t.readString(),this._figure=t.readString(),this._joinedAt=t.readString(),!0)}get id(){return this._id}get name(){return this._name}get figure(){return this._figure}get rank(){return this._rank}get joinedAt(){return this._joinedAt}}class cn{constructor(){this._groupId=void 0,this._groupTitle=void 0,this._roomId=void 0,this._badge=void 0,this._totalMembersCount=void 0,this._result=void 0,this._admin=void 0,this._pageSize=void 0,this._pageIndex=void 0,this._level=void 0,this._query=void 0}flush(){return this._groupId=0,this._groupTitle=null,this._roomId=0,this._badge=null,this._totalMembersCount=0,this._result=[],this._admin=!1,this._pageSize=0,this._pageIndex=0,this._level=0,this._query=null,!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._groupTitle=t.readString(),this._roomId=t.readInt(),this._badge=t.readString(),this._totalMembersCount=t.readInt();let e=t.readInt();for(;e>0;)this._result.push(new un(t)),e--;return this._admin=t.readBoolean(),this._pageSize=t.readInt(),this._pageIndex=t.readInt(),this._level=t.readInt(),this._query=t.readString(),!0}get groupId(){return this._groupId}get groupTitle(){return this._groupTitle}get roomId(){return this._roomId}get badge(){return this._badge}get totalMembersCount(){return this._totalMembersCount}get result(){return this._result}get admin(){return this._admin}get pageSize(){return this._pageSize}get pageIndex(){return this._pageIndex}get level(){return this._level}get query(){return this._query}}class ln{constructor(){this._roomId=void 0,this._groupId=void 0}flush(){return this._roomId=0,this._groupId=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._groupId=t.readInt(),!0)}get roomId(){return this._roomId}get guildId(){return this._groupId}}class gn{constructor(){this._roomId=void 0,this._roomName=void 0,this._id=void 0,this._title=void 0,this._description=void 0,this._colorA=void 0,this._colorB=void 0,this._state=void 0,this._canMembersDecorate=void 0,this._badgeParts=void 0,this._badgeCode=void 0,this._membersCount=void 0}flush(){return this._roomId=0,this._roomName=null,this._id=0,this._title=null,this._description=null,this._colorA=0,this._colorB=0,this._state=0,this._canMembersDecorate=!1,this._badgeParts=new Map,this._badgeCode=null,this._membersCount=0,!0}parse(t){if(!t)return!1;1===t.readInt()&&(this._roomId=t.readInt(),this._roomName=t.readString(),t.readBoolean()),t.readBoolean(),this._id=t.readInt(),this._title=t.readString(),this._description=t.readString(),t.readInt(),this._colorA=t.readInt(),this._colorB=t.readInt(),this._state=t.readInt(),this._canMembersDecorate=0===t.readInt(),t.readBoolean(),t.readString();const e=t.readInt();for(let s=0;s<e;s++){const e=new _n(0===s);e.key=t.readInt(),e.color=t.readInt(),e.position=t.readInt(),0===e.key&&(e.position=4),this._badgeParts.set(s,e)}return this._badgeCode=t.readString(),this._membersCount=t.readInt(),!0}get roomId(){return this._roomId}get roomName(){return this._roomName}get id(){return this._id}get title(){return this._title}get description(){return this._description}get colorA(){return this._colorA}get colorB(){return this._colorB}get state(){return this._state}get canMembersDecorate(){return this._canMembersDecorate}get badgeParts(){return this._badgeParts}get badgeCode(){return this._badgeCode}get membersCount(){return this._membersCount}}class En{constructor(){this._groupId=void 0}flush(){return!0}parse(t){return this._groupId=t.readInt(),!0}get groupId(){return this._groupId}}class pn{constructor(){this._noobnessLevel=void 0}flush(){return this._noobnessLevel=0,!0}parse(t){return!!t&&(this._noobnessLevel=t.readInt(),!0)}get noobnessLevel(){return this._noobnessLevel}}class mn{constructor(){this._infoUrl=void 0}flush(){return!0}parse(t){return!!t&&(this._infoUrl=t.readString(),!0)}get infoUrl(){return this._infoUrl}}class In{flush(){return!0}parse(t){return!0}}class Tn{constructor(){this._calls=void 0}flush(){return this._calls=[],!0}parse(t){this._calls=[];const e=t.readInt();for(let s=0;s<e;s++){const e=t.readString(),s=t.readString(),i=t.readString();this._calls.push({callId:e,timeStamp:s,message:i})}return!0}get pendingCalls(){return this._calls}get count(){return this._calls.length}}class Rn{constructor(){this._message=void 0}flush(){return this._message=null,!0}parse(t){return this._message=t.readString(),!0}get message(){return this._message}}class fn{constructor(){this._resultType=void 0,this._messageText=void 0}flush(){return this._resultType=0,this._messageText=null,!0}parse(t){return!!t&&(this._resultType=t.readInt(),this._messageText=t.readString(),!0)}get resultType(){return this._resultType}get messageText(){return this._messageText}}class On{flush(){return!0}parse(t){return!0}}class vn{constructor(){this._acceptanceTimeout=void 0}flush(){return this._acceptanceTimeout=-1,!0}parse(t){return this._acceptanceTimeout=t.readInt(),!0}get acceptanceTimeout(){return this._acceptanceTimeout}}class An{constructor(){this._winningVoteCode=void 0,this._ownVoteCode=void 0,this._finalStatus=void 0}flush(){return this._winningVoteCode=-1,this._ownVoteCode=-1,this._finalStatus=null,!0}parse(t){this._finalStatus=[],this._winningVoteCode=t.readInt(),this._ownVoteCode=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._finalStatus.push(t.readInt());return!0}get winningVoteCode(){return this._winningVoteCode}get ownVoteCode(){return this._ownVoteCode}get finalStatus(){return this._finalStatus}}class Sn{constructor(){this._votingTimeout=void 0,this._chatRecord=void 0}flush(){return!0}parse(t){return this._votingTimeout=t.readInt(),this._chatRecord=t.readString(),!0}get votingTimeout(){return this._votingTimeout}get chatRecord(){return this._chatRecord}}class Nn{constructor(){this._status=void 0}flush(){return this._status=null,!0}parse(t){this._status=[];const e=t.readInt();for(let s=0;s<e;s++)this._status.push(t.readInt());return!0}get status(){return this._status}}Nn.AWAITING_VOTE=0,Nn.VOTED_OK=1,Nn.VOTED_BAD=2,Nn.VOTED_VERY_BAD=3,Nn.NO_VOTE=4,Nn.FINDING_NEW_VOTER=5;class Mn{constructor(){this._onDuty=void 0,this._guidesOnDuty=void 0,this._helpersOnDuty=void 0,this._guardiansOnDuty=void 0}flush(){return this._onDuty=!1,this._guidesOnDuty=0,this._helpersOnDuty=0,this._guardiansOnDuty=0,!0}parse(t){return!!t&&(this._onDuty=t.readBoolean(),this._guidesOnDuty=t.readInt(),this._helpersOnDuty=t.readInt(),this._guardiansOnDuty=t.readInt(),!0)}get onDuty(){return this._onDuty}get guidesOnDuty(){return this._guidesOnDuty}get helpersOnDuty(){return this._helpersOnDuty}get guardiansOnDuty(){return this._guardiansOnDuty}}class yn{constructor(t,e,s,i,r,n,a){this._type=void 0,this._secondsAgo=void 0,this._isGuide=void 0,this._otherPartyName=void 0,this._otherPartyFigure=void 0,this._description=void 0,this._roomName=void 0,this._type=t,this._secondsAgo=e,this._isGuide=s,this._otherPartyName=i,this._otherPartyFigure=r,this._description=n,this._roomName=a}get type(){return this._type}set type(t){this._type=t}get secondsAgo(){return this._secondsAgo}set secondsAgo(t){this._secondsAgo=t}get isGuide(){return this._isGuide}set isGuide(t){this._isGuide=t}get otherPartyName(){return this._otherPartyName}set otherPartyName(t){this._otherPartyName=t}get otherPartyFigure(){return this._otherPartyFigure}set otherPartyFigure(t){this._otherPartyFigure=t}get description(){return this._description}set description(t){this._description=t}get roomName(){return this._roomName}set roomName(t){this._roomName=t}}class Dn{constructor(){this._statusCode=void 0,this._pendingTicket=void 0}flush(){return this._statusCode=0,this._pendingTicket=null,!0}parse(t){return!!t&&(this._statusCode=t.readInt(),this._pendingTicket=new yn(t.readInt(),t.readInt(),t.readBoolean(),t.readString(),t.readString(),t.readString(),t.readString()),!0)}get statusCode(){return this._statusCode}get pendingTicket(){return this._pendingTicket}}Dn.GUIDE_REPORTING_STATUS_OK=0,Dn.GUIDE_REPORTING_STATUS_PENDING_TICKET=1,Dn.GUIDE_REPORTING_STATUS_ABUSIVE=2,Dn.GUIDE_REPORTING_STATUS_REPORTING_TOO_QUICKLY=3;class Cn{constructor(){this._asGuide=void 0,this._helpRequestType=void 0,this._helpRequestDescription=void 0,this._roleSpecificWaitTime=void 0}flush(){return this._asGuide=!1,this._helpRequestType=0,this._helpRequestDescription=null,this._roleSpecificWaitTime=0,!0}parse(t){return!!t&&(this._asGuide=t.readBoolean(),this._helpRequestType=t.readInt(),this._helpRequestDescription=t.readString(),this._roleSpecificWaitTime=t.readInt(),!0)}get asGuide(){return this._asGuide}get helpRequestType(){return this._helpRequestType}get helpRequestDescription(){return this._helpRequestDescription}get roleSpecificWaitTime(){return this._roleSpecificWaitTime}}class Ln{flush(){return!0}parse(t){return!!t}}class Un{constructor(){this._endReason=void 0}flush(){return this._endReason=0,!0}parse(t){return!!t&&(this._endReason=t.readInt(),!0)}get endReason(){return this._endReason}}class Pn{constructor(){this._errorCode=void 0}flush(){return this._errorCode=0,!0}parse(t){return!!t&&(this._errorCode=t.readInt(),!0)}get errorCode(){return this._errorCode}}Pn.ERROR_GENERIC=0,Pn.ERROR_GUIDES_REJECT=1,Pn.ERROR_NOT_ENOUGH_GUIDES=2,Pn.ERROR_NOT_ENOUGH_VOTES=3,Pn.ERROR_NO_CHATLOG_FOUND=4;class bn{constructor(){this._roomId=void 0,this._roomName=void 0}flush(){return this._roomId=0,this._roomName=null,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._roomName=t.readString(),!0)}get roomId(){return this._roomId}get roomName(){return this._roomName}}class wn{constructor(){this._chatMessage=void 0,this._senderId=void 0}flush(){return this._chatMessage=null,this._senderId=0,!0}parse(t){return!!t&&(this._chatMessage=t.readString(),this._senderId=t.readInt(),!0)}get chatMessage(){return this._chatMessage}get senderId(){return this._senderId}}class Fn{constructor(){this._isTyping=void 0}flush(){return this._isTyping=!1,!0}parse(t){return!!t&&(this._isTyping=t.readBoolean(),!0)}get isTyping(){return this._isTyping}}class xn{constructor(){this._requesterRoomId=void 0}flush(){return this._requesterRoomId=0,!0}parse(t){return!!t&&(this._requesterRoomId=t.readInt(),!0)}get requesterRoomId(){return this._requesterRoomId}}class Bn{constructor(){this._requesterUserId=void 0,this._requesterName=void 0,this._requesterFigure=void 0,this._guideUserId=void 0,this._guideName=void 0,this._guideFigure=void 0}flush(){return this._requesterUserId=0,this._requesterName=null,this._requesterFigure=null,this._guideUserId=0,this._guideName=null,this._guideFigure=null,!0}parse(t){return!!t&&(this._requesterUserId=t.readInt(),this._requesterName=t.readString(),this._requesterFigure=t.readString(),this._guideUserId=t.readInt(),this._guideName=t.readString(),this._guideFigure=t.readString(),!0)}get requesterUserId(){return this._requesterUserId}get requesterName(){return this._requesterName}get requesterFigure(){return this._requesterFigure}get guideUserId(){return this._guideUserId}get guideName(){return this._guideName}get guideFigure(){return this._guideFigure}}class Gn{constructor(){this._result=void 0}flush(){return this._result=0,!0}parse(t){return!!t&&(this._result=t.readInt(),!0)}get result(){return this._result}}Gn.CREATION_RESULT_OK=0,Gn.CREATION_RESULT_UNABLE_TO_REPORT=1,Gn.CREATION_RESULT_NO_CHATLOG_FOUND=2,Gn.CREATION_RESULT_BULLY_ALREADY_REPORTED=3;class Hn{constructor(){this._resolution=void 0}flush(){return this._resolution=0,!0}parse(t){return!!t&&(this._resolution=t.readInt(),!0)}get resolution(){return this._resolution}}Hn.RESOLUTION_GUARDIANS_TOOK_ACTION=0,Hn.RESOLUTION_FORWARDED_TO_MODERATORS=1,Hn.RESOLUTION_REPORTER_IS_ABUSIVE=2;class Vn{flush(){return!0}parse(t){return!!t}}class jn{constructor(){this._closeReason=void 0,this._messageText=void 0}flush(){return this._closeReason=0,this._messageText="",!0}parse(t){return!!t&&(this._closeReason=t.readInt(),this._messageText=t.readString(),!0)}get closeReason(){return this._closeReason}get messageText(){return this._messageText}}class kn{constructor(){this._quizCode=void 0,this._questionIds=void 0}flush(){return this._quizCode=null,this._questionIds=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const e=t.readInt();this._questionIds=[];for(let s=0;s<e;s++)this._questionIds.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIds(){return this._questionIds}}class Yn{constructor(){this._quizCode=void 0,this._questionIdsForWrongAnswers=void 0}flush(){return this._quizCode=null,this._questionIdsForWrongAnswers=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const e=t.readInt();this._questionIdsForWrongAnswers=[];for(let s=0;s<e;s++)this._questionIdsForWrongAnswers.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIdsForWrongAnswers(){return this._questionIdsForWrongAnswers}}class zn{constructor(t){if(this._achievementId=void 0,this._level=void 0,this._badgeId=void 0,this._scoreAtStartOfLevel=void 0,this._scoreLimit=void 0,this._levelRewardPoints=void 0,this._levelRewardPointType=void 0,this._currentPoints=void 0,this._finalLevel=void 0,this._category=void 0,this._subCategory=void 0,this._levelCount=void 0,this._displayMethod=void 0,this._unseen=0,!t)throw new Error("invalid_parser");this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._scoreAtStartOfLevel=t.readInt(),this._scoreLimit=Math.max(1,t.readInt()),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._currentPoints=t.readInt(),this._finalLevel=t.readBoolean(),this._category=t.readString(),this._subCategory=t.readString(),this._levelCount=t.readInt(),this._displayMethod=t.readInt()}get achievementId(){return this._achievementId}get badgeId(){return this._badgeId}get level(){return this._level}get scoreAtStartOfLevel(){return this._scoreAtStartOfLevel}get scoreLimit(){return this._scoreLimit-this._scoreAtStartOfLevel}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get currentPoints(){return this._currentPoints-this._scoreAtStartOfLevel}get finalLevel(){return this._finalLevel}get category(){return this._category}get subCategory(){return this._subCategory}get levelCount(){return this._levelCount}get firstLevelAchieved(){return this._level>1||this._finalLevel}setMaxProgress(){this._currentPoints=this._scoreLimit}get displayMethod(){return this._displayMethod}get progress(){return this._currentPoints}get toNextProgress(){return this._scoreLimit}set unseen(t){this._unseen=t}get unseen(){return this._unseen}reset(t){this._achievementId=t._achievementId,this._level=t._level,this._badgeId=t._badgeId,this._scoreAtStartOfLevel=t._scoreAtStartOfLevel,this._scoreLimit=t._scoreLimit,this._levelRewardPoints=t._levelRewardPoints,this._levelRewardPointType=t._levelRewardPointType,this._currentPoints=t._currentPoints,this._finalLevel=t._finalLevel,this._category=t.category,this._subCategory=t._subCategory,this._levelCount=t._levelCount,this._displayMethod=t._displayMethod}}zn.DISPLAY_METHOD_OBSOLETE=-1,zn.DISPLAY_METHOD_SHOW_LEVEL_PROGRESS=0,zn.DISPLAY_METHOD_NEVER_SHOW_PROGRESS=1,zn.DISPLAY_METHOD_SHOW_TOTAL_PROGRESS=2;class Wn{constructor(){this._achievement=void 0}flush(){return this._achievement=null,!0}parse(t){return!!t&&(this._achievement=new zn(t),!0)}get achievement(){return this._achievement}}class Kn{constructor(){this._achievements=void 0,this._defaultCategory=void 0}flush(){return this._achievements=[],this._defaultCategory=null,!0}parse(t){if(!t)return!1;this._achievements=[];let e=t.readInt();for(;e>0;)this._achievements.push(new zn(t)),e--;return this._defaultCategory=t.readString(),!0}get achievements(){return this._achievements}get defaultCategory(){return this._defaultCategory}}class Xn{constructor(){this._score=void 0}flush(){return this._score=0,!0}parse(t){return!!t&&(this._score=t.readInt(),!0)}get score(){return this._score}}class qn{constructor(){this._type=void 0,this._duration=void 0,this._isPermanent=void 0}flush(){return this._type=0,this._duration=0,this._isPermanent=!1,!0}parse(t){return!!t&&(this._type=t.readInt(),this._duration=t.readInt(),this._isPermanent=t.readBoolean(),!0)}get type(){return this._type}get duration(){return this._duration}get isPermanent(){return this._isPermanent}}class Qn{constructor(){this._type=void 0,this._subType=void 0,this._duration=void 0,this._permanent=void 0}flush(){return this._type=0,this._subType=0,this._duration=0,this._permanent=!1,!0}parse(t){return!!t&&(this._type=t.readInt(),this._subType=t.readInt(),this._duration=t.readInt(),this._permanent=t.readBoolean(),!0)}get type(){return this._type}get subType(){return this._subType}get duration(){return this._duration}get isPermanent(){return this._permanent}}class Zn{constructor(){this._type=void 0}flush(){return this._type=0,!0}parse(t){return!!t&&(this._type=t.readInt(),!0)}get type(){return this._type}}class Jn{constructor(){this._type=void 0,this._subType=void 0,this._duration=void 0,this._inactiveEffectsInInventory=void 0,this._secondsLeftIfActive=void 0,this._permanent=void 0}get type(){return this._type}set type(t){this._type=t}get subType(){return this._subType}set subType(t){this._subType=t}get duration(){return this._duration}set duration(t){this._duration=t}get inactiveEffectsInInventory(){return this._inactiveEffectsInInventory}set inactiveEffectsInInventory(t){this._inactiveEffectsInInventory=t}get secondsLeftIfActive(){return this._secondsLeftIfActive}set secondsLeftIfActive(t){this._secondsLeftIfActive=t}get isPermanent(){return this._permanent}set isPermanent(t){this._permanent=t}}class $n{constructor(){this._effects=void 0}flush(){return this._effects=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=new Jn;s.type=t.readInt(),s.subType=t.readInt(),s.duration=t.readInt(),s.inactiveEffectsInInventory=t.readInt(),s.secondsLeftIfActive=t.readInt(),s.isPermanent=t.readBoolean(),this._effects.push(s),e--}return!0}get effects(){return this._effects}}class ta{constructor(t,e){if(this._badgeId=void 0,this._limit=void 0,!e)throw new Error("invalid_parser");this._badgeId="ACH_"+t+e.readInt(),this._limit=e.readInt()}get badgeId(){return this._badgeId}get limit(){return this._limit}}class ea{constructor(){this._data=void 0}flush(){return this._data=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readString(),i=t.readInt();let r=0;for(;r<i;)this._data.push(new ta(s,t)),r++;e--}return!0}get data(){return this._data}}class sa{constructor(){this._badgeId=void 0,this._badgeCode=void 0}flush(){return this._badgeId=0,this._badgeCode=null,!0}parse(t){return!!t&&(this._badgeId=t.readInt(),this._badgeCode=t.readString(),!0)}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}}class ia{constructor(){this._allBadgeCodes=void 0,this._activeBadgeCodes=void 0,this._badgeIds=void 0}flush(){return this._allBadgeCodes=[],this._activeBadgeCodes=null,this._badgeIds=null,!0}parse(t){if(!t)return!1;this._allBadgeCodes=[],this._activeBadgeCodes=new U,this._badgeIds=new U;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._badgeIds.add(i,s),this._allBadgeCodes.push(i),e--}for(e=t.readInt();e>0;){const s=t.readInt(),i=t.readString();this._activeBadgeCodes.add(i,s),e--}return!0}getBadgeId(t){return this._badgeIds.getValue(t)}getActiveBadgeSlot(t){return this._activeBadgeCodes.getValue(t)}getAllBadgeCodes(){return this._allBadgeCodes}getActiveBadgeCodes(){return this._activeBadgeCodes.getKeys()}}class ra{constructor(){this._requestCode=void 0,this._fulfilled=void 0}flush(){return!0}parse(t){return!!t&&(this._requestCode=t.readString(),this._fulfilled=t.readBoolean(),!0)}get requestCode(){return this._requestCode}get fulfilled(){return this._fulfilled}}class na{constructor(){this._figureSetIds=void 0,this._boundFurnitureNames=void 0}flush(){return this._figureSetIds=[],this._boundFurnitureNames=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._figureSetIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._boundFurnitureNames.push(t.readString()),s--;return!0}get figureSetIds(){return this._figureSetIds}get boundsFurnitureNames(){return this._boundFurnitureNames}}class aa{}aa.UNIQUE_SET=256;class oa{constructor(){this._flags=void 0,this._uniqueNumber=void 0,this._uniqueSeries=void 0,this._flags=0,this._uniqueNumber=0,this._uniqueSeries=0}parseWrapper(t){(this._flags&aa.UNIQUE_SET)>0&&(this._uniqueNumber=t.readInt(),this._uniqueSeries=t.readInt())}initializeFromRoomObjectModel(t){this._uniqueNumber=t.getValue(rt.FURNITURE_UNIQUE_SERIAL_NUMBER),this._uniqueSeries=t.getValue(rt.FURNITURE_UNIQUE_EDITION_SIZE)}writeRoomObjectModel(t){t&&(t.setValue(rt.FURNITURE_UNIQUE_SERIAL_NUMBER,this._uniqueNumber),t.setValue(rt.FURNITURE_UNIQUE_EDITION_SIZE,this._uniqueSeries))}getLegacyString(){return""}compare(t){return!1}get state(){const t=parseInt(this.getLegacyString());return isNaN(t)?0:t}get isUnique(){return this._uniqueSeries>0}get uniqueNumber(){return this._uniqueNumber}set uniqueNumber(t){this._uniqueNumber=t}get uniqueSeries(){return this._uniqueSeries}set uniqueSeries(t){this._uniqueSeries=t}get rarityLevel(){return-1}get flags(){return this._flags}set flags(t){this._flags=t}}class ha{}ha.LEGACY_KEY=0,ha.MAP_KEY=1,ha.STRING_KEY=2,ha.VOTE_KEY=3,ha.EMPTY_KEY=4,ha.NUMBER_KEY=5,ha.HIGHSCORE_KEY=6,ha.CRACKABLE_KEY=7;class _a extends oa{constructor(){super(),this._state=void 0,this._hits=void 0,this._target=void 0,this._state="",this._hits=0,this._target=0}parseWrapper(t){t&&(this._state=t.readString(),this._hits=t.readInt(),this._target=t.readInt(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._state=t.getValue(rt.FURNITURE_CRACKABLE_STATE),this._hits=t.getValue(rt.FURNITURE_CRACKABLE_HITS),this._target=t.getValue(rt.FURNITURE_CRACKABLE_TARGET)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(rt.FURNITURE_DATA_FORMAT,_a.FORMAT_KEY),t.setValue(rt.FURNITURE_CRACKABLE_STATE,this._state),t.setValue(rt.FURNITURE_CRACKABLE_HITS,this._hits),t.setValue(rt.FURNITURE_CRACKABLE_TARGET,this._target)}getLegacyString(){return this._state}compare(t){return!0}get hits(){return this._hits}get target(){return this._target}}_a.FORMAT_KEY=ha.CRACKABLE_KEY;class da extends oa{constructor(){super(...arguments),this._state=void 0}parseWrapper(t){t&&(this._state="",super.parseWrapper(t))}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(rt.FURNITURE_DATA_FORMAT,da.FORMAT_KEY)}getLegacyString(){return this._state}compare(t){return super.compare(t)}}da.FORMAT_KEY=ha.EMPTY_KEY;class ua{constructor(){this._score=void 0,this._users=void 0,this._score=-1,this._users=[]}get score(){return this._score}set score(t){this._score=t}get users(){return this._users}set users(t){this._users=t}addUsername(t){this._users.push(t)}}class ca extends oa{constructor(){super(),this._state=void 0,this._scoreType=void 0,this._clearType=void 0,this._entries=void 0,this._state="",this._scoreType=-1,this._clearType=-1,this._entries=[]}parseWrapper(t){if(!t)return;this._state=t.readString(),this._scoreType=t.readInt(),this._clearType=t.readInt();let e=t.readInt();for(;e>0;){const s=new ua;s.score=t.readInt();let i=t.readInt();for(;i>0;)s.addUsername(t.readString()),i--;this._entries.push(s),e--}super.parseWrapper(t)}initializeFromRoomObjectModel(t){this._scoreType=t.getValue(rt.FURNITURE_HIGHSCORE_SCORE_TYPE),this._clearType=t.getValue(rt.FURNITURE_HIGHSCORE_CLEAR_TYPE),this._entries=[];const e=t.getValue(rt.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT);let s=0;for(;s<e;){const e=new ua;e.score=t.getValue(rt.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+s),e.users=t.getValue(rt.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+s),this._entries.push(e),s++}super.initializeFromRoomObjectModel(t)}writeRoomObjectModel(t){if(super.writeRoomObjectModel(t),t.setValue(rt.FURNITURE_DATA_FORMAT,ca.FORMAT_KEY),t.setValue(rt.FURNITURE_HIGHSCORE_SCORE_TYPE,this._scoreType),t.setValue(rt.FURNITURE_HIGHSCORE_CLEAR_TYPE,this._clearType),this._entries){t.setValue(rt.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT,this._entries.length);let e=0;for(;e<this._entries.length;){const s=this._entries[e];t.setValue(rt.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+e,s.score),t.setValue(rt.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+e,s.users),e++}}}getLegacyString(){return this._state}get entries(){return this._entries}get clearType(){return this._clearType}get scoreType(){return this._scoreType}}ca.FORMAT_KEY=ha.HIGHSCORE_KEY;class la extends oa{constructor(){super(),this._data=void 0,this._data=""}parseWrapper(t){t&&(this._data=t.readString(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(rt.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(rt.FURNITURE_DATA_FORMAT,la.FORMAT_KEY),t.setValue(rt.FURNITURE_DATA,this._data)}getLegacyString(){return this._data}compare(t){return this._data===t.getLegacyString()}setString(t){this._data=t}}la.FORMAT_KEY=ha.LEGACY_KEY;class ga extends oa{constructor(){super(),this._data=void 0,this._data={}}parseWrapper(t){if(!t)return;this._data={};const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data[t.readString()]=t.readString();super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(rt.FURNITURE_DATA)||{}}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(rt.FURNITURE_DATA_FORMAT,ga.FORMAT_KEY),t.setValue(rt.FURNITURE_DATA,this._data)}getLegacyString(){if(!this._data)return"";const t=this._data[ga.STATE];return void 0===t||null===t?"":t}compare(t){return!1}getValue(t){return this._data[t]}get rarityLevel(){if(!this._data)return-1;const t=this._data[ga.RARITY];return void 0===t||null===t?-1:parseInt(t)}get data(){return this._data}}ga.FORMAT_KEY=ha.MAP_KEY,ga.STATE="state",ga.RARITY="rarity";class Ea extends oa{constructor(){super(),this._data=void 0,this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readInt());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(rt.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(rt.FURNITURE_DATA_FORMAT,Ea.FORMAT_KEY),t.setValue(rt.FURNITURE_DATA,this._data)}getLegacyString(){return this._data&&this._data.length?this._data[Ea.STATE].toString():""}compare(t){if(!(t instanceof Ea))return!1;let e=0;for(;e<this._data.length;){if(0===e);else if(this._data[e]!==t.getValue(e))return!1;e++}return!0}getValue(t){if(!this._data||!this._data.length)return-1;const e=this._data[t];return void 0===e||null===e?-1:e}}Ea.FORMAT_KEY=ha.NUMBER_KEY,Ea.STATE=0;class pa extends oa{constructor(){super(),this._data=void 0,this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readString());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(rt.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(rt.FURNITURE_DATA_FORMAT,pa.FORMAT_KEY),t.setValue(rt.FURNITURE_DATA,this._data)}getLegacyString(){return this._data&&this._data.length?this._data[pa.STATE]:""}compare(t){if(!(t instanceof pa))return!1;let e=0;for(;e<this._data.length;){if(0===e);else if(this._data[e]!==t.getValue(e))return!1;e++}return!0}getValue(t){return this._data[t]||""}setValue(t){this._data=t}}pa.FORMAT_KEY=ha.STRING_KEY,pa.STATE=0;class ma extends oa{constructor(){super(),this._state=void 0,this._result=void 0,this._state="",this._result=0}parseWrapper(t){t&&(this._state=t.readString(),this._result=t.readInt(),super.parseWrapper(t))}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(rt.FURNITURE_DATA_FORMAT,ma.FORMAT_KEY);const e={};e.S=this._state,e.R=this._result.toString(),t.setValue(rt.FURNITURE_DATA,e)}getLegacyString(){return this._state}compare(t){return!0}setString(t){this._state=t}get result(){return this._result}}ma.FORMAT_KEY=ha.VOTE_KEY;class Ia{static getData(t){let e=null;switch(255&t){case _a.FORMAT_KEY:e=new _a;break;case da.FORMAT_KEY:e=new da;break;case ca.FORMAT_KEY:e=new ca;break;case la.FORMAT_KEY:e=new la;break;case ga.FORMAT_KEY:e=new ga;break;case Ea.FORMAT_KEY:e=new Ea;break;case pa.FORMAT_KEY:e=new pa;break;case ma.FORMAT_KEY:e=new ma}return e?(e.flags=65280&t,e):null}}class Ta{constructor(){this._itemId=void 0,this._data=void 0}flush(){return this._itemId=0,this._data=null,!0}parse(t){return!!t&&(this._itemId=parseInt(t.readString()),this._data=Ta.parseObjectData(t),!0)}static parseObjectData(t){if(!t)return null;const e=Ia.getData(t.readInt());return e?(e.parseWrapper(t),e):null}get furnitureId(){return this._itemId}get objectData(){return this._data}}class Ra{constructor(t){if(this._rentable=void 0,this._itemId=void 0,this._furniType=void 0,this._ref=void 0,this._spriteId=void 0,this._category=void 0,this._stuffData=void 0,this._isGroupable=void 0,this._isRecyclable=void 0,this._tradable=void 0,this._sellable=void 0,this._secondsToExpiration=void 0,this._extra=void 0,this._flatId=void 0,this._isWallItem=void 0,this._hasRentPeriodStarted=void 0,this._expirationTimeStamp=void 0,this._slotId=void 0,this._songId=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rentable=!1,this._itemId=0,this._furniType=null,this._ref=0,this._spriteId=0,this._category=0,this._stuffData=null,this._isGroupable=!1,this._isRecyclable=!1,this._tradable=!1,this._sellable=!1,this._secondsToExpiration=0,this._extra=0,this._flatId=0,this._isWallItem=!1,this._hasRentPeriodStarted=!1,this._expirationTimeStamp=0,this._slotId="",this._songId=-1,!0}parse(t){return!!t&&(this._itemId=t.readInt(),this._furniType=t.readString(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._stuffData=Ta.parseObjectData(t),this._isRecyclable=t.readBoolean(),this._tradable=t.readBoolean(),this._isGroupable=t.readBoolean(),this._sellable=t.readBoolean(),this._secondsToExpiration=t.readInt(),this._expirationTimeStamp=SU.instance.time,this.secondsToExpiration>-1?this._rentable=!0:(this._rentable=!1,this._secondsToExpiration=-1),this._hasRentPeriodStarted=t.readBoolean(),this._flatId=t.readInt(),this._isWallItem=this._furniType===Ra.WALL_ITEM,this._furniType===Ra.FLOOR_ITEM&&(this._slotId=t.readString(),this._extra=t.readInt()),!0)}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get isGroupable(){return this._isGroupable}get isRecycleable(){return this._isRecyclable}get tradable(){return this._tradable}get sellable(){return this._sellable}get secondsToExpiration(){return this._secondsToExpiration}get flatId(){return this._flatId}get slotId(){return this._slotId}get songId(){return this._songId}get extra(){return this._extra}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get creationDay(){return 0}get creationMonth(){return 0}get creationYear(){return 0}get isExternalImageFurni(){return!(-1===this._furniType.indexOf("external_image"))}}Ra.WALL_ITEM="I",Ra.FLOOR_ITEM="S";class fa{constructor(){this._items=void 0}flush(){return this._items=[],!0}parse(t){return!!t&&(this._items.push(new Ra(t)),!0)}get items(){return this._items}}class Oa{flush(){return!0}parse(t){return!!t}}class va{constructor(){this._totalFragments=void 0,this._fragmentNumber=void 0,this._fragment=void 0}flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=new Map,!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;){const s=new Ra(t);s&&this._fragment.set(s.itemId,s),e--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class Aa{constructor(){this._itemId=void 0}flush(){return this._itemId=0,!0}parse(t){return!!t&&(this._itemId=t.readInt(),!0)}get itemId(){return this._itemId}}class Sa{constructor(){this._itemId=void 0,this._itemsLeft=void 0}flush(){return this._itemId=0,this._itemsLeft=0,!0}parse(t){return!!t&&(this._itemId=t.readInt(),this._itemsLeft=t.readInt(),!0)}get itemId(){return this._itemId}get itemsLeft(){return this._itemsLeft}}class Na{constructor(){this._itemType=void 0,this._classId=void 0,this._productCode=void 0,this._placedItemId=void 0,this._placedItemType=void 0,this._placedInRoom=void 0,this._petFigureString=void 0}flush(){return this._itemType="",this._classId=0,this._productCode="",!0}parse(t){return!!t&&(this._itemType=t.readString(),this._classId=t.readInt(),this._productCode=t.readString(),this._placedItemId=t.readInt(),this._placedItemType=t.readString(),this._placedInRoom=t.readBoolean(),this._petFigureString=t.readString(),!0)}get itemType(){return this._itemType}get classId(){return this._classId}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedItemType(){return this._placedItemType}get placedInRoom(){return this._placedInRoom}get petFigureString(){return this._petFigureString}}class Ma{constructor(){this._pet=void 0,this._boughtAsGift=void 0}flush(){return this._pet=null,this._boughtAsGift=!1,!0}parse(t){return this._pet=new ir(t),this._boughtAsGift=t.readBoolean(),!0}get pet(){return this._pet}get boughtAsGift(){return this._boughtAsGift}}class ya{constructor(){this._state=void 0,this._ownPetId=void 0,this._otherPetId=void 0}flush(){return this._state=0,this._ownPetId=0,this._otherPetId=0,!0}parse(t){return!!t&&(this._state=t.readInt(),this._ownPetId=t.readInt(),this._otherPetId=t.readInt(),!0)}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}}ya.STATE_CANCEL=1,ya.STATE_ACCEPT=2,ya.STATE_REQUEST=3;class Da{constructor(){this._totalFragments=void 0,this._fragmentNumber=void 0,this._fragment=void 0}flush(){return this._fragment=null,!0}parse(t){this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(this._fragment=new Map;e>0;){const s=new ir(t);this._fragment.set(s.id,s),e--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class Ca{constructor(){this._boughtAsGift=void 0,this._pet=void 0}flush(){return this._boughtAsGift=!1,this._pet=null,!0}parse(t){return this._boughtAsGift=t.readBoolean(),this._pet=new ir(t),!0}get boughtAsGift(){return this._boughtAsGift}get pet(){return this._pet}}class La{constructor(){this._petId=void 0}flush(){return!0}parse(t){return!!t&&(this._petId=t.readInt(),!0)}get petId(){return this._petId}}class Ua{constructor(){this._userID=void 0,this._userAccepts=void 0}flush(){return this._userID=-1,this._userAccepts=!1,!0}parse(t){return!!t&&(this._userID=t.readInt(),this._userAccepts=t.readInt()>0,!0)}get userID(){return this._userID}get userAccepts(){return this._userAccepts}}class Pa{constructor(){this._userId=void 0,this._reason=void 0}flush(){return!0}parse(t){return!!t&&(this._userId=t.readInt(),this._reason=t.readInt(),!0)}get userID(){return this._userId}get reason(){return this._reason}}Pa.ERROR_WHILE_COMMIT=1;class ba{flush(){return!0}parse(t){return!!t}}class wa{flush(){return!0}parse(t){return!!t}}class Fa{constructor(t){this._expirationTimeStamp=void 0,this._isWallItem=void 0,this._itemId=void 0,this._furniType=void 0,this._ref=void 0,this._spriteId=void 0,this._category=void 0,this._stuffData=void 0,this._extra=void 0,this._secondsToExpiration=void 0,this._creationDay=void 0,this._creationMonth=void 0,this._creationYear=void 0,this._isGroupable=void 0,this._songId=void 0,this._flatId=void 0,this._rentable=void 0,this._hasRentPeriodStarted=void 0,this._itemId=t.readInt(),this._furniType=t.readString().toUpperCase(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._isGroupable=t.readBoolean(),this._stuffData=Ta.parseObjectData(t),this._secondsToExpiration=-1,this._expirationTimeStamp=SU.instance.time,this._hasRentPeriodStarted=!1,this._creationDay=t.readInt(),this._creationMonth=t.readInt(),this._creationYear=t.readInt(),this._extra="S"===this.furniType?t.readInt():-1,this._flatId=-1,this._rentable=!1,this._isWallItem="I"===this._furniType}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get secondsToExpiration(){return this._secondsToExpiration}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get isGroupable(){return this._isGroupable}get songId(){return this._extra}get flatId(){return this._flatId}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get isRecycleable(){return!0}get tradable(){return!0}get sellable(){return!0}get slotId(){return null}get isExternalImageFurni(){return-1!==this._furniType.indexOf("external_image")}}class xa{constructor(){this._firstUserID=void 0,this._firstUserItemArray=void 0,this._firstUserNumItems=void 0,this._firstUserNumCredits=void 0,this._secondUserID=void 0,this._secondUserItemArray=void 0,this._secondUserNumItems=void 0,this._secondUserNumCredits=void 0}flush(){return this._firstUserID=-1,this._firstUserItemArray=null,this._firstUserNumItems=0,this._firstUserNumCredits=0,this._secondUserID=-1,this._secondUserItemArray=null,this._secondUserNumItems=0,this._secondUserNumCredits=0,!0}parse(t){return!!t&&(this._firstUserID=t.readInt(),this._firstUserItemArray=[],!!this.parseItems(t,this._firstUserItemArray)&&(this._firstUserNumItems=t.readInt(),this._firstUserNumCredits=t.readInt(),this._secondUserID=t.readInt(),this._secondUserItemArray=[],!!this.parseItems(t,this._secondUserItemArray)&&(this._secondUserNumItems=t.readInt(),this._secondUserNumCredits=t.readInt(),!0)))}parseItems(t,e){let s=t.readInt();for(;s>0;)e.push(new Fa(t)),s--;return!0}get firstUserID(){return this._firstUserID}get firstUserItemArray(){return this._firstUserItemArray}get firstUserNumItems(){return this._firstUserNumItems}get firstUserNumCredits(){return this._firstUserNumCredits}get secondUserID(){return this._secondUserID}get secondUserItemArray(){return this._secondUserItemArray}get secondUserNumItems(){return this._secondUserNumItems}get secondUserNumCredits(){return this._secondUserNumCredits}}class Ba{flush(){return!0}parse(t){return!!t}}class Ga{constructor(){this._reason=void 0,this._otherUserName=void 0}flush(){return!0}parse(t){return!!t&&(this._reason=t.readInt(),this._otherUserName=t.readString(),!0)}get reason(){return this._reason}get otherUserName(){return this._otherUserName}}Ga.REASON_YOU_ARE_ALREADY_TRADING=7,Ga.REASON_OTHER_USER_ALREADY_TRADING=8;class Ha{constructor(){this._userId=void 0,this._userCanTrade=void 0,this._otherUserId=void 0,this._otherUserCanTrade=void 0}flush(){return this._userId=-1,this._userCanTrade=!1,this._otherUserId=-1,this._otherUserCanTrade=!1,!0}parse(t){return!!t&&(this._userId=t.readInt(),this._userCanTrade=1===t.readInt(),this._otherUserId=t.readInt(),this._otherUserCanTrade=1===t.readInt(),!0)}get userID(){return this._userId}get userCanTrade(){return this._userCanTrade}get otherUserID(){return this._otherUserId}get otherUserCanTrade(){return this._otherUserCanTrade}}class Va{flush(){return!0}parse(t){return!!t}}class ja{flush(){return!0}parse(t){return!!t}}class ka{constructor(t){this._id=void 0,this._title=void 0,this._bodyText=void 0,this._buttonText=void 0,this._linkType=void 0,this._linkContent=void 0,this._imageUrl=void 0,this._id=t.readInt(),this._title=t.readString(),this._bodyText=t.readString(),this._buttonText=t.readString(),this._linkType=t.readInt(),this._linkContent=t.readString(),this._imageUrl=t.readString()}get id(){return this._id}get title(){return this._title}get bodyText(){return this._bodyText}get buttonText(){return this._buttonText}get linkType(){return this._linkType}get linkContent(){return this._linkContent}get imageUrl(){return this._imageUrl}}ka.LINK_TYPE_URL=0,ka.LINK_TYPE_INTERNAL=1,ka.LINK_TYPE_NO_LINK=2;class Ya{constructor(){this._articles=void 0}flush(){return this._articles=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._articles.push(new ka(t));return!0}get articles(){return this._articles}}class za{constructor(){this._acknowledged=void 0}flush(){return!0}parse(t){return!!t&&(this._acknowledged=t.readBoolean(),!0)}get acknowledged(){return this._acknowledged}}class Wa{constructor(){this._result=void 0,this._newOfferId=void 0,this._newPrice=void 0,this._requestedOfferId=void 0}flush(){return this._newOfferId=-1,this._newPrice=0,this._requestedOfferId=-1,!0}parse(t){return!!t&&(this._result=t.readInt(),this._newOfferId=t.readInt(),this._newPrice=t.readInt(),this._requestedOfferId=t.readInt(),!0)}get result(){return this._result}get offerId(){return this._newOfferId}get newPrice(){return this._newPrice}get requestedOfferId(){return this._requestedOfferId}}class Ka{constructor(){this._offerId=void 0,this._success=void 0}flush(){return this._offerId=0,this._success=!1,!0}parse(t){return!!t&&(this._offerId=t.readInt(),this._success=t.readBoolean(),!0)}get offerId(){return this._offerId}get success(){return this._success}}class Xa{constructor(){this._tokenCount=void 0,this._result=void 0}flush(){return this._tokenCount=0,this._result=0,!0}parse(t){return!!t&&(this._result=t.readInt(),this._tokenCount=t.readInt(),!0)}get tokenCount(){return this._tokenCount}get resultCode(){return this._result}}class qa{constructor(){this._enabled=void 0,this._commission=void 0,this._credits=void 0,this._advertisements=void 0,this._maximumPrice=void 0,this._minimumPrice=void 0,this._offerTime=void 0,this._displayTime=void 0}flush(){return this._enabled=!1,this._commission=0,this._credits=0,this._advertisements=0,this._maximumPrice=0,this._minimumPrice=0,this._offerTime=0,this._displayTime=0,!0}parse(t){return!!t&&(this._enabled=t.readBoolean(),this._commission=t.readInt(),this._credits=t.readInt(),this._advertisements=t.readInt(),this._minimumPrice=t.readInt(),this._maximumPrice=t.readInt(),this._offerTime=t.readInt(),this._displayTime=t.readInt(),!0)}get enabled(){return this._enabled}get commission(){return this._commission}get credits(){return this._credits}get advertisements(){return this._advertisements}get minimumPrice(){return this._minimumPrice}get maximumPrice(){return this._maximumPrice}get offerTime(){return this._offerTime}get displayTime(){return this._displayTime}}class Qa{constructor(){this._result=void 0}flush(){return this._result=0,!0}parse(t){return!!t&&(this._result=t.readInt(),!0)}get result(){return this._result}}class Za{constructor(){this._averagePrice=void 0,this._currentOfferCount=void 0,this._historyLength=void 0,this._dayOffsets=void 0,this._averagePrices=void 0,this._soldAmounts=void 0,this._furniTypeId=void 0,this._furniCategoryId=void 0}flush(){return this._averagePrice=0,this._currentOfferCount=0,this._historyLength=0,this._dayOffsets=[],this._averagePrices=[],this._soldAmounts=[],this._furniTypeId=0,this._furniCategoryId=0,!0}parse(t){if(!t)return!1;this._averagePrice=t.readInt(),this._currentOfferCount=t.readInt(),this._historyLength=t.readInt();let e=t.readInt();for(;e>0;)this._dayOffsets.push(t.readInt()),this._averagePrices.push(t.readInt()),this._soldAmounts.push(t.readInt()),e--;return this._furniCategoryId=t.readInt(),this._furniTypeId=t.readInt(),!0}get averagePrice(){return this._averagePrice}get offerCount(){return this._currentOfferCount}get historyLength(){return this._historyLength}get dayOffsets(){return this._dayOffsets}get averagePrices(){return this._averagePrices}get soldAmounts(){return this._soldAmounts}get furniTypeId(){return this._furniTypeId}get furniCategoryId(){return this._furniCategoryId}}class Ja{constructor(t,e,s,i,r,n,a,o){let h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1;this._offerId=void 0,this._furniId=void 0,this._furniType=void 0,this._extraData=void 0,this._stuffData=void 0,this._price=void 0,this._averagePrice=void 0,this._imageCallback=void 0,this._status=void 0,this._timeLeftMinutes=-1,this._offerCount=void 0,this._image=void 0,this._offerId=t,this._furniId=e,this._furniType=s,this._extraData=i,this._stuffData=r,this._price=n,this._status=a,this._averagePrice=o,this._offerCount=h}get offerId(){return this._offerId}set offerId(t){this._offerId=t}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(t){this._price=t}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(t){this._image=t}get imageCallback(){return this._imageCallback}set imageCallback(t){this._imageCallback=t}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(t){this._timeLeftMinutes=t}get offerCount(){return this._offerCount}set offerCount(t){this._offerCount=t}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}}Ja.TYPE_LANDSCAPE=1,Ja.TYPE_FLOOR=2;class $a{constructor(t,e,s,i,r,n,a,o,h){let _=arguments.length>9&&void 0!==arguments[9]?arguments[9]:-1;this._offerId=void 0,this._furniId=void 0,this._furniType=void 0,this._extraData=void 0,this._stuffData=void 0,this._price=void 0,this._status=void 0,this._timeLeftMinutes=-1,this._averagePrice=void 0,this._offerCount=void 0,this._offerId=t,this._furniId=e,this._furniType=s,this._extraData=i,this._stuffData=r,this._price=n,this._status=a,this._timeLeftMinutes=o,this._averagePrice=h,this._offerCount=_}get offerId(){return this._offerId}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}get averagePrice(){return this._averagePrice}get offerCount(){return this._offerCount}get isUniqueLimitedItem(){return!(null==this.stuffData)&&this.stuffData.uniqueSeries>0}}class to{constructor(){this.MAX_LIST_LENGTH=500,this._offers=void 0,this._totalItemsFound=void 0}flush(){return this._offers=[],this._totalItemsFound=0,!0}parse(t){if(!t)return!1;const e=t.readInt();let s=0;for(;s<e;){const e=t.readInt(),i=t.readInt();let r=t.readInt(),n=-1,a="",o=null;r===to.FURNITYPE_STUFF?(n=t.readInt(),o=Ta.parseObjectData(t)):r===to.FURNITYPE_WALL?(n=t.readInt(),a=t.readString()):r==to.FAKE_FURNITYPE_UNIQUE&&(n=t.readInt(),o=Ia.getData(la.FORMAT_KEY),o.uniqueNumber=t.readInt(),o.uniqueSeries=t.readInt(),r=to.FURNITYPE_STUFF);const h=t.readInt(),_=t.readInt(),d=t.readInt(),u=t.readInt(),c=new $a(e,n,r,a,o,h,i,_,d,u);s<this.MAX_LIST_LENGTH&&this._offers.push(c),s++}return this._totalItemsFound=t.readInt(),!0}get offers(){return this._offers}get totalItemsFound(){return this._totalItemsFound}}to.FURNITYPE_STUFF=1,to.FURNITYPE_WALL=2,to.FAKE_FURNITYPE_UNIQUE=3;class eo{constructor(){this._offers=void 0,this._creditsWaiting=void 0}flush(){return this._offers=[],!0}parse(t){if(!t)return!1;this._offers=[],this._creditsWaiting=t.readInt();const e=t.readInt();for(let s=0;s<e;s++){const e=t.readInt(),i=t.readInt();let r,n,a,o=t.readInt();1==o?(r=t.readInt(),a=this.getStuffData(t)):2==o?(r=t.readInt(),n=t.readString()):3==o&&(r=t.readInt(),a=Ia.getData(la.FORMAT_KEY),a.uniqueNumber=t.readInt(),a.uniqueSeries=t.readInt(),o=1);const h=t.readInt(),_=t.readInt(),d=t.readInt(),u=new $a(e,r,o,n,a,h,i,_,d);s<eo.MAX_LIST_LENGTH&&this._offers.push(u)}return!0}get offers(){return this._offers}get creditsWaiting(){return this._creditsWaiting}getStuffData(t){const e=t.readInt(),s=Ia.getData(e);return s.parseWrapper(t),s}}eo.MAX_LIST_LENGTH=500;class so{constructor(t,e,s,i,r){this._timestamp=void 0,this._habboId=void 0,this._username=void 0,this._message=void 0,this._hasHighlighting=void 0,this._timestamp=t,this._habboId=e,this._username=s,this._message=i,this._hasHighlighting=r}get timestamp(){return this._timestamp}get userId(){return this._habboId}get userName(){return this._username}get message(){return this._message}get hasHighlighting(){return this._hasHighlighting}}class io{constructor(t){this._recordType=void 0,this._context=void 0,this._chatlog=void 0,this._context=new Map,this._chatlog=[],this._recordType=t.readByte();const e=t.readShort();for(let i=0;i<e;i++){const e=t.readString(),s=t.readByte();switch(s){case 0:this._context.set(e,t.readBoolean());break;case 1:this._context.set(e,t.readInt());break;case 2:this._context.set(e,t.readString());break;default:throw new Error("Unknown data type "+s)}}const s=t.readShort();for(let i=0;i<s;i++){const e=t.readString(),s=t.readInt(),i=t.readString(),r=t.readString(),n=t.readBoolean();this._chatlog.push(new so(e,s,i,r,n))}}get recordType(){return this._recordType}get context(){return this._context}get chatlog(){return this._chatlog}get roomId(){return this.getInt("roomId")}get roomName(){return this._context.get("roomName")}get groupId(){return this.getInt("groupId")}get threadId(){return this.getInt("threadId")}get messageId(){return this.getInt("messageId")}getInt(t){const e=this._context.get(t);return e||0}}io.TYPE_SIMPLE=0,io.TYPE_ROOM_CHAT=1,io.TYPE_IM_SESSION=2,io.TYPE_DISCUSSION_THREAD=3,io.TYPE_DISCUSSION_MESSAGE=4,io.TYPE_SELFIE=5,io.TYPE_PHOTO=6;class ro{constructor(t){this._issueId=void 0,this._callerUserId=void 0,this._reportedUserId=void 0,this._chatRecordId=void 0,this._chatRecord=void 0,this._issueId=t.readInt(),this._callerUserId=t.readInt(),this._reportedUserId=t.readInt(),this._chatRecordId=t.readInt(),this._chatRecord=new io(t)}get issueId(){return this._issueId}get callerUserId(){return this._callerUserId}get reportedUserId(){return this._reportedUserId}get chatRecordId(){return this._chatRecordId}get chatRecord(){return this._chatRecord}}class no{constructor(){this._data=void 0}flush(){return this._data=null,!0}parse(t){return!!t&&(this._data=new ro(t),!0)}get data(){return this._data}}class ao{constructor(){this._issueId=void 0}flush(){return!0}parse(t){return this._issueId=parseInt(t.readString()),!0}get issueId(){return this._issueId}}class oo{constructor(t,e,s,i,r,n,a,o,h,_,d,u,c,l,g,E){this._issueId=void 0,this._state=void 0,this._categoryId=void 0,this._reportedCategoryId=void 0,this._issueAgeInMilliseconds=void 0,this._priority=void 0,this._groupingId=void 0,this._reporterUserId=void 0,this._reporterUserName=void 0,this._reportedUserId=void 0,this._reportedUserName=void 0,this._pickerUserId=void 0,this._pickerUserName=void 0,this._message=void 0,this._chatRecordId=void 0,this._patterns=void 0,this._disposed=!1,this._creationTimeInMilliseconds=void 0,this._issueId=t,this._state=e,this._categoryId=s,this._reportedCategoryId=i,this._issueAgeInMilliseconds=r,this._priority=n,this._groupingId=a,this._reporterUserId=o,this._reporterUserName=h,this._reportedUserId=_,this._reportedUserName=d,this._pickerUserId=u,this._pickerUserName=c,this._message=l,this._chatRecordId=g,this._patterns=E,this._creationTimeInMilliseconds=SU.instance.time}get issueId(){return this._issueId}get state(){return this._state}get categoryId(){return this._categoryId}get reportedCategoryId(){return this._reportedCategoryId}get issueAgeInMilliseconds(){return this._issueAgeInMilliseconds}get priority(){return this._priority}get groupingId(){return this._groupingId}get reporterUserId(){return this._reporterUserId}get reporterUserName(){return this._reporterUserName}get reportedUserId(){return this._reportedUserId}get reportedUserName(){return this._reportedUserName}get pickerUserId(){return this._pickerUserId}get pickerUserName(){return this._pickerUserName}get message(){return this._message}get chatRecordId(){return this._chatRecordId}get patterns(){return this._patterns}dispose(){if(!this.disposed){for(const t of this._patterns)t.dispose();this._patterns=[],this._disposed=!0}}get disposed(){return this._disposed}getOpenTime(t){const e=(this._issueAgeInMilliseconds+t-this._creationTimeInMilliseconds)/1e3/60,s=e%60,i=e/60;return(i<10?"0":"")+i+":"+((s<10?"0":"")+s)}}oo.STATE_OPEN=1,oo.STATE_PICKED=2,oo.STATE_CLOSED=3;class ho{constructor(t){this._pattern=void 0,this._startIndex=void 0,this._endIndex=void 0,this._disposed=!1,this._pattern=t.readString(),this._startIndex=t.readInt(),this._endIndex=t.readInt()}dispose(){this._disposed=!0,this._pattern="",this._startIndex=-1,this._endIndex=-1}get disposed(){return this._disposed}get pattern(){return this._pattern}get startIndex(){return this._startIndex}get endIndex(){return this._endIndex}}class _o{constructor(){this._issueData=void 0}get issueData(){return this._issueData}flush(){return this._issueData=null,!0}parse(t){const e=t.readInt(),s=t.readInt(),i=t.readInt(),r=t.readInt(),n=t.readInt(),a=t.readInt(),o=t.readInt(),h=t.readInt(),_=t.readString(),d=t.readInt(),u=t.readString(),c=t.readInt(),l=t.readString(),g=t.readString(),E=t.readInt(),p=t.readInt(),m=[];for(let I=0;I<p;I++)m.push(new ho(t));return this._issueData=new oo(e,s,i,r,n,a,o,h,_,d,u,c,l,g,E,m),!0}}class uo{constructor(){this._issues=void 0,this._retryEnabled=void 0,this._retryCount=void 0}flush(){return this._issues=null,!0}parse(t){this._issues=[];const e=t.readInt();for(let s=0;s<e;s++){const e=t.readInt(),s=t.readInt(),i=t.readString(),r=new oo(e,0,0,0,0,0,0,0,null,0,null,s,i,null,0,[]);this._issues.push(r)}return this._retryEnabled=t.readBoolean(),this._retryCount=t.readInt(),!0}get issues(){return this._issues}get retryEnabled(){return this._retryEnabled}get retryCount(){return this._retryCount}}class co{constructor(){this._message=void 0,this._url=void 0}flush(){return this._message="",this._url=null,!0}parse(t){return!!t&&(this._message=t.readString(),this._url=t.readString(),!0)}get message(){return this._message}get url(){return this._url}}class lo{constructor(){this._userId=void 0,this._success=void 0}flush(){return this._userId=-1,this._success=!1,!0}parse(t){return this._userId=t.readInt(),this._success=t.readBoolean(),!0}get userId(){return this._userId}get success(){return this._success}}class go{constructor(t){this._messageTemplates=void 0,this._roomMessageTemplates=void 0,this._issues=void 0,this._cfhPermission=void 0,this._chatlogsPermission=void 0,this._alertPermission=void 0,this._kickPermission=void 0,this._banPermission=void 0,this._roomAlertPermission=void 0,this._roomKickPermission=void 0,this._disposed=!1;const e=new _o;this._issues=[],this._messageTemplates=[],this._roomMessageTemplates=[];let s=t.readInt(),i=0;for(;i<s;)e.parse(t)&&this._issues.push(e.issueData),i++;for(s=t.readInt(),i=0;i<s;)this._messageTemplates.push(t.readString()),i++;for(s=t.readInt(),i=0;i<s;)t.readString(),i++;for(this._cfhPermission=t.readBoolean(),this._chatlogsPermission=t.readBoolean(),this._alertPermission=t.readBoolean(),this._kickPermission=t.readBoolean(),this._banPermission=t.readBoolean(),this._roomAlertPermission=t.readBoolean(),this._roomKickPermission=t.readBoolean(),s=t.readInt(),i=0;i<s;)this._roomMessageTemplates.push(t.readString()),i++}dispose(){this._disposed||(this._disposed=!0,this._messageTemplates=null,this._roomMessageTemplates=null,this._issues=null)}get disposed(){return this._disposed}get messageTemplates(){return this._messageTemplates}get roomMessageTemplates(){return this._roomMessageTemplates}get issues(){return this._issues}get cfhPermission(){return this._cfhPermission}get chatlogsPermission(){return this._chatlogsPermission}get alertPermission(){return this._alertPermission}get kickPermission(){return this._kickPermission}get banPermission(){return this._banPermission}get roomAlertPermission(){return this._roomAlertPermission}get roomKickPermission(){return this._roomKickPermission}}class Eo{constructor(){this._data=null}flush(){return this._data=null,!0}parse(t){return this._data=new go(t),!0}get data(){return this._data}}class po{constructor(){this._message=void 0,this._url=void 0}flush(){return this._message="",this._url="",!0}parse(t){return!!t&&(this._message=t.readString(),this._url=t.readString(),!0)}get message(){return this._message}get url(){return this._url}}class mo{constructor(t){if(this._exists=void 0,this._name=void 0,this._desc=void 0,this._tags=void 0,this._disposed=void 0,this._tags=[],this._exists=t.readBoolean(),!this.exists)return;this._name=t.readString(),this._desc=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._tags.push(t.readString())}get name(){return this._name}get desc(){return this._desc}get tags(){return this._tags}get exists(){return this._exists}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._tags=null)}}class Io{constructor(t){this._flatId=void 0,this._userCount=void 0,this._ownerInRoom=void 0,this._ownerId=void 0,this._ownerName=void 0,this._room=void 0,this._disposed=void 0,this._flatId=t.readInt(),this._userCount=t.readInt(),this._ownerInRoom=t.readBoolean(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._room=new mo(t)}get flatId(){return this._flatId}get userCount(){return this._userCount}get ownerInRoom(){return this._ownerInRoom}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get room(){return this._room}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,null!=this._room&&(this._room.dispose(),this._room=null))}}class To{constructor(){this._data=void 0}flush(){return this._data=null,!0}parse(t){return!!t&&(this._data=new Io(t),!0)}get data(){return this._data}}class Ro{constructor(){this._windowX=void 0,this._windowY=void 0,this._windowWidth=void 0,this._windowHeight=void 0}flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,!0}parse(t){return this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),!0}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}}class fo{constructor(t){this._userId=void 0,this._userName=void 0,this._registrationAgeInMinutes=void 0,this._minutesSinceLastLogin=void 0,this._online=void 0,this._cfhCount=void 0,this._abusiveCfhCount=void 0,this._cautionCount=void 0,this._banCount=void 0,this._tradingLockCount=void 0,this._tradingExpiryDate=void 0,this._lastPurchaseDate=void 0,this._identityId=void 0,this._identityRelatedBanCount=void 0,this._primaryEmailAddress=void 0,this._figure=void 0,this._userClassification=void 0,this._lastSanctionTime="",this._sanctionAgeHours=0,this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._registrationAgeInMinutes=t.readInt(),this._minutesSinceLastLogin=t.readInt(),this._online=t.readBoolean(),this._cfhCount=t.readInt(),this._abusiveCfhCount=t.readInt(),this._cautionCount=t.readInt(),this._banCount=t.readInt(),this._tradingLockCount=t.readInt(),this._tradingExpiryDate=t.readString(),this._lastPurchaseDate=t.readString(),this._identityId=t.readInt(),this._identityRelatedBanCount=t.readInt(),this._primaryEmailAddress=t.readString(),this._userClassification=t.readString(),t.bytesAvailable&&(this._lastSanctionTime=t.readString(),this._sanctionAgeHours=t.readInt())}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get registrationAgeInMinutes(){return this._registrationAgeInMinutes}get minutesSinceLastLogin(){return this._minutesSinceLastLogin}get online(){return this._online}get cfhCount(){return this._cfhCount}get abusiveCfhCount(){return this._abusiveCfhCount}get cautionCount(){return this._cautionCount}get banCount(){return this._banCount}get tradingLockCount(){return this._tradingLockCount}get tradingExpiryDate(){return this._tradingExpiryDate}get lastPurchaseDate(){return this._lastPurchaseDate}get identityId(){return this._identityId}get identityRelatedBanCount(){return this._identityRelatedBanCount}get primaryEmailAddress(){return this._primaryEmailAddress}get userClassification(){return this._userClassification}get lastSanctionTime(){return this._lastSanctionTime}get sanctionAgeHours(){return this._sanctionAgeHours}}class Oo{constructor(){this._data=void 0}flush(){return this._data=null,!0}parse(t){return!!t&&(this._data=new fo(t),!0)}get data(){return this._data}}class vo{constructor(){this._data=void 0}flush(){return this._data=null,!0}parse(t){return!!t&&(this._data=new io(t),!0)}get data(){return this._data}}class Ao{constructor(t){this._roomId=void 0,this._roomName=void 0,this._enterHour=void 0,this._enterMinute=void 0,this._roomId=t.readInt(),this._roomName=t.readString(),this._enterHour=t.readInt(),this._enterMinute=t.readInt()}get roomId(){return this._roomId}get roomName(){return this._roomName}get enterHour(){return this._enterHour}get enterMinute(){return this._enterMinute}}class So{constructor(t){this._userId=void 0,this._userName=void 0,this._rooms=void 0,this._rooms=[],this._userId=t.readInt(),this._userName=t.readString();const e=t.readInt();let s=0;for(;s<e;)this._rooms.push(new Ao(t)),s++}get userId(){return this._userId}get userName(){return this._userName}get rooms(){return this._rooms}}class No{constructor(){this._data=void 0}flush(){return!0}parse(t){return this._data=new So(t),!0}get data(){return this._data}}class Mo{constructor(){this._message=void 0}flush(){return this._message="",!0}parse(t){return!!t&&(this._message=t.readString(),!0)}get message(){return this._message}}class yo{constructor(t){this._userId=void 0,this._username=void 0,this._roomChatlogs=[],this._userId=t.readInt(),this._username=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._roomChatlogs.push(new io(t))}get userId(){return this._userId}get username(){return this._username}get roomChatlogs(){return this._roomChatlogs}}class Do{constructor(){this._data=void 0}flush(){return this._data=null,!0}parse(t){return!!t&&(this._data=new yo(t),!0)}get data(){return this._data}}class Co{constructor(){this._boxColor=void 0,this._keyColor=void 0}flush(){return this._boxColor=null,this._keyColor=null,!0}parse(t){return!!t&&(this._boxColor=t.readString(),this._keyColor=t.readString(),!0)}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}}class Lo{constructor(){this._canCreate=void 0,this._errorCode=void 0}flush(){return this._canCreate=!1,this._errorCode=0,!0}parse(t){return!!t&&(this._canCreate=t.readBoolean(),this._errorCode=t.readInt(),!0)}get canCreate(){return this._canCreate}get errorCode(){return this._errorCode}}class Uo{constructor(){this._resultCode=void 0,this._roomLimit=void 0}flush(){return!0}parse(t){return!!t&&(this._resultCode=t.readInt(),this._roomLimit=t.readInt(),!0)}get resultCode(){return this._resultCode}get roomLimit(){return this._roomLimit}}Uo.CREATION_ALLOWED=0,Uo.ROOM_LIMIT_REACHED=1;class Po{constructor(t){this._categoryToCurrentUserCountMap=void 0,this._categoryToMaxUserCountMap=void 0,this._categoryToCurrentUserCountMap=new Map,this._categoryToMaxUserCountMap=new Map;const e=t.readInt();for(let s=0;s<e;s++){const e=t.readInt(),s=t.readInt(),i=t.readInt();this._categoryToCurrentUserCountMap.set(e,s),this._categoryToMaxUserCountMap.set(e,i)}}get categoryToCurrentUserCountMap(){return this._categoryToCurrentUserCountMap}get categoryToMaxUserCountMap(){return this._categoryToMaxUserCountMap}}class bo{constructor(){this._data=void 0}flush(){return!0}parse(t){return!!t&&(this._data=new Po(t),!0)}get data(){return this._data}}class wo{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._goalId=void 0,this._pageIndex=void 0,this._pageCount=void 0,this._goalId=e,this._pageIndex=s,t&&(this._goalId=t.readInt(),this._pageIndex=t.readInt(),this._pageCount=t.readInt())}get goalId(){return this._goalId}get pageIndex(){return this._pageIndex}get pageCount(){return this._pageCount}}class Fo{constructor(){this._data=void 0}flush(){return!0}parse(t){return!!t&&(this._data=new wo(t),!0)}get data(){return this._data}}class xo{constructor(){this._globalId=void 0,this._convertedId=void 0}flush(){return!0}parse(t){return!!t&&(this._globalId=t.readString(),this._convertedId=t.readInt(),!0)}get globalId(){return this._globalId}get convertedId(){return this._convertedId}}class Bo{constructor(){this._userName=void 0}flush(){return this._userName=null,!0}parse(t){return!!t&&(this._userName=t.readString(),!0)}get userName(){return this._userName}}class Go{constructor(){this._flatId=void 0,this._added=void 0}flush(){return!0}parse(t){return!!t&&(this._flatId=t.readInt(),this._added=t.readBoolean(),!0)}get flatId(){return this._flatId}get added(){return this._added}}class Ho{constructor(){this._limit=void 0,this._favouriteRoomIds=void 0}flush(){return!0}parse(t){if(!t)return!1;this._favouriteRoomIds=[],this._limit=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._favouriteRoomIds.push(t.readInt());return!0}get limit(){return this._limit}get favoriteRoomIds(){return this._favouriteRoomIds}}class Vo{constructor(){this._userName=void 0}flush(){return this._userName=null,!0}parse(t){return!!t&&(this._userName=t.readString(),!0)}get userName(){return this._userName}}class jo{constructor(){this._roomId=void 0,this._roomName=void 0}flush(){return this._roomId=-1,this._roomName=null,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._roomName=t.readString(),!0)}get roomId(){return this._roomId}get roomName(){return this._roomName}}class ko{constructor(t){if(this._mode=void 0,this._weight=void 0,this._speed=void 0,this._distance=void 0,this._protection=void 0,!t)throw new Error("invalid_wrapper");this._mode=t.readInt(),this._weight=t.readInt(),this._speed=t.readInt(),this._distance=t.readInt(),this._protection=t.readInt()}get mode(){return this._mode}get weight(){return this._weight}get speed(){return this._speed}get distance(){return this._distance}get protection(){return this._protection}}ko.CHAT_MODE_FREE_FLOW=0,ko.CHAT_MODE_LINE_BY_LINE=1,ko.CHAT_BUBBLE_WIDTH_WIDE=0,ko.CHAT_BUBBLE_WIDTH_NORMAL=1,ko.CHAT_BUBBLE_WIDTH_THIN=2,ko.CHAT_SCROLL_SPEED_FAST=0,ko.CHAT_SCROLL_SPEED_NORMAL=1,ko.CHAT_SCROLL_SPEED_SLOW=2,ko.FLOOD_FILTER_STRICT=0,ko.FLOOD_FILTER_NORMAL=1,ko.FLOOD_FILTER_LOOSE=2;class Yo{constructor(t){this._allowMute=void 0,this._allowKick=void 0,this._allowBan=void 0,this._allowMute=t.readInt(),this._allowKick=t.readInt(),this._allowBan=t.readInt()}get allowMute(){return this._allowMute}get allowKick(){return this._allowKick}get allowBan(){return this._allowBan}}Yo.MODERATION_LEVEL_NONE=0,Yo.MODERATION_LEVEL_USER_WITH_RIGHTS=1,Yo.MODERATION_LEVEL_ALL=2;class zo{constructor(t){if(this._roomId=void 0,this._roomName=void 0,this._showOwner=void 0,this._ownerId=void 0,this._ownerName=void 0,this._doorMode=void 0,this._userCount=void 0,this._maxUserCount=void 0,this._description=void 0,this._tradeMode=void 0,this._score=void 0,this._ranking=void 0,this._categoryId=void 0,this._totalStars=void 0,this._groupId=void 0,this._groupName=void 0,this._groupBadge=void 0,this._tags=void 0,this._bitMask=void 0,this._thumbnail=void 0,this._allowPets=void 0,this._displayAd=void 0,this._adName=void 0,this._adDescription=void 0,this._adExpiresIn=void 0,this._allInRoomMuted=void 0,this._canMute=void 0,this._officialRoomPicRef=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=0,this._roomName=null,this._ownerId=0,this._ownerName=null,this._doorMode=0,this._userCount=0,this._maxUserCount=0,this._description=null,this._tradeMode=2,this._score=0,this._ranking=0,this._categoryId=0,this._totalStars=0,this._groupId=0,this._groupName=null,this._groupBadge=null,this._tags=[],this._bitMask=0,this._thumbnail=null,this._allowPets=!1,this._showOwner=!0,this._displayAd=!1,this._adName=null,this._adDescription=null,this._adExpiresIn=0,this._allInRoomMuted=!1,this._canMute=!1,this._officialRoomPicRef=null,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._roomName=t.readString(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._doorMode=t.readInt(),this._userCount=t.readInt(),this._maxUserCount=t.readInt(),this._description=t.readString(),this._tradeMode=t.readInt(),this._score=t.readInt(),this._ranking=t.readInt(),this._categoryId=t.readInt(),this.parseTags(t),this.parseBitMask(t),!0)}parseTags(t){if(!t)return!1;this._tags=[];let e=t.readInt();for(;e>0;)this._tags.push(t.readString()),e--;return!0}parseBitMask(t){return!!t&&(this._bitMask=t.readInt(),this._bitMask&zo.THUMBNAIL_BITMASK&&(this._officialRoomPicRef=t.readString()),this._bitMask&zo.GROUPDATA_BITMASK&&(this._groupId=t.readInt(),this._groupName=t.readString(),this._groupBadge=t.readString()),this._bitMask&zo.ROOMAD_BITMASK&&(this._adName=t.readString(),this._adDescription=t.readString(),this._adExpiresIn=t.readInt()),this._showOwner=(this._bitMask&zo.SHOWOWNER_BITMASK)>0,this._allowPets=(this._bitMask&zo.ALLOW_PETS_BITMASK)>0,this._displayAd=(this._bitMask&zo.DISPLAY_ROOMAD_BITMASK)>0,this._thumbnail=null,!0)}get roomId(){return this._roomId}get roomName(){return this._roomName}set roomName(t){this._roomName=t}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get doorMode(){return this._doorMode}get userCount(){return this._userCount}get maxUserCount(){return this._maxUserCount}get description(){return this._description}get tradeMode(){return this._tradeMode}get score(){return this._score}get ranking(){return this._ranking}get categoryId(){return this._categoryId}get tags(){return this._tags}get officialRoomPicRef(){return this._officialRoomPicRef}get habboGroupId(){return this._groupId}get groupName(){return this._groupName}get groupBadgeCode(){return this._groupBadge}get roomAdName(){return this._adName}get roomAdDescription(){return this._adDescription}get roomAdExpiresInMin(){return this._adExpiresIn}get showOwner(){return this._showOwner}get allowPets(){return this._allowPets}get displayRoomEntryAd(){return this._displayAd}get canMute(){return this._canMute}set canMute(t){this._canMute=t}get allInRoomMuted(){return this._allInRoomMuted}set allInRoomMuted(t){this._allInRoomMuted=t}}zo.THUMBNAIL_BITMASK=1,zo.GROUPDATA_BITMASK=2,zo.ROOMAD_BITMASK=4,zo.SHOWOWNER_BITMASK=8,zo.ALLOW_PETS_BITMASK=16,zo.DISPLAY_ROOMAD_BITMASK=32,zo.OPEN_STATE=0,zo.DOORBELL_STATE=1,zo.PASSWORD_STATE=2,zo.INVISIBLE_STATE=3,zo.NOOB_STATE=4;class Wo{constructor(){this._roomEnter=void 0,this._roomForward=void 0,this._data=void 0,this._staffPick=void 0,this._isGroupMember=void 0,this._moderation=void 0,this._chat=void 0}flush(){return this._roomEnter=!1,this._roomForward=!1,this._data=null,this._staffPick=!1,this._isGroupMember=!1,this._moderation=null,this._chat=null,!0}parse(t){return!!t&&(this._roomEnter=t.readBoolean(),this._data=new zo(t),this._roomForward=t.readBoolean(),this._staffPick=t.readBoolean(),this._isGroupMember=t.readBoolean(),this.data.allInRoomMuted=t.readBoolean(),this._moderation=new Yo(t),this.data.canMute=t.readBoolean(),this._chat=new ko(t),!0)}get roomEnter(){return this._roomEnter}get roomForward(){return this._roomForward}get data(){return this._data}get staffPick(){return this._staffPick}get isGroupMember(){return this._isGroupMember}get moderation(){return this._moderation}get chat(){return this._chat}}class Ko{constructor(){this._reason=void 0,this._parameter=void 0}flush(){return this._reason=0,this._parameter="",!0}parse(t){return!!t&&(this._reason=t.readInt(),this._parameter=t.readString(),!0)}get reason(){return this._reason}get parameter(){return this._parameter}}Ko.REASON_FULL=1,Ko.REASON_CLOSED=2,Ko.REASON_QUEUE_ERROR=3,Ko.REASON_BANNED=4;class Xo{constructor(){this._userName=void 0}flush(){return this._userName=null,!0}parse(t){return!!t&&(this._userName=t.readString(),!0)}get userName(){return this._userName}}class qo{flush(){return!0}parse(t){return!!t}}class Qo{flush(){return!0}parse(t){return!!t}}class Zo{}Zo.NONE=0,Zo.GUEST=1,Zo.GUILD_MEMBER=2,Zo.GUILD_ADMIN=3,Zo.ROOM_OWNER=4,Zo.MODERATOR=5;class Jo{constructor(){this._controllerLevel=void 0}flush(){return this._controllerLevel=Zo.NONE,!0}parse(t){return!!t&&(this._controllerLevel=t.readInt(),!0)}get controllerLevel(){return this._controllerLevel}}class $o{flush(){return!0}parse(t){return!!t}}class th{constructor(){this._roomId=void 0}flush(){return this._roomId=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),!0)}get roomId(){return this._roomId}}class eh{constructor(){this._botId=void 0,this._commandId=void 0,this._data=void 0}flush(){return this._botId=-1,this._commandId=-1,this._data="",!0}parse(t){return!!t&&(this._botId=t.readInt(),this._commandId=t.readInt(),this._data=t.readString(),!0)}get botId(){return this._botId}get commandId(){return this._commandId}get data(){return this._data}}class sh{constructor(){this._chat=void 0}flush(){return this._chat=null,!0}parse(t){return!!t&&(this._chat=new ko(t),!0)}get chat(){return this._chat}}class ih{constructor(){this._roomId=void 0,this._isOwner=void 0}flush(){return this._roomId=0,this._isOwner=!1,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._isOwner=t.readBoolean(),!0)}get roomId(){return this._roomId}get isOwner(){return this._isOwner}}class rh{constructor(){this._totalLikes=void 0,this._canLike=void 0}flush(){return this._totalLikes=0,this._canLike=!1,!0}parse(t){return!!t&&(this._totalLikes=t.readInt(),this._canLike=t.readBoolean(),!0)}get totalLikes(){return this._totalLikes}get canLike(){return this._canLike}}class nh{constructor(){this._roomIndex=void 0,this._groupId=void 0,this._status=void 0,this._groupName=void 0}flush(){return this._roomIndex=-1,this._groupId=-1,this._status=0,this._groupName=null,!0}parse(t){return!!t&&(this._roomIndex=t.readInt(),this._groupId=t.readInt(),this._status=t.readInt(),this._groupName=t.readString(),!0)}get roomIndex(){return this._roomIndex}get groupId(){return this._groupId}get status(){return this._status}get groupName(){return this._groupName}}class ah{constructor(t,e,s){this._id=0,this._state=0,this._data=void 0,this._id=t,this._state=e,this._data=s}get id(){return this._id}get state(){return this._state}get data(){return this._data}}class oh{constructor(){this._objects=void 0}flush(){return this._objects=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=Ta.parseObjectData(t),r=parseFloat(i.getLegacyString());this._objects.push(new ah(s,r,i)),e--}return!0}get objects(){return this._objects}}class hh{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._id=void 0,this._location=void 0,this._targetLocation=void 0,this._movementType=void 0,this._id=t,this._location=e,this._targetLocation=s,this._movementType=i}get id(){return this._id}get location(){return this._location}get targetLocation(){return this._targetLocation}get movementType(){return this._movementType}}hh.MOVE="mv",hh.SLIDE="sld";class _h{constructor(){this._rollerId=void 0,this._itemsRolling=void 0,this._unitRolling=void 0}flush(){return this._rollerId=0,this._itemsRolling=[],this._unitRolling=null,!0}parse(t){if(!t)return!1;const e=t.readInt(),s=t.readInt(),i=t.readInt(),r=t.readInt();let n=t.readInt();for(;n>0;){const a=t.readInt(),o=parseFloat(t.readString()),h=parseFloat(t.readString()),_=new hh(a,new dt(e,s,o),new dt(i,r,h));this._itemsRolling.push(_),n--}if(this._rollerId=t.readInt(),!t.bytesAvailable)return!0;const a=t.readInt(),o=t.readInt(),h=parseFloat(t.readString()),_=parseFloat(t.readString());switch(a){case 0:break;case 1:this._unitRolling=new hh(o,new dt(e,s,h),new dt(i,r,_),hh.MOVE);break;case 2:this._unitRolling=new hh(o,new dt(e,s,h),new dt(i,r,_),hh.SLIDE)}return!0}get rollerId(){return this._rollerId}get itemsRolling(){return this._itemsRolling}get unitRolling(){return this._unitRolling}}class dh{constructor(){this._code=void 0}flush(){return this._code=0,!0}parse(t){return!!t&&(this._code=t.readInt(),!0)}get count(){return this._code}}class uh{constructor(){this._itemId=void 0,this._value=void 0}flush(){return this._itemId=0,this._value=0,!0}parse(t){return!!t&&(this._itemId=t.readInt(),this._value=t.readInt(),!0)}get itemId(){return this._itemId}get value(){return this._value}}class ch{constructor(t){if(this._itemId=void 0,this._spriteId=void 0,this._spriteName=void 0,this._x=void 0,this._y=void 0,this._direction=void 0,this._z=void 0,this._stackHeight=void 0,this._extra=void 0,this._data=void 0,this._state=void 0,this._expires=void 0,this._usagePolicy=void 0,this._userId=void 0,this._username=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._spriteName=null,this._x=0,this._y=0,this._direction=0,this._z=0,this._stackHeight=0,this._extra=0,this._data=null,this._state=0,this._expires=0,this._usagePolicy=0,this._userId=0,this._username=null,!0}parse(t){return!!t&&(this._itemId=t.readInt(),this._spriteId=t.readInt(),this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt()%8*45,this._z=parseFloat(t.readString()),this._stackHeight=parseFloat(t.readString()),this._extra=t.readInt(),this._data=Ta.parseObjectData(t),this._state=parseFloat(this._data&&this._data.getLegacyString())||0,this._expires=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null,this._spriteId<0&&(this._spriteName=t.readString()),!0)}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}get z(){return isNaN(this._z)?0:this._z}get stackHeight(){return isNaN(this._stackHeight)?0:this._stackHeight}get extra(){return this._extra}get data(){return this._data}get state(){return this._state}get expires(){return this._expires}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get spriteName(){return this._spriteName}set spriteName(t){this._spriteName=t}}class lh{constructor(){this._item=void 0}flush(){return this._item=null,!0}parse(t){return!!t&&(this._item=new ch(t),this._item.username=t.readString(),!0)}get item(){return this._item}}class gh{constructor(){this._owners=void 0,this._items=void 0}flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t)return!1;if(!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new ch(t);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class Eh{constructor(){this._itemId=void 0,this._isExpired=void 0,this._userId=void 0,this._delay=void 0}flush(){return this._itemId=0,this._isExpired=!0,this._userId=0,this._delay=0,!0}parse(t){return!!t&&(this._itemId=parseInt(t.readString()),this._isExpired=t.readBoolean(),this._userId=t.readInt(),this._delay=t.readInt(),!0)}get itemId(){return this._itemId}get isExpired(){return this._isExpired}get userId(){return this._userId}get delay(){return this._delay}}class ph{constructor(){this._item=void 0}flush(){return this._item=null,!0}parse(t){return!!t&&(this._item=new ch(t),!0)}get item(){return this._item}}class mh{constructor(){this._aliases=void 0}flush(){return this._aliases=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._aliases.set(t.readString(),t.readString()),e--;return!0}get aliases(){return this._aliases}}class Ih{constructor(){this._furniId=void 0,this._height=void 0}flush(){return this._furniId=-1,this._height=0,!0}parse(t){return!!t&&(this._furniId=t.readInt(),this._height=t.readInt()/100,!0)}get furniId(){return this._furniId}get height(){return this._height}}class Th{constructor(){this._objectId=void 0,this._guildId=void 0,this._guildName=void 0,this._guildHomeRoomId=void 0,this._userIsMember=void 0,this._guildHasReadableForum=void 0}flush(){return this._objectId=0,this._guildId=0,this._guildName=null,this._guildHomeRoomId=0,this._userIsMember=!1,this._guildHasReadableForum=!1,!0}parse(t){return!!t&&(this._objectId=t.readInt(),this._guildId=t.readInt(),this._guildName=t.readString(),this._guildHomeRoomId=t.readInt(),this._userIsMember=t.readBoolean(),this._guildHasReadableForum=t.readBoolean(),!0)}get objectId(){return this._objectId}get guildId(){return this._guildId}get guildName(){return this._guildName}get guildHomeRoomId(){return this._guildHomeRoomId}get userIsMember(){return this._userIsMember}get guildHasReadableForum(){return this._guildHasReadableForum}}class Rh{constructor(){this._itemId=void 0,this._data=void 0}flush(){return this._itemId=0,this._data="",!0}parse(t){return!!t&&(this._itemId=parseInt(t.readString()),this._data=t.readString(),!0)}get furnitureId(){return this._itemId}get data(){return this._data}}class fh{constructor(){this._furniId=void 0}get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class Oh{constructor(){this._furniId=void 0}get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class vh{constructor(){this._furniId=void 0,this._start=void 0}get furniId(){return this._furniId}get start(){return this._start}flush(){return this._furniId=-1,this._start=!1,!0}parse(t){return this._furniId=t.readInt(),this._start=t.readBoolean(),!0}}class Ah{constructor(){this._itemId=void 0,this._state=void 0}flush(){return this._itemId=0,this._state=0,!0}parse(t){return!!t&&(this._itemId=t.readInt(),this._state=t.readInt(),!0)}get itemId(){return this._itemId}get state(){return this._state}}class Sh{constructor(){this._itemId=void 0,this._location=void 0}flush(){return this._itemId=-1,this._location="",!0}parse(t){return!!t&&(this._itemId=t.readInt(),this._location=t.readString(),!0)}get itemId(){return this._itemId}get location(){return this._location}}class Nh{constructor(t,e,s,i){this.id=t,this.type=e,this.color=s,this.brightness=i}}class Mh{constructor(){this._selectedPresetId=void 0,this._presets=void 0,this._selectedPresetId=0,this._presets=[]}flush(){return this._presets=[],!0}parse(t){const e=t.readInt();this._selectedPresetId=t.readInt();for(let s=0;s<e;s++){const e=t.readInt(),s=t.readInt(),i=parseInt(t.readString().substr(1),16),r=t.readInt();this._presets.push(new Nh(e,s,i,r))}return!0}getPreset(t){return t<0||t>=this.presetCount?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}}class yh{constructor(t){if(this._itemId=void 0,this._spriteId=void 0,this._location=void 0,this._stuffData=void 0,this._state=void 0,this._secondsToExpiration=void 0,this._usagePolicy=void 0,this._userId=void 0,this._username=void 0,this._width=void 0,this._height=void 0,this._localX=void 0,this._localY=void 0,this._y=void 0,this._z=void 0,this._direction=void 0,this._isOldFormat=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._location=null,this._stuffData=null,this._state=0,this._secondsToExpiration=0,this._usagePolicy=-1,this._userId=0,this._username=null,this._width=0,this._height=0,this._localX=0,this._localY=0,this._y=0,this._z=0,this._direction=null,this._isOldFormat=!1,!0}parse(t){if(!t)return!1;this._itemId=parseInt(t.readString()),this._spriteId=t.readInt(),this._location=t.readString(),this._stuffData=t.readString(),this._secondsToExpiration=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null;const e=parseFloat(this._stuffData);if(isNaN(e)||(this._state=e),0===this._location.indexOf(":")){this._isOldFormat=!1;let t=this._location.split(" ");if(t.length>=3){let e=t[0],s=t[1];const i=t[2];if(e.length>3&&s.length>2&&(e=e.substr(3),s=s.substr(2),t=e.split(","),t.length>=2)){const e=parseInt(t[0]),r=parseInt(t[1]);if(t=s.split(","),t.length>=2){const s=parseInt(t[0]),n=parseInt(t[1]);this._width=e,this._height=r,this._localX=s,this._localY=n,this._direction=i}}}}else this._isOldFormat=!0;return!0}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get wallPosition(){return this._location}get stuffData(){return this._stuffData}get state(){return this._state}get secondsToExpiration(){return this._secondsToExpiration}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get width(){return this._width}get height(){return this._height}get localX(){return this._localX}get localY(){return this._localY}get direction(){return this._direction}get isOldFormat(){return this._isOldFormat}}class Dh{constructor(){this._item=void 0}flush(){return this._item=null,!0}parse(t){return!!t&&(this._item=new yh(t),this._item.username=t.readString(),!0)}get item(){return this._item}}class Ch{constructor(){this._owners=void 0,this._items=void 0}flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t)return!1;if(!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new yh(t);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class Lh{constructor(){this._itemId=void 0,this._userId=void 0}flush(){return this._itemId=0,this._userId=0,!0}parse(t){return!!t&&(this._itemId=parseInt(t.readString()),this._userId=t.readInt(),!0)}get itemId(){return this._itemId}get userId(){return this._userId}}class Uh{constructor(){this._item=void 0}flush(){return this._item=null,!0}parse(t){return!!t&&(this._item=new yh(t),this._item.username=t.readString(),!0)}get item(){return this._item}}class Ph{constructor(){this._furniId=void 0,this._commandId=void 0}parse(t){return this._furniId=t.readInt(),this._commandId=t.readInt(),!0}flush(){return this._furniId=-1,this._commandId=-1,!0}get furniId(){return this._furniId}get commandId(){return this._commandId}}class bh{constructor(t,e,s){this._video=void 0,this._title=void 0,this._description=void 0,this._video=t,this._title=e,this._description=s}get video(){return this._video}get title(){return this._title}get description(){return this._description}}class wh{constructor(){this._furniId=void 0,this._playlists=void 0,this._selectedPlaylistId=void 0}flush(){return this._furniId=-1,this._playlists=null,this._selectedPlaylistId=null,!0}parse(t){this._furniId=t.readInt();const e=t.readInt();this._playlists=[];for(let s=0;s<e;s++)this._playlists.push(new bh(t.readString(),t.readString(),t.readString()));return this._selectedPlaylistId=t.readString(),!0}get furniId(){return this._furniId}get playlists(){return this._playlists}get selectedPlaylistId(){return this._selectedPlaylistId}}class Fh{constructor(){this._furniId=void 0,this._videoId=void 0,this._startAtSeconds=void 0,this._endAtSeconds=void 0,this._state=void 0}flush(){return!0}parse(t){return this._furniId=t.readInt(),this._videoId=t.readString(),this._startAtSeconds=t.readInt(),this._endAtSeconds=t.readInt(),this._state=t.readInt(),!0}get furniId(){return this._furniId}get videoId(){return this._videoId}get state(){return this._state}get startAtSeconds(){return this._startAtSeconds}get endAtSeconds(){return this._endAtSeconds}}class xh{constructor(t,e,s,i){this._x=void 0,this._y=void 0,this._width=void 0,this._height=void 0,this._x=t,this._y=e,this._width=s,this._height=i}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}class Bh{constructor(){this._width=void 0,this._height=void 0,this._wallHeight=void 0,this._fixedWallsHeight=void 0,this._tileMap=void 0,this._holeMap=void 0,this._doors=void 0,this._dimensions=void 0,this._restrictsDragging=void 0,this._restrictsScaling=void 0,this._restrictedScale=void 0,this._width=0,this._height=0,this._wallHeight=0,this._fixedWallsHeight=0,this._tileMap=[],this._holeMap=[],this._doors=[],this._dimensions={minX:0,maxX:0,minY:0,maxY:0},this._restrictsDragging=!1,this._restrictedScale=1,this._restrictsScaling=!1}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}get wallHeight(){return this._wallHeight}set wallHeight(t){this._wallHeight=t}get fixedWallsHeight(){return this._fixedWallsHeight}set fixedWallsHeight(t){this._fixedWallsHeight=t}get tileMap(){return this._tileMap}get holeMap(){return this._holeMap}get doors(){return this._doors}get dimensions(){return this._dimensions}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}}class Gh{constructor(t,e,s,i){this._leftSideLoc=0,this._rightSideLoc=0,this._leftSideLength=0,this._rightSideLength=0,this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}class Hh{constructor(t,e,s,i,r){let n,a,o,h,_,d,u,c;if(this._type=0,this._loc=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._normalDirection=null,this._secondaryNormals=void 0,this._masks=void 0,this._secondaryNormals=[],this._masks=[],this._loc=new dt,this._loc.assign(e),this._leftSide=new dt,this._leftSide.assign(s),this._rightSide=new dt,this._rightSide.assign(i),this._type=t,null!=s&&null!=i&&(this._normal=dt.crossProduct(s,i),n=0,a=0,o=0,h=0,_=0,0!=this.normal.x||0!=this.normal.y?(h=this.normal.x,_=this.normal.y,n=360+Math.atan2(_,h)/Math.PI*180,n>=360&&(n-=360),h=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y),_=this.normal.z,a=360+Math.atan2(_,h)/Math.PI*180,a>=360&&(a-=360)):a=this.normal.z<0?90:270,this._normalDirection=new dt(n,a,0)),null!=r&&r.length>0)for(d=0;d<r.length;)u=r[d],null!=u&&u.length>0&&(c=new dt,c.assign(u),c.multiply(1/c.length),this._secondaryNormals.push(c)),d++}get type(){return this._type}get loc(){return this._loc}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get normal(){return this._normal}get normalDirection(){return this._normalDirection}get secondaryNormalCount(){return this._secondaryNormals.length}get maskCount(){return this._masks.length}getSecondaryNormal(t){if(t<0||t>=this.secondaryNormalCount)return null;const e=new dt;return e.assign(this._secondaryNormals[t]),e}addMask(t,e,s,i){const r=new Gh(t,e,s,i);this._masks.push(r)}getMask(t){return t<0||t>=this.maskCount?null:this._masks[t]}getMaskLeftSideLoc(t){const e=this.getMask(t);return null!=e?e.leftSideLoc:-1}getMaskRightSideLoc(t){const e=this.getMask(t);return null!=e?e.rightSideLoc:-1}getMaskLeftSideLength(t){const e=this.getMask(t);return null!=e?e.leftSideLength:-1}getMaskRightSideLength(t){const e=this.getMask(t);return null!=e?e.rightSideLength:-1}}Hh.PLANE_UNDEFINED=0,Hh.PLANE_FLOOR=1,Hh.PLANE_WALL=2,Hh.PLANE_LANDSCAPE=3,Hh.PLANE_BILLBOARD=4;class Vh{constructor(){this._corners=void 0,this._endPoints=void 0,this._directions=void 0,this._lengths=void 0,this._leftTurns=void 0,this._borders=void 0,this._hideWalls=void 0,this._manuallyLeftCut=void 0,this._manuallyRightCut=void 0,this._addDuplicates=void 0,this._count=void 0,this._corners=[],this._endPoints=[],this._directions=[],this._lengths=[],this._leftTurns=[],this._borders=[],this._hideWalls=[],this._manuallyLeftCut=[],this._manuallyRightCut=[],this._addDuplicates=!1,this._count=0}addWall(t,e,s,i,r){(this._addDuplicates||this.checkIsNotDuplicate(t,e,s,i,r))&&(this._corners.push(t),this._directions.push(e),this._lengths.push(s),this._borders.push(i),this._leftTurns.push(r),this._hideWalls.push(!1),this._manuallyLeftCut.push(!1),this._manuallyRightCut.push(!1),this._count++)}checkIsNotDuplicate(t,e,s,i,r){let n=0;for(;n<this._count;){if(this._corners[n].x==t.x&&this._corners[n].y==t.y&&this._directions[n]==e&&this._lengths[n]==s&&this._borders[n]==i&&this._leftTurns[n]==r)return!1;n++}return!0}get count(){return this._count}getCorner(t){return this._corners[t]}getEndPoint(t){return this.calculateWallEndPoints(),this._endPoints[t]}getLength(t){return this._lengths[t]}getDirection(t){return this._directions[t]}getBorder(t){return this._borders[t]}getHideWall(t){return this._hideWalls[t]}getLeftTurn(t){return this._leftTurns[t]}getManuallyLeftCut(t){return this._manuallyLeftCut[t]}getManuallyRightCut(t){return this._manuallyRightCut[t]}setHideWall(t,e){this._hideWalls[t]=e}setLength(t,e){e<this._lengths[t]&&(this._lengths[t]=e,this._manuallyRightCut[t]=!0)}moveCorner(t,e){let s;if(e>0&&e<this._lengths[t]){const i=this._corners[t];s=Vh.WALL_DIRECTION_VECTORS[this.getDirection(t)],this._corners[t]=new j.g(i.x+e*s.x,i.y+e*s.y),this._lengths[t]=this._lengths[t]-e,this._manuallyLeftCut[t]=!0}}calculateWallEndPoints(){let t,e,s,i,r;if(this._endPoints.length!=this.count)for(this._endPoints=[],t=0;t<this.count;)e=this.getCorner(t),s=new j.g(e.x,e.y),i=Vh.WALL_DIRECTION_VECTORS[this.getDirection(t)],r=this.getLength(t),s.x=s.x+i.x*r,s.y=s.y+i.y*r,this._endPoints.push(s),t++}}Vh.WALL_DIRECTION_VECTORS=[new dt(1,0,0),new dt(0,1,0),new dt(-1,0,0),new dt(0,-1,0)],Vh.WALL_NORMAL_VECTORS=[new dt(0,1,0),new dt(-1,0,0),new dt(0,-1,0),new dt(1,0,0)];class jh{constructor(){this._tileMatrix=void 0,this._tileMatrixOriginal=void 0,this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._planes=void 0,this._wallHeight=void 0,this._wallThicknessMultiplier=void 0,this._floorThicknessMultiplier=void 0,this._fixedWallHeight=-1,this._floorHeight=0,this._floorHoles=void 0,this._floorHoleMatrix=void 0,this._restrictsDragging=void 0,this._restrictsScaling=!1,this._restrictedScale=1,this._tileMatrix=[],this._tileMatrixOriginal=[],this._planes=[],this._floorHoleMatrix=[],this._wallHeight=3.6,this._wallThicknessMultiplier=1,this._floorThicknessMultiplier=1,this._floorHoles=new Map}static getFloorHeight(t){const e=t.length;if(!e)return 0;let s=0,i=0;for(;i<e;){const e=t[i];let r=0;for(;r<e.length;){const t=e[r];t>s&&(s=t),r++}i++}return s}static findEntranceTile(t){if(!t)return null;const e=t.length;if(!e)return null;const s=[];let i=0;for(;i<e;){const e=t[i];if(!e||!e.length)return null;let r=0;for(;r<e.length;){if(e[r]>=0){s.push(r);break}r++}s.length<i+1&&s.push(e.length+1),i++}for(i=1;i<s.length-1;){if(Math.trunc(s[i])<=Math.trunc(s[i-1])-1&&Math.trunc(s[i])<=Math.trunc(s[i+1])-1)return new j.g(Math.trunc(0|s[i]),i);i++}return null}static expandFloorTiles(t){let e,s,i,r,n,a,o,h,_,d,u,c;const l=t.length,g=t[0].length,E=[];for(s=0;s<4*l;)E[s]=[],s++;let p=0;for(s=0;s<l;){for(n=0,e=0;e<g;){if(a=t[s][e],a<0||a<=255)for(r=0;r<4;){for(i=0;i<4;)void 0===E[p+r]&&(E[p+r]=[]),E[p+r][n+i]=a<0?a:4*a,i++;r++}else{for(o=4*(255&a),h=o+3*(a>>11&1),_=o+3*(a>>10&1),d=o+3*(a>>9&1),u=o+3*(a>>8&1),i=0;i<3;)c=i+1,E[p][n+i]=(h*(3-i)+_*i)/3,E[p+3][n+c]=(d*(3-c)+u*c)/3,E[p+c][n]=(h*(3-c)+d*c)/3,E[p+i][n+3]=(_*(3-i)+u*i)/3,i++;E[p+1][n+1]=h>o?o+2:o+1,E[p+1][n+2]=_>o?o+2:o+1,E[p+2][n+1]=d>o?o+2:o+1,E[p+2][n+2]=u>o?o+2:o+1}n+=4,e++}p+=4,s++}return E}static addTileTypes(t){let e,s,i,r,n,a,o,h,_,d,u,c,l,g;const E=t.length-1,p=t[0].length-1;for(s=1;s<E;){for(e=1;e<p;)i=t[s][e],i<0||(r=255&t[s-1][e-1],n=255&t[s-1][e],a=255&t[s-1][e+1],o=255&t[s][e-1],h=255&t[s][e+1],_=255&t[s+1][e-1],d=255&t[s+1][e],u=255&t[s+1][e+1],c=i+1,l=i-1,g=(r==c||n==c||o==c?8:0)|(a==c||n==c||h==c?4:0)|(_==c||d==c||o==c?2:0)|(u==c||d==c||h==c?1:0),15==g&&(g=0),t[s][e]=i|g<<8),e++;s++}}static unpadHeightMap(t){t.shift(),t.pop();for(const e of t)e.shift(),e.pop()}static padHeightMap(t){const e=[],s=[];for(const i of t)i.push(jh.TILE_BLOCKED),i.unshift(jh.TILE_BLOCKED);for(const i of t[0])e.push(jh.TILE_BLOCKED),s.push(jh.TILE_BLOCKED);t.push(s),t.unshift(e)}get minX(){return this._minX}get maxX(){return this._maxX}get minY(){return this._minY}get maxY(){return this._maxY}get tileMapWidth(){return this._width}get tileMapHeight(){return this._height}get planeCount(){return this._planes.length}get floorHeight(){return-1!=this._fixedWallHeight?this._fixedWallHeight:this._floorHeight}get wallHeight(){return-1!=this._fixedWallHeight?this._fixedWallHeight+3.6:this._wallHeight}set wallHeight(t){t<0&&(t=0),this._wallHeight=t}get wallThicknessMultiplier(){return this._wallThicknessMultiplier}set wallThicknessMultiplier(t){t<0&&(t=0),this._wallThicknessMultiplier=t}get floorThicknessMultiplier(){return this._floorThicknessMultiplier}set floorThicknessMultiplier(t){t<0&&(t=0),this._floorThicknessMultiplier=t}dispose(){this._planes=null,this._tileMatrix=null,this._tileMatrixOriginal=null,this._floorHoleMatrix=null,null!=this._floorHoles&&(this._floorHoles.clear(),this._floorHoles=null)}reset(){this._planes=[],this._tileMatrix=[],this._tileMatrixOriginal=[],this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._floorHoleMatrix=[]}initializeTileMap(t,e){t<0&&(t=0),e<0&&(e=0),this._tileMatrix=[],this._tileMatrixOriginal=[],this._floorHoleMatrix=[];let s=0;for(;s<e;){const e=[],i=[],r=[];let n=0;for(;n<t;)e[n]=jh.TILE_BLOCKED,i[n]=jh.TILE_BLOCKED,r[n]=!1,n++;this._tileMatrix.push(e),this._tileMatrixOriginal.push(i),this._floorHoleMatrix.push(r),s++}return this._width=t,this._height=e,this._minX=this._width,this._maxX=-1,this._minY=this._height,this._maxY=-1,!0}setTileHeight(t,e,s){let i,r,n,a,o;if(t>=0&&t<this._width&&e>=0&&e<this._height){if(i=this._tileMatrix[e],i[t]=s,s>=0)t<this._minX&&(this._minX=t),t>this._maxX&&(this._maxX=t),e<this._minY&&(this._minY=e),e>this._maxY&&(this._maxY=e);else{if(t==this._minX||t==this._maxX){for(r=!1,n=this._minY;n<this._maxY;){if(this.getTileHeightInternal(t,n)>=0){r=!0;break}n++}r||(t==this._minX&&this._minX++,t==this._maxX&&this._maxX--)}if(e==this._minY||e==this._maxY){for(a=!1,o=this._minX;o<this._maxX;){if(this.getTileHeight(o,e)>=0){a=!0;break}o++}a||(e==this._minY&&this._minY++,e==this._maxY&&this._maxY--)}}return!0}return!1}getTileHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return jh.TILE_BLOCKED;const s=this._tileMatrix[e];return void 0===s[t]?0:Math.abs(s[t])}getTileHeightOriginal(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return jh.TILE_BLOCKED;if(this._floorHoleMatrix[e][t])return jh.TILE_HOLE;return this._tileMatrixOriginal[e][t]}getTileHeightInternal(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return jh.TILE_BLOCKED;return this._tileMatrix[e][t]}initializeFromTileData(){let t,e,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(this._fixedWallHeight=s,e=0;e<this._height;){for(t=0;t<this._width;)void 0===this._tileMatrixOriginal[e]&&(this._tileMatrixOriginal[e]=[]),this._tileMatrixOriginal[e][t]=this._tileMatrix[e][t],t++;e++}const i=jh.findEntranceTile(this._tileMatrix);for(e=0;e<this._height;){for(t=0;t<this._width;)void 0===this._floorHoleMatrix[e]&&(this._floorHoleMatrix[e]=[]),this._floorHoleMatrix[e][t]&&this.setTileHeight(t,e,jh.TILE_HOLE),t++;e++}return this.initialize(i)}initialize(t){let e=0;null!=t&&(e=this.getTileHeight(t.x,t.y),this.setTileHeight(t.x,t.y,jh.TILE_BLOCKED)),this._floorHeight=jh.getFloorHeight(this._tileMatrix),this.createWallPlanes();const s=[];for(const r of this._tileMatrix)s.push(r.concat());jh.padHeightMap(s),jh.addTileTypes(s),jh.unpadHeightMap(s);const i=jh.expandFloorTiles(s);return this.extractPlanes(i),null!=t&&(this.setTileHeight(t.x,t.y,e),this.addFloor(new dt(t.x+.5,t.y+.5,e),new dt(-1,0,0),new dt(0,-1,0),!1,!1,!1,!1)),!0}generateWallData(t,e){let s,i,r,n,a;const o=new Vh,h=[this.extractTopWall.bind(this),this.extractRightWall.bind(this),this.extractBottomWall.bind(this),this.extractLeftWall.bind(this)];let _=0,d=new j.g(t.x,t.y),u=0;for(;u++<1e3;){if(s=!1,i=!1,r=_,(d.x<this.minX||d.x>this.maxX||d.y<this.minY||d.y>this.maxY)&&(s=!0),n=h[_](d,e),null==n)return null;if(a=Math.abs(n.x-d.x)+Math.abs(n.y-d.y),d.x==n.x||d.y==n.y?(_=(_-1+h.length)%h.length,a+=1,i=!0):(_=(_+1)%h.length,a--),o.addWall(d,r,a,s,i),n.x==t.x&&n.y==t.y&&(n.x!=d.x||n.y!=d.y))break;d=n}return 0==o.count?null:o}hidePeninsulaWallChains(t){let e,s,i,r,n=0;const a=t.count;for(;n<a;){const o=n;for(e=n,s=0,i=!1;!t.getBorder(n)&&n<a;)t.getLeftTurn(n)?s++:s>0&&s--,s>1&&(i=!0),e=n,n++;if(i)for(r=o;r<=e;)t.setHideWall(r,!0),r++;n++}}updateWallsNextToHoles(t){let e,s,i,r,n,a,o;const h=t.count;let _=0;for(;_<h;){if(!t.getHideWall(_)){for(e=t.getCorner(_),s=t.getDirection(_),i=t.getLength(_),r=Vh.WALL_DIRECTION_VECTORS[s],n=Vh.WALL_NORMAL_VECTORS[s],a=0,o=0;o<i;){if(this.getTileHeightInternal(e.x+o*r.x-n.x,e.y+o*r.y-n.y)==jh.TILE_HOLE){if(o>0&&0==a){t.setLength(_,o);break}a++}else if(a>0){t.moveCorner(_,a);break}o++}a==i&&t.setHideWall(_,!0)}_++}}resolveOriginalWallIndex(t,e,s){let i,r,n,a,o,h;const _=Math.min(t.y,e.y),d=Math.max(t.y,e.y),u=Math.min(t.x,e.x),c=Math.max(t.x,e.x),l=s.count;let g=0;for(;g<l;){if(i=s.getCorner(g),r=s.getEndPoint(g),t.x==e.x){if(i.x==t.x&&r.x==t.x&&(n=Math.min(i.y,r.y),a=Math.max(i.y,r.y),n<=_&&d<=a))return g}else if(t.y==e.y&&i.y==t.y&&r.y==t.y&&(o=Math.min(i.x,r.x),h=Math.max(i.x,r.x),o<=u&&c<=h))return g;g++}return-1}hideOriginallyHiddenWalls(t,e){let s,i,r,n,a;const o=t.count;let h=0;for(;h<o;)t.getHideWall(h)||(s=t.getCorner(h),i=new j.g(s.x,s.y),r=Vh.WALL_DIRECTION_VECTORS[t.getDirection(h)],n=t.getLength(h),i.x=i.x+r.x*n,i.y=i.y+r.y*n,a=this.resolveOriginalWallIndex(s,i,e),a>=0?e.getHideWall(a)&&t.setHideWall(h,!0):t.setHideWall(h,!0)),h++}checkWallHiding(t,e){this.hidePeninsulaWallChains(e),this.updateWallsNextToHoles(t),this.hideOriginallyHiddenWalls(t,e)}addWalls(t,e){const s=t.count,i=e.count;let r=0;for(;r<s;){if(!t.getHideWall(r)){const n=t.getCorner(r),a=t.getDirection(r),o=t.getLength(r),h=Vh.WALL_DIRECTION_VECTORS[a],_=Vh.WALL_NORMAL_VECTORS[a];let d=-1,u=0;for(;u<o;){const t=this.getTileHeightInternal(n.x+u*h.x+_.x,n.y+u*h.y+_.y);t>=0&&(t<d||d<0)&&(d=t),u++}const c=d;let l=new dt(n.x,n.y,c);l=dt.sum(l,dt.product(_,.5)),l=dt.sum(l,dt.product(h,-.5));const g=this.wallHeight+Math.min(jh.MAX_WALL_ADDITIONAL_HEIGHT,this.floorHeight)-d,E=dt.product(h,-o),p=new dt(0,0,g);l=dt.dif(l,E);const m=this.resolveOriginalWallIndex(n,t.getEndPoint(r),e);let I=0,T=0;m>=0?(I=e.getDirection((m+1)%i),T=e.getDirection((m-1+i)%i)):(I=t.getDirection((r+1)%s),T=t.getDirection((r-1+s)%s));let R=null;(I-a+4)%4==3?R=Vh.WALL_NORMAL_VECTORS[I]:(a-T+4)%4==3&&(R=Vh.WALL_NORMAL_VECTORS[T]);const f=t.getLeftTurn(r),O=t.getLeftTurn((r-1+s)%s),v=t.getHideWall((r+1)%s),A=t.getManuallyLeftCut(r),S=t.getManuallyRightCut(r);this.addWall(l,E,p,R,!O||A,!f||S,!v)}r++}}createWallPlanes(){let t,e;const s=this._tileMatrix;if(null==s)return!1;let i,r,n;const a=s.length;let o=0;if(0==a)return!1;for(i=0;i<a;){if(n=s[i],null==n||0==n.length)return!1;o=o>0?Math.min(o,n.length):n.length,i++}const h=Math.min(jh.MAX_WALL_ADDITIONAL_HEIGHT,-1!=this._fixedWallHeight?this._fixedWallHeight:jh.getFloorHeight(s)),_=this.minX;let d=this.minY;for(d=this.minY;d<=this.maxY;){if(this.getTileHeightInternal(_,d)>jh.TILE_HOLE){d--;break}d++}if(d>this.maxY)return!1;const u=new j.g(_,d),c=this.generateWallData(u,!0),l=this.generateWallData(u,!1);for(null!=c&&(t=c.count,e=l.count,this.checkWallHiding(c,l),this.addWalls(c,l)),r=0;r<this.tileMapHeight;){for(i=0;i<this.tileMapWidth;)this.getTileHeightInternal(i,r)<0&&this.setTileHeight(i,r,-(h+this.wallHeight)),i++;r++}return!0}extractTopWall(t,e){if(null==t)return null;let s=1,i=jh.TILE_HOLE;for(e||(i=jh.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x+s,t.y)>i)return new j.g(t.x+s-1,t.y);if(this.getTileHeightInternal(t.x+s,t.y+1)<=i)return new j.g(t.x+s,t.y+1);s++}return null}extractRightWall(t,e){if(null==t)return null;let s=1,i=jh.TILE_HOLE;for(e||(i=jh.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x,t.y+s)>i)return new j.g(t.x,t.y+(s-1));if(this.getTileHeightInternal(t.x-1,t.y+s)<=i)return new j.g(t.x-1,t.y+s);s++}return null}extractBottomWall(t,e){if(null==t)return null;let s=1,i=jh.TILE_HOLE;for(e||(i=jh.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x-s,t.y)>i)return new j.g(t.x-(s-1),t.y);if(this.getTileHeightInternal(t.x-s,t.y-1)<=i)return new j.g(t.x-s,t.y-1);s++}return null}extractLeftWall(t,e){if(null==t)return null;let s=1,i=jh.TILE_HOLE;for(e||(i=jh.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x,t.y-s)>i)return new j.g(t.x,t.y-(s-1));if(this.getTileHeightInternal(t.x+1,t.y-s)<=i)return new j.g(t.x+1,t.y-s);s++}return null}addWall(t,e,s,i,r,n,a){this.addPlane(Hh.PLANE_WALL,t,e,s,[i]);const o=jh.WALL_THICKNESS*this._wallThicknessMultiplier,h=jh.FLOOR_THICKNESS*this._floorThicknessMultiplier,_=dt.crossProduct(e,s),d=dt.product(_,1/_.length*-o);if(this.addPlane(Hh.PLANE_WALL,dt.sum(t,s),e,d,[_,i]),r&&this.addPlane(Hh.PLANE_WALL,dt.sum(dt.sum(t,e),s),dt.product(s,-(s.length+h)/s.length),d,[_,i]),n&&(this.addPlane(Hh.PLANE_WALL,dt.sum(t,dt.product(s,-h/s.length)),dt.product(s,(s.length+h)/s.length),d,[_,i]),a)){const r=dt.product(e,o/e.length);this.addPlane(Hh.PLANE_WALL,dt.sum(dt.sum(t,s),dt.product(r,-1)),r,d,[_,e,i])}}addFloor(t,e,s,i,r,n,a){let o,h,_;null!=this.addPlane(Hh.PLANE_FLOOR,t,e,s)&&(o=jh.FLOOR_THICKNESS*this._floorThicknessMultiplier,h=new dt(0,0,o),_=dt.dif(t,h),n&&this.addPlane(Hh.PLANE_FLOOR,_,e,h),a&&this.addPlane(Hh.PLANE_FLOOR,dt.sum(_,dt.sum(e,s)),dt.product(e,-1),h),i&&this.addPlane(Hh.PLANE_FLOOR,dt.sum(_,s),dt.product(s,-1),h),r&&this.addPlane(Hh.PLANE_FLOOR,dt.sum(_,e),s,h))}initializeFromMapData(t){if(!t)return!1;this.reset(),this.resetFloorHoles();const e=t.width,s=t.height,i=t.wallHeight,r=t.fixedWallsHeight;if(this.initializeTileMap(e,s),t.tileMap){let e=0;for(;e<t.tileMap.length;){const s=t.tileMap[e];if(s){let t=0;for(;t<s.length;){const i=s[t];i&&this.setTileHeight(t,e,i.height),t++}}e++}}if(t.holeMap&&t.holeMap.length){let e=0;for(;e<t.holeMap.length;){const s=t.holeMap[e];s&&(this.addFloorHole(s.id,s.x,s.y,s.width,s.height),e++)}this.initializeHoleMap()}return this.wallHeight=i,this.restrictsDragging=t.restrictsDragging,this.restrictsScaling=t.restrictsScaling,this.restrictedScale=t.restrictedScale,this.initializeFromTileData(r),!0}addPlane(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(0==s.length||0==i.length)return null;const n=new Hh(t,e,s,i,r);return this._planes.push(n),n}getMapData(){const t=new Bh;t.width=this._width,t.height=this._height,t.wallHeight=this._wallHeight,t.fixedWallsHeight=this._fixedWallHeight,t.dimensions.minX=this.minX,t.dimensions.maxX=this.maxX,t.dimensions.minY=this.minY,t.dimensions.maxY=this.maxY,t.restrictsDragging=this.restrictsDragging,t.restrictsScaling=this.restrictsScaling,t.restrictedScale=this.restrictedScale;let e=0;for(;e<this._height;){const s=[],i=this._tileMatrixOriginal[e];let r=0;for(;r<this._width;){const t=i[r];s.push({height:t}),r++}t.tileMap.push(s),e++}for(const[s,i]of this._floorHoles.entries())i&&t.holeMap.push({id:s,x:i.x,y:i.y,width:i.width,height:i.height});return t}getPlaneLocation(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.loc:null}getPlaneNormal(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.normal:null}getPlaneLeftSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.leftSide:null}getPlaneRightSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.rightSide:null}getPlaneNormalDirection(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.normalDirection:null}getPlaneSecondaryNormals(t){let e,s;if(t<0||t>=this.planeCount)return null;const i=this._planes[t];if(null!=i){for(e=[],s=0;s<i.secondaryNormalCount;)e.push(i.getSecondaryNormal(s)),s++;return e}return null}getPlaneType(t){if(t<0||t>=this.planeCount)return Hh.PLANE_UNDEFINED;const e=this._planes[t];return e?e.type:Hh.PLANE_UNDEFINED}getPlaneMaskCount(t){if(t<0||t>=this.planeCount)return 0;const e=this._planes[t];return e?e.maskCount:0}getPlaneMaskLeftSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskLeftSideLoc(e):-1}getPlaneMaskRightSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskRightSideLoc(e):-1}getPlaneMaskLeftSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskLeftSideLength(e):-1}getPlaneMaskRightSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskRightSideLength(e):-1}addFloorHole(t,e,s,i,r){this.removeFloorHole(t),this._floorHoles.set(t,new xh(e,s,i,r))}removeFloorHole(t){this._floorHoles.delete(t)}resetFloorHoles(){this._floorHoles.clear()}initializeHoleMap(){let t,e,s,i,r,n,a,o;for(e=0;e<this._height;){for(s=this._floorHoleMatrix[e],t=0;t<this._width;)s[t]=!1,t++;e++}for(const h of this._floorHoles.values())if(i=h,null!=i)for(r=i.x,n=i.x+i.width-1,a=i.y,o=i.y+i.height-1,r=r<0?0:r,n=n>=this._width?this._width-1:n,a=a<0?0:a,o=o>=this._height?this._height-1:o,e=a;e<=o;){for(s=this._floorHoleMatrix[e],t=r;t<=n;)s[t]=!0,t++;e++}}extractPlanes(t){let e,s,i,r,n,a,o,h,_,d,u,c,l,g,E;const p=t.length,m=t[0].length,I=[];let T=0;for(;T<p;)I[T]=[],T++;let R=0;for(;R<p;){for(e=0;e<m;){if(s=t[R][e],s<0||I[R][e]);else{for(n=0==e||!(t[R][e-1]==s),a=0==R||!(t[R-1][e]==s),i=e+1;i<m&&!(t[R][i]!=s||I[R][i]||R>0&&t[R-1][i]==s==a);)i++;for(o=i==m||!(t[R][i]==s),u=!1,r=R+1;r<p&&!u;){for(h=!(t[r][e]==s),u=h||e>0&&t[r][e-1]==s==n||i<m&&t[r][i]==s==o,_=e;_<i;){if(t[r][_]==s==h){u=!0,i=_;break}_++}if(u)break;r++}for(h=h||r==p,o=i==m||!(t[R][i]==s),d=R;d<r;){for(_=e;_<i;)I[d][_]=!0,_++;d++}c=e/4-.5,l=R/4-.5,g=(i-e)/4,E=(r-R)/4,this.addFloor(new dt(c+g,l+E,s/4),new dt(-g,0,0),new dt(0,-E,0),o,n,h,a)}e++}R++}}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}}jh.FLOOR_THICKNESS=.25,jh.WALL_THICKNESS=.25,jh.MAX_WALL_ADDITIONAL_HEIGHT=20,jh.TILE_BLOCKED=-110,jh.TILE_HOLE=-100;class kh{constructor(){this._model=void 0,this._width=void 0,this._height=void 0,this._heightMap=void 0,this._wallHeight=void 0,this._scale=void 0}flush(){return this._model=null,this._width=0,this._height=0,this._wallHeight=-1,this._heightMap=[],this._scale=64,this._model=null,!0}parse(t){if(!t)return!1;const e=t.readBoolean(),s=t.readInt(),i=t.readString();return this.parseExplicitly(i,s,e)}parseModel(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.parseExplicitly(t,e,s)}parseExplicitly(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._scale=s?32:64,this._wallHeight=e,this._model=t;const i=this._model.split("\r"),r=i.length;let n=0;let a=0;for(;a<r;){const t=i[a];t.length>n&&(n=t.length),a++}for(this._heightMap=[],a=0;a<r;){const t=[];let e=0;for(;e<n;)t.push(jh.TILE_BLOCKED),e++;this._heightMap.push(t),a++}for(this._width=n,this._height=r,a=0;a<r;){const t=this._heightMap[a],e=i[a];if(e.length>0){let s=0;for(;s<e.length;){const i=e.charAt(s);let r=jh.TILE_BLOCKED;"x"!==i&&"X"!==i&&(r=parseInt(i,36)),t[s]=r,s++}}a++}return!0}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return-110;const s=this._heightMap[e];if(void 0===s)return-110;const i=s[t];return void 0===i?-110:i}get model(){return this._model}get width(){return this._width}get height(){return this._height}get heightMap(){return this._heightMap}get wallHeight(){return this._wallHeight}get scale(){return this._scale}}class Yh{constructor(){this._x=void 0,this._y=void 0,this._direction=void 0}flush(){return this._x=0,this._y=0,this._direction=0,!0}parse(t){return!!t&&(this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt(),!0)}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class zh{constructor(){this._width=void 0,this._height=void 0,this._heights=void 0}static decodeTileHeight(t){return t<0?-1:(16383&t)/256}static decodeIsStackingBlocked(t){return!!(16384&t)}static decodeIsRoomTile(t){return t>=0}getTileHeight(t,e){return t<0||t>=this._width||e<0||e>=this._height?-1:zh.decodeTileHeight(this._heights[e*this._width+t])}getStackingBlocked(t,e){return t<0||t>=this._width||e<0||e>=this._height||zh.decodeIsStackingBlocked(this._heights[e*this._width+t])}isRoomTile(t,e){return!(t<0||t>=this._width||e<0||e>=this._height)&&zh.decodeIsRoomTile(this._heights[e*this._width+t])}flush(){return this._width=0,this._height=0,this._heights=[],!0}parse(t){if(!t)return!1;this._width=t.readInt();const e=t.readInt();this._height=e/this._width;let s=0;for(;s<e;)this._heights[s]=t.readShort(),s++;return!0}get width(){return this._width}get height(){return this._height}get heights(){return this._heights}}class Wh{constructor(){this._wrapper=void 0,this._count=void 0,this._x=void 0,this._y=void 0,this._value=void 0}flush(){return this._wrapper=null,this._count=0,this._x=0,this._y=0,this._value=0,!0}tileHeight(){return zh.decodeTileHeight(this._value)}isStackingBlocked(){return zh.decodeIsStackingBlocked(this._value)}isRoomTile(){return zh.decodeIsRoomTile(this._value)}next(){return!!this._count&&(this._count--,this._x=this._wrapper.readByte(),this._y=this._wrapper.readByte(),this._value=this._wrapper.readShort(),!0)}parse(t){return!!t&&(this._wrapper=t,this._count=t.readByte(),!0)}get x(){return this._x}get y(){return this._y}get height(){return this._value}}class Kh{constructor(){this._blockedTilesMap=void 0}flush(){return this._blockedTilesMap=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readInt();this._blockedTilesMap[i]||(this._blockedTilesMap[i]=[]),this._blockedTilesMap[i][s]=!0,e--}return!0}get blockedTilesMap(){return this._blockedTilesMap}}class Xh{constructor(){this._floorType=void 0,this._wallType=void 0,this._landscapeType=void 0,this._landscapeAnimation=void 0}flush(){return this._floorType=null,this._wallType=null,this._landscapeType=null,this._landscapeAnimation=null,!0}parse(t){if(!t)return!1;const e=t.readString(),s=t.readString();switch(e){case"floor":this._floorType=s;break;case"wallpaper":this._wallType=s;break;case"landscape":this._landscapeType=s;break;case"landscapeanim":this._landscapeAnimation=s}return!0}get floorType(){return this._floorType}get wallType(){return this._wallType}get landscapeType(){return this._landscapeType}get landscapeAnimation(){return this._landscapeAnimation}}class qh{constructor(){this._name=void 0,this._roomId=void 0}flush(){return this._name=null,this._roomId=0,!0}parse(t){return!!t&&(this._name=t.readString(),this._roomId=t.readInt(),!0)}get name(){return this._name}get roomId(){return this._roomId}}class Qh{constructor(){this._hideWalls=void 0,this._thicknessWall=void 0,this._thicknessFloor=void 0}flush(){return this._hideWalls=!1,this._thicknessWall=0,this._thicknessFloor=0,!0}parse(t){if(!t)return!1;this._hideWalls=t.readBoolean();let e=t.readInt(),s=t.readInt();return e=e<-2?-2:e>1?1:e,s=s<-2?-2:s>1?1:s,this._thicknessWall=Math.pow(2,e),this._thicknessFloor=Math.pow(2,s),!0}get hideWalls(){return this._hideWalls}get thicknessWall(){return this._thicknessWall}get thicknessFloor(){return this._thicknessFloor}}class Zh{constructor(){this._petId=void 0,this._roomIndex=void 0,this._gainedExperience=void 0}flush(){return this._petId=-1,this._roomIndex=-1,this._gainedExperience=0,!0}parse(t){return!!t&&(this._petId=t.readInt(),this._roomIndex=t.readInt(),this._gainedExperience=t.readInt(),!0)}get petId(){return this._petId}get roomIndex(){return this._roomIndex}get gainedExperience(){return this._gainedExperience}}class Jh{constructor(){this._roomIndex=void 0,this._petId=void 0,this._figureData=void 0,this._hasSaddle=void 0,this._isRiding=void 0}flush(){return!0}parse(t){return!!t&&(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._figureData=new sr(t),this._hasSaddle=t.readBoolean(),this._isRiding=t.readBoolean(),!0)}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get figureData(){return this._figureData}get hasSaddle(){return this._hasSaddle}get isRiding(){return this._isRiding}}class $h{constructor(){this._id=void 0,this._name=void 0,this._level=void 0,this._maximumLevel=void 0,this._experience=void 0,this._energy=void 0,this._happyness=void 0,this._levelExperienceGoal=void 0,this._maximumEnergy=void 0,this._maximumHappyness=void 0,this._respect=void 0,this._ownerId=void 0,this._ownerName=void 0,this._age=void 0,this._rarityLevel=void 0,this._saddle=void 0,this._rider=void 0,this._breedable=void 0,this._fullyGrown=void 0,this._dead=void 0,this._maximumTimeToLive=void 0,this._remainingTimeToLive=void 0,this._remainingGrowTime=void 0,this._skillThresholds=void 0,this._publiclyRideable=void 0,this._unknownRarity=void 0,this._publiclyBreedable=void 0}flush(){return this._id=-1,this._skillThresholds=[],!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._name=t.readString(),this._level=t.readInt(),this._maximumLevel=t.readInt(),this._experience=t.readInt(),this._levelExperienceGoal=t.readInt(),this._energy=t.readInt(),this._maximumEnergy=t.readInt(),this._happyness=t.readInt(),this._maximumHappyness=t.readInt(),this._respect=t.readInt(),this._ownerId=t.readInt(),this._age=t.readInt(),this._ownerName=t.readString(),this._rarityLevel=t.readInt(),this._saddle=t.readBoolean(),this._rider=t.readBoolean();let e=t.readInt();for(;e>0;)this._skillThresholds.push(t.readInt()),e--;return this._skillThresholds.sort(),this._publiclyRideable=t.readInt(),this._breedable=t.readBoolean(),this._fullyGrown=t.readBoolean(),this._dead=t.readBoolean(),this._unknownRarity=t.readInt(),this._maximumTimeToLive=t.readInt(),this._remainingTimeToLive=t.readInt(),this._remainingGrowTime=t.readInt(),this._publiclyBreedable=t.readBoolean(),!0}get id(){return this._id}get name(){return this._name}get level(){return this._level}get maximumLevel(){return this._maximumLevel}get experience(){return this._experience}get energy(){return this._energy}get happyness(){return this._happyness}get levelExperienceGoal(){return this._levelExperienceGoal}get maximumEnergy(){return this._maximumEnergy}get maximumHappyness(){return this._maximumHappyness}get respect(){return this._respect}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get age(){return this._age}get rarityLevel(){return this._rarityLevel}get saddle(){return this._saddle}get rider(){return this._rider}get breedable(){return this._breedable}get fullyGrown(){return this._fullyGrown}get dead(){return this._dead}get maximumTimeToLive(){return this._maximumTimeToLive}get remainingTimeToLive(){return this._remainingTimeToLive}get remainingGrowTime(){return this._remainingGrowTime}get skillTresholds(){return this._skillThresholds}get publiclyRideable(){return this._publiclyRideable}get unknownRarity(){return this._unknownRarity}get publiclyBreedable(){return this._publiclyBreedable}}class t_{constructor(){this._roomIndex=void 0,this._petId=void 0,this._canBreed=void 0,this._canHarvest=void 0,this._canRevive=void 0,this._hasBreedingPermission=void 0}flush(){return this._roomIndex=-1,this._petId=-1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,!0}parse(t){return!!t&&(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._canBreed=t.readBoolean(),this._canHarvest=t.readBoolean(),this._canRevive=t.readBoolean(),this._hasBreedingPermission=t.readBoolean(),!0)}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}}class e_{constructor(){this._isPlaying=void 0}flush(){return this._isPlaying=!1,!0}parse(t){return!!t&&(this._isPlaying=t.readBoolean(),!0)}get isPlaying(){return this._isPlaying}}class s_{flush(){return!0}parse(t){return!0}}class i_{constructor(){this._seconds=void 0}flush(){return this._seconds=0,!0}parse(t){return!!t&&(this._seconds=t.readInt(),!0)}get seconds(){return this._seconds}}class r_{constructor(){this._seconds=void 0}flush(){return this._seconds=0,!0}parse(t){return!!t&&(this._seconds=t.readInt(),!0)}get seconds(){return this._seconds}}class n_{constructor(){this._roomIndex=void 0,this._message=void 0,this._gesture=void 0,this._bubble=void 0,this._urls=void 0,this._messageLength=void 0}flush(){return this._roomIndex=null,this._message=null,this._gesture=0,this._bubble=0,this._urls=[],this._messageLength=0,!0}parse(t){return!!t&&(this._roomIndex=t.readInt(),this._message=t.readString(),this._gesture=t.readInt(),this._bubble=t.readInt(),this.parseUrls(t),this._messageLength=t.readInt(),!0)}parseUrls(t){if(!t)return!1;this._urls=[];let e=t.readInt();for(;e>0;)this._urls.push(t.readString()),e--;return!0}get roomIndex(){return this._roomIndex}get message(){return this._message}get gesture(){return this._gesture}get bubble(){return this._bubble}get urls(){return this._urls}get messageLength(){return this._messageLength}}class a_{constructor(){this._unitId=void 0,this._isTyping=void 0}flush(){return this._unitId=null,this._isTyping=!1,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._isTyping=1===t.readInt(),!0)}get unitId(){return this._unitId}get isTyping(){return this._isTyping}}class o_{constructor(){this._unitId=void 0,this._danceId=void 0}flush(){return this._unitId=null,this._danceId=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._danceId=t.readInt(),!0)}get unitId(){return this._unitId}get danceId(){return this._danceId}}class h_{constructor(){this._unitId=void 0,this._effectId=void 0,this._delay=void 0}flush(){return this._unitId=null,this._effectId=0,this._delay=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._effectId=t.readInt(),this._delay=t.readInt(),!0)}get unitId(){return this._unitId}get effectId(){return this._effectId}get delay(){return this._delay}}class __{constructor(){this._unitId=void 0,this._expression=void 0}flush(){return this._unitId=null,this._expression=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._expression=t.readInt(),!0)}get unitId(){return this._unitId}get expression(){return this._expression}}class d_{constructor(){this._unitId=void 0,this._handId=void 0}flush(){return this._unitId=null,this._handId=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._handId=t.readInt(),!0)}get unitId(){return this._unitId}get handId(){return this._handId}}class u_{constructor(){this._giverUserId=void 0,this._handItemType=void 0}flush(){return this._giverUserId=-1,this._handItemType=-1,!0}parse(t){return!!t&&(this._giverUserId=t.readInt(),this._handItemType=t.readInt(),!0)}get giverUserId(){return this._giverUserId}get handItemType(){return this._handItemType}}class c_{constructor(){this._unitId=void 0,this._isIdle=void 0}flush(){return this._unitId=null,this._isIdle=!1,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._isIdle=t.readBoolean(),!0)}get unitId(){return this._unitId}get isIdle(){return this._isIdle}}class l_{constructor(){this._unitId=void 0,this._figure=void 0,this._gender=void 0,this._motto=void 0,this._achievementScore=void 0}flush(){return this._unitId=null,this._figure=null,this._gender="M",this._motto=null,this._achievementScore=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._figure=t.readString(),this._gender=t.readString().toLocaleUpperCase(),this._motto=t.readString(),this._achievementScore=t.readInt(),!0)}get unitId(){return this._unitId}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get achievementScore(){return this._achievementScore}}class g_{constructor(){this._unitId=void 0,this._value=void 0}flush(){return this._unitId=null,this._value=0,!0}parse(t){return!!t&&(this._unitId=t.readInt(),this._value=t.readInt(),!0)}get unitId(){return this._unitId}get value(){return this._value}}class E_{}E_.USER=1,E_.PET=2,E_.BOT=3,E_.RENTABLE_BOT=4;class p_{constructor(t){this._roomIndex=0,this._x=0,this._y=0,this._z=0,this._dir=0,this._name="",this._userType=0,this._sex="",this._figure="",this._custom="",this._activityPoints=0,this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._subType="",this._ownerId=0,this._ownerName="",this._rarityLevel=0,this._hasSaddle=!1,this._isRiding=!1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,this._petLevel=0,this._petPosture="",this._botSkills=[],this._isModerator=!1,this._isReadOnly=!1,this._roomIndex=t}setReadOnly(){this._isReadOnly=!0}get roomIndex(){return this._roomIndex}get x(){return this._x}set x(t){this._isReadOnly||(this._x=t)}get y(){return this._y}set y(t){this._isReadOnly||(this._y=t)}get z(){return this._z}set z(t){this._isReadOnly||(this._z=t)}get dir(){return this._dir}set dir(t){this._isReadOnly||(this._dir=t)}get name(){return this._name}set name(t){this._isReadOnly||(this._name=t)}get userType(){return this._userType}set userType(t){this._isReadOnly||(this._userType=t)}get sex(){return this._sex}set sex(t){this._isReadOnly||(this._sex=t)}get figure(){return this._figure}set figure(t){this._isReadOnly||(this._figure=t)}get custom(){return this._custom}set custom(t){this._isReadOnly||(this._custom=t)}get activityPoints(){return this._activityPoints}set activityPoints(t){this._isReadOnly||(this._activityPoints=t)}get webID(){return this._webID}set webID(t){this._isReadOnly||(this._webID=t)}get groupID(){return this._groupID}set groupID(t){this._isReadOnly||(this._groupID=t)}get groupName(){return this._groupName}set groupName(t){this._isReadOnly||(this._groupName=t)}get groupStatus(){return this._groupStatus}set groupStatus(t){this._isReadOnly||(this._groupStatus=t)}get subType(){return this._subType}set subType(t){this._isReadOnly||(this._subType=t)}get ownerId(){return this._ownerId}set ownerId(t){this._isReadOnly||(this._ownerId=t)}get ownerName(){return this._ownerName}set ownerName(t){this._isReadOnly||(this._ownerName=t)}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._isReadOnly||(this._rarityLevel=t)}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._isReadOnly||(this._hasSaddle=t)}get isRiding(){return this._isRiding}set isRiding(t){this._isReadOnly||(this._isRiding=t)}get canBreed(){return this._canBreed}set canBreed(t){this._isReadOnly||(this._canBreed=t)}get canHarvest(){return this._canHarvest}set canHarvest(t){this._isReadOnly||(this._canHarvest=t)}get canRevive(){return this._canRevive}set canRevive(t){this._isReadOnly||(this._canRevive=t)}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._isReadOnly||(this._hasBreedingPermission=t)}get petLevel(){return this._petLevel}set petLevel(t){this._isReadOnly||(this._petLevel=t)}get petPosture(){return this._petPosture}set petPosture(t){this._isReadOnly||(this._petPosture=t)}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isReadOnly||(this._isModerator=t)}}p_.M="M",p_.F="F";class m_{constructor(){this._users=void 0}flush(){return this._users=[],!0}parse(t){if(!t)return!1;this._users=[];const e=t.readInt();let s=0;for(;s<e;){const e=t.readInt(),i=t.readString(),r=t.readString();let n=t.readString();const a=t.readInt(),o=t.readInt(),h=t.readInt(),_=parseFloat(t.readString()),d=t.readInt(),u=t.readInt(),c=new p_(a);if(c.dir=d,c.name=i,c.custom=r,c.x=o,c.y=h,c.z=_,this._users.push(c),1===u){c.webID=e,c.userType=E_.USER,c.sex=this.resolveSex(t.readString()),c.groupID=t.readInt(),c.groupStatus=t.readInt(),c.groupName=t.readString();const s=t.readString();""!==s&&(n=this.convertSwimFigure(s,n,c.sex)),c.figure=n,c.activityPoints=t.readInt(),c.isModerator=t.readBoolean()}else if(2===u)c.userType=E_.PET,c.figure=n,c.webID=e,c.subType=t.readInt().toString(),c.ownerId=t.readInt(),c.ownerName=t.readString(),c.rarityLevel=t.readInt(),c.hasSaddle=t.readBoolean(),c.isRiding=t.readBoolean(),c.canBreed=t.readBoolean(),c.canHarvest=t.readBoolean(),c.canRevive=t.readBoolean(),c.hasBreedingPermission=t.readBoolean(),c.petLevel=t.readInt(),c.petPosture=t.readString();else if(3===u)c.userType=E_.BOT,c.webID=-1*a,-1===n.indexOf("/")?c.figure=n:c.figure="hr-100-.hd-180-1.ch-876-66.lg-270-94.sh-300-64",c.sex=p_.M;else if(4===u){c.userType=E_.RENTABLE_BOT,c.webID=e,c.sex=this.resolveSex(t.readString()),c.figure=n,c.ownerId=t.readInt(),c.ownerName=t.readString();const s=t.readInt();if(s){const e=[];let i=0;for(;i<s;)e.push(t.readShort()),i++;c.botSkills=e}}s++}return!0}resolveSex(t){return"f"===t.substr(0,1).toLowerCase()?p_.F:p_.M}convertSwimFigure(t,e,s){const i=e.split(".");let r=1,n=1,a=1;let o=0;for(;o<i.length;){const t=i[o].split("-");if(t.length>2){"hd"===t[0]&&(r=parseInt(t[2]))}o++}const h=["238,238,238","250,56,49","253,146,160","42,199,210","53,51,44","239,255,146","198,255,152","255,146,90","157,89,126","182,243,255","109,255,51","51,120,201","255,182,49","223,161,233","249,251,50","202,175,143","197,198,197","71,98,61","138,131,97","255,140,51","84,198,39","30,108,153","152,79,136","119,200,255","255,192,142","60,75,135","124,44,71","215,255,227","143,63,28","255,99,147","31,155,121","253,255,51"],_=t.split("=");if(_.length>1){const t=_[1].split("/"),e=(t[0],t[1]);a="F"===s?10010:10011;n=1e4+h.indexOf(e)+1}return e+".bds-10001-"+r+".ss-"+a+"-"+n}get users(){return this._users}}class I_{constructor(){this._unitId=void 0}flush(){return this._unitId=null,!0}parse(t){return!!t&&(this._unitId=parseInt(t.readString()),!0)}get unitId(){return this._unitId}}class T_{constructor(t,e){this._action=void 0,this._value=void 0,this._action=t,this._value=e}get action(){return this._action}get value(){return this._value}}class R_{constructor(t,e,s,i,r,n,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=arguments.length>10?arguments[10]:void 0,u=arguments.length>11?arguments[11]:void 0,c=arguments.length>12?arguments[12]:void 0;this._id=void 0,this._x=void 0,this._y=void 0,this._z=void 0,this._height=void 0,this._headDirection=void 0,this._direction=void 0,this._targetX=void 0,this._targetY=void 0,this._targetZ=void 0,this._didMove=void 0,this._canStandUp=void 0,this._actions=void 0,this._id=t,this._x=e,this._y=s,this._z=i,this._height=r,this._headDirection=n,this._direction=a,this._targetX=o,this._targetY=h,this._targetZ=_,this._didMove=d,this._canStandUp=u,this._actions=c||[]}get id(){return this._id}get x(){return this._x}get y(){return this._y}get z(){return this._z}get height(){return this._height}get headDirection(){return this._headDirection}get direction(){return this._direction}get targetX(){return this._targetX}get targetY(){return this._targetY}get targetZ(){return this._targetZ}get didMove(){return this._didMove}get canStandUp(){return this._canStandUp}get actions(){return this._actions}}class f_{constructor(){this._statuses=void 0}flush(){return this._statuses=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=this.parseStatus(t);s?(this._statuses.push(s),e--):e--}return!0}parseStatus(t){if(!t)return null;const e=t.readInt(),s=t.readInt(),i=t.readInt(),r=parseFloat(t.readString()),n=t.readInt()%8*45,a=t.readInt()%8*45,o=t.readString();let h=0,_=0,d=0,u=0,c=!1,l=!1;if(o){const t=o.split("/"),g=[];for(const e of t){const t=e.split(" ");if(""!==t[0]&&t.length>=2){switch(t[0]){case"mv":{const e=t[1].split(",");e.length>=3&&(h=parseInt(e[0]),_=parseInt(e[1]),d=parseFloat(e[2]),l=!0);break}case"sit":{const e=parseFloat(t[1]);t.length>=3&&(c="1"===t[2]),u=e;break}case"lay":{const e=parseFloat(t[1]);u=Math.abs(e);break}}g.push(new T_(t[0],t[1]))}}this._statuses.push(new R_(e,s,i,r,u,n,a,h,_,d,l,c,g))}}get statuses(){return this._statuses}}class O_{constructor(t){this._index=void 0,this._Str_20260=void 0,this._Str_21337=void 0,this._Str_21113=void 0,this._picText=void 0,this._Str_6192=void 0,this._Str_22099=void 0,this._userCount=void 0,this._type=void 0,this._tag=void 0,this._Str_2567=void 0,this._open=void 0,this._disposed=void 0,this._index=t.readInt(),this._Str_20260=t.readString(),this._Str_21337=t.readString(),this._Str_21113=1==t.readInt(),this._picText=t.readString(),this._Str_6192=t.readString(),this._Str_22099=t.readInt(),this._userCount=t.readInt(),this._type=t.readInt(),this._type==O_._Str_14955?this._tag=t.readString():this._type==O_._Str_12025?this._Str_2567=new zo(t):this._open=t.readBoolean()}dispose(){this._disposed||(this._disposed=!0,null!=this._Str_2567&&(this._Str_2567.flush(),this._Str_2567=null))}get disposed(){return this._disposed}get type(){return this._type}get index(){return this._index}get _Str_9428(){return this._Str_20260}get _Str_22426(){return this._Str_21337}get _Str_5386(){return this._Str_21113}get picText(){return this._picText}get _Str_10304(){return this._Str_6192}get _Str_22186(){return this._Str_22099}get tag(){return this._tag}get userCount(){return this._userCount}get _Str_5019(){return this._Str_2567}get open(){return this._open}_Str_16147(){this._open=!this._open}get _Str_23003(){return this.type==O_._Str_14955?0:this.type==O_._Str_12025?this._Str_2567.maxUserCount:0}}O_._Str_14955=1,O_._Str_12025=2,O_._Str_16098=4;class v_{constructor(t){this._searchType=void 0,this._searchParam=void 0,this._rooms=void 0,this._ad=void 0,this._disposed=void 0,this._rooms=[],this._searchType=t.readInt(),this._searchParam=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._rooms.push(new zo(t));t.readBoolean()&&(this._ad=new O_(t))}dispose(){if(!this._disposed){if(this._disposed=!0,null!=this._rooms)for(const t of this._rooms)t.flush();null!=this._ad&&(this._ad.dispose(),this._ad=null),this._rooms=null}}get disposed(){return this._disposed}get searchType(){return this._searchType}get _Str_25185(){return this._searchParam}get rooms(){return this._rooms}get ad(){return this._ad}}class A_{constructor(){this._data=void 0}flush(){return!0}parse(t){return!!t&&(this._data=new v_(t),!0)}get data(){return this._data}}class S_{constructor(t){if(this._id=void 0,this._name=void 0,this._visible=void 0,this._automatic=void 0,this._automaticCategoryKey=void 0,this._globalCategoryKey=void 0,this._staffOnly=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,this._automatic=!1,this._automaticCategoryKey=null,this._globalCategoryKey=null,this._staffOnly=!1,!0}parse(t){return!!t&&(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),this._automatic=t.readBoolean(),this._automaticCategoryKey=t.readString(),this._globalCategoryKey=t.readString(),this._staffOnly=t.readBoolean(),!0)}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}get automatic(){return this._automatic}get automaticCategoryKey(){return this._automaticCategoryKey}get globalCategoryKey(){return this._globalCategoryKey}get staffOnly(){return this._staffOnly}}class N_{constructor(){this._categories=void 0}flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(t.readString()),e--;return!0}get categories(){return this._categories}}class M_{constructor(t){if(this._id=void 0,this._name=void 0,this._visible=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,!0}parse(t){return!!t&&(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),!0)}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}}class y_{constructor(){this._homeRoomId=void 0,this._roomIdToEnter=void 0}flush(){return this._homeRoomId=-1,this._roomIdToEnter=-1,!0}parse(t){return!!t&&(this._homeRoomId=t.readInt(),this._roomIdToEnter=t.readInt(),!0)}get homeRoomId(){return this._homeRoomId}get roomIdToEnter(){return this._roomIdToEnter}}class D_{constructor(t){if(this._roomId=void 0,this._areaId=void 0,this._image=void 0,this._caption=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=-1,this._areaId=-1,this._image=null,this._caption=null,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._areaId=t.readInt(),this._image=t.readString(),this._caption=t.readString(),!0)}get roomId(){return this._roomId}get areaId(){return this._areaId}get image(){return this._image}get caption(){return this._caption}}class C_{constructor(){this._rooms=void 0}flush(){return this._rooms=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._rooms.push(new D_(t)),e--;return!0}get rooms(){return this._rooms}}class L_{constructor(t){if(this._id=void 0,this._code=void 0,this._filter=void 0,this._localization=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._code=null,this._filter=null,this._localization=null,!0}parse(t){return!!t&&(this._id=t.readInt(),this._code=t.readString(),this._filter=t.readString(),this._localization=t.readString(),!0)}get id(){return this._id}get code(){return this._code}get filter(){return this._filter}get localization(){return this._localization}}class U_{constructor(t){if(this._code=void 0,this._savedSearches=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._savedSearches=[],!0}parse(t){if(!t)return!1;this._code=t.readString();let e=t.readInt();for(;e>0;)this._savedSearches.push(new L_(t)),e--;return!0}get code(){return this._code}get savedSearches(){return this._savedSearches}}class P_{constructor(){this._topLevelContexts=void 0}flush(){return this._topLevelContexts=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._topLevelContexts.push(new U_(t)),e--;return!0}get topLevelContexts(){return this._topLevelContexts}}class b_{flush(){return!0}parse(t){return!!t}}class w_{constructor(){this._searches=void 0}flush(){return this._searches=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._searches.push(new L_(t)),e--;return!0}get searches(){return this._searches}}class F_{constructor(t){if(this._code=void 0,this._data=void 0,this._action=void 0,this._closed=void 0,this._mode=void 0,this._rooms=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._action=-1,this._closed=!1,this._mode=-1,this._rooms=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString(),this._action=t.readInt(),this._closed=t.readBoolean(),this._mode=t.readInt();let e=t.readInt();for(;e>0;)this._rooms.push(new zo(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get action(){return this._action}get closed(){return this._closed}get mode(){return this._mode}get rooms(){return this._rooms}}class x_{constructor(t){if(this._code=void 0,this._data=void 0,this._results=void 0,!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._results=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString();let e=t.readInt();for(;e>0;)this._results.push(new F_(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get results(){return this._results}}class B_{constructor(){this._result=void 0}flush(){return this._result=null,!0}parse(t){return!!t&&(this._result=new x_(t),!0)}get result(){return this._result}}class G_{constructor(){this._windowX=void 0,this._windowY=void 0,this._windowWidth=void 0,this._windowHeight=void 0,this._leftPanelHidden=void 0,this._resultsMode=void 0}flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,this._leftPanelHidden=!1,this._resultsMode=0,!0}parse(t){return!!t&&(this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),this._leftPanelHidden=t.readBoolean(),this._resultsMode=t.readInt(),!0)}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}get leftPanelHidden(){return this._leftPanelHidden}get resultsMode(){return this._resultsMode}}class H_{flush(){return!0}parse(t){return!0}}class V_{constructor(t){this._adId=void 0,this._ownerAvatarId=void 0,this._ownerAvatarName=void 0,this._flatId=void 0,this._categoryId=void 0,this._eventType=void 0,this._eventName=void 0,this._eventDescription=void 0,this._creationTime=void 0,this._expirationDate=void 0,this._disposed=void 0,this._adId=t.readInt(),this._ownerAvatarId=t.readInt(),this._ownerAvatarName=t.readString(),this._flatId=t.readInt(),this._eventType=t.readInt(),this._eventName=t.readString(),this._eventDescription=t.readString();const e=t.readInt(),s=t.readInt(),i=new Date;let r=i.getTime();r-=60*e*1e3;const n=new Date(r);this._creationTime=n.getDate()+"-"+n.getMonth()+"-"+n.getFullYear()+" "+n.getHours()+":"+n.getMinutes();let a=i.getTime();a+=60*s*1e3,this._expirationDate=new Date(a),this._categoryId=t.readInt()}dispose(){this._disposed||(this._disposed=!0)}get disposed(){return this._disposed}get adId(){return this._adId}get ownerAvatarId(){return this._ownerAvatarId}get ownerAvatarName(){return this._ownerAvatarName}get flatId(){return this._flatId}get categoryId(){return this._categoryId}get eventType(){return this._eventType}get eventName(){return this._eventName}get eventDescription(){return this._eventDescription}get creationTime(){return this._creationTime}get expirationDate(){return this._expirationDate}}class j_{constructor(){this._data=void 0}flush(){return!0}parse(t){return this._data=new V_(t),!0}get data(){return this._data}}class k_{constructor(){this._roomId=void 0}flush(){return this._roomId=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),!0)}get roomId(){return this._roomId}}class Y_{constructor(){this._flatId=void 0,this._resultCode=void 0}flush(){return!0}parse(t){return this._flatId=t.readInt(),this._resultCode=t.readInt(),!0}get flatId(){return this._flatId}get resultCode(){return this._resultCode}}class z_{constructor(){this._categories=void 0}flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new M_(t)),e--;return!0}get categories(){return this._categories}}class W_{constructor(){this._categories=void 0}flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new S_(t)),e--;return!0}get categories(){return this._categories}}class K_{constructor(){this._data=void 0}flush(){return this._data=null,!0}parse(t){return!!t&&(this._data=new LE(t),!0)}get data(){return this._data}}class X_{constructor(){this._amount=void 0,this._amountChanged=void 0,this._type=void 0}flush(){return this._amount=0,this._amountChanged=0,this._type=-1,!0}parse(t){return!!t&&(this._amount=t.readInt(),this._amountChanged=t.readInt(),this._type=t.readInt(),!0)}get amount(){return this._amount}get amountChanged(){return this._amountChanged}get type(){return this._type}}class q_{constructor(){this._errorCode=void 0}flush(){return this._errorCode=-1,!0}parse(t){return!!t&&(this._errorCode=t.readInt(),!0)}get errorCode(){return this._errorCode}}class Q_{constructor(){this._numGifts=void 0}flush(){return this._numGifts=0,!0}parse(t){return!!t&&(this._numGifts=t.readInt(),!0)}get numGifts(){return this._numGifts}}class Z_{constructor(){this._message=void 0}flush(){return this._message=null,!0}parse(t){return!!t&&(this._message=t.readString(),!0)}get message(){return this._message}}class J_{constructor(){this._enabled=void 0}flush(){return this._enabled=!1,!0}parse(t){return!!t&&(this._enabled=t.readBoolean(),!0)}get enabled(){return this._enabled}}class $_{constructor(){this._messages=void 0}flush(){return this._messages=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._messages.push(t.readString()),e--;return!0}get messages(){return this._messages}}class td{constructor(){this._type=void 0,this._parameters=void 0}flush(){return this._type=null,this._parameters=new Map,!0}parse(t){if(!t)return!1;this._type=t.readString();let e=t.readInt();for(;e>0;)this._parameters.set(t.readString(),t.readString()),e--;return!0}get type(){return this._type}get parameters(){return this._parameters}}class ed{constructor(){this._petId=void 0,this._petName=void 0,this._level=void 0,this._figureData=void 0}flush(){return this._petId=-1,this._petName=null,this._level=0,this._figureData=null,!0}parse(t){return!!t&&(this._petId=t.readInt(),this._petName=t.readString(),this._level=t.readInt(),this._figureData=new sr(t),!0)}get petId(){return this._petId}get petName(){return this._petName}get level(){return this._level}get figureData(){return this._figureData}}class sd{constructor(){this._errorCode=void 0}flush(){return this._errorCode=-1,!0}parse(t){return!!t&&(this._errorCode=t.readInt(),!0)}get errorCode(){return this._errorCode}}class id{constructor(){this._items=void 0}flush(){return this._items=new U,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt();let i=t.readInt();const r=[];for(;i>0;)r.push(t.readInt()),i--;this._items.add(s,r),e--}return!0}getItemsByCategory(t){return this._items.getValue(t)}get categories(){return this._items.getKeys()}}class rd{constructor(t,e,s){this._code=void 0,this._errorMessage=void 0,this._isAllowed=void 0,this._code=t,this._errorMessage=e,this._isAllowed=s}get code(){return this._code}get errorMessage(){return this._errorMessage}get isAllowed(){return this._isAllowed}}class nd{}nd.USE_GUIDE_TOOL="USE_GUIDE_TOOL",nd.GIVE_GUIDE_TOUR="GIVE_GUIDE_TOUR",nd.JUDGE_CHAT_REVIEWS="JUDGE_CHAT_REVIEWS",nd.VOTE_IN_COMPETITIONS="VOTE_IN_COMPETITIONS",nd.CALL_ON_HELPERS="CALL_ON_HELPERS",nd.CITIZEN="CITIZEN",nd.TRADE="TRADE",nd.HEIGHTMAP_EDITOR_BETA="HEIGHTMAP_EDITOR_BETA",nd.BUILDER_AT_WORK="BUILDER_AT_WORK",nd.NAVIGATOR_ROOM_THUMBNAIL_CAMERA="NAVIGATOR_ROOM_THUMBNAIL_CAMERA",nd.CAMERA="CAMERA",nd.MOUSE_ZOOM="MOUSE_ZOOM";class ad{constructor(){this._perks=void 0}flush(){return this._perks=[],!0}parse(t){if(!t)return!1;this._perks=[];const e=t.readInt();for(let s=0;s<e;s++)this._perks.push(new rd(t.readString(),t.readString(),t.readBoolean()));return!0}isAllowed(t){let e=!1;for(const s of this._perks)if(s.code===t){e=s.isAllowed;break}return e}get perks(){return this._perks}}class od{constructor(t,e,s){this._value=void 0,this._choiceText=void 0,this._choiceType=void 0,this._value=t,this._choiceText=e,this._choiceType=s}get value(){return this._value}set value(t){this._value=t}get choiceText(){return this._choiceText}set choiceText(t){this._choiceText=t}get choiceType(){return this._choiceType}set choiceType(t){this._choiceType=t}}class hd{constructor(){this._questionId=void 0,this._questionType=void 0,this._sortOrder=void 0,this._questionCategory=void 0,this._questionText=void 0,this._questionAnswerType=void 0,this._questionAnswerCount=void 0,this._children=void 0,this._questionChoices=void 0,this._children=[],this._questionChoices=[]}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get questionType(){return this._questionType}set questionType(t){this._questionType=t}get sortOrder(){return this._sortOrder}set sortOrder(t){this._sortOrder=t}get questionText(){return this._questionText}set questionText(t){this._questionText=t}get questionCategory(){return this._questionCategory}set questionCategory(t){this._questionCategory=t}get questionAnswerType(){return this._questionAnswerType}set questionAnswerType(t){this._questionAnswerType=t}get questionAnswerCount(){return this._questionAnswerCount}set questionAnswerCount(t){this._questionAnswerCount=t}get children(){return this._children}set children(t){this._children=t}get questionChoices(){return this._questionChoices}set questionChoices(t){this._questionChoices=t}}class _d{constructor(){this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],this._npsPoll=!1}flush(){return this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],!0}parse(t){this._id=t.readInt(),this._startMessage=t.readString(),this._endMessage=t.readString(),this._numQuestions=t.readInt();for(let e=0;e<this._numQuestions;e++){const e=this.parsePollQuestion(t),s=t.readInt();for(let i=0;i<s;i++)e.children.push(this.parsePollQuestion(t));this._questionArray.push(e)}return this._npsPoll=t.readBoolean(),!0}parsePollQuestion(t){const e=new hd;if(e.questionId=t.readInt(),e.sortOrder=t.readInt(),e.questionType=t.readInt(),e.questionText=t.readString(),e.questionCategory=t.readInt(),e.questionAnswerType=t.readInt(),e.questionAnswerCount=t.readInt(),1==e.questionType||2==e.questionType)for(let s=0;s<e.questionAnswerCount;s++)e.questionChoices.push(new od(t.readString(),t.readString(),t.readInt()));return e}get id(){return this._id}get startMessage(){return this._startMessage}get endMessage(){return this._endMessage}get numQuestions(){return this._numQuestions}get questionArray(){return this._questionArray}get npsPoll(){return this._npsPoll}}class dd{flush(){throw!0}parse(t){return!0}}class ud{constructor(){this._id=-1,this._type="",this._headline="",this._summary=""}flush(){return this._id=-1,this._type="",this._summary="",!0}parse(t){return this._id=t.readInt(),this._type=t.readString(),this._headline=t.readString(),this._summary=t.readString(),!0}get id(){return this._id}get type(){return this._type}get headline(){return this._headline}get summary(){return this._summary}}class cd{constructor(){this._userId=void 0,this._value=void 0,this._answerCounts=void 0}flush(){return this._userId=-1,this._value="",this._answerCounts=null,!0}parse(t){this._userId=t.readInt(),this._value=t.readString(),this._answerCounts=new Map;const e=t.readInt();for(let s=0;s<e;s++){const e=t.readString(),s=t.readInt();this._answerCounts.set(e,s)}return!0}get userId(){return this._userId}get value(){return this._value}get answerCounts(){return this._answerCounts}}class ld{constructor(){this._questionId=void 0,this._answerCounts=void 0}flush(){return this._questionId=-1,this._answerCounts=null,!0}parse(t){this._questionId=t.readInt(),this._answerCounts=new Map;const e=t.readInt();for(let s=0;s<e;s++){const e=t.readString(),s=t.readInt();this._answerCounts.set(e,s)}return!0}get questionId(){return this._questionId}get answerCounts(){return this._answerCounts}}class gd{constructor(){this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null}flush(){return this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,!0}parse(t){this._pollType=t.readString(),this._pollId=t.readInt(),this._questionId=t.readInt(),this._duration=t.readInt();const e=t.readInt(),s=t.readInt(),i=t.readInt(),r=t.readString();if(this._question={id:e,number:s,type:i,content:r},1==this._question.type||2==this._question.type){this._question.selection_min=t.readInt();const e=t.readInt();this._question.selections=[],this._question.selection_values=[],this._question.selection_count=e,this._question.selection_max=e;for(let s=0;s<e;s++)this._question.selection_values.push(t.readString()),this._question.selections.push(t.readString())}return!0}get pollType(){return this._pollType}get pollId(){return this._pollId}get questionId(){return this._questionId}get duration(){return this._duration}get question(){return this._question}}class Ed{constructor(t){this._communityGoalId=void 0,this._communityGoalCode=void 0,this._userRank=void 0,this._rewardCode=void 0,this._badge=void 0,this._localizedName=void 0,this._communityGoalId=t.readInt(),this._communityGoalCode=t.readString(),this._userRank=t.readInt(),this._rewardCode=t.readString(),this._badge=t.readBoolean(),this._localizedName=t.readString()}get communityGoalId(){return this._communityGoalId}get communityGoalCode(){return this._communityGoalCode}get userRank(){return this._userRank}get rewardCode(){return this._rewardCode}get badge(){return this._badge}get localizedName(){return this._localizedName}}class pd{constructor(){this._prizes=void 0}flush(){return this._prizes=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._prizes.push(new Ed(t));return!0}get prizes(){return this._prizes}}class md{constructor(t){this._userId=void 0,this._userName=void 0,this._figure=void 0,this._rank=void 0,this._currentScore=void 0,this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._rank=t.readInt(),this._currentScore=t.readInt()}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get rank(){return this._rank}get currentScore(){return this._currentScore}}class Id{constructor(t){this._goalCode=void 0,this._hof=void 0,this._hof=[],this._goalCode=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._hof.push(new md(t))}dispose(){this._hof=null}get disposed(){return null==this._hof}get hof(){return this._hof}get goalCode(){return this._goalCode}}class Td{constructor(){this._data=void 0}flush(){return this._data=null,!0}parse(t){return!!t&&(this._data=new Id(t),!0)}get data(){return this._data}}class Rd{constructor(t){this._hasGoalExpired=void 0,this._personalContributionScore=void 0,this._personalContributionRank=void 0,this._communityTotalScore=void 0,this._communityHighestAchievedLevel=void 0,this._scoreRemainingUntilNextLevel=void 0,this._percentCompletionTowardsNextLevel=void 0,this._goalCode=void 0,this._timeRemainingInSeconds=void 0,this._rewardUserLimits=void 0,this._rewardUserLimits=[],this._hasGoalExpired=t.readBoolean(),this._personalContributionScore=t.readInt(),this._personalContributionRank=t.readInt(),this._communityTotalScore=t.readInt(),this._communityHighestAchievedLevel=t.readInt(),this._scoreRemainingUntilNextLevel=t.readInt(),this._percentCompletionTowardsNextLevel=t.readInt(),this._goalCode=t.readString(),this._timeRemainingInSeconds=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._rewardUserLimits.push(t.readInt())}dispose(){this._rewardUserLimits=null}get disposed(){return null==this._rewardUserLimits}get hasGoalExpired(){return this._hasGoalExpired}get personalContributionScore(){return this._personalContributionScore}get personalContributionRank(){return this._personalContributionRank}get communityTotalScore(){return this._communityTotalScore}get communityHighestAchievedLevel(){return this._communityHighestAchievedLevel}get scoreRemainingUntilNextLevel(){return this._scoreRemainingUntilNextLevel}get percentCompletionTowardsNextLevel(){return this._percentCompletionTowardsNextLevel}get timeRemainingInSeconds(){return this._timeRemainingInSeconds}get rewardUserLimits(){return this._rewardUserLimits}get goalCode(){return this._goalCode}}class fd{constructor(){this._data=void 0}flush(){return this._data=null,!0}parse(t){return!!t&&(this._data=new Rd(t),!0)}get data(){return this._data}}class Od{constructor(){this._state=void 0,this._userCount=void 0,this._userCountGoal=void 0}flush(){return this._state=-1,this._userCount=-1,this._userCountGoal=-1,!0}parse(t){return!!t&&(this._state=t.readInt(),this._userCount=t.readInt(),this._userCountGoal=t.readInt(),!0)}get state(){return this._state}get userCount(){return this._userCount}get userCountGoal(){return this._userCountGoal}}class vd{constructor(){this._imageUri=void 0}flush(){return this._imageUri="",!0}parse(t){return!!t&&(this._imageUri=t.readString(),!0)}get imageUri(){return this._imageUri}}class Ad{constructor(){this._expired=void 0}flush(){return!0}parse(t){return!!t&&(this._expired=t.readBoolean(),!0)}get expired(){return this._expired}}class Sd{constructor(t){this._campaignCode=void 0,this._completedQuestsInCampaign=void 0,this._questCountInCampaign=void 0,this._activityPointType=void 0,this._id=void 0,this._accepted=void 0,this._type=void 0,this._imageVersion=void 0,this._rewardCurrencyAmount=void 0,this._localizationCode=void 0,this._completedSteps=void 0,this._totalSteps=void 0,this._waitPeriodSeconds=void 0,this._sortOrder=void 0,this._catalogPageName=void 0,this._chainCode=void 0,this._easy=void 0,this._receiveTime=void 0,this._receiveTime=new Date,this._campaignCode=t.readString(),this._completedQuestsInCampaign=t.readInt(),this._questCountInCampaign=t.readInt(),this._activityPointType=t.readInt(),this._id=t.readInt(),this._accepted=t.readBoolean(),this._type=t.readString(),this._imageVersion=t.readString(),this._rewardCurrencyAmount=t.readInt(),this._localizationCode=t.readString(),this._completedSteps=t.readInt(),this._totalSteps=t.readInt(),this._sortOrder=t.readInt(),this._catalogPageName=t.readString(),this._chainCode=t.readString(),this._easy=t.readBoolean()}static getCampaignLocalizationKeyForCode(t){return"quests."+t}get campaignCode(){return this._campaignCode}get localizationCode(){return this._localizationCode}get completedQuestsInCampaign(){return this._completedQuestsInCampaign}get questCountInCampaign(){return this._questCountInCampaign}get activityPointType(){return this._activityPointType}set accepted(t){this._accepted=t}get accepted(){return this._accepted}set id(t){this._id=t}get id(){return this._id}get type(){return this._type}get imageVersion(){return this._imageVersion}get rewardCurrencyAmount(){return this._rewardCurrencyAmount}get completedSteps(){return this._completedSteps}get totalSteps(){return this._totalSteps}get isCompleted(){return this._completedSteps==this._totalSteps}set waitPeriodSeconds(t){this._waitPeriodSeconds=t}get waitPeriodSeconds(){if(this._waitPeriodSeconds<1)return 0;const t=(new Date).getTime()-this._receiveTime.getTime();return Math.max(0,this._waitPeriodSeconds-Math.floor(t/1e3))}getCampaignLocalizationKey(){return Sd.getCampaignLocalizationKeyForCode(this.campaignCode)}getQuestLocalizationKey(){return this.getCampaignLocalizationKey()+"."+this._localizationCode}get completedCampaign(){return this._id<1}get lastQuestInCampaign(){return this._completedQuestsInCampaign>=this._questCountInCampaign}get receiveTime(){return this._receiveTime}get sortOrder(){return this._sortOrder}get catalogPageName(){return this._catalogPageName}get chainCode(){return this._chainCode}get easy(){return this._easy}}class Nd{constructor(){this._questData=void 0,this._showDialog=void 0}flush(){return this._questData=null,!0}parse(t){return!!t&&(this._questData=new Sd(t),this._showDialog=t.readBoolean(),!0)}get questData(){return this._questData}get showDialog(){return this._showDialog}}class Md{constructor(){this._quest=void 0,this._easyQuestCount=void 0,this._hardQuestCount=void 0}flush(){return this._quest=null,!0}parse(t){if(!t)return!1;return t.readBoolean()&&(this._quest=new Sd(t),this._easyQuestCount=t.readInt(),this._hardQuestCount=t.readInt()),!0}get quest(){return this._quest}get easyQuestCount(){return this._easyQuestCount}get hardQuestCount(){return this._hardQuestCount}}class yd{constructor(){this._quest=void 0}flush(){return this._quest=null,!0}parse(t){return!!t&&(this._quest=new Sd(t),!0)}get quest(){return this._quest}}class Dd{constructor(){this._quests=void 0,this._openWindow=void 0}flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._quests.push(new Sd(t));return this._openWindow=t.readBoolean(),!0}get quests(){return this._quests}get openWindow(){return this._openWindow}}class Cd{constructor(){this._quests=void 0}flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._quests.push(new Sd(t));return!0}get quests(){return this._quests}}class Ld{constructor(t){this._stuffTypeSelectionEnabled=void 0,this._furniLimit=void 0,this._stuffIds=void 0,this._id=void 0,this._stringParam=void 0,this._intParams=void 0,this._stuffTypeId=void 0,this._stuffTypeSelectionCode=void 0,this._stuffIds=[],this._intParams=[],this._stuffTypeSelectionEnabled=t.readBoolean(),this._furniLimit=t.readInt();let e=t.readInt();for(;e>0;)this._stuffIds.push(t.readInt()),e--;for(this._stuffTypeId=t.readInt(),this._id=t.readInt(),this._stringParam=t.readString(),e=t.readInt();e>0;)this._intParams.push(t.readInt()),e--;this._stuffTypeSelectionCode=t.readInt()}getBoolean(t){return 1===this._intParams[t]}get stuffTypeSelectionEnabled(){return this._stuffTypeSelectionEnabled}get stuffTypeSelectionCode(){return this._stuffTypeSelectionCode}set stuffTypeSelectionCode(t){this._stuffTypeSelectionCode=t}get maximumItemSelectionCount(){return this._furniLimit}get selectedItems(){return this._stuffIds}get id(){return this._id}get stringData(){return this._stringParam}get intData(){return this._intParams}get code(){return 0}get spriteId(){return this._stuffTypeId}}class Ud extends Ld{constructor(t){super(t),this._type=void 0,this._delayInPulses=void 0,this._conflictingTriggers=void 0,this._conflictingTriggers=[],this._type=t.readInt(),this._delayInPulses=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingTriggers.push(t.readInt()),e--}get type(){return this._type}get code(){return this._type}get delayInPulses(){return this._delayInPulses}get conflictingTriggers(){return this._conflictingTriggers}}class Pd{constructor(){this._definition=void 0}flush(){return this._definition=null,!0}parse(t){return!!t&&(this._definition=new Ud(t),!0)}get definition(){return this._definition}}class bd extends Ld{constructor(t){super(t),this._type=void 0,this._type=t.readInt()}get type(){return this._type}get code(){return this._type}}class wd{constructor(){this._definition=void 0}flush(){return this._definition=null,!0}parse(t){return!!t&&(this._definition=new bd(t),!0)}get definition(){return this._definition}}class Fd extends Ld{constructor(t){super(t),this._triggerConf=void 0,this._conflictingActions=void 0,this._conflictingActions=[],this._triggerConf=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingActions.push(t.readInt()),e--}get code(){return this._triggerConf}get conflictingActions(){return this._conflictingActions}}class xd{constructor(){this._definition=void 0}flush(){return this._definition=null,!0}parse(t){return!!t&&(this._definition=new Fd(t),!0)}get definition(){return this._definition}}class Bd{constructor(){this._stuffId=void 0}flush(){return this._stuffId=0,!0}parse(t){return!!t&&(this._stuffId=t.readInt(),!0)}get stuffId(){return this._stuffId}}class Gd{constructor(){this._reason=void 0}flush(){return this._reason=0,!0}parse(t){return!!t&&(this._reason=t.readInt(),!0)}get reason(){return this._reason}}class Hd{flush(){return!0}parse(t){return!!t}}class Vd{constructor(){this._info=void 0}flush(){return this._info=null,!0}parse(t){return!!t&&(this._info=t.readString(),!0)}get info(){return this._info}}class jd{constructor(t){this._userId=void 0,this._userName=void 0,this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}}class kd{constructor(){this._roomId=void 0,this._bannedUsers=void 0}flush(){return this._roomId=0,this._bannedUsers=[],!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let e=t.readInt();for(;e>0;)this._bannedUsers.push(new jd(t)),e--;return!0}get roomId(){return this._roomId}get bannedUsers(){return this._bannedUsers}}class Yd{constructor(t){this._userId=void 0,this._userName=void 0,this._selected=void 0,this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}get selected(){return this._selected}set selected(t){this._selected=t}}class zd{constructor(){this._roomId=void 0,this._data=void 0}flush(){return this._roomId=0,this._data=null,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._data=new Yd(t),!0)}get roomId(){return this._roomId}get data(){return this._data}}class Wd{constructor(){this._roomId=void 0,this._userId=void 0}flush(){return this._roomId=0,this._userId=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._userId=t.readInt(),!0)}get roomId(){return this._roomId}get userId(){return this._userId}}class Kd{constructor(){this._roomId=void 0,this._users=void 0}flush(){return this._roomId=0,this._users=new Map,!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._users.set(s,i),e--}return!0}get roomId(){return this._roomId}get users(){return this._users}}class Xd{constructor(){this._isMuted=void 0}flush(){return!0}parse(t){return!!t&&(this._isMuted=t.readBoolean(),!0)}get isMuted(){return this._isMuted}}class qd{constructor(){this._roomId=void 0}flush(){return this._roomId=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),!0)}get roomId(){return this._roomId}}class Qd{constructor(){this._roomId=-1,this._name=null,this._description=null,this._doorMode=Qd.DOORMODE_OPEN,this._categoryId=-1,this._maximumVisitors=0,this._maximumVisitorsLimit=0,this._tags=[],this._tradeMode=Qd.TRADEMODE_NOT_ALLOWED,this._allowPets=!1,this._allowFoodConsume=!1,this._allowWalkThrough=!1,this._hideWalls=!1,this._wallThickness=0,this._floorThickness=0,this._controllersById=new Map,this._controllerList=null,this._highlightedUserId=-1,this._bannedUsersById=new Map,this._bannedUsersList=null,this._roomModerationSettings=null,this._chatSettings=null,this._allowNavigatorDynamicCats=!1}static from(t){const e=new Qd;return e._roomId=t._roomId,e._name=t._name,e._description=t._description,e._doorMode=t._doorMode,e._categoryId=t._categoryId,e._maximumVisitors=t._maximumVisitors,e._maximumVisitorsLimit=t._maximumVisitorsLimit,e._tags=t._tags,e._tradeMode=t._tradeMode,e._allowPets=t._allowPets,e._allowFoodConsume=t._allowFoodConsume,e._allowWalkThrough=t._allowWalkThrough,e._hideWalls=t._hideWalls,e._wallThickness=t._wallThickness,e._floorThickness=t._floorThickness,e._controllersById=t._controllersById,e._controllerList=t._controllerList,e._highlightedUserId=t._highlightedUserId,e._bannedUsersById=t._bannedUsersById,e._bannedUsersList=t._bannedUsersList,e._roomModerationSettings=t._roomModerationSettings,e._chatSettings=t._chatSettings,e._allowNavigatorDynamicCats=t._allowNavigatorDynamicCats,e}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get allowFoodConsume(){return this._allowFoodConsume}set allowFoodConsume(t){this._allowFoodConsume=t}get allowWalkThrough(){return this._allowWalkThrough}set allowWalkThrough(t){this._allowWalkThrough=t}get hideWalls(){return this._hideWalls}set hideWalls(t){this._hideWalls=t}get wallThickness(){return this._wallThickness}set wallThickness(t){this._wallThickness=t}get floorThickness(){return this._floorThickness}set floorThickness(t){this._floorThickness=t}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get name(){return this._name}set name(t){this._name=t}get description(){return this._description}set description(t){this._description=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get categoryId(){return this._categoryId}set categoryId(t){this._categoryId=t}get maximumVisitors(){return this._maximumVisitors}set maximumVisitors(t){this._maximumVisitors=t}get maximumVisitorsLimit(){return this._maximumVisitorsLimit}set maximumVisitorsLimit(t){this._maximumVisitorsLimit=t}get tags(){return this._tags}set tags(t){this._tags=t}_Str_17474(t,e){this._controllersById.set(t,e),this._controllerList=null,this._highlightedUserId=t}get roomModerationSettings(){return this._roomModerationSettings}set roomModerationSettings(t){this._roomModerationSettings=t}get controllersById(){return this._controllersById}set controllersById(t){this._controllersById=t}get controllerList(){if(!this._controllerList){this._controllerList=[];for(const t of this._controllersById.values())this._controllerList.push(t);this._controllerList.sort(((t,e)=>t.userName.localeCompare(e.userName)))}return this._controllerList}get highlightedUserId(){return this._highlightedUserId}_Str_22019(t,e){this._bannedUsersById.set(t,e),this._bannedUsersList=null}get bannedUsersById(){return this._bannedUsersById}get bannedUsersList(){if(!this._bannedUsersList){this._bannedUsersList=[];for(const t of this._bannedUsersById.values())this._bannedUsersList.push(t);this._bannedUsersList.sort(((t,e)=>t.userName.localeCompare(e.userName)))}return this._bannedUsersList}get chatSettings(){return this._chatSettings}set chatSettings(t){this._chatSettings=t}get allowNavigatorDynamicCats(){return this._allowNavigatorDynamicCats}set allowNavigatorDynamicCats(t){this._allowNavigatorDynamicCats=t}}Qd.DOORMODE_OPEN=0,Qd.DOORMODE_CLOSED=1,Qd.DOORMODE_PASSWORD=2,Qd.DOORMODE_INVISIBLE=3,Qd.DOORMODE_NOOBS_ONLY=4,Qd.TRADEMODE_NOT_ALLOWED=0,Qd.TRADEMODE_WITH_CONTROLLER=1,Qd.TRADEMODE_ALLOWED=2;class Zd{constructor(){this._roomSettingsData=void 0}flush(){return this._roomSettingsData=null,!0}parse(t){if(!t)return!1;this._roomSettingsData=new Qd,this._roomSettingsData.roomId=t.readInt(),this._roomSettingsData.name=t.readString(),this._roomSettingsData.description=t.readString(),this._roomSettingsData.doorMode=t.readInt(),this._roomSettingsData.categoryId=t.readInt(),this._roomSettingsData.maximumVisitors=t.readInt(),this._roomSettingsData.maximumVisitorsLimit=t.readInt(),this._roomSettingsData.tags=[];let e=t.readInt();for(;e>0;)this._roomSettingsData.tags.push(t.readString()),e--;return this._roomSettingsData.tradeMode=t.readInt(),this._roomSettingsData.allowPets=1===t.readInt(),this._roomSettingsData.allowFoodConsume=1===t.readInt(),this._roomSettingsData.allowWalkThrough=1===t.readInt(),this._roomSettingsData.hideWalls=1===t.readInt(),this._roomSettingsData.wallThickness=t.readInt(),this._roomSettingsData.floorThickness=t.readInt(),this._roomSettingsData.chatSettings=new ko(t),this._roomSettingsData.allowNavigatorDynamicCats=t.readBoolean(),this._roomSettingsData.roomModerationSettings=new Yo(t),!0}get data(){return this._roomSettingsData}}class Jd{constructor(){this._roomId=void 0,this._code=void 0}flush(){return this._roomId=0,this._code=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._code=t.readInt(),!0)}get roomId(){return this._roomId}get code(){return this._code}}class $d{constructor(){this._roomId=void 0}flush(){return this._roomId=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),!0)}get roomId(){return this._roomId}}class tu{constructor(){this._roomId=void 0,this._code=void 0,this._message=void 0}flush(){return this._roomId=0,this._code=0,this._message=null,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._code=t.readInt(),this._message=t.readString(),!0)}get roomId(){return this._roomId}get code(){return this._code}get message(){return this._message}}tu.ERROR_ROOM_NOT_FOUND=1,tu.ERROR_NOT_OWNER=2,tu.ERROR_INVALID_DOOR_MODE=3,tu.ERROR_INVALID_USER_LIMIT=4,tu.ERROR_INVALID_PASSWORD=5,tu.ERROR_INVALID_CATEGORY=6,tu.ERROR_INVALID_NAME=7,tu.ERROR_UNACCEPTABLE_NAME=8,tu.ERROR_INVALID_DESCRIPTION=9,tu.ERROR_UNACCEPTABLE_DESCRIPTION=10,tu.ERROR_INVALID_TAG=11,tu.ERROR_NON_USER_CHOOSABLE_TAG=12,tu.ERROR_TOO_MANY_CHARACTERS_IN_TAG=13;class eu{flush(){return!0}parse(t){return!0}}class su{constructor(){this._songDisks=new Map,this._maxLength=void 0}flush(){return this._songDisks.clear(),this._maxLength=0,!0}parse(t){this._maxLength=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._songDisks.set(t.readInt(),t.readInt());return!0}get songDisks(){return this._songDisks}get maxLength(){return this._maxLength}}class iu{constructor(){this._currentSongId=void 0,this._currentPosition=void 0,this._nextSongId=void 0,this._nextPosition=void 0,this._syncCount=void 0}flush(){return this._currentSongId=-1,this._currentPosition=-1,this._nextSongId=-1,this._nextPosition=-1,this._syncCount=-1,!0}parse(t){return this._currentSongId=t.readInt(),this._currentPosition=t.readInt(),this._nextSongId=t.readInt(),this._nextPosition=t.readInt(),this._syncCount=t.readInt(),!0}get currentSongId(){return this._currentSongId}get currentPosition(){return this._currentPosition}get nextSongId(){return this._nextSongId}get nextPosition(){return this._nextPosition}get syncCount(){return this._syncCount}}class ru{constructor(){this._songId=void 0,this._officialSongId=void 0}flush(){return this._songId=0,this._officialSongId="",!0}parse(t){return this._officialSongId=t.readString(),this._songId=t.readInt(),!0}get songId(){return this._songId}get officialSongId(){return this._officialSongId}}class nu extends O{constructor(t){super(t,eu)}getParser(){return this.parser}}class au extends O{constructor(t){super(t,su)}getParser(){return this.parser}}class ou extends O{constructor(t){super(t,iu)}getParser(){return this.parser}}class hu extends O{constructor(t){super(t,ru)}getParser(){return this.parser}}class _u{constructor(t,e,s,i){this._id=void 0,this._length=void 0,this._name=void 0,this._creator=void 0,this._startPlayHead=0,this._id=t,this._length=e,this._name=s,this._creator=i}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get startPlayHeadPos(){return this._startPlayHead}set startPlayHeadPos(t){this._startPlayHead=t}}class du extends O{constructor(t){super(t,Eu)}getParser(){return this.parser}}class uu extends O{constructor(t){super(t,pu)}getParser(){return this.parser}}class cu extends _u{constructor(t,e,s,i,r){super(t,e,s,i),this._data="",this._data=r}get data(){return this._data}}class lu extends O{constructor(t){super(t,mu)}getParser(){return this.parser}}class gu extends O{constructor(t){super(t,Iu)}getParser(){return this.parser}}class Eu{constructor(){this._synchronizationCount=void 0,this._playlist=void 0}flush(){return this._synchronizationCount=-1,this._playlist=[],!0}parse(t){this._synchronizationCount=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._playlist.push(new _u(t.readInt(),t.readInt(),t.readString(),t.readString()));return!0}get synchronizationCount(){return this._synchronizationCount}get playList(){return this._playlist}}class pu{constructor(){this._entry=void 0}flush(){return this._entry=null,!0}parse(t){return this._entry=new _u(t.readInt(),t.readInt(),t.readString(),t.readString()),!0}get entry(){return this._entry}}class mu{constructor(){this._songs=void 0}flush(){return this._songs=[],!0}parse(t){const e=t.readInt();for(let s=0;s<e;s++){const e=t.readInt(),s=(t.readString(),t.readString()),i=t.readString(),r=t.readInt(),n=t.readString(),a=new cu(e,r,s,n,i);this._songs.push(a)}return!0}get songs(){return this._songs}}class Iu{constructor(){this._songDiskInventory=new U}flush(){return this._songDiskInventory.reset(),!0}parse(t){const e=t.readInt();for(let s=0;s<e;s++)this._songDiskInventory.add(t.readInt(),t.readInt());return!0}getDiskId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getKey(t):-1}getSongId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(t):-1}get songDiskCount(){return this._songDiskInventory.length}}class Tu{constructor(t,e,s,i,r){this._level=void 0,this._state=void 0,this._tasks=void 0,this._rewardPerks=void 0,this._rewardProducts=void 0,this._level=t,this._state=e,this._tasks=s,this._rewardPerks=i,this._rewardProducts=r}get level(){return this._level}get state(){return this._state}get tasks(){return this._tasks}get perks(){return this._rewardPerks}get items(){return this._rewardProducts}}class Ru{constructor(t,e){this._productCode=void 0,this._vipDays=void 0,this._productCode=t,this._vipDays=e}get productCode(){return this._productCode}get vipDays(){return this._vipDays}}class fu{constructor(t,e,s,i,r,n){this._id=void 0,this._requiredLevel=void 0,this._badgeCode=void 0,this._state=void 0,this._currentScore=void 0,this._totalScore=void 0,this._id=t,this._requiredLevel=e,this._badgeCode=s,this._state=i,this._currentScore=r,this._totalScore=n}get id(){return this._id}get requiredLevel(){return this._requiredLevel}get badgeCode(){return this._badgeCode}get state(){return this._state}get currentScore(){return this._currentScore}get totalScore(){return this._totalScore}}class Ou{constructor(){this._type=void 0,this._levels=void 0}flush(){return this._type=null,this._levels=null,!0}parse(t){if(!t)return!1;this._type=t.readString(),this._levels=[];const e=t.readInt();for(let s=0;s<e;s++){const e=t.readInt(),s=t.readInt(),i=[],r=t.readInt();for(let _=0;_<r;_++){const e=t.readInt(),s=t.readInt(),r=t.readString(),n=t.readInt(),a=t.readInt(),o=t.readInt();i.push(new fu(e,s,r,n,a,o))}const n=[],a=t.readInt();for(let _=0;_<a;_++)n.push(t.readString());const o=[],h=t.readInt();for(let _=0;_<h;_++){const e=t.readString(),s=t.readInt();o.push(new Ru(e,s))}this._levels.push(new Tu(e,s,i,n,o))}return!0}get type(){return this._type}get levels(){return this._levels}}class vu extends O{constructor(t){super(t,Os)}getParser(){return this.parser}}class Au extends O{constructor(t){super(t,vs)}getParser(){return this.parser}}class Su extends O{constructor(t){super(t,As)}getParser(){return this.parser}}class Nu extends O{constructor(t){super(t,Ss)}getParser(){return this.parser}}class Mu extends O{constructor(t){super(t,Ns)}getParser(){return this.parser}}class yu extends O{constructor(t){super(t,Ms)}getParser(){return this.parser}}class Du extends O{constructor(t){super(t,ys)}getParser(){return this.parser}}class Cu extends O{constructor(t){super(t,Ds)}getParser(){return this.parser}}class Lu extends O{constructor(t){super(t,Cs)}getParser(){return this.parser}}Lu.NAME_OK=0,Lu.ERROR_NAME_REQUIRED=1,Lu.ERROR_NAME_TOO_SHORT=2,Lu.ERROR_NAME_TOO_LONG=3,Lu.ERROR_NAME_NOT_VALID=4,Lu.ERROR_NAME_IN_USE=5,Lu.ERROR_NAME_CHANGE_NOT_ALLOWED=6,Lu.ERROR_MERGE_HOTEL_DOWN=7;class Uu extends O{constructor(t){super(t,Ls)}getParser(){return this.parser}}class Pu extends O{constructor(t){super(t,Us)}getParser(){return this.parser}}class bu{constructor(t){this._slotId=void 0,this._figureString=void 0,this._gender=void 0,this._slotId=t.readInt(),this._figureString=t.readString(),this._gender=t.readString()}get slotId(){return this._slotId}get figureString(){return this._figureString}get gender(){return this._gender}}class wu extends O{constructor(t){super(t,Ps)}getParser(){return this.parser}}class Fu extends O{constructor(t){super(t,ws)}getParser(){return this.parser}}class xu extends O{constructor(t){super(t,Fs)}getParser(){return this.parser}}class Bu extends O{constructor(t){super(t,xs)}getParser(){return this.parser}}class Gu extends O{constructor(t){super(t,Bs)}getParser(){return this.parser}}class Hu extends O{constructor(t){super(t,Xs)}getParser(){return this.parser}}class Vu extends O{constructor(t){super(t,qs)}getParser(){return this.parser}}class ju extends O{constructor(t){super(t,Qs)}getParser(){return this.parser}}class ku extends O{constructor(t){super(t,Zs)}getParser(){return this.parser}}class Yu extends O{constructor(t){super(t,Js)}getParser(){return this.parser}}class zu extends O{constructor(t){super(t,$s)}getParser(){return this.parser}}class Wu extends O{constructor(t){super(t,ei)}getParser(){return this.parser}}class Ku extends O{constructor(t){super(t,si)}getParser(){return this.parser}}class Xu extends O{constructor(t){super(t,ii)}getParser(){return this.parser}}class qu extends O{constructor(t){super(t,ri)}getParser(){return this.parser}}class Qu extends O{constructor(t){super(t,ni)}getParser(){return this.parser}}class Zu{constructor(t){this._Str_20535=void 0,this._Str_19937=void 0,this._Str_20951=void 0,this._Str_20460=void 0,this._Str_16144=void 0,this._Str_20535=t.readInt(),this._Str_19937=t.readInt(),this._Str_20951=t.readInt(),this._Str_20460=t.readInt(),this._Str_16144=[];let e=t.readInt();for(;e>0;)this._Str_16144.push(t.readInt()),e--}get _Str_22802(){return this._Str_20535}get _Str_9227(){return this._Str_19937}get _Str_23802(){return this._Str_20951}get _Str_21500(){return this._Str_20460}get _Str_25155(){return this._Str_16144}}class Ju extends O{constructor(t){super(t,ai)}getParser(){return this.parser}}class $u extends O{constructor(t){super(t,_i)}getParser(){return this.parser}}class tc extends O{constructor(t){super(t,gi)}getParser(){return this.parser}}class ec extends O{constructor(t){super(t,hi)}getParser(){return this.parser}}class sc extends O{constructor(t){super(t,Ei)}getParser(){return this.parser}}class ic extends O{constructor(t){super(t,pi)}getParser(){return this.parser}}class rc extends O{constructor(t){super(t,Ii)}getParser(){return this.parser}}class nc extends O{constructor(t){super(t,Ti)}getParser(){return this.parser}}class ac extends O{constructor(t){super(t,Ri)}getParser(){return this.parser}}class oc extends O{constructor(t){super(t,fi)}getParser(){return this.parser}}class hc extends O{constructor(t){super(t,Oi)}getParser(){return this.parser}}class _c extends O{constructor(t){super(t,Si)}getParser(){return this.parser}}class dc extends O{constructor(t){super(t,Ni)}getParser(){return this.parser}}class uc extends O{constructor(t){super(t,Mi)}getParser(){return this.parser}}class cc extends O{constructor(t){super(t,yi)}getParser(){return this.parser}}class lc extends O{constructor(t){super(t,Di)}getParser(){return this.parser}}class gc extends O{constructor(t){super(t,Ci)}getParser(){return this.parser}}class Ec extends O{constructor(t){super(t,Li)}getParser(){return this.parser}}class pc extends O{constructor(t){super(t,Ui)}getParser(){return this.parser}}class mc extends O{constructor(t){super(t,Pi)}getParser(){return this.parser}}class Ic extends O{constructor(t){super(t,wi)}getParser(){return this.parser}}class Tc extends O{constructor(t){super(t,ur)}getParser(){return this.parser}}class Rc extends O{constructor(t){super(t,cr)}getParser(){return this.parser}}class fc extends O{constructor(t){super(t,gr)}getParser(){return this.parser}}class Oc extends O{constructor(t){super(t,mr)}getParser(){return this.parser}}class vc extends O{constructor(t){super(t,Er)}getParser(){return this.parser}}class Ac extends O{constructor(t){super(t,Ir)}getParser(){return this.parser}}class Sc extends O{constructor(t){super(t,Tr)}getParser(){return this.parser}}class Nc extends O{constructor(t){super(t,yr)}getParser(){return this.parser}}class Mc extends O{constructor(t){super(t,Cr)}getParser(){return this.parser}}class yc extends O{constructor(t){super(t,Lr)}getParser(){return this.parser}}class Dc extends O{constructor(t){super(t,Ur)}getParser(){return this.parser}}class Cc extends O{constructor(t){super(t,Pr)}getParser(){return this.parser}}class Lc extends O{constructor(t){super(t,wr)}getParser(){return this.parser}}class Uc extends O{constructor(t){super(t,Fr)}getParser(){return this.parser}}class Pc extends O{constructor(t){super(t,xr)}getParser(){return this.parser}}class bc extends O{constructor(t){super(t,Gr)}getParser(){return this.parser}}class wc extends O{constructor(t){super(t,Vr)}getParser(){return this.parser}}class Fc extends O{constructor(t){super(t,jr)}getParser(){return this.parser}}class xc extends O{constructor(t){super(t,Yr)}getParser(){return this.parser}}class Bc extends O{constructor(t){super(t,Wr)}getParser(){return this.parser}}class Gc extends O{constructor(t){super(t,Kr)}getParser(){return this.parser}}class Hc extends O{constructor(t){super(t,Xr)}getParser(){return this.parser}}class Vc extends O{constructor(t){super(t,qr)}getParser(){return this.parser}}class jc extends O{constructor(t){super(t,Qr)}getParser(){return this.parser}}class kc extends O{constructor(t){super(t,Zr)}getParser(){return this.parser}}class Yc extends O{constructor(t){super(t,Jr)}getParser(){return this.parser}}class zc extends O{constructor(t){super(t,$r)}getParser(){return this.parser}}class Wc extends O{constructor(t){super(t,tn)}getParser(){return this.parser}}class Kc extends O{constructor(t){super(t,en)}getParser(){return this.parser}}class Xc extends O{constructor(t){super(t,sn)}getParser(){return this.parser}}class qc extends O{constructor(t){super(t,rn)}getParser(){return this.parser}}class Qc extends O{constructor(t){super(t,nn)}getParser(){return this.parser}}class Zc extends O{constructor(t){super(t,an)}getParser(){return this.parser}}class Jc extends O{constructor(t){super(t,on)}getParser(){return this.parser}}class $c extends O{constructor(t){super(t,hn)}getParser(){return this.parser}}class tl extends O{constructor(t){super(t,cn)}getParser(){return this.parser}}class el extends O{constructor(t){super(t,ln)}getParser(){return this.parser}}class sl extends O{constructor(t){super(t,gn)}getParser(){return this.parser}}class il extends O{constructor(t){super(t,En)}getParser(){return this.parser}}class rl{constructor(){this._groupId=void 0,this._name=void 0,this._description=void 0,this._icon=void 0,this._totalThreads=void 0,this._leaderboardScore=void 0,this._totalMessages=void 0,this._unreadMessages=void 0,this._lastMessageId=void 0,this._lastMessageAuthorId=void 0,this._lastMessageAuthorName=void 0,this._lastMessageTimeAsSecondsAgo=void 0}static parse(t){return this.fillFromMessage(new rl,t)}static fillFromMessage(t,e){return t._groupId=e.readInt(),t._name=e.readString(),t._description=e.readString(),t._icon=e.readString(),t._totalThreads=e.readInt(),t._leaderboardScore=e.readInt(),t._totalMessages=e.readInt(),t._unreadMessages=e.readInt(),t._lastMessageId=e.readInt(),t._lastMessageAuthorId=e.readInt(),t._lastMessageAuthorName=e.readString(),t._lastMessageTimeAsSecondsAgo=e.readInt(),t}get groupId(){return this._groupId}get name(){return this._name}get description(){return this._description}get icon(){return this._icon}get totalThreads(){return this._totalThreads}get leaderboardScore(){return this._leaderboardScore}get totalMessages(){return this._totalMessages}get unreadMessages(){return this._unreadMessages}get lastMessageId(){return this._lastMessageId}get lastMessageAuthorId(){return this._lastMessageAuthorId}get lastMessageAuthorName(){return this._lastMessageAuthorName}get lastMessageTimeAsSecondsAgo(){return this._lastMessageTimeAsSecondsAgo}_Str_25309(t){this._totalThreads=t._totalThreads,this._totalMessages=t._totalMessages,this._unreadMessages=t._unreadMessages,this._lastMessageAuthorId=t._lastMessageAuthorId,this._lastMessageAuthorName=t._lastMessageAuthorName,this._lastMessageId=t._lastMessageId,this._lastMessageTimeAsSecondsAgo=t._lastMessageTimeAsSecondsAgo}get _Str_12786(){return this._totalMessages-this._unreadMessages}set _Str_12786(t){this._unreadMessages=this._totalMessages-t,this._unreadMessages<0&&(this._unreadMessages=0)}_Str_23783(t){this._lastMessageAuthorId=t.lastUserId,this._lastMessageAuthorName=t.lastUserName,this._lastMessageId=t.lastMessageId,this._lastMessageTimeAsSecondsAgo=t.lastCommentTime,this._totalThreads++,this._totalMessages++,this._unreadMessages=0}}class nl extends rl{constructor(){super(...arguments),this._readPermissions=void 0,this._postMessagePermissions=void 0,this._postThreadPermissions=void 0,this._moderatePermissions=void 0,this._readPermissionError=void 0,this._postMessagePermissionError=void 0,this._postThreadPermissionError=void 0,this._moderatePermissionError=void 0,this._reportPermissionError=void 0,this._canChangeSettings=void 0,this._isStaff=void 0}static parse(t){const e=new nl;return rl.fillFromMessage(e,t),e._readPermissions=t.readInt(),e._postMessagePermissions=t.readInt(),e._postThreadPermissions=t.readInt(),e._moderatePermissions=t.readInt(),e._readPermissionError=t.readString(),e._postMessagePermissionError=t.readString(),e._postThreadPermissionError=t.readString(),e._moderatePermissionError=t.readString(),e._reportPermissionError=t.readString(),e._canChangeSettings=t.readBoolean(),e._isStaff=t.readBoolean(),e}get readPermissions(){return this._readPermissions}get postMessagePermissions(){return this._postMessagePermissions}get postThreadPermissions(){return this._postThreadPermissions}get moderatePermissions(){return this._moderatePermissions}get hasReadPermissionError(){return 0===this._readPermissionError.length}get _Str_21331(){return!0}get hasPostMessagePermissionError(){return 0===this._postMessagePermissionError.length}get hasPostThreadPermissionError(){return 0===this._postThreadPermissionError.length}get hasModeratePermissionError(){return 0===this._moderatePermissionError.length}get canChangeSettings(){return this._canChangeSettings}get isStaf(){return this._isStaff}get readPermissionError(){return this._readPermissionError}get postMessagePermissionError(){return this._postMessagePermissionError}get postThreadPermissionError(){return this._postThreadPermissionError}get moderatePermissionError(){return this._moderatePermissionError}get reportPermissionError(){return this._reportPermissionError}}class al{constructor(){this._extendedForumData=void 0}flush(){return this._extendedForumData=null,!0}parse(t){return!!t&&(this._extendedForumData=nl.parse(t),!0)}get extendedForumData(){return this._extendedForumData}}class ol extends O{constructor(t){super(t,al)}getParser(){return this.parser}}class hl{constructor(){this._listCode=void 0,this._totalAmount=void 0,this._startIndex=void 0,this._amount=void 0,this._forums=void 0}flush(){return this._listCode=-1,this._totalAmount=0,this._startIndex=-1,this._amount=0,this._forums=[],!0}parse(t){if(!t)return!1;this._listCode=t.readInt(),this._totalAmount=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._forums=[];let e=0;for(;e<this._amount;)this._forums.push(rl.parse(t)),e++;return!0}get listCode(){return this._listCode}get totalAmount(){return this._totalAmount}get startIndex(){return this._startIndex}get amount(){return this._amount}get forums(){return this._forums}}class _l extends O{constructor(t){super(t,hl)}getParser(){return this.parser}}class dl{constructor(){this._threadId=void 0,this._authorId=void 0,this._authorName=void 0,this._creationTimeAsSecondsAgo=void 0,this._header=void 0,this._totalMessages=void 0,this._unreadMessagesCount=void 0,this._lastMessageId=void 0,this._lastUserId=void 0,this._lastUserName=void 0,this._lastCommentTime=void 0,this._state=void 0,this._adminId=void 0,this._adminName=void 0,this._adminOperationTimeAsSecondsAgo=void 0,this._isPinned=void 0,this._isLocked=void 0}static parse(t){const e=new dl;return e._threadId=t.readInt(),e._authorId=t.readInt(),e._authorName=t.readString(),e._header=t.readString(),e._isPinned=t.readBoolean(),e._isLocked=t.readBoolean(),e._creationTimeAsSecondsAgo=t.readInt(),e._totalMessages=t.readInt(),e._unreadMessagesCount=t.readInt(),e._lastMessageId=t.readInt(),e._lastUserId=t.readInt(),e._lastUserName=t.readString(),e._lastCommentTime=t.readInt(),e._state=t.readByte(),e._adminId=t.readInt(),e._adminName=t.readString(),e._adminOperationTimeAsSecondsAgo=t.readInt(),e}get adminOperationTimeAsSecondsAgo(){return this._adminOperationTimeAsSecondsAgo}set adminOperationTimeAsSecondsAgo(t){this._adminOperationTimeAsSecondsAgo=t}get lastCommentTime(){return this._lastCommentTime}set lastCommentTime(t){this._lastCommentTime=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get creationTimeAsSecondsAgo(){return this._creationTimeAsSecondsAgo}set creationTimeAsSecondsAgo(t){this._creationTimeAsSecondsAgo=t}get header(){return this._header}set header(t){this._header=t}get lastMessageId(){return this._lastMessageId}set lastMessageId(t){this._lastMessageId=t}get lastUserId(){return this._lastUserId}set lastUserId(t){this._lastUserId=t}get lastUserName(){return this._lastUserName}set lastUserName(t){this._lastUserName=t}get totalMessages(){return this._totalMessages}set totalMessages(t){this._totalMessages=t}get unreadMessagesCount(){return this._unreadMessagesCount}set unreadMessagesCount(t){this._unreadMessagesCount=t}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get isPinned(){return this._isPinned}set isPinned(t){this._isPinned=t}get isLocked(){return this._isLocked}set isLocked(t){this._isLocked=t}}class ul{constructor(){this._groupId=void 0,this._startIndex=void 0,this._amount=void 0,this._threads=void 0}flush(){return this._groupId=-1,this._startIndex=-1,this._amount=0,this._threads=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._threads=[];let e=0;for(;e<this._amount;)this._threads.push(dl.parse(t)),e++;return!0}get groupId(){return this._groupId}get startIndex(){return this._startIndex}get amount(){return this._amount}get threads(){return this._threads}}class cl extends O{constructor(t){super(t,ul)}getParser(){return this.parser}}class ll{constructor(){this._groupId=void 0,this._messageId=void 0,this._messageIndex=void 0,this._authorId=void 0,this._threadId=void 0,this._creationTime=void 0,this._messageText=void 0,this._authorName=void 0,this._authorFigure=void 0,this._state=void 0,this._adminId=void 0,this._adminName=void 0,this._adminOperationTimeAsSeccondsAgo=void 0,this._authorPostCount=void 0}static parse(t){const e=new ll;return e._messageId=t.readInt(),e._messageIndex=t.readInt(),e._authorId=t.readInt(),e._authorName=t.readString(),e._authorFigure=t.readString(),e._creationTime=t.readInt(),e._messageText=t.readString(),e._state=t.readByte(),e._adminId=t.readInt(),e._adminName=t.readString(),e._adminOperationTimeAsSeccondsAgo=t.readInt(),e._authorPostCount=t.readInt(),e}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get adminOperationTimeAsSeccondsAgo(){return this._adminOperationTimeAsSeccondsAgo}set adminOperationTimeAsSeccondsAgo(t){this._adminOperationTimeAsSeccondsAgo=t}get messageId(){return this._messageId}set messageId(t){this._messageId=t}get creationTime(){return this._creationTime}set creationTime(t){this._creationTime=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get authorFigure(){return this._authorFigure}set authorFigure(t){this._authorFigure=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get messageIndex(){return this._messageIndex}set messageIndex(t){this._messageIndex=t}set groupID(t){this._groupId=t}get groupId(){return this._groupId}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get messageText(){return this._messageText}set messageText(t){this._messageText=t}get authorPostCount(){return this._authorPostCount}set authorPostCount(t){this._authorPostCount=t}}class gl{constructor(){this._groupId=void 0,this._threadId=void 0,this._message=void 0}flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return!!t&&(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=ll.parse(t),!0)}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class El extends O{constructor(t){super(t,gl)}getParser(){return this.parser}}class pl{constructor(){this._groupId=void 0,this._thread=void 0}flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return!!t&&(this._groupId=t.readInt(),this._thread=dl.parse(t),!0)}get groupId(){return this._groupId}get thread(){return this._thread}}class ml extends O{constructor(t){super(t,pl)}getParser(){return this.parser}}class Il{constructor(){this._groupId=void 0,this._threadId=void 0,this._startIndex=void 0,this._amount=void 0,this._messages=void 0}flush(){return this._groupId=-1,this._threadId=-1,this._startIndex=-1,this._amount=0,this._messages=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._threadId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._messages=[];let e=0;for(;e<this._amount;){const s=ll.parse(t);s.groupID=this._groupId,s.threadId=this._threadId,this._messages.push(s),e++}return!0}get groupId(){return this._groupId}get threadId(){return this._threadId}get startIndex(){return this._startIndex}get amount(){return this._amount}get messages(){return this._messages}}class Tl extends O{constructor(t){super(t,Il)}getParser(){return this.parser}}class Rl{constructor(){this._count=void 0}flush(){return this._count=0,!0}parse(t){return!!t&&(this._count=t.readInt(),!0)}get count(){return this._count}}class fl extends O{constructor(t){super(t,Rl)}getParser(){return this.parser}}class Ol{constructor(){this._groupId=void 0,this._threadId=void 0,this._message=void 0}flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return!!t&&(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=ll.parse(t),!0)}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class vl extends O{constructor(t){super(t,Ol)}getParser(){return this.parser}}class Al{constructor(){this._groupId=void 0,this._thread=void 0}flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return!!t&&(this._groupId=t.readInt(),this._thread=dl.parse(t),!0)}get groupId(){return this._groupId}get thread(){return this._thread}}class Sl extends O{constructor(t){super(t,Al)}getParser(){return this.parser}}class Nl extends O{constructor(t){super(t,pn)}getParser(){return this.parser}}class Ml extends O{constructor(t){super(t,mn)}getParser(){return this.parser}}class yl extends O{constructor(t){super(t,In)}getParser(){return this.parser}}class Dl extends O{constructor(t){super(t,Tn)}getParser(){return this.parser}}class Cl extends O{constructor(t){super(t,Rn)}getParser(){return this.parser}}class Ll extends O{constructor(t){super(t,fn)}getParser(){return this.parser}}class Ul extends O{constructor(t){super(t,On)}getParser(){return this.parser}}class Pl extends O{constructor(t){super(t,vn)}getParser(){return this.parser}}class bl extends O{constructor(t){super(t,An)}getParser(){return this.parser}}class wl extends O{constructor(t){super(t,Sn)}getParser(){return this.parser}}class Fl extends O{constructor(t){super(t,Nn)}getParser(){return this.parser}}class xl extends O{constructor(t){super(t,Mn)}getParser(){return this.parser}}class Bl extends O{constructor(t){super(t,Cn)}getParser(){return this.parser}}class Gl extends O{constructor(t){super(t,Ln)}getParser(){return this.parser}}class Hl extends O{constructor(t){super(t,Un)}getParser(){return this.parser}}class Vl extends O{constructor(t){super(t,Pn)}getParser(){return this.parser}}class jl extends O{constructor(t){super(t,bn)}getParser(){return this.parser}}class kl extends O{constructor(t){super(t,wn)}getParser(){return this.parser}}class Yl extends O{constructor(t){super(t,Fn)}getParser(){return this.parser}}class zl extends O{constructor(t){super(t,xn)}getParser(){return this.parser}}class Wl extends O{constructor(t){super(t,Bn)}getParser(){return this.parser}}class Kl extends O{constructor(t){super(t,Gn)}getParser(){return this.parser}}class Xl extends O{constructor(t){super(t,Hn)}getParser(){return this.parser}}class ql extends O{constructor(t){super(t,Vn)}getParser(){return this.parser}}class Ql extends O{constructor(t){super(t,jn)}getParser(){return this.parser}}class Zl extends O{constructor(t){super(t,kn)}getParser(){return this.parser}}class Jl extends O{constructor(t){super(t,Yn)}getParser(){return this.parser}}class $l{}$l.ACHIEVEMENT_LIST=305,$l.AUTHENTICATED=2491,$l.AUTHENTICATION=-1,$l.AVAILABILITY_STATUS=2033,$l.BUILDERS_CLUB_EXPIRED=1452,$l.CLUB_OFFERS=2405,$l.CATALOG_PAGE=804,$l.CATALOG_PAGE_LIST=1032,$l.CATALOG_PURCHASE_OK=869,$l.CATALOG_PURCHASE_ERROR=1404,$l.CATALOG_PURCHASE_NOT_ALLOWED=3770,$l.PRODUCT_OFFER=3388,$l.LIMITED_SOLD_OUT=377,$l.CATALOG_PUBLISHED=1866,$l.CFH_RESULT_MESSAGE=3635,$l.CLIENT_LATENCY=10,$l.CLIENT_PING=3928,$l.DESKTOP_CAMPAIGN=1745,$l.DESKTOP_NEWS=286,$l.DESKTOP_VIEW=122,$l.BUNDLE_DISCOUNT_RULESET=2347,$l.FIRST_LOGIN_OF_DAY=793,$l.FURNITURE_ALIASES=1723,$l.FURNITURE_DATA=2547,$l.FURNITURE_FLOOR=1778,$l.FURNITURE_FLOOR_ADD=1534,$l.FURNITURE_FLOOR_REMOVE=2703,$l.FURNITURE_FLOOR_UPDATE=3776,$l.FURNITURE_ITEMDATA=2202,$l.FURNITURE_STATE=2376,$l.FURNITURE_GROUP_CONTEXT_MENU_INFO=3293,$l.FURNITURE_POSTIT_STICKY_POLE_OPEN=2366,$l.GAME_CENTER_ACHIEVEMENTS=2265,$l.GAME_CENTER_GAME_LIST=222,$l.GAME_CENTER_STATUS=2893,$l.GENERIC_ALERT=3801,$l.MODERATOR_MESSAGE=2030,$l.GENERIC_ERROR=1600,$l.GIFT_WRAPPER_CONFIG=2234,$l.GROUP_BADGES=2402,$l.GROUP_CREATE_OPTIONS=2159,$l.GROUP_FORUM_DATA=3011,$l.GROUP_FORUM_LIST=3001,$l.GROUP_FORUM_THREADS=1073,$l.GROUP_FORUM_POST=2049,$l.GROUP_FORUM_POST_THREAD=1862,$l.GROUP_FORUM_THREAD_MESSAGES=509,$l.GROUP_FORUM_UNREAD_COUNT=2379,$l.GROUP_FORUM_UPDATE_MESSAGE=324,$l.GROUP_FORUM_UPDATE_THREAD=2528,$l.GROUP_INFO=1702,$l.GROUP_LIST=420,$l.GROUP_MEMBER=265,$l.GROUP_MEMBERS=1200,$l.GROUP_MEMBERS_REFRESH=2445,$l.GROUP_MEMBER_REMOVE_CONFIRM=1876,$l.GROUP_PURCHASED=2808,$l.GROUP_SETTINGS=3965,$l.GROUP_BADGE_PARTS=2238,$l.ITEM_DIMMER_SETTINGS=2710,$l.ITEM_STACK_HELPER=2816,$l.ITEM_WALL=1369,$l.ITEM_WALL_ADD=2187,$l.ITEM_WALL_REMOVE=3208,$l.ITEM_WALL_UPDATE=2009,$l.LOAD_GAME_URL=2624,$l.MARKETPLACE_CONFIG=1823,$l.MESSENGER_ACCEPT_FRIENDS=896,$l.MESSENGER_CHAT=1587,$l.MESSENGER_FIND_FRIENDS=1210,$l.MESSENGER_FOLLOW_FAILED=3048,$l.MESSENGER_FRIEND_NOTIFICATION=3082,$l.MESSENGER_FRIENDS=3130,$l.MESSENGER_INIT=1605,$l.MESSENGER_INSTANCE_MESSAGE_ERROR=3359,$l.MESSENGER_INVITE=3870,$l.MESSENGER_INVITE_ERROR=462,$l.MESSENGER_MESSAGE_ERROR=892,$l.MESSENGER_MINIMAIL_COUNT=2803,$l.MESSENGER_MINIMAIL_NEW=1911,$l.MESSENGER_RELATIONSHIPS=2016,$l.MESSENGER_REQUEST=2219,$l.MESSENGER_REQUEST_ERROR=892,$l.MESSENGER_REQUESTS=280,$l.MESSENGER_SEARCH=973,$l.MESSENGER_UPDATE=2800,$l.MODERATION_REPORT_DISABLED=1651,$l.MODERATION_TOOL=2696,$l.MODERATION_USER_INFO=2866,$l.MOTD_MESSAGES=2035,$l.NAVIGATOR_CATEGORIES=1562,$l.NAVIGATOR_COLLAPSED=1543,$l.NAVIGATOR_EVENT_CATEGORIES=3244,$l.NAVIGATOR_LIFTED=3104,$l.NAVIGATOR_METADATA=3052,$l.NAVIGATOR_OPEN_ROOM_CREATOR=2064,$l.NAVIGATOR_SEARCH=2690,$l.NAVIGATOR_SEARCHES=3984,$l.NAVIGATOR_SETTINGS=518,$l.THUMBNAIL_UPDATE_RESULT=1927,$l.CAN_CREATE_ROOM=378,$l.CATEGORIES_WITH_VISITOR_COUNT=1455,$l.COMPETITION_ROOMS_DATA=3954,$l.CONVERTED_ROOM_ID=1331,$l.GUEST_ROOM_SEARCH_RESULT=52,$l.NOTIFICATION_LIST=1992,$l.PET_FIGURE_UPDATE=1924,$l.PET_INFO=2901,$l.RECYCLER_PRIZES=3164,$l.ROOM_BAN_LIST=1869,$l.ROOM_BAN_REMOVE=3429,$l.ROOM_CREATED=1304,$l.ROOM_DOORBELL=2309,$l.ROOM_DOORBELL_ACCEPTED=3783,$l.ROOM_DOORBELL_REJECTED=878,$l.ROOM_ENTER=758,$l.ROOM_ENTER_ERROR=899,$l.ROOM_FORWARD=160,$l.ROOM_HEIGHT_MAP=2753,$l.ROOM_HEIGHT_MAP_UPDATE=558,$l.ROOM_INFO=687,$l.ROOM_INFO_OWNER=749,$l.ROOM_MODEL=1301,$l.ROOM_MODEL_BLOCKED_TILES=3990,$l.ROOM_MODEL_DOOR=1664,$l.ROOM_MODEL_NAME=2031,$l.ROOM_MUTED=2533,$l.ROOM_MUTE_USER=826,$l.ROOM_PAINT=2454,$l.ROOM_PROMOTION=2274,$l.ROOM_QUEUE_STATUS=2208,$l.ROOM_RIGHTS=780,$l.ROOM_RIGHTS_CLEAR=2392,$l.ROOM_RIGHTS_LIST=1284,$l.ROOM_RIGHTS_LIST_ADD=2088,$l.ROOM_RIGHTS_LIST_REMOVE=1327,$l.ROOM_RIGHTS_OWNER=339,$l.ROOM_ROLLING=3207,$l.ROOM_SCORE=482,$l.ROOM_SETTINGS=1498,$l.ROOM_SETTINGS_CHAT=1191,$l.ROOM_SETTINGS_SAVE=948,$l.ROOM_SETTINGS_SAVE_ERROR=1555,$l.ROOM_INFO_UPDATED=3297,$l.ROOM_SPECTATOR=1033,$l.ROOM_THICKNESS=3547,$l.INFO_FEED_ENABLE=3284,$l.SECURITY_MACHINE=1488,$l.MYSTERY_BOX_KEYS=2833,$l.TRADE_ACCEPTED=2568,$l.TRADE_CLOSED=1373,$l.TRADE_COMPLETED=1001,$l.TRADE_CONFIRMATION=2720,$l.TRADE_LIST_ITEM=2024,$l.TRADE_NOT_OPEN=3128,$l.TRADE_OPEN=2505,$l.TRADE_OPEN_FAILED=217,$l.TRADE_OTHER_NOT_ALLOWED=2154,$l.TRADE_YOU_NOT_ALLOWED=3058,$l.UNIT=374,$l.UNIT_CHANGE_NAME=2182,$l.UNIT_CHAT=1446,$l.UNIT_CHAT_SHOUT=1036,$l.UNIT_CHAT_WHISPER=2704,$l.UNIT_DANCE=2233,$l.UNIT_EFFECT=1167,$l.UNIT_EXPRESSION=1631,$l.UNIT_HAND_ITEM=1474,$l.UNIT_IDLE=1797,$l.UNIT_INFO=3920,$l.UNIT_NUMBER=2324,$l.UNIT_REMOVE=2661,$l.UNIT_STATUS=1640,$l.UNIT_TYPING=1717,$l.UNSEEN_ITEMS=2103,$l.USER_ACHIEVEMENT_SCORE=1968,$l.USER_BADGES=717,$l.USER_BADGES_ADD=2493,$l.USER_BADGES_CURRENT=1087,$l.USER_BOT_REMOVE=233,$l.USER_BOTS=3086,$l.USER_CHANGE_NAME=118,$l.USER_CLOTHING=1450,$l.USER_CREDITS=3475,$l.USER_CURRENCY=2018,$l.ACTIVITY_POINT_NOTIFICATION=2275,$l.USER_EFFECTS=340,$l.USER_FAVORITE_ROOM=2524,$l.USER_FAVORITE_ROOM_COUNT=151,$l.USER_FIGURE=2429,$l.USER_FURNITURE=994,$l.USER_FURNITURE_ADD=104,$l.USER_FURNITURE_POSTIT_PLACED=1501,$l.USER_FURNITURE_REFRESH=3151,$l.USER_FURNITURE_REMOVE=159,$l.USER_HOME_ROOM=2875,$l.ROOM_EVENT_CANCEL=3479,$l.ROOM_EVENT=1840,$l.USER_IGNORED=126,$l.USER_IGNORED_RESULT=207,$l.USER_INFO=2725,$l.USER_OUTFITS=3315,$l.USER_PERKS=2586,$l.USER_PERMISSIONS=411,$l.USER_PET_ADD=2101,$l.USER_PET_REMOVE=3253,$l.USER_PETS=3522,$l.USER_PROFILE=3898,$l.USER_RESPECT=2815,$l.USER_SANCTION_STATUS=3679,$l.USER_SETTINGS=513,$l.USER_SUBSCRIPTION=954,$l.USER_WARDROBE_PAGE=3315,$l.WIRED_ACTION=1434,$l.WIRED_CONDITION=1108,$l.WIRED_ERROR=156,$l.WIRED_OPEN=1830,$l.WIRED_REWARD=178,$l.WIRED_SAVE=1155,$l.WIRED_TRIGGER=383,$l.PLAYING_GAME=448,$l.FURNITURE_STATE_2=3431,$l.REMOVE_BOT_FROM_INVENTORY=233,$l.ADD_BOT_TO_INVENTORY=1352,$l.ACHIEVEMENT_PROGRESSED=2107,$l.MODTOOL_ROOM_INFO=1333,$l.MODTOOL_USER_CHATLOG=3377,$l.MODTOOL_ROOM_CHATLOG=3434,$l.MODTOOL_VISITED_ROOMS_USER=1752,$l.MODERATOR_ACTION_RESULT=2335,$l.ISSUE_DELETED=3192,$l.ISSUE_INFO=3609,$l.ISSUE_PICK_FAILED=3150,$l.CFH_CHATLOG=607,$l.MODERATOR_TOOL_PREFERENCES=1576,$l.LOVELOCK_FURNI_START=3753,$l.LOVELOCK_FURNI_FRIEND_COMFIRMED=382,$l.LOVELOCK_FURNI_FINISHED=770,$l.GIFT_RECEIVER_NOT_FOUND=1517,$l.GIFT_OPENED=56,$l.FLOOD_CONTROL=566,$l.REMAINING_MUTE=826,$l.USER_EFFECT_LIST=340,$l.USER_EFFECT_LIST_ADD=2867,$l.USER_EFFECT_LIST_REMOVE=2228,$l.USER_EFFECT_ACTIVATE=1959,$l.CLUB_GIFT_INFO=619,$l.REDEEM_VOUCHER_ERROR=714,$l.REDEEM_VOUCHER_OK=3336,$l.IN_CLIENT_LINK=2023,$l.BOT_COMMAND_CONFIGURATION=1618,$l.HAND_ITEM_RECEIVED=354,$l.PET_PLACING_ERROR=2913,$l.BOT_ERROR=639,$l.MARKETPLACE_SELL_ITEM=54,$l.MARKETPLACE_ITEM_STATS=725,$l.MARKETPLACE_OWN_ITEMS=3884,$l.MARKETPLACE_CANCEL_SALE=3264,$l.MARKETPLACE_ITEM_POSTED=1359,$l.MARKETPLACE_ITEMS_SEARCHED=680,$l.MARKETPLACE_AFTER_ORDER_STATUS=2032,$l.CATALOG_RECEIVE_PET_BREEDS=3331,$l.CATALOG_APPROVE_NAME_RESULT=1503,$l.OBJECTS_DATA_UPDATE=1453,$l.PET_EXPERIENCE=2156,$l.COMMUNITY_GOAL_VOTE_EVENT=1435,$l.PROMO_ARTICLES=286,$l.COMMUNITY_GOAL_EARNED_PRIZES=3319,$l.COMMUNITY_GOAL_PROGRESS=2525,$l.CONCURRENT_USERS_GOAL_PROGRESS=2737,$l.QUEST_DAILY=1878,$l.QUEST_CANCELLED=3027,$l.QUEST_COMPLETED=949,$l.COMMUNITY_GOAL_HALL_OF_FAME=3005,$l.EPIC_POPUP=3945,$l.SEASONAL_QUESTS=1122,$l.QUESTS=3625,$l.QUEST=230,$l.BONUS_RARE_INFO=1533,$l.CRAFTABLE_PRODUCTS=1e3,$l.CRAFTING_RECIPE=2774,$l.CRAFTING_RECIPES_AVAILABLE=2124,$l.CRAFTING_RESULT=618,$l.CAMERA_PUBLISH_STATUS=2057,$l.CAMERA_PURCHASE_OK=2783,$l.CAMERA_STORAGE_URL=3696,$l.COMPETITION_STATUS=133,$l.INIT_CAMERA=3878,$l.THUMBNAIL_STATUS=3595,$l.ACHIEVEMENT_NOTIFICATION=806,$l.CLUB_GIFT_NOTIFICATION=2188,$l.INTERSTITIAL_MESSAGE=1808,$l.ROOM_AD_ERROR=1759,$l.AVAILABILITY_TIME=600,$l.HOTEL_CLOSED_AND_OPENS=3728,$l.HOTEL_CLOSES_AND_OPENS_AT=2771,$l.HOTEL_WILL_CLOSE_MINUTES=1050,$l.HOTEL_MAINTENANCE=1350,$l.JUKEBOX_PLAYLIST_FULL=105,$l.JUKEBOX_SONG_DISKS=34,$l.NOW_PLAYING=469,$l.OFFICIAL_SONG_ID=1381,$l.PLAYLIST=1748,$l.PLAYLIST_SONG_ADDED=1140,$l.TRAX_SONG_INFO=3365,$l.USER_SONG_DISKS_INVENTORY=2602,$l.CHECK_USER_NAME=563,$l.CFH_SANCTION=2782,$l.CFH_TOPICS=325,$l.CFH_SANCTION_STATUS=2221,$l.CAMPAIGN_CALENDAR_DATA=2531,$l.CAMPAIGN_CALENDAR_DOOR_OPENED=2551,$l.BUILDERS_CLUB_FURNI_COUNT=3828,$l.BUILDERS_CLUB_SUBSCRIPTION=1452,$l.CATALOG_PAGE_EXPIRATION=2668,$l.CATALOG_EARLIEST_EXPIRY=2515,$l.CLUB_GIFT_SELECTED=659,$l.TARGET_OFFER_NOT_FOUND=1237,$l.TARGET_OFFER=119,$l.DIRECT_SMS_CLUB_BUY=195,$l.ROOM_AD_PURCHASE=2468,$l.NOT_ENOUGH_BALANCE=3914,$l.LIMITED_OFFER_APPEARING_NEXT=44,$l.IS_OFFER_GIFTABLE=761,$l.CLUB_EXTENDED_OFFER=3964,$l.SEASONAL_CALENDAR_OFFER=1889,$l.COMPETITION_ENTRY_SUBMIT=1177,$l.COMPETITION_VOTING_INFO=3506,$l.COMPETITION_TIMING_CODE=1745,$l.COMPETITION_USER_PART_OF=3841,$l.COMPETITION_NO_OWNED_ROOMS=2064,$l.COMPETITION_SECONDS_UNTIL=3926,$l.BADGE_POINT_LIMITS=2501,$l.BADGE_REQUEST_FULFILLED=2998,$l.HELPER_TALENT_TRACK=3406,$l.USER_BANNED=1683,$l.BOT_RECEIVED=3684,$l.PET_LEVEL_NOTIFICATION=859,$l.PET_RECEIVED=1111,$l.MODERATION_CAUTION=1890,$l.YOUTUBE_CONTROL_VIDEO=1554,$l.YOUTUBE_DISPLAY_PLAYLISTS=1112,$l.YOUTUBE_DISPLAY_VIDEO=1411,$l.CFH_DISABLED_NOTIFY=1651,$l.QUESTION=2665,$l.POLL_CONTENTS=2997,$l.POLL_ERROR=662,$l.POLL_OFFER=3785,$l.QUESTION_ANSWERED=2589,$l.QUESTION_FINISHED=1066,$l.CFH_PENDING_CALLS=1121,$l.GUIDE_ON_DUTY_STATUS=1548,$l.GUIDE_SESSION_ATTACHED=1591,$l.GUIDE_SESSION_DETACHED=138,$l.GUIDE_SESSION_ENDED=1456,$l.GUIDE_SESSION_ERROR=673,$l.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM=219,$l.GUIDE_SESSION_MESSAGE=841,$l.GUIDE_SESSION_PARTNER_IS_TYPING=1016,$l.GUIDE_SESSION_REQUESTER_ROOM=1847,$l.GUIDE_SESSION_STARTED=3209,$l.GUIDE_TICKET_CREATION_RESULT=3285,$l.GUIDE_TICKET_RESOLUTION=2674,$l.GUIDE_REPORTING_STATUS=3463,$l.HOTEL_MERGE_NAME_CHANGE=1663,$l.ISSUE_CLOSE_NOTIFICATION=934,$l.QUIZ_DATA=2927,$l.QUIZ_RESULTS=2772,$l.CFH_PENDING_CALLS_DELETED=77,$l.CFH_REPLY=3796,$l.CHAT_REVIEW_SESSION_DETACHED=30,$l.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE=735,$l.CHAT_REVIEW_SESSION_RESULTS=3276,$l.CHAT_REVIEW_SESSION_STARTED=143,$l.CHAT_REVIEW_SESSION_VOTING_STATUS=1829,$l.SCR_SEND_KICKBACK_INFO=3277,$l.PET_STATUS=1907,$l.GROUP_DEACTIVATE=3129,$l.PET_RESPECTED=2788,$l.PET_SUPPLEMENT=3441,$l.NOOBNESS_LEVEL=3738,$l.CAN_CREATE_ROOM_EVENT=2599,$l.FAVORITE_GROUP_UDPATE=3403,$l.NO_SUCH_FLAT=84,$l.ROOM_SETTINGS_ERROR=2897,$l.SHOW_ENFORCE_ROOM_CATEGORY=3896,$l.CUSTOM_USER_NOTIFICATION=909;class tg extends O{constructor(t){super(t,Wn)}getParser(){return this.parser}}class eg{constructor(t){this._achievementId=void 0,this._level=void 0,this._badgeId=void 0,this._requiredLevel=void 0,this._state=void 0,this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._requiredLevel=t.readInt(),this._state=t.readInt()}dispose(){this._achievementId=0,this._level=0,this._badgeId="",this._requiredLevel=0}get achievementId(){return this._achievementId}get level(){return this._level}get badgeId(){return this._badgeId}get requiredLevel(){return this._requiredLevel}get enabled(){return this._state===eg.STATE_SELECTABLE}get state(){return this._state}}eg.STATE_SELECTABLE=0;class sg extends O{constructor(t){super(t,Kn)}getParser(){return this.parser}}class ig extends O{constructor(t){super(t,Xn)}getParser(){return this.parser}}class rg extends O{constructor(t){super(t,qn)}getParser(){return this.parser}}class ng extends O{constructor(t){super(t,Qn)}getParser(){return this.parser}}class ag extends O{constructor(t){super(t,Zn)}getParser(){return this.parser}}class og extends O{constructor(t){super(t,$n)}getParser(){return this.parser}}class hg extends O{constructor(t){super(t,ea)}getParser(){return this.parser}}class _g extends O{constructor(t){super(t,sa)}getParser(){return this.parser}}class dg extends O{constructor(t){super(t,ia)}getParser(){return this.parser}}class ug extends O{constructor(t){super(t,ra)}getParser(){return this.parser}}class cg extends O{constructor(t){super(t,na)}getParser(){return this.parser}}class lg extends O{constructor(t){super(t,fa)}getParser(){return this.parser}}class gg extends O{constructor(t){super(t,va)}getParser(){return this.parser}}class Eg extends O{constructor(t){super(t,Oa)}getParser(){return this.parser}}class pg extends O{constructor(t){super(t,Aa)}getParser(){return this.parser}}class mg extends O{constructor(t){super(t,Sa)}getParser(){return this.parser}}class Ig extends O{constructor(t){super(t,Na)}getParser(){return this.parser}}class Tg extends O{constructor(t){super(t,Ma)}getParser(){return this.parser}}class Rg extends O{constructor(t){super(t,Da)}getParser(){return this.parser}}class fg extends O{constructor(t){super(t,Ca)}getParser(){return this.parser}}class Og extends O{constructor(t){super(t,La)}getParser(){return this.parser}}class vg extends O{constructor(t){super(t,Ua)}get userID(){return this.getParser().userID}get userAccepts(){return this.getParser().userAccepts}getParser(){return this.parser}}class Ag extends O{constructor(t){super(t,Pa)}get userID(){return this.getParser().userID}getParser(){return this.parser}}class Sg extends O{constructor(t){super(t,ba)}getParser(){return this.parser}}class Ng extends O{constructor(t){super(t,wa)}getParser(){return this.parser}}class Mg extends O{constructor(t){super(t,xa)}get firstUserID(){return this.getParser().firstUserID}get secondUserID(){return this.getParser().secondUserID}get firstUserNumItems(){return this.getParser().firstUserNumItems}get secondUserNumItems(){return this.getParser().secondUserNumItems}get firstUserNumCredits(){return this.getParser().firstUserNumCredits}get secondUserNumCredits(){return this.getParser().secondUserNumCredits}get firstUserItemArray(){return this.getParser().firstUserItemArray}get secondUserItemArray(){return this.getParser().secondUserItemArray}getParser(){return this.parser}}class yg extends O{constructor(t){super(t,Ba)}getParser(){return this.parser}}class Dg extends O{constructor(t){super(t,Ha)}get userID(){return this.getParser().userID}get userCanTrade(){return this.getParser().userCanTrade}get otherUserID(){return this.getParser().otherUserID}get otherUserCanTrade(){return this.getParser().otherUserCanTrade}getParser(){return this.parser}}class Cg extends O{constructor(t){super(t,Ga)}getParser(){return this.parser}}class Lg extends O{constructor(t){super(t,Va)}getParser(){return this.parser}}class Ug extends O{constructor(t){super(t,ja)}getParser(){return this.parser}}class Pg extends O{constructor(t){super(t,Ya)}getParser(){return this.parser}}class bg extends O{constructor(t){super(t,za)}getParser(){return this.parser}}class wg extends O{constructor(t){super(t,Wa)}getParser(){return this.parser}}class Fg extends O{constructor(t){super(t,Ka)}getParser(){return this.parser}}class xg extends O{constructor(t){super(t,Xa)}getParser(){return this.parser}}class Bg extends O{constructor(t){super(t,qa)}getParser(){return this.parser}}class Gg extends O{constructor(t){super(t,Za)}getParser(){return this.parser}}class Hg extends O{constructor(t){super(t,Qa)}getParser(){return this.parser}}class Vg extends O{constructor(t){super(t,to)}getParser(){return this.parser}}class jg extends O{constructor(t){super(t,eo)}getParser(){return this.parser}}class kg extends O{constructor(t){super(t,no)}getParser(){return this.parser}}class Yg extends O{constructor(t){super(t,ao)}getParser(){return this.parser}}class zg extends O{constructor(t){super(t,_o)}getParser(){return this.parser}}class Wg extends O{constructor(t){super(t,uo)}getParser(){return this.parser}}class Kg extends O{constructor(t){super(t,lo)}getParser(){return this.parser}}class Xg extends O{constructor(t){super(t,co)}getParser(){return this.parser}}class qg extends O{constructor(t){super(t,Eo)}getParser(){return this.parser}}class Qg extends O{constructor(t){super(t,po)}getParser(){return this.parser}}class Zg extends O{constructor(t){super(t,To)}getParser(){return this.parser}}class Jg extends O{constructor(t){super(t,Ro)}getParser(){return this.parser}}class $g extends O{constructor(t){super(t,Oo)}getParser(){return this.parser}}class tE extends O{constructor(t){super(t,vo)}getParser(){return this.parser}}class eE extends O{constructor(t){super(t,No)}getParser(){return this.parser}}class sE extends O{constructor(t){super(t,Mo)}getParser(){return this.parser}}class iE extends O{constructor(t){super(t,Do)}getParser(){return this.parser}}class rE extends O{constructor(t){super(t,Co)}getParser(){return this.parser}}class nE extends O{constructor(t){super(t,Uo)}getParser(){return this.parser}}class aE extends O{constructor(t){super(t,Lo)}getParser(){return this.parser}}class oE extends O{constructor(t){super(t,bo)}getParser(){return this.parser}}class hE extends O{constructor(t){super(t,Fo)}getParser(){return this.parser}}class _E extends O{constructor(t){super(t,xo)}getParser(){return this.parser}}class dE extends O{constructor(t){super(t,Bo)}getParser(){return this.parser}get userName(){return this.getParser().userName}}class uE extends O{constructor(t){super(t,Go)}getParser(){return this.parser}}class cE extends O{constructor(t){super(t,Ho)}getParser(){return this.parser}}class lE extends O{constructor(t){super(t,Vo)}getParser(){return this.parser}}class gE extends O{constructor(t){super(t,jo)}getParser(){return this.parser}}class EE extends O{constructor(t){super(t,Wo)}getParser(){return this.parser}}class pE extends O{constructor(t){super(t,A_)}getParser(){return this.parser}}class mE extends O{constructor(t){super(t,N_)}getParser(){return this.parser}}class IE extends O{constructor(t){super(t,y_)}getParser(){return this.parser}}class TE extends O{constructor(t){super(t,C_)}getParser(){return this.parser}}class RE extends O{constructor(t){super(t,P_)}getParser(){return this.parser}}class fE extends O{constructor(t){super(t,b_)}getParser(){return this.parser}}class OE extends O{constructor(t){super(t,w_)}getParser(){return this.parser}}class vE extends O{constructor(t){super(t,B_)}getParser(){return this.parser}}class AE extends O{constructor(t){super(t,G_)}getParser(){return this.parser}}class SE extends O{constructor(t){super(t,H_)}getParser(){return this.parser}}class NE extends O{constructor(t){super(t,j_)}getParser(){return this.parser}}class ME extends O{constructor(t){super(t,k_)}getParser(){return this.parser}}class yE extends O{constructor(t){super(t,Y_)}getParser(){return this.parser}}class DE extends O{constructor(t){super(t,z_)}getParser(){return this.parser}}class CE extends O{constructor(t){super(t,W_)}getParser(){return this.parser}}class LE{constructor(t){this._type=void 0,this._level=void 0,this._points=void 0,this._levelRewardPoints=void 0,this._levelRewardPointType=void 0,this._bonusPoints=void 0,this._badgeId=void 0,this._badgeCode="",this._removedBadgeCode="",this._achievementID=void 0,this._category=void 0,this._showDialogToUser=void 0,this._type=t.readInt(),this._level=t.readInt(),this._badgeId=t.readInt(),this._badgeCode=t.readString(),this._points=t.readInt(),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._bonusPoints=t.readInt(),this._achievementID=t.readInt(),this._removedBadgeCode=t.readString(),this._category=t.readString(),this._showDialogToUser=t.readBoolean()}get type(){return this._type}get level(){return this._level}get points(){return this._points}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get bonusPoints(){return this._bonusPoints}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}get removedBadgeCode(){return this._removedBadgeCode}get achievementID(){return this._achievementID}get category(){return this._category}get showDialogToUser(){return this._showDialogToUser}}class UE extends O{constructor(t){super(t,K_)}getParser(){return this.parser}}class PE extends O{constructor(t){super(t,X_)}getParser(){return this.parser}}class bE extends O{constructor(t){super(t,q_)}getParser(){return this.parser}}class wE extends O{constructor(t){super(t,Q_)}getParser(){return this.parser}}class FE extends O{constructor(t){super(t,Z_)}getParser(){return this.parser}}class xE extends O{constructor(t){super(t,J_)}getParser(){return this.parser}}class BE extends O{constructor(t){super(t,$_)}getParser(){return this.parser}}class GE extends O{constructor(t){super(t,td)}getParser(){return this.parser}}class HE extends O{constructor(t){super(t,ed)}getParser(){return this.parser}}class VE extends O{constructor(t){super(t,sd)}getParser(){return this.parser}}class jE extends O{constructor(t){super(t,id)}getParser(){return this.parser}}class kE extends O{constructor(t){super(t,ad)}getParser(){return this.parser}}class YE extends O{constructor(t){super(t,_d)}getParser(){return this.parser}}class zE extends O{constructor(t){super(t,dd)}getParser(){return this.parser}}class WE extends O{constructor(t){super(t,ud)}getParser(){return this.parser}}class KE extends O{constructor(t){super(t,cd)}getParser(){return this.parser}}class XE extends O{constructor(t){super(t,gd)}getParser(){return this.parser}}class qE extends O{constructor(t){super(t,ld)}getParser(){return this.parser}}class QE extends O{constructor(t){super(t,pd)}getParser(){return this.parser}}class ZE extends O{constructor(t){super(t,Td)}getParser(){return this.parser}}class JE extends O{constructor(t){super(t,fd)}getParser(){return this.parser}}class $E extends O{constructor(t){super(t,Od)}getParser(){return this.parser}}class tp extends O{constructor(t){super(t,vd)}getParser(){return this.parser}}class ep extends O{constructor(t){super(t,Ad)}getParser(){return this.parser}}class sp extends O{constructor(t){super(t,Nd)}getParser(){return this.parser}}class ip extends O{constructor(t){super(t,Md)}getParser(){return this.parser}}class rp extends O{constructor(t){super(t,yd)}getParser(){return this.parser}}class np extends O{constructor(t){super(t,Dd)}getParser(){return this.parser}}class ap extends O{constructor(t){super(t,Cd)}getParser(){return this.parser}}class op extends O{constructor(t){super(t,Xo)}getParser(){return this.parser}}class hp extends O{constructor(t){super(t,qo)}getParser(){return this.parser}}class _p extends O{constructor(t){super(t,Jo)}getParser(){return this.parser}}class dp extends O{constructor(t){super(t,Qo)}getParser(){return this.parser}}class up extends O{constructor(t){super(t,Ko)}getParser(){return this.parser}}class cp extends O{constructor(t){super(t,$o)}getParser(){return this.parser}}class lp extends O{constructor(t){super(t,th)}getParser(){return this.parser}}class gp extends O{constructor(t){super(t,eh)}getParser(){return this.parser}}class Ep extends O{constructor(t){super(t,sh)}getParser(){return this.parser}}class pp extends O{constructor(t){super(t,ih)}getParser(){return this.parser}}class mp extends O{constructor(t){super(t,rh)}getParser(){return this.parser}}class Ip extends O{constructor(t){super(t,oh)}getParser(){return this.parser}}class Tp extends O{constructor(t){super(t,_h)}getParser(){return this.parser}}class Rp extends O{constructor(t){super(t,dh)}getParser(){return this.parser}}class fp extends O{constructor(t){super(t,uh)}getParser(){return this.parser}}class Op extends O{constructor(t){super(t,lh)}getParser(){return this.parser}}class vp extends O{constructor(t){super(t,gh)}getParser(){return this.parser}}class Ap extends O{constructor(t){super(t,Eh)}getParser(){return this.parser}}class Sp extends O{constructor(t){super(t,ph)}getParser(){return this.parser}}class Np extends O{constructor(t){super(t,mh)}getParser(){return this.parser}}class Mp extends O{constructor(t){super(t,Ta)}getParser(){return this.parser}}class yp extends O{constructor(t){super(t,Ih)}getParser(){return this.parser}}class Dp extends O{constructor(t){super(t,Th)}getParser(){return this.parser}}class Cp extends O{constructor(t){super(t,Rh)}getParser(){return this.parser}}class Lp extends O{constructor(t){super(t,fh)}getParser(){return this.parser}}class Up extends O{constructor(t){super(t,Oh)}getParser(){return this.parser}}class Pp extends O{constructor(t){super(t,vh)}getParser(){return this.parser}}class bp extends O{constructor(t){super(t,Ah)}getParser(){return this.parser}}class wp extends O{constructor(t){super(t,Sh)}getParser(){return this.parser}}class Fp extends O{constructor(t){super(t,Mh)}getParser(){return this.parser}}class xp extends O{constructor(t){super(t,Dh)}getParser(){return this.parser}}class Bp extends O{constructor(t){super(t,Ch)}getParser(){return this.parser}}class Gp extends O{constructor(t){super(t,Lh)}getParser(){return this.parser}}class Hp extends O{constructor(t){super(t,Uh)}getParser(){return this.parser}}class Vp extends O{constructor(t){super(t,Ph)}getParser(){return this.parser}}class jp extends O{constructor(t){super(t,wh)}getParser(){return this.parser}}class kp extends O{constructor(t){super(t,Fh)}getParser(){return this.parser}}class Yp extends O{constructor(t){super(t,kh)}getParser(){return this.parser}}class zp extends O{constructor(t){super(t,Yh)}getParser(){return this.parser}}class Wp extends O{constructor(t){super(t,zh)}getParser(){return this.parser}}class Kp extends O{constructor(t){super(t,Wh)}getParser(){return this.parser}}class Xp extends O{constructor(t){super(t,Kh)}getParser(){return this.parser}}class qp extends O{constructor(t){super(t,Xh)}getParser(){return this.parser}}class Qp extends O{constructor(t){super(t,qh)}getParser(){return this.parser}}class Zp extends O{constructor(t){super(t,Qh)}getParser(){return this.parser}}class Jp extends O{constructor(t){super(t,Zh)}getParser(){return this.parser}}class $p extends O{constructor(t){super(t,Jh)}getParser(){return this.parser}}class tm extends O{constructor(t){super(t,$h)}getParser(){return this.parser}}class em extends O{constructor(t){super(t,e_)}getParser(){return this.parser}}class sm extends O{constructor(t){super(t,i_)}getParser(){return this.parser}}class im extends O{constructor(t){super(t,r_)}getParser(){return this.parser}}class rm extends O{constructor(t){super(t,n_)}getParser(){return this.parser}}class nm extends O{constructor(t){super(t,n_)}getParser(){return this.parser}}class am extends O{constructor(t){super(t,n_)}getParser(){return this.parser}}class om extends O{constructor(t){super(t,a_)}getParser(){return this.parser}}class hm extends O{constructor(t){super(t,o_)}getParser(){return this.parser}}class _m extends O{constructor(t){super(t,h_)}getParser(){return this.parser}}class dm extends O{constructor(t){super(t,m_)}getParser(){return this.parser}}class um extends O{constructor(t){super(t,__)}getParser(){return this.parser}}class cm extends O{constructor(t){super(t,d_)}getParser(){return this.parser}}class lm extends O{constructor(t){super(t,u_)}getParser(){return this.parser}}class gm extends O{constructor(t){super(t,c_)}getParser(){return this.parser}}class Em extends O{constructor(t){super(t,l_)}getParser(){return this.parser}}class pm extends O{constructor(t){super(t,g_)}getParser(){return this.parser}}class mm extends O{constructor(t){super(t,I_)}getParser(){return this.parser}}class Im extends O{constructor(t){super(t,f_)}getParser(){return this.parser}}class Tm extends O{constructor(t){super(t,Pd)}getParser(){return this.parser}}class Rm extends O{constructor(t){super(t,wd)}getParser(){return this.parser}}class fm extends O{constructor(t){super(t,xd)}getParser(){return this.parser}}class Om extends O{constructor(t){super(t,Bd)}getParser(){return this.parser}}class vm extends O{constructor(t){super(t,Gd)}getParser(){return this.parser}}vm.PRODUCT_DONATED_CODE=6,vm.BADGE_DONATED_CODE=7;class Am extends O{constructor(t){super(t,Hd)}getParser(){return this.parser}}class Sm extends O{constructor(t){super(t,Vd)}getParser(){return this.parser}}class Nm extends O{constructor(t){super(t,kd)}getParser(){return this.parser}}class Mm extends O{constructor(t){super(t,zd)}getParser(){return this.parser}}class ym extends O{constructor(t){super(t,Wd)}getParser(){return this.parser}}class Dm extends O{constructor(t){super(t,Kd)}getParser(){return this.parser}}class Cm extends O{constructor(t){super(t,Xd)}getParser(){return this.parser}}class Lm extends O{constructor(t){super(t,qd)}getParser(){return this.parser}}class Um extends O{constructor(t){super(t,Zd)}getParser(){return this.parser}}class Pm extends O{constructor(t){super(t,Jd)}getParser(){return this.parser}}class bm extends O{constructor(t){super(t,tu)}getParser(){return this.parser}}class wm extends O{constructor(t){super(t,Ou)}getParser(){return this.parser}}class Fm extends O{constructor(t){super(t,Fi)}getParser(){return this.parser}}class xm extends O{constructor(t){super(t,xi)}getParser(){return this.parser}}class Bm extends O{constructor(t){super(t,Hi)}getParser(){return this.parser}}class Gm extends O{constructor(t){super(t,Vi)}getParser(){return this.parser}}class Hm extends O{constructor(t){super(t,ki)}getParser(){return this.parser}}class Vm extends O{constructor(t){super(t,Yi)}getParser(){return this.parser}}class jm extends O{constructor(t){super(t,Wi)}getParser(){return this.parser}}class km extends O{constructor(t){super(t,Ki)}getParser(){return this.parser}}class Ym{constructor(){this._groups=void 0}flush(){return this._groups=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._groups.push(new zi(t)),e--;return!0}get groups(){return this._groups}}class zm extends O{constructor(t){super(t,Ym)}getParser(){return this.parser}}class Wm extends O{constructor(t){super(t,Xi)}getParser(){return this.parser}}class Km extends O{constructor(t){super(t,qi)}getParser(){return this.parser}}class Xm extends O{constructor(t){super(t,Qi)}getParser(){return this.parser}}class qm extends O{constructor(t){super(t,Zi)}getParser(){return this.parser}}class Qm extends O{constructor(t){super(t,Ji)}getParser(){return this.parser}}class Zm extends O{constructor(t){super(t,$i)}getParser(){return this.parser}}class Jm extends O{constructor(t){super(t,tr)}getParser(){return this.parser}}class $m extends O{constructor(t){super(t,nr)}getParser(){return this.parser}}class tI{}tI.WATER=0,tI.LIGHT=1,tI.REVIVE=2,tI.REBREED_FERTILIZER=3,tI.SPEED_FERTILIZER=4;class eI extends O{constructor(t){super(t,ar)}getParser(){return this.parser}}class sI extends O{constructor(t){super(t,_r)}getParser(){return this.parser}}class iI extends O{constructor(t){super(t,dr)}getParser(){return this.parser}}class rI{constructor(){this._data=void 0,this._data=[]}dispose(){}getMessageArray(){return this._data}}class nI{constructor(){this._data=void 0,this._data=[]}dispose(){}getMessageArray(){return this._data}}class aI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class oI{constructor(t){this._data=void 0,this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class hI{constructor(t){this._data=void 0,this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class _I{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dI{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class uI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class cI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class lI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){this._data=[]}assignBitmap(t){const e=At.generateImageUrl(t);if(!e)return;const s=e.split(",")[1],i=Uint8Array.from(atob(s),(t=>t.charCodeAt(0)));this._data.push(i.byteLength,i.buffer)}assignBase64(t){const e=t.split(",")[1],s=Uint8Array.from(atob(e),(t=>t.charCodeAt(0)));this._data.push(s.byteLength,s.buffer)}}class EI extends gI{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1)}}class pI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class mI{constructor(t,e){this._data=void 0,this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class II{constructor(t,e){this._data=void 0,this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class TI{constructor(t,e,s,i,r,n){this._data=void 0,this._data=[t,e,s,i,r,n]}dispose(){this._data=null}getMessageArray(){return this._data}}class RI{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}dispose(){this._data=null}getMessageArray(){return this._data}}class fI{constructor(){this._data=void 0,this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class OI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class vI{constructor(){this._data=void 0,this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class AI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class SI{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class NI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class MI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class yI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class DI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class CI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class LI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class UI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class PI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class bI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class wI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class FI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class xI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class BI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class GI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class HI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class VI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class jI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class kI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class YI{constructor(t,e,s,i,r,n,a,o,h){this._data=void 0,this._data=[t,e,s,i,r,n,a,o,h]}getMessageArray(){return this._data}dispose(){}}class zI{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class WI{constructor(t,e,s,i,r,n,a){this._data=void 0,this._data=[t,e,s,i,r,n,a]}getMessageArray(){return this._data}dispose(){}}class KI{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class XI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class qI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class QI{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class ZI{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class JI{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class $I{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class tT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class eT{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class sT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class iT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aT{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class oT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}oT.CONFIRM_LEVEL_NOT_ACCEPTED=0,oT.CONFIRM_LEVEL_NOT_SUBMITTED=1,oT.CONFIRM_LEVEL_NOT_CONFIRMED=2,oT.CONFIRM_LEVEL_COMMIT=3;class hT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class _T{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class dT{constructor(t,e){this._data=void 0,this._data=[t,e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class uT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class lT{constructor(t,e){this._data=void 0,this._data=[t,e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class gT{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class ET{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class pT{constructor(){this._data=void 0;for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class mT{constructor(t){this._data=void 0;for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];this._data=[t,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class IT{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class TT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class RT{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class fT{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class OT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class vT{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class AT{constructor(){this._data=void 0;for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class ST{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class NT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class MT{constructor(t,e){this._data=void 0,this._data=[e.length,...e,t]}getMessageArray(){return this._data}dispose(){}}class yT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class DT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class CT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class LT{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}LT.NO_ISSUE_ID=-1;class UT{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class PT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}PT.NO_ISSUE_ID=-1;class bT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class wT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class FT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class xT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class BT{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class GT{constructor(t,e,s,i,r,n){this._data=void 0,this._data=[t,e,s,i,r,n.length,...n]}getMessageArray(){return this._data}dispose(){}}class HT{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class VT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class jT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class YT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class zT{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class WT{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class KT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class XT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class qT{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class QT{constructor(t,e){this._data=void 0,this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class ZT{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class JT{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class $T{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class tR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class eR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sR{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class iR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rR{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class nR{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class aR{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class oR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class hR{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class _R{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class dR{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class uR{constructor(){this._data=void 0;for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this._data=[e.length],e.forEach((t=>{this._data.push(t.k),this._data.push(t._arg_2),this._data.push(t._arg_3)}))}getMessageArray(){return this._data}dispose(){}}class cR{constructor(t,e,s,i,r){this._data=void 0,this._data=[t,e,s,i,r]}getMessageArray(){return this._data}dispose(){}}class lR{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,i,s]}getMessageArray(){return this._data}dispose(){}}class gR{constructor(t,e,s){if(this._type=void 0,this._data=void 0,this._type=t,e.length===s.length){this._data=[];for(let t=0;t<e.length;t++)this._data.push(e[t]),this._data.push(s[t])}}getMessageArray(){return this._data}dispose(){}}class ER{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class pR{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class mR{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class IR{constructor(t,e,s,i,r){this._data=void 0,this._data=[t,e,s,i,r]}getMessageArray(){return this._data}dispose(){}}class TR{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class RR{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i.length/2,...i]}getMessageArray(){return this._data}dispose(){}}class fR{constructor(t,e,s,i,r){this._data=void 0,this._data=[t,e,s,i,r]}getMessageArray(){return this._data}dispose(){}}class OR{constructor(t,e,s,i,r){this._data=void 0,this._data=[t,e,s,i,r]}getMessageArray(){return this._data}dispose(){}}class vR{constructor(t,e,s,i,r){this._data=void 0,this._data=[t,e,s,i,r.length/2,...r]}getMessageArray(){return this._data}dispose(){}}class AR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class SR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class NR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class MR{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class yR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class DR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class CR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class LR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class UR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class PR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class bR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wR{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class FR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class BR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class GR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class HR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class VR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jR{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class kR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class YR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class zR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class WR{constructor(t,e){this._data=void 0,this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class KR{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class XR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class qR{constructor(){this._badges=[]}getMessageArray(){const t=[];for(let e=0;e<this._badges.length;e++)e<=this._badges.length?(t.push(e+1),t.push(this._badges[e])):(t.push(e+1),t.push(""));return t}dispose(){}addActivatedBadge(t){this._badges.push(t)}}class QR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class ZR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class JR{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class $R{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class tf{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class ef{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class sf{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class rf{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class nf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class af{constructor(){this._data=void 0;for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class of{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class _f{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class df{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class uf{constructor(t){this._data=void 0;for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];this._data=[t,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class cf{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class lf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class Ef{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class pf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class mf{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class If{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Tf{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){this._data=null}}class Rf{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){this._data=null}}class ff{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Of{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class vf{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Af{constructor(t,e,s){this._data=void 0,this._data=[t,e.length,...e,s]}getMessageArray(){return this._data}dispose(){}}class Sf{constructor(t,e){this._data=void 0,this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}Sf.RESOLUTION_USELESS=1,Sf.RESOLUTION_ABUSIVE=2,Sf.RESOLUTION_RESOLVED=3;class Nf{constructor(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1;this._data=void 0,this._data=[t,e,s,i,r],n!=Nf.NO_ISSUE_ID&&this._data.push(n)}getMessageArray(){return this._data}dispose(){}}Nf.NO_ISSUE_ID=-1;class Mf{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this._data=void 0,this._data=[t,e,s],i!=Nf.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class yf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Df{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Cf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Lf{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._data=void 0,this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Uf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Pf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bf{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this._data=void 0,this._data=[t,e,s],i!=Nf.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class wf{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Ff{constructor(t,e,s){this._data=[],this._data.push(t),this._data.push(e),this._data.push(s)}getMessageArray(){return this._data}dispose(){}}Ff.ACTION_ALERT=0,Ff.ACTION_KICK=1,Ff.ACTION_MESSAGE=3,Ff.ACTION_MESSAGE_AND_SOFT_KICK=4;class xf{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this._data=void 0,this._data=[t,e,s],i!=Nf.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class Bf{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this._data=[],this._data.push(t),this._data.push(e),this._data.push(""),this._data.push(""),this._data.push(s),i!=Nf.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class Gf{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this._data=void 0,this._data=[t,e,s],i!=Nf.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class Hf{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Vf{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class jf{constructor(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1;this._data=void 0,this._data=[t,e,s,i],r!=Nf.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class kf{constructor(t,e,s,i){this._data=void 0,this._data=[t.length,...t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Yf{constructor(t){this._data=void 0,this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class zf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Wf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Kf{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class Xf{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class qf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Qf{constructor(t,e,s,i,r,n){this._data=void 0,this._data=[t,e,s,i,r,n]}getMessageArray(){return this._data}dispose(){}}class Zf{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Jf{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class $f{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class eO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class sO{constructor(t,e,s){this._data=void 0,this._data=[t,e?1:0,s?1:0]}getMessageArray(){return this._data}dispose(){}}class iO{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class nO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class aO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class oO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class _O{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class dO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class uO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class cO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class lO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class gO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class EO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class pO{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class mO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class IO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class TO{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class RO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fO{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class OO{constructor(t,e,s,i,r,n){this._data=void 0,this._data=[t,e,s,i,r,n]}getMessageArray(){return this._data}dispose(){}}class vO{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class AO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class SO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class NO{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class MO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class yO{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class DO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class CO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class LO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class UO{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class PO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wO{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class FO{}FO.ACHIEVEMENT_LIST=219,FO.AUTHENTICATION=-1,FO.BOT_CONFIGURATION=1986,FO.BOT_PICKUP=3323,FO.BOT_PLACE=1592,FO.BOT_SKILL_SAVE=2624,FO.GET_CLUB_OFFERS=3285,FO.GET_CLUB_GIFT_INFO=487,FO.GET_CATALOG_INDEX=1195,FO.GET_CATALOG_PAGE=412,FO.CATALOG_PURCHASE=3492,FO.CATALOG_PURCHASE_GIFT=1411,FO.GET_PRODUCT_OFFER=2594,FO.CLIENT_LATENCY=295,FO.CLIENT_LATENCY_MEASURE=96,FO.CLIENT_POLICY=26979,FO.CLIENT_PONG=2596,FO.CLIENT_TOOLBAR_TOGGLE=2313,FO.CLIENT_VARIABLES=1053,FO.GET_CURRENT_TIMING_CODE=2912,FO.DESKTOP_NEWS=1827,FO.DESKTOP_VIEW=105,FO.GET_BUNDLE_DISCOUNT_RULESET=223,FO.EVENT_TRACKER=3457,FO.FIND_NEW_FRIENDS=516,FO.FURNITURE_ALIASES=3898,FO.FURNITURE_FLOOR_UPDATE=248,FO.FURNITURE_MULTISTATE=99,FO.FURNITURE_PICKUP=3456,FO.FURNITURE_PLACE=1258,FO.FURNITURE_POSTIT_PLACE=2248,FO.FURNITURE_POSTIT_SAVE_STICKY_POLE=3283,FO.FURNITURE_RANDOMSTATE=3617,FO.FURNITURE_WALL_MULTISTATE=210,FO.FURNITURE_WALL_UPDATE=168,FO.GAMES_INIT=2914,FO.GAMES_LIST=741,FO.GET_GIFT_WRAPPING_CONFIG=418,FO.GROUP_ADMIN_ADD=2894,FO.GROUP_ADMIN_REMOVE=722,FO.GROUP_CREATE_OPTIONS=798,FO.GROUP_FAVORITE=3549,FO.GET_FORUM_STATS=3149,FO.GET_FORUM_THREADS=873,FO.GET_FORUMS_LIST=436,FO.GET_FORUM_MESSAGES=232,FO.GET_FORUM_THREAD=3900,FO.GET_UNREAD_FORUMS_COUNT=2908,FO.FORUM_MODERATE_MESSAGE=286,FO.FORUM_MODERATE_THREAD=1397,FO.FORUM_POST_MESSAGE=3529,FO.UPDATE_FORUM_READ_MARKER=1855,FO.UPDATE_FORUM_SETTINGS=2214,FO.FORUM_UPDATE_THREAD=3045,FO.GROUP_INFO=2991,FO.GROUP_DELETE=1134,FO.GROUP_MEMBER_REMOVE_CONFIRM=3593,FO.GROUP_MEMBER_REMOVE=593,FO.GROUP_MEMBERS=312,FO.GROUP_MEMBERSHIPS=367,FO.GROUP_REQUEST=998,FO.GROUP_REQUEST_ACCEPT=3386,FO.GROUP_REQUEST_DECLINE=1894,FO.GROUP_SETTINGS=1004,FO.GROUP_PARTS=813,FO.GROUP_BUY=230,FO.GROUP_SAVE_INFORMATION=3137,FO.GROUP_SAVE_BADGE=1991,FO.GROUP_SAVE_COLORS=1764,FO.GROUP_SAVE_PREFERENCES=3435,FO.GROUP_BADGES=21,FO.INVENTORY_UNKNOWN=1371,FO.ITEM_CLOTHING_REDEEM=3374,FO.ITEM_COLOR_WHEEL_CLICK=2144,FO.ITEM_DICE_CLICK=1990,FO.ITEM_DICE_CLOSE=1533,FO.ITEM_DIMMER_SAVE=1648,FO.ITEM_DIMMER_SETTINGS=2813,FO.ITEM_DIMMER_TOGGLE=2296,FO.ITEM_EXCHANGE_REDEEM=3115,FO.ITEM_PAINT=711,FO.SET_OBJECT_DATA=3608,FO.ITEM_STACK_HELPER=3839,FO.ITEM_WALL_CLICK=210,FO.ITEM_WALL_UPDATE=168,FO.MARKETPLACE_CONFIG=2597,FO.ACCEPT_FRIEND=137,FO.MESSENGER_CHAT=3567,FO.DECLINE_FRIEND=2890,FO.FOLLOW_FRIEND=3997,FO.MESSENGER_FRIENDS=1523,FO.MESSENGER_INIT=2781,FO.MESSENGER_RELATIONSHIPS=2138,FO.SET_RELATIONSHIP_STATUS=3768,FO.REMOVE_FRIEND=1689,FO.REQUEST_FRIEND=3157,FO.GET_FRIEND_REQUESTS=2448,FO.SEND_ROOM_INVITE=1276,FO.HABBO_SEARCH=1210,FO.FRIEND_LIST_UPDATE=1419,FO.MOD_TOOL_USER_INFO=3295,FO.GET_USER_FLAT_CATS=3027,FO.NAVIGATOR_INIT=2110,FO.NAVIGATOR_SEARCH=249,FO.NAVIGATOR_SEARCH_CLOSE=1834,FO.NAVIGATOR_SEARCH_OPEN=637,FO.NAVIGATOR_SEARCH_SAVE=2226,FO.GET_USER_EVENT_CATS=1782,FO.NAVIGATOR_SETTINGS_SAVE=3159,FO.NAVIGATOR_CATEGORY_LIST_MODE=1202,FO.PET_INFO=2934,FO.PET_PICKUP=1581,FO.PET_PLACE=2647,FO.PET_RESPECT=3202,FO.PET_RIDE=1036,FO.PET_MOVE=3449,FO.RECYCLER_PRIZES=398,FO.RELEASE_VERSION=4e3,FO.CALL_FOR_HELP=1691,FO.ROOM_AMBASSADOR_ALERT=2996,FO.ROOM_BAN_GIVE=1477,FO.ROOM_BAN_LIST=2267,FO.ROOM_BAN_REMOVE=992,FO.ROOM_CREATE=2752,FO.ROOM_DELETE=532,FO.ROOM_DOORBELL=1644,FO.ROOM_ENTER=2312,FO.ROOM_FAVORITE=3817,FO.ROOM_FAVORITE_REMOVE=309,FO.CAN_CREATE_ROOM=2128,FO.CANCEL_ROOM_EVENT=2725,FO.EDIT_ROOM_EVENT=3991,FO.COMPETITION_ROOM_SEARCH=433,FO.FORWARD_TO_RANDOM_PROMOTED_ROOM=10,FO.FORWARD_TO_SOME_ROOM=1703,FO.GET_CATEGORIES_WITH_USER_COUNT=3782,FO.GET_GUEST_ROOM=2230,FO.GET_OFFICIAL_ROOMS=1229,FO.GET_POPULAR_ROOM_TAGS=826,FO.GUILD_BASE_SEARCH=2930,FO.MY_FAVOURITE_ROOMS_SEARCH=2578,FO.MY_FREQUENT_ROOM_HISTORY_SEARCH=1002,FO.MY_FRIENDS_ROOM_SEARCH=2266,FO.MY_GUILD_BASES_SEARCH=39,FO.MY_RECOMMENDED_ROOMS=2537,FO.MY_ROOM_HISTORY_SEARCH=2264,FO.MY_ROOM_RIGHTS_SEARCH=272,FO.MY_ROOMS_SEARCH=2277,FO.POPULAR_ROOMS_SEARCH=2758,FO.ROOM_AD_EVENT_TAB_CLICKED=2412,FO.ROOM_AD_EVENT_TAB_VIEWED=2668,FO.ROOM_AD_SEARCH=2809,FO.ROOM_TEXT_SEARCH=3943,FO.ROOMS_WHERE_MY_FRIENDS_ARE=1786,FO.ROOMS_WITH_HIGHEST_SCORE_SEARCH=2939,FO.SET_ROOM_SESSION_TAGS=3305,FO.UPDATE_ROOM_THUMBNAIL=2468,FO.ROOM_KICK=1320,FO.ROOM_LIKE=3582,FO.ROOM_MODEL=2300,FO.GET_OCCUPIED_TILES=1687,FO.GET_ROOM_ENTRY_TILE=3559,FO.ROOM_MODEL_SAVE=875,FO.ROOM_MUTE=3637,FO.ROOM_MUTE_USER=3485,FO.ROOM_RIGHTS_GIVE=808,FO.ROOM_RIGHTS_LIST=3385,FO.ROOM_RIGHTS_REMOVE=2064,FO.ROOM_RIGHTS_REMOVE_ALL=2683,FO.ROOM_RIGHTS_REMOVE_OWN=3182,FO.ROOM_SETTINGS=3129,FO.ROOM_SETTINGS_SAVE=1969,FO.ROOM_STAFF_PICK=1918,FO.SECURITY_MACHINE=2490,FO.SECURITY_TICKET=2419,FO.TRADE=1481,FO.TRADE_ACCEPT=3863,FO.TRADE_CANCEL=2341,FO.TRADE_CLOSE=2551,FO.TRADE_CONFIRM=2760,FO.TRADE_ITEM=3107,FO.TRADE_ITEM_REMOVE=3845,FO.TRADE_ITEMS=1263,FO.TRADE_UNACCEPT=1444,FO.UNIT_ACTION=2456,FO.UNIT_CHAT=1314,FO.UNIT_CHAT_SHOUT=2085,FO.UNIT_CHAT_WHISPER=1543,FO.UNIT_DANCE=2080,FO.UNIT_DROP_HAND_ITEM=2814,FO.UNIT_GIVE_HANDITEM=2941,FO.UNIT_LOOK=3301,FO.UNIT_POSTURE=2235,FO.UNIT_SIGN=1975,FO.UNIT_TYPING=1597,FO.UNIT_TYPING_STOP=1474,FO.UNIT_WALK=3320,FO.USER_BADGES=2769,FO.USER_BADGES_CURRENT=2091,FO.USER_BADGES_CURRENT_UPDATE=644,FO.USER_BOTS=3848,FO.USER_CURRENCY=273,FO.USER_EFFECT_ACTIVATE=2959,FO.USER_EFFECT_ENABLE=1752,FO.USER_FIGURE=2730,FO.USER_FURNITURE=3150,FO.USER_FURNITURE2=3500,FO.USER_HOME_ROOM=1740,FO.USER_INFO=357,FO.USER_MOTTO=2228,FO.USER_IGNORED=3878,FO.USER_PETS=3095,FO.USER_PROFILE=3265,FO.USER_PROFILE_BY_NAME=2249,FO.USER_RESPECT=2694,FO.GET_SOUND_SETTINGS=2388,FO.USER_SETTINGS_CAMERA=1461,FO.USER_SETTINGS_CHAT_STYLE=1030,FO.USER_SETTINGS_INVITES=1086,FO.USER_SETTINGS_OLD_CHAT=1262,FO.USER_SETTINGS_VOLUME=1367,FO.USER_SUBSCRIPTION=3166,FO.GET_WARDROBE=2742,FO.SAVE_WARDROBE_OUTFIT=800,FO.USER_TAGS=17,FO.VISIT_USER=2970,FO.WIRED_ACTION_SAVE=2281,FO.WIRED_APPLY_SNAPSHOT=3373,FO.WIRED_CONDITION_SAVE=3203,FO.WIRED_OPEN=768,FO.WIRED_TRIGGER_SAVE=1520,FO.GET_ITEM_DATA=3964,FO.ONE_WAY_DOOR_CLICK=2765,FO.REMOVE_WALL_ITEM=3336,FO.SET_ITEM_DATA=3666,FO.CATALOG_REDEEM_VOUCHER=339,FO.ROOM_TONER_APPLY=2880,FO.FRIEND_FURNI_CONFIRM_LOCK=3775,FO.MANNEQUIN_SAVE_NAME=2850,FO.MANNEQUIN_SAVE_LOOK=2209,FO.PRESENT_OPEN_PRESENT=3558,FO.CATALOG_SELECT_VIP_GIFT=2276,FO.USER_IGNORE_ID=3314,FO.USER_IGNORE=1117,FO.USER_UNIGNORE=2061,FO.MODTOOL_REQUEST_ROOM_INFO=707,FO.MODTOOL_CHANGE_ROOM_SETTINGS=3260,FO.MODTOOL_REQUEST_USER_CHATLOG=1391,FO.MODTOOL_REQUEST_ROOM_CHATLOG=2587,FO.MODTOOL_SANCTION_ALERT=229,FO.MODTOOL_SANCTION_BAN=2766,FO.MODTOOL_SANCTION_KICK=2582,FO.MODTOOL_SANCTION_TRADELOCK=3742,FO.MODTOOL_ALERTEVENT=1840,FO.MODTOOL_SANCTION_MUTE=1945,FO.MODTOOL_REQUEST_USER_ROOMS=3526,FO.MODTOOL_ROOM_ALERT=3842,FO.MODTOOL_PREFERENCES=31,FO.CLOSE_ISSUE_DEFAULT_ACTION=2717,FO.CLOSE_ISSUES=2067,FO.DEFAULT_SANCTION=1681,FO.GET_CFH_CHATLOG=211,FO.MODTOOL_SANCTION=1392,FO.PICK_ISSUES=15,FO.RELEASE_ISSUES=1572,FO.CONVERT_GLOBAL_ROOM_ID=314,FO.REQUEST_SELL_ITEM=848,FO.REQUEST_MARKETPLACE_ITEM_STATS=3288,FO.MARKETPLACE_SELL_ITEM=3447,FO.MARKETPLACE_REQUEST_OWN_ITEMS=2105,FO.MARKETPLACE_TAKE_BACK_ITEM=434,FO.MARKETPLACE_REDEEM_CREDITS=2650,FO.MARKETPLACE_REQUEST_OFFERS=2407,FO.MARKETPLACE_BUY_OFFER=1603,FO.MARKETPLACE_BUY_TOKENS=1866,FO.CATALOG_REQUESET_PET_BREEDS=1756,FO.APPROVE_NAME=2109,FO.UNIT_GIVE_HANDITEM_PET=2768,FO.PET_MOUNT=1036,FO.PET_SUPPLEMENT=749,FO.FURNITURE_GROUP_INFO=2651,FO.ACHIEVEMENT_RESOLUTION_OPEN=359,FO.USE_PET_PRODUCT=1328,FO.REMOVE_PET_SADDLE=186,FO.TOGGLE_PET_RIDING=1472,FO.TOGGLE_PET_BREEDING=3379,FO.UNSEEN_RESET_CATEGORY=3493,FO.UNSEEN_RESET_ITEMS=2343,FO.COMMUNITY_GOAL_VOTE_COMPOSER=3536,FO.GET_PROMO_ARTICLES=1827,FO.ACCEPT_QUEST=3604,FO.ACTIVATE_QUEST=793,FO.CANCEL_QUEST=3133,FO.FRIEND_REQUEST_QUEST_COMPLETE=1148,FO.GET_COMMUNITY_GOAL_EARNED_PRIZES=2688,FO.GET_COMMUNITY_GOAL_HALL_OF_FAME=2167,FO.GET_COMMUNITY_GOAL_PROGRESS=1145,FO.GET_CONCURRENT_USERS_GOAL_PROGRESS=1343,FO.GET_CONCURRENT_USERS_REWARD=3872,FO.GET_DAILY_QUEST=2486,FO.GET_QUESTS=3333,FO.GET_SEASONAL_QUESTS_ONLY=1190,FO.OPEN_QUEST_TRACKER=2750,FO.REDEEM_COMMUNITY_GOAL_PRIZE=90,FO.REJECT_QUEST=2397,FO.START_CAMPAIGN=1697,FO.GET_BONUS_RARE_INFO=957,FO.CRAFT=3591,FO.CRAFT_SECRET=1251,FO.GET_CRAFTABLE_PRODUCTS=633,FO.GET_CRAFTING_RECIPE=1173,FO.GET_CRAFTING_RECIPES_AVAILABLE=3086,FO.PHOTO_COMPETITION=3959,FO.PUBLISH_PHOTO=2068,FO.PURCHASE_PHOTO=2408,FO.RENDER_ROOM=3226,FO.RENDER_ROOM_THUMBNAIL=1982,FO.REQUEST_CAMERA_CONFIGURATION=796,FO.ADD_JUKEBOX_DISK=753,FO.GET_JUKEBOX_PLAYLIST=1435,FO.GET_NOW_PLAYING=1325,FO.GET_OFFICIAL_SONG_ID=3189,FO.GET_SONG_INFO=3082,FO.GET_SOUND_MACHINE_PLAYLIST=3498,FO.GET_USER_SONG_DISKS=2304,FO.REMOVE_JUKEBOX_DISK=3050,FO.INTERSTITIAL_SHOWN=1109,FO.GET_INTERSTITIAL=2519,FO.CHANGE_USERNAME=2977,FO.CHECK_USERNAME=3950,FO.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF=3889,FO.OPEN_CAMPAIGN_CALENDAR_DOOR=2257,FO.BUILDERS_CLUB_PLACE_ROOM_ITEM=1051,FO.BUILDERS_CLUB_PLACE_WALL_ITEM=462,FO.BUILDERS_CLUB_QUERY_FURNI_COUNT=2529,FO.GET_CATALOG_PAGE_EXPIRATION=742,FO.GET_CATALOG_PAGE_WITH_EARLIEST_EXP=3135,FO.GET_DIRECT_CLUB_BUY_AVAILABLE=801,FO.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER=603,FO.GET_HABBO_CLUB_EXTEND_OFFER=2462,FO.GET_IS_OFFER_GIFTABLE=1347,FO.GET_LIMITED_OFFER_APPEARING_NEXT=410,FO.GET_NEXT_TARGETED_OFFER=596,FO.GET_ROOM_AD_PURCHASE_INFO=1075,FO.GET_SEASONAL_CALENDAR_DAILY_OFFER=3257,FO.GET_TARGETED_OFFER=2487,FO.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED=2150,FO.PURCHASE_BASIC_MEMBERSHIP_EXTENSION=2735,FO.PURCHASE_ROOM_AD=777,FO.PURCHASE_TARGETED_OFFER=1826,FO.PURCHASE_VIP_MEMBERSHIP_EXTENSION=3407,FO.ROOM_AD_PURCHASE_INITIATED=2283,FO.SET_TARGETTED_OFFER_STATE=2041,FO.SHOP_TARGETED_OFFER_VIEWED=3483,FO.HELPER_TALENT_TRACK=196,FO.FORWARD_TO_A_COMPETITION_ROOM=172,FO.FORWARD_TO_A_SUBMITTABLE_ROOM=1450,FO.FORWARD_TO_RANDOM_COMPETITION_ROOM=865,FO.GET_IS_USER_PART_OF_COMPETITION=2077,FO.GET_SECONDS_UNTIL=271,FO.ROOM_COMPETITION_INIT=1334,FO.SUBMIT_ROOM_TO_COMPETITION=2595,FO.VOTE_FOR_ROOM=143,FO.GET_GIFT=2436,FO.RESET_PHONE_NUMBER_STATE=2741,FO.SET_PHONE_NUMBER_VERIFICATION_STATUS=1379,FO.TRY_PHONE_NUMBER=790,FO.VERIFY_CODE=2721,FO.CONTROL_YOUTUBE_DISPLAY_PLAYBACK=3005,FO.GET_YOUTUBE_DISPLAY_STATUS=336,FO.SET_YOUTUBE_DISPLAY_PLAYLIST=2069,FO.GO_TO_FLAT=685,FO.CALL_FOR_HELP_FROM_FORUM_MESSAGE=1412,FO.CALL_FOR_HELP_FROM_FORUM_THREAD=534,FO.CALL_FOR_HELP_FROM_IM=2950,FO.CALL_FOR_HELP_FROM_PHOTO=2492,FO.CALL_FOR_HELP_FROM_SELFIE=2755,FO.CHAT_REVIEW_GUIDE_DECIDES=3365,FO.CHAT_REVIEW_GUIDE_DETACHED=2501,FO.CHAT_REVIEW_GUIDE_VOTE=3961,FO.CHAT_REVIEW_SESSION_CREATE=3060,FO.DELETE_PENDING_CALLS_FOR_HELP=3605,FO.GET_CFH_STATUS=2746,FO.GET_FAQ_CATEGORY=3445,FO.GET_FAQ_TEXT=1849,FO.GET_GUIDE_REPORTING_STATUS=3786,FO.GET_PENDING_CALLS_FOR_HELP=3267,FO.GET_QUIZ_QUESTIONS=1296,FO.GUIDE_SESSION_CREATE=3338,FO.GUIDE_SESSION_FEEDBACK=477,FO.GUIDE_SESSION_GET_REQUESTER_ROOM=1052,FO.GUIDE_SESSION_GUIDE_DECIDES=1424,FO.GUIDE_SESSION_INVITE_REQUESTER=234,FO.GUIDE_SESSION_IS_TYPING=519,FO.GUIDE_SESSION_MESSAGE=3899,FO.GUIDE_SESSION_ON_DUTY_UPDATE=1922,FO.GUIDE_SESSION_REPORT=3969,FO.GUIDE_SESSION_REQUESTER_CANCELS=291,FO.GUIDE_SESSION_RESOLVED=887,FO.POST_QUIZ_ANSWERS=3720,FO.SEARCH_FAQS=2031,FO.POLL_ANSWER=3505,FO.POLL_REJECT=1773,FO.POLL_START=109,FO.DISCONNECT=2445,FO.SCR_GET_KICKBACK_INFO=869,FO.COMPOST_PLANT=3835,FO.HARVEST_PET=1521,FO.GROUP_UNFAVORITE=1820;class xO{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class BO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class GO{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class HO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class VO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class YO{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class zO{constructor(t,e,s){this._data=void 0,this._data=[t,e,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class WO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class KO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class XO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class qO{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class QO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class ZO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class JO{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class $O{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tv{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class ev{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class sv{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class iv{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class rv{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class nv{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class av{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class ov{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hv{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class _v{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dv{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class uv{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class cv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class lv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gv{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0;this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Ev{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Iv{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Tv{constructor(){this._data=void 0;for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class Rv{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class fv{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Ov{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class vv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Av{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Sv{constructor(t,e,s,i,r,n,a,o,h,_,d,u,c,l,g,E,p,m,I,T,R,f,O,v){this._data=void 0,this._data=[],this._data.push(t,e,s,i,r,n,a),this._data.push(h.length,...h),this._data.push(_,d,u,c,l,g,E,p,m,I,T,R,f,O,v)}getMessageArray(){return this._data}dispose(){}}class Nv{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Mv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class yv{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Dv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Cv extends Dv{constructor(t){super(t)}}class Lv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Uv extends Dv{constructor(t){super(t)}}class Pv{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class bv{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class wv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Fv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xv{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Bv{constructor(t,e){this._data=void 0,this._data=[t,2*e.size];for(const[s,i]of e.entries())this._data.push(s,i)}getMessageArray(){return this._data}dispose(){}}class Gv{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Hv{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class Vv{constructor(t,e,s,i,r){this._data=void 0,this._data=[t,e,s,i,r]}getMessageArray(){return this._data}dispose(){}}class jv{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class kv{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Yv{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class zv{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Wv{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Kv{constructor(t,e,s,i,r,n){this._itemId=void 0,this._category=void 0,this._wallLocation=void 0,this._x=void 0,this._y=void 0,this._direction=void 0,this._itemId=t,this._category=e,this._wallLocation=s,this._x=i,this._y=r,this._direction=n}getMessageArray(){switch(this._category){case st.FLOOR:return[`${this._itemId} ${this._x} ${this._y} ${this._direction}`];case st.WALL:return[`${this._itemId} ${this._wallLocation} `];default:return[]}}dispose(){}}class Xv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class qv{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Qv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Zv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Jv{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $v{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tA{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class eA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sA{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class iA{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-100;this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class rA{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class nA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aA{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class oA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hA{constructor(t,e,s,i){this._data=void 0,this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class _A{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class dA{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class uA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cA{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class lA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class gA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class EA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class pA{constructor(t,e,s,i,r,n,a){this._data=void 0,this._data=[t,e,s,i,r,n,a]}getMessageArray(){return this._data}dispose(){}}class mA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class IA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class TA{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class RA{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class fA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class OA{constructor(t,e,s){this._data=void 0,this._data=[t+" "+e,s]}getMessageArray(){return this._data}dispose(){}}class vA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class AA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class SA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class NA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class MA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class yA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class DA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class CA{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class LA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class UA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class PA{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class bA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class FA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class xA{constructor(t,e,s,i,r,n){this._data=void 0,this._data=[t,e.length,...e,s,i.length,...i,r,n]}getMessageArray(){return this._data}dispose(){}}class BA{constructor(t,e,s,i,r){this._data=void 0,this._data=[t,e.length,...e,s,i.length,...i,r]}getMessageArray(){return this._data}dispose(){}}class GA{constructor(t,e,s,i,r){this._data=void 0,this._data=[t,e.length,...e,s,i.length,...i,r]}getMessageArray(){return this._data}dispose(){}}class HA{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class VA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class jA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class kA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class YA{constructor(){this._data=void 0;for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this._data=[e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class zA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class WA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class KA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class XA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class qA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class QA{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class ZA{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class JA{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $A{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tS{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class eS{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sS{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class iS{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rS{constructor(t,e){this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class nS{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aS{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._data=void 0,this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class oS{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hS{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class _S{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class dS{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class uS{constructor(){this._data=void 0,this._data=[]}getMessageArray(){return this._data}dispose(){}}class cS{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class lS{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gS{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ES{constructor(t,e,s){this._data=void 0,this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class pS{constructor(t){this._data=void 0,this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mS extends O{constructor(t){super(t,Rr)}getParser(){return this.parser}}class IS extends O{constructor(t){super(t,Or)}getParser(){return this.parser}}class TS extends O{constructor(t){super(t,vr)}getParser(){return this.parser}}class RS extends O{constructor(t){super(t,Ar)}getParser(){return this.parser}}class fS extends O{constructor(t){super(t,Sr)}getParser(){return this.parser}}class OS extends O{constructor(t){super(t,Nr)}getParser(){return this.parser}}class vS extends O{constructor(t){super(t,Dn)}getParser(){return this.parser}}class AS extends O{constructor(t){super(t,nh)}getParser(){return this.parser}}class SS extends O{constructor(t){super(t,t_)}getParser(){return this.parser}}class NS extends O{constructor(t){super(t,s_)}getParser(){return this.parser}}class MS extends O{constructor(t){super(t,$d)}getParser(){return this.parser}}class yS{constructor(){this._selectionType=void 0}flush(){return this._selectionType=0,!0}parse(t){return!!t&&(this._selectionType=t.readInt(),!0)}get selectionType(){return this._selectionType}}class DS extends O{constructor(t){super(t,yS)}getParser(){return this.parser}}class CS{constructor(){this._roomId=void 0,this._userId=void 0}flush(){return this._roomId=0,this._userId=0,!0}parse(t){return!!t&&(this._roomId=t.readInt(),this._userId=t.readInt(),!0)}get roomId(){return this._roomId}get userId(){return this._userId}}class LS extends O{constructor(t){super(t,CS)}getParser(){return this.parser}}class US extends O{constructor(t){super(t,rr)}getParser(){return this.parser}}class PS{constructor(){this._events=void 0,this._composers=void 0,this._events=new Map,this._composers=new Map,this.registerEvents(),this.registerComposers()}registerEvents(){this._events.set($l.INTERSTITIAL_MESSAGE,vu),this._events.set($l.ROOM_AD_ERROR,Au),this._events.set($l.AVAILABILITY_STATUS,Su),this._events.set($l.AVAILABILITY_TIME,Nu),this._events.set($l.HOTEL_CLOSED_AND_OPENS,Mu),this._events.set($l.HOTEL_CLOSES_AND_OPENS_AT,yu),this._events.set($l.HOTEL_WILL_CLOSE_MINUTES,Du),this._events.set($l.HOTEL_MAINTENANCE,Cu),this._events.set($l.USER_CHANGE_NAME,Lu),this._events.set($l.CHECK_USER_NAME,Uu),this._events.set($l.USER_FIGURE,Pu),this._events.set($l.USER_OUTFITS,wu),this._events.set($l.ADD_BOT_TO_INVENTORY,Fu),this._events.set($l.USER_BOTS,xu),this._events.set($l.BOT_RECEIVED,Bu),this._events.set($l.REMOVE_BOT_FROM_INVENTORY,Gu),this._events.set($l.CFH_SANCTION,Vs),this._events.set($l.CFH_TOPICS,Ys),this._events.set($l.CFH_SANCTION_STATUS,zs),this._events.set($l.CAMERA_PUBLISH_STATUS,Hu),this._events.set($l.CAMERA_PURCHASE_OK,Vu),this._events.set($l.CAMERA_STORAGE_URL,ju),this._events.set($l.COMPETITION_STATUS,ku),this._events.set($l.INIT_CAMERA,Yu),this._events.set($l.THUMBNAIL_STATUS,zu),this._events.set($l.CAMPAIGN_CALENDAR_DATA,Wu),this._events.set($l.CAMPAIGN_CALENDAR_DOOR_OPENED,Ku),this._events.set($l.BONUS_RARE_INFO,Xu),this._events.set($l.BUILDERS_CLUB_FURNI_COUNT,qu),this._events.set($l.BUILDERS_CLUB_SUBSCRIPTION,Qu),this._events.set($l.BUNDLE_DISCOUNT_RULESET,Ju),this._events.set($l.CATALOG_PAGE_EXPIRATION,$u),this._events.set($l.CATALOG_PAGE,tc),this._events.set($l.CATALOG_PAGE_LIST,ec),this._events.set($l.CATALOG_EARLIEST_EXPIRY,sc),this._events.set($l.CATALOG_PUBLISHED,ic),this._events.set($l.CLUB_GIFT_INFO,rc),this._events.set($l.CLUB_GIFT_SELECTED,nc),this._events.set($l.DIRECT_SMS_CLUB_BUY,ac),this._events.set($l.GIFT_RECEIVER_NOT_FOUND,oc),this._events.set($l.GIFT_WRAPPER_CONFIG,hc),this._events.set($l.CLUB_EXTENDED_OFFER,_c),this._events.set($l.CLUB_OFFERS,dc),this._events.set($l.IS_OFFER_GIFTABLE,uc),this._events.set($l.LIMITED_SOLD_OUT,cc),this._events.set($l.LIMITED_OFFER_APPEARING_NEXT,lc),this._events.set($l.NOT_ENOUGH_BALANCE,gc),this._events.set($l.PRODUCT_OFFER,Ec),this._events.set($l.CATALOG_PURCHASE_ERROR,pc),this._events.set($l.CATALOG_PURCHASE_NOT_ALLOWED,mc),this._events.set($l.CATALOG_PURCHASE_OK,Ic),this._events.set($l.ROOM_AD_PURCHASE,Tc),this._events.set($l.SEASONAL_CALENDAR_OFFER,Rc),this._events.set($l.CATALOG_RECEIVE_PET_BREEDS,fc),this._events.set($l.TARGET_OFFER,Oc),this._events.set($l.TARGET_OFFER_NOT_FOUND,vc),this._events.set($l.REDEEM_VOUCHER_ERROR,Ac),this._events.set($l.REDEEM_VOUCHER_OK,Sc),this._events.set($l.CLIENT_PING,us),this._events.set($l.COMPETITION_ENTRY_SUBMIT,mS),this._events.set($l.COMPETITION_VOTING_INFO,IS),this._events.set($l.COMPETITION_TIMING_CODE,TS),this._events.set($l.COMPETITION_USER_PART_OF,RS),this._events.set($l.COMPETITION_NO_OWNED_ROOMS,fS),this._events.set($l.COMPETITION_SECONDS_UNTIL,OS),this._events.set($l.CRAFTABLE_PRODUCTS,Nc),this._events.set($l.CRAFTING_RECIPE,Mc),this._events.set($l.CRAFTING_RECIPES_AVAILABLE,yc),this._events.set($l.CRAFTING_RESULT,Dc),this._events.set($l.DESKTOP_VIEW,Cc),this._events.set($l.MESSENGER_ACCEPT_FRIENDS,Lc),this._events.set($l.MESSENGER_FIND_FRIENDS,Uc),this._events.set($l.MESSENGER_FOLLOW_FAILED,Pc),this._events.set($l.MESSENGER_FRIENDS,bc),this._events.set($l.MESSENGER_UPDATE,wc),this._events.set($l.MESSENGER_FRIEND_NOTIFICATION,Fc),this._events.set($l.MESSENGER_REQUESTS,xc),this._events.set($l.MESSENGER_SEARCH,Bc),this._events.set($l.MESSENGER_INSTANCE_MESSAGE_ERROR,Gc),this._events.set($l.MESSENGER_MESSAGE_ERROR,Hc),this._events.set($l.MESSENGER_INIT,Vc),this._events.set($l.MESSENGER_MINIMAIL_NEW,jc),this._events.set($l.MESSENGER_MINIMAIL_COUNT,kc),this._events.set($l.MESSENGER_CHAT,Yc),this._events.set($l.MESSENGER_REQUEST,zc),this._events.set($l.MESSENGER_INVITE_ERROR,Wc),this._events.set($l.MESSENGER_INVITE,Kc),this._events.set($l.LOAD_GAME_URL,Xc),this._events.set($l.GROUP_INFO,$c),this._events.set($l.GROUP_MEMBER_REMOVE_CONFIRM,Jc),this._events.set($l.GROUP_MEMBERS,tl),this._events.set($l.GROUP_CREATE_OPTIONS,Zc),this._events.set($l.GROUP_BADGE_PARTS,Qc),this._events.set($l.GROUP_SETTINGS,sl),this._events.set($l.GROUP_PURCHASED,el),this._events.set($l.GROUP_BADGES,Wm),this._events.set($l.GROUP_DEACTIVATE,il),this._events.set($l.GROUP_FORUM_DATA,ol),this._events.set($l.GROUP_FORUM_LIST,_l),this._events.set($l.GROUP_FORUM_THREADS,cl),this._events.set($l.GROUP_FORUM_POST,El),this._events.set($l.GROUP_FORUM_POST_THREAD,ml),this._events.set($l.GROUP_FORUM_THREAD_MESSAGES,Tl),this._events.set($l.GROUP_FORUM_UNREAD_COUNT,fl),this._events.set($l.GROUP_FORUM_UPDATE_MESSAGE,vl),this._events.set($l.GROUP_FORUM_UPDATE_THREAD,Sl),this._events.set($l.CFH_DISABLED_NOTIFY,Ml),this._events.set($l.CFH_PENDING_CALLS_DELETED,yl),this._events.set($l.CFH_PENDING_CALLS,Dl),this._events.set($l.CFH_REPLY,Cl),this._events.set($l.CFH_RESULT_MESSAGE,Ll),this._events.set($l.GUIDE_ON_DUTY_STATUS,xl),this._events.set($l.GUIDE_SESSION_ATTACHED,Bl),this._events.set($l.GUIDE_SESSION_DETACHED,Gl),this._events.set($l.GUIDE_SESSION_ENDED,Hl),this._events.set($l.GUIDE_SESSION_ERROR,Vl),this._events.set($l.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM,jl),this._events.set($l.GUIDE_SESSION_MESSAGE,kl),this._events.set($l.GUIDE_SESSION_PARTNER_IS_TYPING,Yl),this._events.set($l.GUIDE_SESSION_REQUESTER_ROOM,zl),this._events.set($l.GUIDE_SESSION_STARTED,Wl),this._events.set($l.GUIDE_TICKET_CREATION_RESULT,Kl),this._events.set($l.GUIDE_TICKET_RESOLUTION,Xl),this._events.set($l.GUIDE_REPORTING_STATUS,vS),this._events.set($l.HOTEL_MERGE_NAME_CHANGE,ql),this._events.set($l.ISSUE_CLOSE_NOTIFICATION,Ql),this._events.set($l.QUIZ_DATA,Zl),this._events.set($l.QUIZ_RESULTS,Jl),this._events.set($l.CHAT_REVIEW_SESSION_DETACHED,Ul),this._events.set($l.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE,Pl),this._events.set($l.CHAT_REVIEW_SESSION_RESULTS,bl),this._events.set($l.CHAT_REVIEW_SESSION_STARTED,wl),this._events.set($l.CHAT_REVIEW_SESSION_VOTING_STATUS,Fl),this._events.set($l.ACHIEVEMENT_PROGRESSED,tg),this._events.set($l.ACHIEVEMENT_LIST,sg),this._events.set($l.USER_ACHIEVEMENT_SCORE,ig),this._events.set($l.USER_EFFECT_ACTIVATE,rg),this._events.set($l.USER_EFFECT_LIST_ADD,ng),this._events.set($l.USER_EFFECT_LIST_REMOVE,ag),this._events.set($l.USER_EFFECT_LIST,og),this._events.set($l.USER_BADGES,dg),this._events.set($l.USER_BADGES_ADD,_g),this._events.set($l.BADGE_POINT_LIMITS,hg),this._events.set($l.BADGE_REQUEST_FULFILLED,ug),this._events.set($l.USER_CLOTHING,cg),this._events.set($l.USER_FURNITURE_ADD,lg),this._events.set($l.USER_FURNITURE,gg),this._events.set($l.USER_FURNITURE_REFRESH,Eg),this._events.set($l.USER_FURNITURE_REMOVE,pg),this._events.set($l.USER_FURNITURE_POSTIT_PLACED,mg),this._events.set($l.USER_PETS,Rg),this._events.set($l.USER_PET_REMOVE,Og),this._events.set($l.USER_PET_ADD,Tg),this._events.set($l.PET_RECEIVED,fg),this._events.set($l.PET_PLACING_ERROR,VE),this._events.set($l.YOUTUBE_CONTROL_VIDEO,Vp),this._events.set($l.YOUTUBE_DISPLAY_PLAYLISTS,jp),this._events.set($l.YOUTUBE_DISPLAY_VIDEO,kp),this._events.set($l.TRADE_ACCEPTED,vg),this._events.set($l.TRADE_CLOSED,Ag),this._events.set($l.TRADE_COMPLETED,Sg),this._events.set($l.TRADE_CONFIRMATION,Ng),this._events.set($l.TRADE_LIST_ITEM,Mg),this._events.set($l.TRADE_NOT_OPEN,yg),this._events.set($l.TRADE_OPEN_FAILED,Cg),this._events.set($l.TRADE_OPEN,Dg),this._events.set($l.TRADE_OTHER_NOT_ALLOWED,Lg),this._events.set($l.TRADE_YOU_NOT_ALLOWED,Ug),this._events.set($l.COMMUNITY_GOAL_VOTE_EVENT,bg),this._events.set($l.PROMO_ARTICLES,Pg),this._events.set($l.MARKETPLACE_AFTER_ORDER_STATUS,wg),this._events.set($l.MARKETPLACE_CANCEL_SALE,Fg),this._events.set($l.MARKETPLACE_SELL_ITEM,xg),this._events.set($l.MARKETPLACE_CONFIG,Bg),this._events.set($l.MARKETPLACE_ITEM_STATS,Gg),this._events.set($l.MARKETPLACE_ITEM_POSTED,Hg),this._events.set($l.MARKETPLACE_ITEMS_SEARCHED,Vg),this._events.set($l.MARKETPLACE_OWN_ITEMS,jg),this._events.set($l.USER_BANNED,sE),this._events.set($l.MODERATION_CAUTION,Xg),this._events.set($l.MODTOOL_ROOM_INFO,Zg),this._events.set($l.MODTOOL_USER_CHATLOG,iE),this._events.set($l.MODTOOL_ROOM_CHATLOG,tE),this._events.set($l.MODERATION_USER_INFO,$g),this._events.set($l.MODERATION_TOOL,qg),this._events.set($l.MODTOOL_VISITED_ROOMS_USER,eE),this._events.set($l.CFH_CHATLOG,kg),this._events.set($l.ISSUE_DELETED,Yg),this._events.set($l.ISSUE_INFO,zg),this._events.set($l.ISSUE_PICK_FAILED,Wg),this._events.set($l.MODERATOR_ACTION_RESULT,Kg),this._events.set($l.MODERATOR_MESSAGE,Qg),this._events.set($l.MODERATOR_TOOL_PREFERENCES,Jg),this._events.set($l.MYSTERY_BOX_KEYS,rE),this._events.set($l.CAN_CREATE_ROOM,nE),this._events.set($l.CAN_CREATE_ROOM_EVENT,aE),this._events.set($l.CATEGORIES_WITH_VISITOR_COUNT,oE),this._events.set($l.COMPETITION_ROOMS_DATA,hE),this._events.set($l.CONVERTED_ROOM_ID,_E),this._events.set($l.ROOM_DOORBELL,dE),this._events.set($l.USER_FAVORITE_ROOM,uE),this._events.set($l.USER_FAVORITE_ROOM_COUNT,cE),this._events.set($l.ROOM_DOORBELL_REJECTED,lE),this._events.set($l.ROOM_CREATED,gE),this._events.set($l.ROOM_INFO,EE),this._events.set($l.GUEST_ROOM_SEARCH_RESULT,pE),this._events.set($l.USER_HOME_ROOM,IE),this._events.set($l.ROOM_EVENT_CANCEL,SE),this._events.set($l.ROOM_EVENT,NE),this._events.set($l.ROOM_INFO_UPDATED,ME),this._events.set($l.THUMBNAIL_UPDATE_RESULT,yE),this._events.set($l.NAVIGATOR_EVENT_CATEGORIES,DE),this._events.set($l.NAVIGATOR_CATEGORIES,CE),this._events.set($l.NAVIGATOR_COLLAPSED,mE),this._events.set($l.NAVIGATOR_LIFTED,TE),this._events.set($l.NAVIGATOR_METADATA,RE),this._events.set($l.NAVIGATOR_OPEN_ROOM_CREATOR,fE),this._events.set($l.NAVIGATOR_SEARCHES,OE),this._events.set($l.NAVIGATOR_SEARCH,vE),this._events.set($l.NAVIGATOR_SETTINGS,AE),this._events.set($l.GENERIC_ALERT,FE),this._events.set($l.MOTD_MESSAGES,BE),this._events.set($l.NOTIFICATION_LIST,GE),this._events.set($l.UNSEEN_ITEMS,jE),this._events.set($l.ACHIEVEMENT_NOTIFICATION,UE),this._events.set($l.INFO_FEED_ENABLE,xE),this._events.set($l.CLUB_GIFT_NOTIFICATION,wE),this._events.set($l.ACTIVITY_POINT_NOTIFICATION,PE),this._events.set($l.BOT_ERROR,bE),this._events.set($l.PET_LEVEL_NOTIFICATION,HE),this._events.set($l.USER_PERKS,kE),this._events.set($l.QUESTION,XE),this._events.set($l.POLL_CONTENTS,YE),this._events.set($l.POLL_ERROR,zE),this._events.set($l.POLL_OFFER,WE),this._events.set($l.QUESTION_ANSWERED,KE),this._events.set($l.QUESTION_FINISHED,qE),this._events.set($l.COMMUNITY_GOAL_EARNED_PRIZES,QE),this._events.set($l.COMMUNITY_GOAL_PROGRESS,JE),this._events.set($l.CONCURRENT_USERS_GOAL_PROGRESS,$E),this._events.set($l.QUEST_DAILY,ip),this._events.set($l.QUEST_CANCELLED,ep),this._events.set($l.QUEST_COMPLETED,sp),this._events.set($l.COMMUNITY_GOAL_HALL_OF_FAME,ZE),this._events.set($l.EPIC_POPUP,tp),this._events.set($l.SEASONAL_QUESTS,ap),this._events.set($l.QUESTS,np),this._events.set($l.QUEST,rp),this._events.set($l.ROOM_ENTER_ERROR,up),this._events.set($l.ROOM_ENTER,cp),this._events.set($l.ROOM_FORWARD,lp),this._events.set($l.ROOM_DOORBELL_ACCEPTED,op),this._events.set($l.ROOM_RIGHTS_CLEAR,hp),this._events.set($l.ROOM_RIGHTS_OWNER,dp),this._events.set($l.ROOM_RIGHTS,_p),this._events.set($l.BOT_COMMAND_CONFIGURATION,gp),this._events.set($l.ROOM_SETTINGS_CHAT,Ep),this._events.set($l.ROOM_INFO_OWNER,pp),this._events.set($l.ROOM_SCORE,mp),this._events.set($l.ROOM_ROLLING,Tp),this._events.set($l.FURNITURE_FLOOR_ADD,Op),this._events.set($l.FURNITURE_FLOOR,vp),this._events.set($l.FURNITURE_FLOOR_REMOVE,Ap),this._events.set($l.FURNITURE_FLOOR_UPDATE,Sp),this._events.set($l.ITEM_WALL_ADD,xp),this._events.set($l.ITEM_WALL,Bp),this._events.set($l.ITEM_WALL_REMOVE,Gp),this._events.set($l.ITEM_WALL_UPDATE,Hp),this._events.set($l.FURNITURE_ALIASES,Np),this._events.set($l.FURNITURE_DATA,Mp),this._events.set($l.FURNITURE_ITEMDATA,Cp),this._events.set($l.ITEM_STACK_HELPER,yp),this._events.set($l.FURNITURE_STATE,bp),this._events.set($l.ITEM_DIMMER_SETTINGS,Fp),this._events.set($l.FURNITURE_STATE_2,fp),this._events.set($l.LOVELOCK_FURNI_FINISHED,Lp),this._events.set($l.LOVELOCK_FURNI_FRIEND_COMFIRMED,Up),this._events.set($l.LOVELOCK_FURNI_START,Pp),this._events.set($l.OBJECTS_DATA_UPDATE,Ip),this._events.set($l.FURNITURE_GROUP_CONTEXT_MENU_INFO,Dp),this._events.set($l.FURNITURE_POSTIT_STICKY_POLE_OPEN,wp),this._events.set($l.ROOM_SPECTATOR,NS),this._events.set($l.CUSTOM_USER_NOTIFICATION,Rp),this._events.set($l.ROOM_RIGHTS_LIST,Dm),this._events.set($l.ROOM_RIGHTS_LIST_ADD,Mm),this._events.set($l.ROOM_RIGHTS_LIST_REMOVE,ym),this._events.set($l.ROOM_BAN_LIST,Nm),this._events.set($l.ROOM_SETTINGS_SAVE_ERROR,bm),this._events.set($l.ROOM_SETTINGS,Um),this._events.set($l.ROOM_SETTINGS_SAVE,MS),this._events.set($l.ROOM_SETTINGS_ERROR,Pm),this._events.set($l.SHOW_ENFORCE_ROOM_CATEGORY,DS),this._events.set($l.ROOM_BAN_REMOVE,LS),this._events.set($l.ROOM_MUTED,Cm),this._events.set($l.NO_SUCH_FLAT,Lm),this._events.set($l.FAVORITE_GROUP_UDPATE,AS),this._events.set($l.ROOM_MODEL_DOOR,zp),this._events.set($l.ROOM_HEIGHT_MAP,Wp),this._events.set($l.ROOM_HEIGHT_MAP_UPDATE,Kp),this._events.set($l.ROOM_MODEL,Yp),this._events.set($l.ROOM_MODEL_NAME,Qp),this._events.set($l.ROOM_PAINT,qp),this._events.set($l.ROOM_THICKNESS,Zp),this._events.set($l.ROOM_MODEL_BLOCKED_TILES,Xp),this._events.set($l.PET_FIGURE_UPDATE,$p),this._events.set($l.PET_INFO,tm),this._events.set($l.PET_STATUS,SS),this._events.set($l.PET_EXPERIENCE,Jp),this._events.set($l.PLAYING_GAME,em),this._events.set($l.UNIT_DANCE,hm),this._events.set($l.UNIT_EFFECT,_m),this._events.set($l.UNIT,dm),this._events.set($l.UNIT_EXPRESSION,um),this._events.set($l.UNIT_HAND_ITEM,cm),this._events.set($l.UNIT_IDLE,gm),this._events.set($l.UNIT_INFO,Em),this._events.set($l.UNIT_NUMBER,pm),this._events.set($l.UNIT_REMOVE,mm),this._events.set($l.UNIT_STATUS,Im),this._events.set($l.HAND_ITEM_RECEIVED,lm),this._events.set($l.FLOOD_CONTROL,sm),this._events.set($l.REMAINING_MUTE,im),this._events.set($l.UNIT_CHAT,rm),this._events.set($l.UNIT_CHAT_SHOUT,nm),this._events.set($l.UNIT_CHAT_WHISPER,am),this._events.set($l.UNIT_TYPING,om),this._events.set($l.WIRED_ACTION,Tm),this._events.set($l.WIRED_CONDITION,Rm),this._events.set($l.WIRED_TRIGGER,fm),this._events.set($l.WIRED_OPEN,Om),this._events.set($l.WIRED_REWARD,vm),this._events.set($l.WIRED_SAVE,Am),this._events.set($l.WIRED_ERROR,Sm),this._events.set($l.AUTHENTICATED,ls),this._events.set($l.JUKEBOX_PLAYLIST_FULL,nu),this._events.set($l.JUKEBOX_SONG_DISKS,au),this._events.set($l.NOW_PLAYING,ou),this._events.set($l.OFFICIAL_SONG_ID,hu),this._events.set($l.PLAYLIST,du),this._events.set($l.PLAYLIST_SONG_ADDED,uu),this._events.set($l.TRAX_SONG_INFO,lu),this._events.set($l.USER_SONG_DISKS_INVENTORY,gu),this._events.set($l.HELPER_TALENT_TRACK,wm),this._events.set($l.IN_CLIENT_LINK,qm),this._events.set($l.USER_IGNORED,Km),this._events.set($l.USER_IGNORED_RESULT,Xm),this._events.set($l.USER_RESPECT,eI),this._events.set($l.USER_PERMISSIONS,Fm),this._events.set($l.USER_BADGES_CURRENT,Gm),this._events.set($l.USER_INFO,Hm),this._events.set($l.UNIT_CHANGE_NAME,Vm),this._events.set($l.USER_SETTINGS,km),this._events.set($l.USER_PROFILE,jm),this._events.set($l.MESSENGER_RELATIONSHIPS,Bm),this._events.set($l.GIFT_OPENED,Ig),this._events.set($l.USER_CREDITS,Qm),this._events.set($l.USER_CURRENCY,Zm),this._events.set($l.USER_SUBSCRIPTION,Jm),this._events.set($l.USER_WARDROBE_PAGE,iI),this._events.set($l.SCR_SEND_KICKBACK_INFO,sI),this._events.set($l.PET_RESPECTED,US),this._events.set($l.PET_SUPPLEMENT,$m),this._events.set($l.GENERIC_ERROR,qc),this._events.set($l.GROUP_LIST,zm),this._events.set($l.CATALOG_APPROVE_NAME_RESULT,xm),this._events.set($l.NOOBNESS_LEVEL,Nl)}registerComposers(){this._composers.set(FO.AUTHENTICATION,gR),this._composers.set(FO.INTERSTITIAL_SHOWN,nI),this._composers.set(FO.GET_INTERSTITIAL,rI),this._composers.set(FO.GET_WARDROBE,_I),this._composers.set(FO.SAVE_WARDROBE_OUTFIT,dI),this._composers.set(FO.CHANGE_USERNAME,oI),this._composers.set(FO.CHECK_USERNAME,hI),this._composers.set(FO.REQUEST_CAMERA_CONFIGURATION,pI),this._composers.set(FO.RENDER_ROOM,gI),this._composers.set(FO.RENDER_ROOM_THUMBNAIL,EI),this._composers.set(FO.PURCHASE_PHOTO,lI),this._composers.set(FO.PUBLISH_PHOTO,cI),this._composers.set(FO.PHOTO_COMPETITION,uI),this._composers.set(FO.OPEN_CAMPAIGN_CALENDAR_DOOR,II),this._composers.set(FO.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF,mI),this._composers.set(FO.BUILDERS_CLUB_PLACE_ROOM_ITEM,TI),this._composers.set(FO.BUILDERS_CLUB_PLACE_WALL_ITEM,RI),this._composers.set(FO.BUILDERS_CLUB_QUERY_FURNI_COUNT,fI),this._composers.set(FO.GET_CATALOG_INDEX,AI),this._composers.set(FO.GET_CATALOG_PAGE,SI),this._composers.set(FO.CATALOG_PURCHASE,zI),this._composers.set(FO.CATALOG_PURCHASE_GIFT,YI),this._composers.set(FO.GET_PRODUCT_OFFER,xI),this._composers.set(FO.GET_CLUB_OFFERS,DI),this._composers.set(FO.GET_CLUB_GIFT_INFO,yI),this._composers.set(FO.CATALOG_REDEEM_VOUCHER,qI),this._composers.set(FO.GROUP_MEMBERSHIPS,ZA),this._composers.set(FO.GET_GIFT_WRAPPING_CONFIG,LI),this._composers.set(FO.CATALOG_SELECT_VIP_GIFT,ZI),this._composers.set(FO.CATALOG_REQUESET_PET_BREEDS,HI),this._composers.set(FO.GET_BONUS_RARE_INFO,OI),this._composers.set(FO.GET_BUNDLE_DISCOUNT_RULESET,vI),this._composers.set(FO.GET_CATALOG_PAGE_EXPIRATION,NI),this._composers.set(FO.GET_CATALOG_PAGE_WITH_EARLIEST_EXP,MI),this._composers.set(FO.GET_DIRECT_CLUB_BUY_AVAILABLE,CI),this._composers.set(FO.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER,UI),this._composers.set(FO.GET_HABBO_CLUB_EXTEND_OFFER,PI),this._composers.set(FO.GET_IS_OFFER_GIFTABLE,bI),this._composers.set(FO.GET_LIMITED_OFFER_APPEARING_NEXT,wI),this._composers.set(FO.GET_NEXT_TARGETED_OFFER,FI),this._composers.set(FO.GET_ROOM_AD_PURCHASE_INFO,BI),this._composers.set(FO.GET_SEASONAL_CALENDAR_DAILY_OFFER,GI),this._composers.set(FO.GET_TARGETED_OFFER,VI),this._composers.set(FO.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED,jI),this._composers.set(FO.PURCHASE_BASIC_MEMBERSHIP_EXTENSION,kI),this._composers.set(FO.PURCHASE_ROOM_AD,WI),this._composers.set(FO.PURCHASE_TARGETED_OFFER,KI),this._composers.set(FO.PURCHASE_VIP_MEMBERSHIP_EXTENSION,XI),this._composers.set(FO.ROOM_AD_PURCHASE_INITIATED,QI),this._composers.set(FO.SET_TARGETTED_OFFER_STATE,JI),this._composers.set(FO.SHOP_TARGETED_OFFER_VIEWED,$I),this._composers.set(FO.FORWARD_TO_A_COMPETITION_ROOM,tT),this._composers.set(FO.FORWARD_TO_A_SUBMITTABLE_ROOM,eT),this._composers.set(FO.FORWARD_TO_RANDOM_COMPETITION_ROOM,sT),this._composers.set(FO.GET_CURRENT_TIMING_CODE,iT),this._composers.set(FO.GET_IS_USER_PART_OF_COMPETITION,rT),this._composers.set(FO.GET_SECONDS_UNTIL,nT),this._composers.set(FO.ROOM_COMPETITION_INIT,aT),this._composers.set(FO.SUBMIT_ROOM_TO_COMPETITION,oT),this._composers.set(FO.VOTE_FOR_ROOM,hT),this._composers.set(FO.CRAFT,_T),this._composers.set(FO.CRAFT_SECRET,dT),this._composers.set(FO.GET_CRAFTABLE_PRODUCTS,cT),this._composers.set(FO.GET_CRAFTING_RECIPE,uT),this._composers.set(FO.GET_CRAFTING_RECIPES_AVAILABLE,lT),this._composers.set(FO.FRIEND_FURNI_CONFIRM_LOCK,ET),this._composers.set(FO.ACCEPT_FRIEND,pT),this._composers.set(FO.DECLINE_FRIEND,mT),this._composers.set(FO.FIND_NEW_FRIENDS,IT),this._composers.set(FO.FOLLOW_FRIEND,TT),this._composers.set(FO.FRIEND_LIST_UPDATE,RT),this._composers.set(FO.GET_FRIEND_REQUESTS,fT),this._composers.set(FO.HABBO_SEARCH,OT),this._composers.set(FO.MESSENGER_INIT,vT),this._composers.set(FO.REMOVE_FRIEND,AT),this._composers.set(FO.REQUEST_FRIEND,ST),this._composers.set(FO.MESSENGER_CHAT,NT),this._composers.set(FO.SEND_ROOM_INVITE,MT),this._composers.set(FO.SET_RELATIONSHIP_STATUS,yT),this._composers.set(FO.VISIT_USER,DT),this._composers.set(FO.GET_GIFT,LT),this._composers.set(FO.RESET_PHONE_NUMBER_STATE,UT),this._composers.set(FO.SET_PHONE_NUMBER_VERIFICATION_STATUS,PT),this._composers.set(FO.TRY_PHONE_NUMBER,bT),this._composers.set(FO.VERIFY_CODE,wT),this._composers.set(FO.GET_FORUM_STATS,iR),this._composers.set(FO.GET_FORUMS_LIST,sR),this._composers.set(FO.GET_FORUM_MESSAGES,rR),this._composers.set(FO.GET_FORUM_THREAD,nR),this._composers.set(FO.GET_FORUM_THREADS,aR),this._composers.set(FO.GET_UNREAD_FORUMS_COUNT,oR),this._composers.set(FO.FORUM_MODERATE_MESSAGE,hR),this._composers.set(FO.FORUM_MODERATE_THREAD,_R),this._composers.set(FO.FORUM_POST_MESSAGE,dR),this._composers.set(FO.UPDATE_FORUM_READ_MARKER,uR),this._composers.set(FO.UPDATE_FORUM_SETTINGS,cR),this._composers.set(FO.FORUM_UPDATE_THREAD,lR),this._composers.set(FO.CLIENT_PONG,Is),this._composers.set(FO.RELEASE_VERSION,ps),this._composers.set(FO.SECURITY_TICKET,Ts),this._composers.set(FO.USER_INFO,ms),this._composers.set(FO.DISCONNECT,ER),this._composers.set(FO.SECURITY_MACHINE,pR),this._composers.set(FO.CLIENT_VARIABLES,mR),this._composers.set(FO.CALL_FOR_HELP_FROM_FORUM_MESSAGE,IR),this._composers.set(FO.CALL_FOR_HELP_FROM_FORUM_THREAD,TR),this._composers.set(FO.CALL_FOR_HELP_FROM_IM,RR),this._composers.set(FO.CALL_FOR_HELP_FROM_PHOTO,fR),this._composers.set(FO.CALL_FOR_HELP_FROM_SELFIE,OR),this._composers.set(FO.CALL_FOR_HELP,vR),this._composers.set(FO.CHAT_REVIEW_GUIDE_DECIDES,AR),this._composers.set(FO.CHAT_REVIEW_GUIDE_DETACHED,SR),this._composers.set(FO.CHAT_REVIEW_GUIDE_VOTE,NR),this._composers.set(FO.CHAT_REVIEW_SESSION_CREATE,MR),this._composers.set(FO.DELETE_PENDING_CALLS_FOR_HELP,yR),this._composers.set(FO.GET_CFH_STATUS,DR),this._composers.set(FO.GET_FAQ_CATEGORY,CR),this._composers.set(FO.GET_FAQ_TEXT,LR),this._composers.set(FO.GET_GUIDE_REPORTING_STATUS,UR),this._composers.set(FO.GET_PENDING_CALLS_FOR_HELP,PR),this._composers.set(FO.GET_QUIZ_QUESTIONS,bR),this._composers.set(FO.GUIDE_SESSION_CREATE,wR),this._composers.set(FO.GUIDE_SESSION_FEEDBACK,FR),this._composers.set(FO.GUIDE_SESSION_GET_REQUESTER_ROOM,xR),this._composers.set(FO.GUIDE_SESSION_GUIDE_DECIDES,BR),this._composers.set(FO.GUIDE_SESSION_INVITE_REQUESTER,GR),this._composers.set(FO.GUIDE_SESSION_IS_TYPING,HR),this._composers.set(FO.GUIDE_SESSION_MESSAGE,VR),this._composers.set(FO.GUIDE_SESSION_ON_DUTY_UPDATE,jR),this._composers.set(FO.GUIDE_SESSION_REPORT,kR),this._composers.set(FO.GUIDE_SESSION_REQUESTER_CANCELS,YR),this._composers.set(FO.GUIDE_SESSION_RESOLVED,zR),this._composers.set(FO.POST_QUIZ_ANSWERS,WR),this._composers.set(FO.SEARCH_FAQS,KR),this._composers.set(FO.DESKTOP_VIEW,gT),this._composers.set(FO.GROUP_INFO,YT),this._composers.set(FO.GROUP_REQUEST,zT),this._composers.set(FO.GROUP_MEMBER_REMOVE_CONFIRM,VT),this._composers.set(FO.GROUP_MEMBER_REMOVE,qT),this._composers.set(FO.GROUP_MEMBERS,WT),this._composers.set(FO.GROUP_ADMIN_ADD,FT),this._composers.set(FO.GROUP_ADMIN_REMOVE,xT),this._composers.set(FO.GROUP_REQUEST_ACCEPT,KT),this._composers.set(FO.GROUP_REQUEST_DECLINE,XT),this._composers.set(FO.GROUP_DELETE,jT),this._composers.set(FO.GROUP_CREATE_OPTIONS,HT),this._composers.set(FO.GROUP_PARTS,BT),this._composers.set(FO.GROUP_BUY,GT),this._composers.set(FO.GROUP_SETTINGS,tR),this._composers.set(FO.GROUP_SAVE_BADGE,QT),this._composers.set(FO.GROUP_SAVE_COLORS,ZT),this._composers.set(FO.GROUP_SAVE_INFORMATION,JT),this._composers.set(FO.GROUP_SAVE_PREFERENCES,$T),this._composers.set(FO.GROUP_FAVORITE,kT),this._composers.set(FO.GROUP_UNFAVORITE,eR),this._composers.set(FO.GROUP_BADGES,hS),this._composers.set(FO.ROOM_FAVORITE,zf),this._composers.set(FO.CAN_CREATE_ROOM,Kf),this._composers.set(FO.CANCEL_ROOM_EVENT,Wf),this._composers.set(FO.CONVERT_GLOBAL_ROOM_ID,qf),this._composers.set(FO.COMPETITION_ROOM_SEARCH,Xf),this._composers.set(FO.ROOM_CREATE,Qf),this._composers.set(FO.GET_USER_FLAT_CATS,aO),this._composers.set(FO.GET_USER_EVENT_CATS,nO),this._composers.set(FO.ROOM_FAVORITE_REMOVE,Zf),this._composers.set(FO.EDIT_ROOM_EVENT,Jf),this._composers.set(FO.FORWARD_TO_RANDOM_PROMOTED_ROOM,$f),this._composers.set(FO.FORWARD_TO_SOME_ROOM,tO),this._composers.set(FO.GET_CATEGORIES_WITH_USER_COUNT,eO),this._composers.set(FO.GET_GUEST_ROOM,sO),this._composers.set(FO.GET_OFFICIAL_ROOMS,iO),this._composers.set(FO.GET_POPULAR_ROOM_TAGS,rO),this._composers.set(FO.GUILD_BASE_SEARCH,oO),this._composers.set(FO.MY_FAVOURITE_ROOMS_SEARCH,hO),this._composers.set(FO.MY_FREQUENT_ROOM_HISTORY_SEARCH,_O),this._composers.set(FO.MY_FRIENDS_ROOM_SEARCH,dO),this._composers.set(FO.MY_GUILD_BASES_SEARCH,uO),this._composers.set(FO.MY_RECOMMENDED_ROOMS,cO),this._composers.set(FO.MY_ROOM_HISTORY_SEARCH,lO),this._composers.set(FO.MY_ROOM_RIGHTS_SEARCH,gO),this._composers.set(FO.MY_ROOMS_SEARCH,EO),this._composers.set(FO.POPULAR_ROOMS_SEARCH,vO),this._composers.set(FO.ROOM_LIKE,AO),this._composers.set(FO.ROOM_RIGHTS_REMOVE_OWN,SO),this._composers.set(FO.ROOM_AD_EVENT_TAB_CLICKED,NO),this._composers.set(FO.ROOM_AD_EVENT_TAB_VIEWED,MO),this._composers.set(FO.ROOM_AD_SEARCH,yO),this._composers.set(FO.ROOM_TEXT_SEARCH,LO),this._composers.set(FO.ROOMS_WHERE_MY_FRIENDS_ARE,DO),this._composers.set(FO.ROOMS_WITH_HIGHEST_SCORE_SEARCH,CO),this._composers.set(FO.SET_ROOM_SESSION_TAGS,UO),this._composers.set(FO.ROOM_STAFF_PICK,PO),this._composers.set(FO.USER_HOME_ROOM,bO),this._composers.set(FO.UPDATE_ROOM_THUMBNAIL,wO),this._composers.set(FO.NAVIGATOR_INIT,mO),this._composers.set(FO.NAVIGATOR_SEARCH_CLOSE,IO),this._composers.set(FO.NAVIGATOR_SEARCH,TO),this._composers.set(FO.NAVIGATOR_SEARCH_OPEN,RO),this._composers.set(FO.NAVIGATOR_SEARCH_SAVE,fO),this._composers.set(FO.NAVIGATOR_SETTINGS_SAVE,OO),this._composers.set(FO.NAVIGATOR_CATEGORY_LIST_MODE,pO),this._composers.set(FO.POLL_ANSWER,zO),this._composers.set(FO.POLL_REJECT,WO),this._composers.set(FO.POLL_START,KO),this._composers.set(FO.USER_BADGES,XR),this._composers.set(FO.USER_BADGES_CURRENT_UPDATE,qR),this._composers.set(FO.USER_BOTS,QR),this._composers.set(FO.USER_FURNITURE,JR),this._composers.set(FO.USER_FURNITURE2,ZR),this._composers.set(FO.USER_PETS,$R),this._composers.set(FO.TRADE_ACCEPT,tf),this._composers.set(FO.TRADE_CANCEL,ef),this._composers.set(FO.TRADE_CLOSE,sf),this._composers.set(FO.TRADE_CONFIRM,rf),this._composers.set(FO.TRADE_ITEM,nf),this._composers.set(FO.TRADE_ITEMS,af),this._composers.set(FO.TRADE_ITEM_REMOVE,of),this._composers.set(FO.TRADE,hf),this._composers.set(FO.TRADE_UNACCEPT,_f),this._composers.set(FO.UNSEEN_RESET_CATEGORY,df),this._composers.set(FO.UNSEEN_RESET_ITEMS,uf),this._composers.set(FO.ACHIEVEMENT_LIST,aI),this._composers.set(FO.PET_MOUNT,xO),this._composers.set(FO.PET_RESPECT,BO),this._composers.set(FO.PET_SUPPLEMENT,GO),this._composers.set(FO.REMOVE_PET_SADDLE,HO),this._composers.set(FO.PET_INFO,VO),this._composers.set(FO.TOGGLE_PET_BREEDING,jO),this._composers.set(FO.TOGGLE_PET_RIDING,kO),this._composers.set(FO.USE_PET_PRODUCT,YO),this._composers.set(FO.ROOM_ENTER,uv),this._composers.set(FO.ROOM_DOORBELL,dv),this._composers.set(FO.GO_TO_FLAT,IA),this._composers.set(FO.ROOM_AMBASSADOR_ALERT,lv),this._composers.set(FO.ROOM_BAN_GIVE,gv),this._composers.set(FO.ROOM_BAN_REMOVE,Rv),this._composers.set(FO.ROOM_RIGHTS_GIVE,pv),this._composers.set(FO.ROOM_KICK,mv),this._composers.set(FO.ROOM_MUTE_USER,Iv),this._composers.set(FO.ROOM_RIGHTS_REMOVE,Tv),this._composers.set(FO.ROOM_RIGHTS_REMOVE_ALL,cv),this._composers.set(FO.ROOM_DELETE,Ev),this._composers.set(FO.ROOM_SETTINGS,vv),this._composers.set(FO.ROOM_SETTINGS_SAVE,Sv),this._composers.set(FO.ROOM_RIGHTS_LIST,Av),this._composers.set(FO.ROOM_BAN_LIST,Ov),this._composers.set(FO.BOT_CONFIGURATION,fv),this._composers.set(FO.GET_ITEM_DATA,Lv),this._composers.set(FO.REMOVE_WALL_ITEM,Fv),this._composers.set(FO.BOT_PLACE,Nv),this._composers.set(FO.BOT_PICKUP,Mv),this._composers.set(FO.BOT_SKILL_SAVE,yv),this._composers.set(FO.PET_PLACE,bv),this._composers.set(FO.PET_MOVE,Pv),this._composers.set(FO.PET_PICKUP,wv),this._composers.set(FO.SET_ITEM_DATA,xv),this._composers.set(FO.SET_OBJECT_DATA,Bv),this._composers.set(FO.COMPOST_PLANT,Cv),this._composers.set(FO.HARVEST_PET,Uv),this._composers.set(FO.FURNITURE_ALIASES,Yv),this._composers.set(FO.FURNITURE_GROUP_INFO,zv),this._composers.set(FO.FURNITURE_PICKUP,Wv),this._composers.set(FO.FURNITURE_PLACE,Kv),this._composers.set(FO.ITEM_PAINT,Xv),this._composers.set(FO.FURNITURE_POSTIT_PLACE,qv),this._composers.set(FO.FURNITURE_POSTIT_SAVE_STICKY_POLE,Gv),this._composers.set(FO.CONTROL_YOUTUBE_DISPLAY_PLAYBACK,dA),this._composers.set(FO.GET_YOUTUBE_DISPLAY_STATUS,uA),this._composers.set(FO.SET_YOUTUBE_DISPLAY_PLAYLIST,cA),this._composers.set(FO.FURNITURE_FLOOR_UPDATE,kv),this._composers.set(FO.FURNITURE_WALL_UPDATE,_A),this._composers.set(FO.ITEM_DIMMER_SETTINGS,Hv),this._composers.set(FO.ITEM_DIMMER_SAVE,Vv),this._composers.set(FO.ITEM_DIMMER_TOGGLE,jv),this._composers.set(FO.ROOM_TONER_APPLY,hA),this._composers.set(FO.ITEM_COLOR_WHEEL_CLICK,Qv),this._composers.set(FO.ITEM_DICE_CLICK,Zv),this._composers.set(FO.ITEM_DICE_CLOSE,Jv),this._composers.set(FO.FURNITURE_MULTISTATE,tA),this._composers.set(FO.FURNITURE_RANDOMSTATE,sA),this._composers.set(FO.ITEM_STACK_HELPER,iA),this._composers.set(FO.FURNITURE_WALL_MULTISTATE,rA),this._composers.set(FO.ONE_WAY_DOOR_CLICK,eA),this._composers.set(FO.ITEM_EXCHANGE_REDEEM,$v),this._composers.set(FO.ITEM_CLOTHING_REDEEM,mA),this._composers.set(FO.ROOM_MODEL,gA),this._composers.set(FO.GET_OCCUPIED_TILES,lA),this._composers.set(FO.GET_ROOM_ENTRY_TILE,EA),this._composers.set(FO.ROOM_MODEL_SAVE,pA),this._composers.set(FO.UNIT_ACTION,SA),this._composers.set(FO.UNIT_DANCE,NA),this._composers.set(FO.UNIT_DROP_HAND_ITEM,MA),this._composers.set(FO.UNIT_GIVE_HANDITEM,yA),this._composers.set(FO.UNIT_GIVE_HANDITEM_PET,DA),this._composers.set(FO.UNIT_LOOK,CA),this._composers.set(FO.UNIT_SIGN,UA),this._composers.set(FO.UNIT_POSTURE,LA),this._composers.set(FO.UNIT_WALK,PA),this._composers.set(FO.UNIT_CHAT,TA),this._composers.set(FO.UNIT_CHAT_SHOUT,RA),this._composers.set(FO.USER_SETTINGS_CHAT_STYLE,fA),this._composers.set(FO.UNIT_CHAT_WHISPER,OA),this._composers.set(FO.UNIT_TYPING,vA),this._composers.set(FO.UNIT_TYPING_STOP,AA),this._composers.set(FO.WIRED_APPLY_SNAPSHOT,bA),this._composers.set(FO.WIRED_OPEN,wA),this._composers.set(FO.WIRED_ACTION_SAVE,xA),this._composers.set(FO.WIRED_CONDITION_SAVE,BA),this._composers.set(FO.WIRED_TRIGGER_SAVE,GA),this._composers.set(FO.ROOM_MUTE,FA),this._composers.set(FO.APPROVE_NAME,QA),this._composers.set(FO.USER_RESPECT,pS),this._composers.set(FO.SCR_GET_KICKBACK_INFO,uS),this._composers.set(FO.USER_IGNORED,$A),this._composers.set(FO.USER_IGNORE,tS),this._composers.set(FO.USER_IGNORE_ID,eS),this._composers.set(FO.USER_UNIGNORE,sS),this._composers.set(FO.USER_BADGES_CURRENT,iS),this._composers.set(FO.USER_FIGURE,rS),this._composers.set(FO.USER_MOTTO,nS),this._composers.set(FO.USER_PROFILE,aS),this._composers.set(FO.USER_PROFILE_BY_NAME,JA),this._composers.set(FO.MESSENGER_RELATIONSHIPS,oS),this._composers.set(FO.MANNEQUIN_SAVE_NAME,aA),this._composers.set(FO.MANNEQUIN_SAVE_LOOK,nA),this._composers.set(FO.PRESENT_OPEN_PRESENT,oA),this._composers.set(FO.MARKETPLACE_CONFIG,If),this._composers.set(FO.MARKETPLACE_SELL_ITEM,Of),this._composers.set(FO.MARKETPLACE_REQUEST_OWN_ITEMS,ff),this._composers.set(FO.MARKETPLACE_TAKE_BACK_ITEM,pf),this._composers.set(FO.MARKETPLACE_REQUEST_OFFERS,Rf),this._composers.set(FO.MARKETPLACE_BUY_OFFER,gf),this._composers.set(FO.MARKETPLACE_REDEEM_CREDITS,vf),this._composers.set(FO.MARKETPLACE_BUY_TOKENS,Ef),this._composers.set(FO.REQUEST_SELL_ITEM,mf),this._composers.set(FO.REQUEST_MARKETPLACE_ITEM_STATS,Tf),this._composers.set(FO.USER_BOTS,QR),this._composers.set(FO.USER_PETS,$R),this._composers.set(FO.USER_CURRENCY,_S),this._composers.set(FO.USER_SUBSCRIPTION,dS),this._composers.set(FO.MODTOOL_REQUEST_ROOM_INFO,Df),this._composers.set(FO.MODTOOL_CHANGE_ROOM_SETTINGS,wf),this._composers.set(FO.MODTOOL_REQUEST_USER_CHATLOG,Pf),this._composers.set(FO.MODTOOL_REQUEST_ROOM_CHATLOG,Lf),this._composers.set(FO.MOD_TOOL_USER_INFO,Cf),this._composers.set(FO.MODTOOL_SANCTION_ALERT,bf),this._composers.set(FO.MODTOOL_SANCTION_BAN,Nf),this._composers.set(FO.MODTOOL_SANCTION_KICK,xf),this._composers.set(FO.MODTOOL_SANCTION_TRADELOCK,jf),this._composers.set(FO.MODTOOL_ALERTEVENT,Bf),this._composers.set(FO.MODTOOL_SANCTION_MUTE,Gf),this._composers.set(FO.MODTOOL_REQUEST_USER_ROOMS,Uf),this._composers.set(FO.MODTOOL_ROOM_ALERT,Ff),this._composers.set(FO.CLOSE_ISSUE_DEFAULT_ACTION,Af),this._composers.set(FO.CLOSE_ISSUES,Sf),this._composers.set(FO.DEFAULT_SANCTION,Mf),this._composers.set(FO.GET_CFH_CHATLOG,yf),this._composers.set(FO.MODTOOL_PREFERENCES,Hf),this._composers.set(FO.MODTOOL_SANCTION,Vf),this._composers.set(FO.PICK_ISSUES,kf),this._composers.set(FO.RELEASE_ISSUES,Yf),this._composers.set(FO.USER_SETTINGS_CAMERA,cS),this._composers.set(FO.USER_SETTINGS_OLD_CHAT,lS),this._composers.set(FO.USER_SETTINGS_INVITES,gS),this._composers.set(FO.USER_SETTINGS_VOLUME,ES),this._composers.set(FO.COMMUNITY_GOAL_VOTE_COMPOSER,lf),this._composers.set(FO.GET_PROMO_ARTICLES,cf),this._composers.set(FO.ACCEPT_QUEST,XO),this._composers.set(FO.ACTIVATE_QUEST,qO),this._composers.set(FO.CANCEL_QUEST,QO),this._composers.set(FO.FRIEND_REQUEST_QUEST_COMPLETE,ZO),this._composers.set(FO.GET_COMMUNITY_GOAL_EARNED_PRIZES,JO),this._composers.set(FO.GET_COMMUNITY_GOAL_HALL_OF_FAME,$O),this._composers.set(FO.GET_COMMUNITY_GOAL_PROGRESS,tv),this._composers.set(FO.GET_CONCURRENT_USERS_GOAL_PROGRESS,ev),this._composers.set(FO.GET_CONCURRENT_USERS_REWARD,sv),this._composers.set(FO.GET_DAILY_QUEST,iv),this._composers.set(FO.GET_QUESTS,rv),this._composers.set(FO.GET_SEASONAL_QUESTS_ONLY,nv),this._composers.set(FO.OPEN_QUEST_TRACKER,av),this._composers.set(FO.REDEEM_COMMUNITY_GOAL_PRIZE,ov),this._composers.set(FO.REJECT_QUEST,hv),this._composers.set(FO.START_CAMPAIGN,_v),this._composers.set(FO.GET_SOUND_SETTINGS,WA),this._composers.set(FO.ADD_JUKEBOX_DISK,HA),this._composers.set(FO.GET_JUKEBOX_PLAYLIST,VA),this._composers.set(FO.GET_NOW_PLAYING,jA),this._composers.set(FO.GET_OFFICIAL_SONG_ID,kA),this._composers.set(FO.GET_SONG_INFO,YA),this._composers.set(FO.GET_SOUND_MACHINE_PLAYLIST,zA),this._composers.set(FO.GET_USER_SONG_DISKS,KA),this._composers.set(FO.REMOVE_JUKEBOX_DISK,XA),this._composers.set(FO.HELPER_TALENT_TRACK,qA),this._composers.set(FO.ACHIEVEMENT_RESOLUTION_OPEN,CT)}get events(){return this._events}get composers(){return this._composers}}class bS extends M{constructor(t){super(),this._communication=void 0,this._connection=void 0,this._messages=void 0,this._demo=void 0,this._communication=t,this._connection=null,this._messages=new PS,this._demo=new fs(this),this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.onConnectionAuthenticatedEvent=this.onConnectionAuthenticatedEvent.bind(this)}onInit(){this._connection||(SU.instance.events.addEventListener(Rs.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),this._connection=this._communication.createConnection(this),this._connection.registerMessages(this._messages),this._connection.addEventListener(f.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.addEventListener(f.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.addEventListener(f.CONNECTION_ERROR,this.onConnectionErrorEvent),this._demo&&this._demo.init(),this._connection.init(SU.instance.getConfiguration("socket.url")))}onDispose(){this._demo&&this._demo.dispose(),this._connection&&(this._connection.removeEventListener(f.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.removeEventListener(f.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.removeEventListener(f.CONNECTION_ERROR,this.onConnectionErrorEvent)),SU.instance.events.removeEventListener(Rs.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),super.onDispose()}onConnectionOpenedEvent(t){this.logger.log("Connection Initialized")}onConnectionClosedEvent(t){this.logger.log("Connection Closed")}onConnectionErrorEvent(t){this.logger.log("Connection Error")}onConnectionAuthenticatedEvent(t){this.logger.log("Connection Authenticated"),this._connection&&this._connection.authenticated()}connectionInit(t){this.logger.log(`Initializing Connection: ${t}`)}registerMessageEvent(t){return this._connection&&this._connection.addMessageEvent(t),t}removeMessageEvent(t){this._connection&&this._connection.removeMessageEvent(t)}get demo(){return this._demo}get connection(){return this._connection}}class wS{static get available(){return this._isListeningForPostMessages||(this._isListeningForPostMessages=!0,window.addEventListener("message",(t=>{if("string"===typeof t.data)if(t.data.startsWith(wS.MESSAGE_KEY)){const{method:e,params:s}=JSON.parse(t.data.substr(wS.MESSAGE_KEY.length)),i=window[e];if(!i)return;i(...s)}else;}))),!0}static call(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];if(window.top!==window&&window.top.postMessage(wS.MESSAGE_KEY+JSON.stringify({method:t,params:s}),"*"),!("FlashExternalInterface"in window))return;const r=window.FlashExternalInterface[t];return"undefined"!==typeof r?r(...s):void 0}static callGame(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];if(window.top!==window&&window.top.postMessage("Nitro_LegacyExternalGameInterface"+JSON.stringify({method:t,params:s}),"*"),!("FlashExternalGameInterface"in window))return;const r=window.FlashExternalGameInterface[t];return"undefined"!==typeof r?r(...s):void 0}static addCallback(t,e){window[t]=e}}wS.MESSAGE_KEY="Nitro_LegacyExternalInterface",wS._isListeningForPostMessages=!1;class FS{constructor(t){t.addMessageEvent(new Xc(this.onLoadGameUrl.bind(this)))}onLoadGameUrl(t){if(!t)return;const e=t.getParser();e&&wS.callGame("showGame",e.url)}}class xS{constructor(t){this._badgeId="",this._level=1,this._base="",this._badgeId=t,this.parseText()}parseText(){let t=this._badgeId.length-1;for(;t>0&&this.isNumber(this._badgeId.charAt(t));)t--;this._base=this._badgeId.substr(0,t+1);const e=this._badgeId.substr(t+1,this._badgeId.length);e&&""!==e&&(this._level=Number.parseInt(e))}isNumber(t){const e=t.charCodeAt(0);return e>=48&&e<=57}get level(){return this._level}set level(t){this._level=Math.max(1,t)}get getBadgeId(){return this._base+this._level}get base(){return this._base}}class BS extends d{constructor(t){super(t)}}BS.LOADED="NLE_LOADED",BS.FAILED="NLE_FAILED";class GS extends M{constructor(t){super(),this._communication=void 0,this._definitions=void 0,this._parameters=void 0,this._badgePointLimits=void 0,this._romanNumerals=void 0,this._pendingUrls=void 0,this._communication=t,this._definitions=new Map,this._parameters=new Map,this._badgePointLimits=new Map,this._romanNumerals=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX","XXI","XXII","XXIII","XXIV","XXV","XXVI","XXVII","XXVIII","XXIX","XXX"],this._pendingUrls=[]}onInit(){this._communication.registerMessageEvent(new hg(this.onBadgePointLimitsEvent.bind(this)));let t=SU.instance.getConfiguration("external.texts.url");Array.isArray(t)||(t=[SU.instance.getConfiguration("external.texts.url")]);for(let e=0;e<t.length;e++)t[e]=SU.instance.core.configuration.interpolate(t[e]);this._pendingUrls=t,this.loadNextLocalization()}loadNextLocalization(){this._pendingUrls.length?this.loadLocalizationFromURL(this._pendingUrls[0]):this.events&&this.events.dispatchEvent(new BS(BS.LOADED))}loadLocalizationFromURL(t){fetch(t).then((t=>t.json())).then((e=>this.onLocalizationLoaded(e,t))).catch((t=>this.onLocalizationFailed(t)))}onLocalizationLoaded(t,e){if(!t)return;if(!this.parseLocalization(t))throw new Error(`Invalid json data for file ${e}`);const s=this._pendingUrls.indexOf(e);s>=0&&this._pendingUrls.splice(s,1),this.loadNextLocalization()}onLocalizationFailed(t){this.events&&this.events.dispatchEvent(new BS(BS.FAILED))}parseLocalization(t){if(!t)return!1;for(const e in t)this._definitions.set(e,t[e]);return!0}onBadgePointLimitsEvent(t){const e=t.getParser();for(const s of e.data)this.setBadgePointLimit(s.badgeId,s.limit)}getBadgePointLimit(t){return this._badgePointLimits.get(t)||-1}setBadgePointLimit(t,e){this._badgePointLimits.set(t,e)}getRomanNumeral(t){return this._romanNumerals[Math.max(0,t-1)]}getPreviousLevelBadgeId(t){const e=new xS(t);return e.level--,e.getBadgeId}hasValue(t){return this._definitions.has(t)}getValue(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t||!t.length)return null;const s=t.match(/\$\{.[^}]*\}/g);if(s&&s.length)for(const r of s)t=t.replace(r,this.getValue(r.slice(2,-1),e));let i=this._definitions.get(t)||null;if(!i&&(i=SU.instance.core.configuration.definitions.get(t),i))return i;if(i&&e){const e=this._parameters.get(t);if(e)for(const[t,s]of e)i=i.replace("%"+t+"%",s)}return i||t}getValueWithParameter(t,e,s){const i=this.getValue(t,!1),r=i.replace("%"+e+"%",s);if(i.startsWith("%{")){const t=new RegExp("%{"+e.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),n=i.match(t);if(!n)return r;let a=-1;let o=!1;switch(Number.parseInt(s)){case 0:a=1;break;case 1:a=2;break;default:a=3,o=!0}if(-1==a||"undefined"==typeof n[a])return r;const h=n[a];if(h)return h.replace("%%",s)}return r}getValueWithParameters(t,e,s){let i=this.getValue(t,!1);if(e)for(let r=0;r<e.length;r++){const t=e[r],n=s[r];if(void 0!==n&&(i=i.replace("%"+t+"%",n),i.startsWith("%{"))){const e=new RegExp("%{"+t.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),s=i.match(e);if(!s)continue;let r=-1,a=!1;switch(parseInt(n)){case 0:r=1;break;case 1:r=2;break;default:r=3,a=!0}if(-1===r||"undefined"===typeof s[r])continue;const o=s[r];o&&(i=o.replace("%%",n))}}return i}setValue(t,e){this._definitions.set(t,e)}registerParameter(t,e,s){if(!t||0===t.length||!e||0===e.length)return;let i=this._parameters.get(t);i||(i=new Map,this._parameters.set(t,i)),i.set(e,s)}getBadgeName(t){const e=new xS(t),s=["badge_name_"+t,"badge_name_"+e.base];let i=this._Str_2103(this.getExistingKey(s));return i=i.replace("%roman%",this.getRomanNumeral(e.level)),i}getBadgeDesc(t){const e=new xS(t),s=["badge_desc_"+t,"badge_desc_"+e.base];let i=this._Str_2103(this.getExistingKey(s));const r=this.getBadgePointLimit(t);return r>-1&&(i=i.replace("%limit%",r.toString())),i=i.replace("%roman%",this.getRomanNumeral(e.level)),i}getExistingKey(t){for(const e of t){const t=this.getValue(e);if(t!=e)return t}return""}_Str_2103(t){return t.replace("${","$").replace("{","$").replace("}","$")}}s(100);var HS=s(46),VS=(s(101),s(102),s(103),s(104),s(105),s(106),s(77)),jS=s(9),kS=(s(66),s(67),s(29),s(47));i.p.registerPlugin("batch",i.f),i.p.registerPlugin("extract",HS.a),i.p.registerPlugin("tilingSprite",VS.a),i.p.registerPlugin("tilemap",Q.b),i.p.registerPlugin("interaction",q.b),r.b.registerPlugin(n.b),a.a.registerPlugin(r.a),a.a.registerPlugin(_.b);class YS extends d{constructor(t,e){super(t),this._roomId=void 0,this._roomId=e}get roomId(){return this._roomId}}YS.INITIALIZED="REE_INITIALIZED",YS.ENGINE_INITIALIZED="REE_ENGINE_INITIALIZED",YS.OBJECTS_INITIALIZED="REE_OBJECTS_INITIALIZED",YS.NORMAL_MODE="REE_NORMAL_MODE",YS.GAME_MODE="REE_GAME_MODE",YS.ROOM_ZOOMED="REE_ROOM_ZOOMED",YS.DISPOSED="REE_DISPOSED";class zS{constructor(t,e,s){this._layerId=void 0,this._partId=void 0,this._paletteId=void 0,this._layerId=t,this._partId=e,this._paletteId=s}get layerId(){return this._layerId}set layerId(t){this._layerId=t}get partId(){return this._partId}set partId(t){this._partId=t}get paletteId(){return this._paletteId}set paletteId(t){this._paletteId=t}}class WS{constructor(t){this._typeId=void 0,this._paletteId=void 0,this._color=void 0,this._headOnly=void 0,this._customParts=void 0,this._customLayerIds=void 0,this._customPartIds=void 0,this._customPaletteIds=void 0,this._typeId=this.getTypeId(t),this._paletteId=this.getPaletteId(t),this._color=this.getColor(t),this._headOnly=this.getHeadOnly(t);const e=this.getCustomData(t);this._customLayerIds=this.getCustomLayerIds(e),this._customPartIds=this.getCustomPartIds(e),this._customPaletteIds=this.getCustomPaletteIds(e),this._customParts=[];let s=0;for(;s<this._customLayerIds.length;)this._customParts.push(new zS(this._customLayerIds[s],this._customPartIds[s],this._customPaletteIds[s])),s++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get customLayerIds(){return this._customLayerIds}get customPartIds(){return this._customPartIds}get customPaletteIds(){return this._customPaletteIds}get customParts(){return this._customParts}getCustomPart(t){if(this._customParts)for(const e of this._customParts)if(e.layerId===t)return e;return null}get hasCustomParts(){return!(null==this._customLayerIds)&&this._customLayerIds.length>0}get headOnly(){return this._headOnly}get figureString(){let t=this.typeId+" "+this.paletteId+" "+this.color.toString(16);t=t+" "+this.customParts.length;for(const e of this.customParts)t=t+" "+e.layerId+" "+e.partId+" "+e.paletteId;return t}getCustomData(t){let e=[];if(t){const s=t.split(" "),i=this._headOnly?1:0,r=4+i;if(s.length>r){const t=parseInt(s[3+i]);e=s.slice(r,r+3*t)}}return e}getCustomLayerIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+0])),s+=3;return e}getCustomPartIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+1])),s+=3;return e}getCustomPaletteIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+2])),s+=3;return e}getTypeId(t){if(t){const e=t.split(" ");if(e.length>=1)return parseInt(e[0])}return 0}getPaletteId(t){if(t){const e=t.split(" ");if(e.length>=2)return parseInt(e[1])}return 0}getColor(t){if(t){const e=t.split(" ");if(e.length>=3)return parseInt(e[2],16)}return 16777215}getHeadOnly(t){if(t){const e=t.split(" ");if(e.length>=4)return"head"===e[3]}return!1}}class KS{}KS.HOTEL_VIEW="hotel_view",KS.HOME_ROOM="home_room",KS.NAVIGATOR="navigator",KS.CATALOG="catalog",KS.INVENTORY="inventory",KS.ME_MENU="me_menu",KS.FRIEND_LIST="friendlist";class XS extends d{constructor(t){super(t),this._iconId=void 0,this._iconName=void 0}get iconId(){return this._iconId}set iconId(t){this._iconId=t}get iconName(){return this._iconName}set iconName(t){this._iconName=t}}XS.TOOLBAR_CLICK="NTE_TOOLBAR_CLICK",XS.SELECT_OWN_AVATAR="NTE_SELECT_OWN_AVATAR";class qS extends XS{constructor(t,e,s){super(qS.ANIMATE_ICON),this._image=void 0,this._x=void 0,this._y=void 0,this._image=t,this._x=e,this._y=s}get image(){return this._image}get x(){return this._x}get y(){return this._y}}qS.ANIMATE_ICON="NTAIE_ANIMATE_ICON";class QS extends d{constructor(t,e){super(QS.IMAGE_READY),this._badgeId=void 0,this._image=void 0,this._badgeId=t,this._image=e}get badgeId(){return this._badgeId}get image(){return this._image}}QS.IMAGE_READY="BIME_BADGE_IMAGE_READY";class ZS extends d{constructor(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(t),this._session=void 0,this._openLandingView=void 0,this._session=e,this._openLandingView=s}get session(){return this._session}get openLandingView(){return this._openLandingView}}ZS.CREATED="RSE_CREATED",ZS.STARTED="RSE_STARTED",ZS.ENDED="RSE_ENDED",ZS.ROOM_DATA="RSE_ROOM_DATA";class JS{static isBuilderClubId(t){return t>=JS.BUILDER_CLUB_FURNI_ID_BASE}}JS.BUILDER_CLUB_FURNI_ID_BASE=2147418112;class $S extends YS{constructor(t,e,s,i){super($S.ROOM_COLOR,t),this._color=void 0,this._brightness=void 0,this._bgOnly=void 0,this._color=e,this._brightness=s,this._bgOnly=i}get color(){return this._color}get brightness(){return this._brightness}get bgOnly(){return this._bgOnly}}$S.ROOM_COLOR="REE_ROOM_COLOR";class tN extends YS{constructor(t,e,s){super(tN.ROOM_DRAG,t),this._offsetX=void 0,this._offsetY=void 0,this._offsetX=e,this._offsetY=s}get offsetX(){return this._offsetX}get offsetY(){return this._offsetY}}tN.ROOM_DRAG="RDE_ROOM_DRAG";class eN extends YS{constructor(t,e,s,i,r,n){super(eN.ROOM_COLOR,t),this._state=void 0,this._presetId=void 0,this._effectId=void 0,this._color=void 0,this._brightness=void 0,this._state=e,this._presetId=s,this._effectId=i,this._color=r,this._brightness=n}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}}eN.ROOM_COLOR="REDSE_ROOM_COLOR";class sN extends YS{constructor(t,e,s,i){super(t,e),this._objectId=void 0,this._category=void 0,this._objectId=s,this._category=i}get objectId(){return this._objectId}get category(){return this._category}}sN.SELECTED="REOE_SELECTED",sN.DESELECTED="REOE_DESELECTED",sN.ADDED="REOE_ADDED",sN.REMOVED="REOE_REMOVED",sN.PLACED="REOE_PLACED",sN.PLACED_ON_USER="REOE_PLACED_ON_USER",sN.CONTENT_UPDATED="REOE_CONTENT_UPDATED",sN.REQUEST_MOVE="REOE_REQUEST_MOVE",sN.REQUEST_ROTATE="REOE_REQUEST_ROTATE",sN.REQUEST_MANIPULATION="REOE_REQUEST_MANIPULATION",sN.MOUSE_ENTER="REOE_MOUSE_ENTER",sN.MOUSE_LEAVE="REOE_MOUSE_LEAVE";class iN extends sN{constructor(t,e,s,i,r,n,a,o,h,_,d,u,c){super(t,e,s,i),this._wallLocation="",this._x=0,this._y=0,this._z=0,this._direction=0,this._placedInRoom=!1,this._placedOnFloor=!1,this._placedOnWall=!1,this._instanceData=null,this._wallLocation=r,this._x=n,this._y=a,this._z=o,this._direction=h,this._placedInRoom=_,this._placedOnFloor=d,this._placedOnWall=u,this._instanceData=c}get wallLocation(){return this._wallLocation}get x(){return this._x}get y(){return this._y}get z(){return this._z}get direction(){return this._direction}get placedInRoom(){return this._placedInRoom}get placedOnFloor(){return this._placedOnFloor}get placedOnWall(){return this._placedOnWall}get instanceData(){return this._instanceData}}class rN extends sN{constructor(t,e,s,i,r,n){super(t,e,s,i),this._droppedObjectId=void 0,this._droppedObjectCategory=void 0,this._droppedObjectId=r,this._droppedObjectCategory=n}get droppedObjectId(){return this._droppedObjectId}get droppedObjectCategory(){return this._droppedObjectCategory}}class nN extends sN{constructor(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(t,e,s,i),this._soundId=void 0,this._pitch=void 0,this._soundId=r,this._pitch=n}get soundId(){return this._soundId}get pitch(){return this._pitch}}nN.PLAY_SOUND="REOPSE_PLAY_SOUND",nN.PLAY_SOUND_AT_PITCH="REOPSE_PLAY_SOUND_AT_PITCH";class aN extends sN{}aN.FURNI_CLICK="RERAE_FURNI_CLICK",aN.FURNI_DOUBLE_CLICK="RERAE_FURNI_DOUBLE_CLICK",aN.TOOLTIP_SHOW="RERAE_TOOLTIP_SHOW",aN.TOOLTIP_HIDE="RERAE_TOOLTIP_HIDE";class oN extends sN{constructor(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(t,e,s,i),this._sampleId=void 0,this._pitch=void 0,this._sampleId=r,this._pitch=n}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}oN.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED",oN.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED",oN.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE",oN.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class hN extends sN{constructor(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;super(t,e,s,i),this._widget=void 0,this._widget=r}get widget(){return this._widget}get contextMenu(){return this._widget}}hN.OPEN_WIDGET="RETWE_OPEN_WIDGET",hN.CLOSE_WIDGET="RETWE_CLOSE_WIDGET",hN.OPEN_FURNI_CONTEXT_MENU="RETWE_OPEN_FURNI_CONTEXT_MENU",hN.CLOSE_FURNI_CONTEXT_MENU="RETWE_CLOSE_FURNI_CONTEXT_MENU",hN.REQUEST_PLACEHOLDER="RETWE_REQUEST_PLACEHOLDER",hN.REQUEST_CREDITFURNI="RETWE_REQUEST_CREDITFURNI",hN.REQUEST_STACK_HEIGHT="RETWE_REQUEST_STACK_HEIGHT",hN.REQUEST_EXTERNAL_IMAGE="RETWE_REQUEST_EXTERNAL_IMAGE",hN.REQUEST_STICKIE="RETWE_REQUEST_STICKIE",hN.REQUEST_PRESENT="RETWE_REQUEST_PRESENT",hN.REQUEST_TROPHY="RETWE_REQUEST_TROPHY",hN.REQUEST_TEASER="RETWE_REQUEST_TEASER",hN.REQUEST_ECOTRONBOX="RETWE_REQUEST_ECOTRONBOX",hN.REQUEST_DIMMER="RETWE_REQUEST_DIMMER",hN.REMOVE_DIMMER="RETWE_REMOVE_DIMMER",hN.REQUEST_CLOTHING_CHANGE="RETWE_REQUEST_CLOTHING_CHANGE",hN.REQUEST_PLAYLIST_EDITOR="RETWE_REQUEST_PLAYLIST_EDITOR",hN.REQUEST_MANNEQUIN="RETWE_REQUEST_MANNEQUIN",hN.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",hN.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",hN.REQUEST_BACKGROUND_COLOR="RETWE_REQUEST_BACKGROUND_COLOR",hN.REQUEST_MYSTERYBOX_OPEN_DIALOG="RETWE_REQUEST_MYSTERYBOX_OPEN_DIALOG",hN.REQUEST_EFFECTBOX_OPEN_DIALOG="RETWE_REQUEST_EFFECTBOX_OPEN_DIALOG",hN.REQUEST_MYSTERYTROPHY_OPEN_DIALOG="RETWE_REQUEST_MYSTERYTROPHY_OPEN_DIALOG",hN.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING",hN.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_FAILED",hN.REQUEST_FRIEND_FURNITURE_CONFIRM="RETWE_REQUEST_FRIEND_FURNITURE_CONFIRM",hN.REQUEST_FRIEND_FURNITURE_ENGRAVING="RETWE_REQUEST_FRIEND_FURNITURE_ENGRAVING",hN.REQUEST_BADGE_DISPLAY_ENGRAVING="RETWE_REQUEST_BADGE_DISPLAY_ENGRAVING",hN.REQUEST_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIGH_SCORE_DISPLAY",hN.REQUEST_HIDE_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIDE_HIGH_SCORE_DISPLAY",hN.REQUEST_INTERNAL_LINK="RETWE_REQUEST_INTERNAL_LINK",hN.REQUEST_ROOM_LINK="RETWE_REQUEST_ROOM_LINK",hN.REQUEST_YOUTUBE="RETWE_REQUEST_YOUTUBE";class _N extends sN{constructor(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1;super(t,e,s,i),this._inventoryStripId=void 0,this._furnitureTypeId=void 0,this._inventoryStripId=r,this._furnitureTypeId=n}get inventoryStripId(){return this._inventoryStripId}get furnitureTypeId(){return this._furnitureTypeId}}_N.USE_PRODUCT_FROM_ROOM="REUPE_USE_PRODUCT_FROM_ROOM",_N.USE_PRODUCT_FROM_INVENTORY="REUPE_USE_PRODUCT_FROM_INVENTORY";class dN extends ye{constructor(t,e,s){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];super(t,e),this._badgeId=void 0,this._groupBadge=void 0,this._badgeId=s,this._groupBadge=i}get badgeId(){return this._badgeId}get groupBadge(){return this._groupBadge}}dN.LOAD_BADGE="ROBAE_LOAD_BADGE";class uN extends ye{constructor(t,e){super(t,e)}}uN.RODRE_CURRENT_USER_ID="RODRE_CURRENT_USER_ID",uN.RODRE_URL_PREFIX="RODRE_URL_PREFIX";class cN extends ye{constructor(t,e,s,i,r,n){super(cN.DIMMER_STATE,t),this._state=void 0,this._presetId=void 0,this._effectId=void 0,this._color=void 0,this._brightness=void 0,this._state=e,this._presetId=s,this._effectId=i,this._color=r,this._brightness=n}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}}cN.DIMMER_STATE="RODSUE_DIMMER_STATE";class lN extends ye{constructor(t,e){super(t,e)}}lN.ADD_HOLE="ROFHO_ADD_HOLE",lN.REMOVE_HOLE="ROFHO_REMOVE_HOLE";class gN extends ye{}gN.DICE_OFF="ROFCAE_DICE_OFF",gN.DICE_ACTIVATE="ROFCAE_DICE_ACTIVATE",gN.USE_HABBOWHEEL="ROFCAE_USE_HABBOWHEEL",gN.STICKIE="ROFCAE_STICKIE",gN.ENTER_ONEWAYDOOR="ROFCAE_ENTER_ONEWAYDOOR",gN.SOUND_MACHINE_INIT="ROFCAE_SOUND_MACHINE_INIT",gN.SOUND_MACHINE_START="ROFCAE_SOUND_MACHINE_START",gN.SOUND_MACHINE_STOP="ROFCAE_SOUND_MACHINE_STOP",gN.SOUND_MACHINE_DISPOSE="ROFCAE_SOUND_MACHINE_DISPOSE",gN.JUKEBOX_INIT="ROFCAE_JUKEBOX_INIT",gN.JUKEBOX_START="ROFCAE_JUKEBOX_START",gN.JUKEBOX_MACHINE_STOP="ROFCAE_JUKEBOX_MACHINE_STOP",gN.JUKEBOX_DISPOSE="ROFCAE_JUKEBOX_DISPOSE",gN.MOUSE_BUTTON="ROFCAE_MOUSE_BUTTON",gN.MOUSE_ARROW="ROFCAE_MOUSE_ARROW";class EN extends YS{constructor(t,e,s,i,r,n){super(t,e),this._enable=void 0,this._hue=void 0,this._saturation=void 0,this._lightness=void 0,this._enable=s,this._hue=i,this._saturation=r,this._lightness=n}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}EN.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class pN extends ye{constructor(t,e,s,i,r,n){super(t,e),this._enable=void 0,this._hue=void 0,this._saturation=void 0,this._lightness=void 0,this._enable=s,this._hue=i,this._saturation=r,this._lightness=n}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}pN.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class mN extends ye{constructor(t,e){super(t,e)}}mN.POSITION_CHANGED="ROME_POSITION_CHANGED",mN.OBJECT_REMOVED="ROME_OBJECT_REMOVED";class IN extends gN{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(t,e),this._soundId=void 0,this._pitch=void 0,this._soundId=s,this._pitch=i}get soundId(){return this._soundId}get pitch(){return this._pitch}}IN.PLAY_SOUND="ROPSIE_PLAY_SOUND",IN.PLAY_SOUND_AT_PITCH="ROPSIE_PLAY_SOUND_AT_PITCH";class TN extends ye{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";super(t,e),this._imageUrl="",this._clickUrl="",this._imageUrl=s,this._clickUrl=i}get imageUrl(){return this._imageUrl}get clickUrl(){return this._clickUrl}}TN.ROOM_AD_LOAD_IMAGE="RORAE_ROOM_AD_LOAD_IMAGE",TN.ROOM_AD_FURNI_CLICK="RORAE_ROOM_AD_FURNI_CLICK",TN.ROOM_AD_FURNI_DOUBLE_CLICK="RORAE_ROOM_AD_FURNI_DOUBLE_CLICK",TN.ROOM_AD_TOOLTIP_SHOW="RORAE_ROOM_AD_TOOLTIP_SHOW",TN.ROOM_AD_TOOLTIP_HIDE="RORAE_ROOM_AD_TOOLTIP_HIDE";class RN extends ye{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(t,e),this._sampleId=void 0,this._pitch=void 0,this._sampleId=s,this._pitch=i}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}RN.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED",RN.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED",RN.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE",RN.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class fN extends sN{}fN.SOUND_MACHINE_INIT="ROSM_SOUND_MACHINE_INIT",fN.SOUND_MACHINE_SWITCHED_ON="ROSM_SOUND_MACHINE_SWITCHED_ON",fN.SOUND_MACHINE_SWITCHED_OFF="ROSM_SOUND_MACHINE_SWITCHED_OFF",fN.SOUND_MACHINE_DISPOSE="ROSM_SOUND_MACHINE_DISPOSE",fN.JUKEBOX_INIT="ROSM_JUKEBOX_INIT",fN.JUKEBOX_SWITCHED_ON="ROSM_JUKEBOX_SWITCHED_ON",fN.JUKEBOX_SWITCHED_OFF="ROSM_JUKEBOX_SWITCHED_OFF",fN.JUKEBOX_DISPOSE="ROSM_JUKEBOX_DISPOSE";class ON extends ye{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(t,e),this._state=void 0,this._state=s}get state(){return this._state}}ON.STATE_CHANGE="ROSCE_STATE_CHANGE",ON.STATE_RANDOM="ROSCE_STATE_RANDOM";class vN extends De{constructor(t,e,s,i,r,n){super(t,e,s,arguments.length>6&&void 0!==arguments[6]&&arguments[6],arguments.length>7&&void 0!==arguments[7]&&arguments[7],arguments.length>8&&void 0!==arguments[8]&&arguments[8],arguments.length>9&&void 0!==arguments[9]&&arguments[9]),this._tileX=void 0,this._tileY=void 0,this._tileZ=void 0,this._tileX=i,this._tileY=r,this._tileZ=n}get tileX(){return this._tileX}get tileY(){return this._tileY}get tileZ(){return this._tileZ}get tileXAsInt(){return Math.trunc(this._tileX+.499)}get tileYAsInt(){return Math.trunc(this._tileY+.499)}get tileZAsInt(){return Math.trunc(this._tileZ+.499)}}class AN extends De{constructor(t,e,s,i,r,n,a,o,h){super(t,e,s,arguments.length>9&&void 0!==arguments[9]&&arguments[9],arguments.length>10&&void 0!==arguments[10]&&arguments[10],arguments.length>11&&void 0!==arguments[11]&&arguments[11],arguments.length>12&&void 0!==arguments[12]&&arguments[12]),this._wallLocation=void 0,this._wallWd=void 0,this._wallHt=void 0,this._x=void 0,this._y=void 0,this._direction=void 0,this._wallLocation=new dt,this._wallWd=new dt,this._wallHt=new dt,this._wallLocation.assign(i),this._wallWd.assign(r),this._wallHt.assign(n),this._x=a,this._y=o,this._direction=h}get wallLocation(){return this._wallLocation}get wallWidth(){return this._wallWd}get wallHeight(){return this._wallHt}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class SN extends ye{constructor(t,e){super(t,e)}}SN.OPEN_WIDGET="ROWRE_OPEN_WIDGET",SN.CLOSE_WIDGET="ROWRE_CLOSE_WIDGET",SN.OPEN_FURNI_CONTEXT_MENU="ROWRE_OPEN_FURNI_CONTEXT_MENU",SN.CLOSE_FURNI_CONTEXT_MENU="ROWRE_CLOSE_FURNI_CONTEXT_MENU",SN.PLACEHOLDER="ROWRE_PLACEHOLDER",SN.CREDITFURNI="ROWRE_CREDITFURNI",SN.STACK_HEIGHT="ROWRE_STACK_HEIGHT",SN.EXTERNAL_IMAGE="ROWRE_EXTERNAL_IMAGE",SN.STICKIE="ROWRE_STICKIE",SN.PRESENT="ROWRE_PRESENT",SN.TROPHY="ROWRE_TROPHY",SN.TEASER="ROWRE_TEASER",SN.ECOTRONBOX="ROWRE_ECOTRONBOX",SN.DIMMER="ROWRE_DIMMER",SN.WIDGET_REMOVE_DIMMER="ROWRE_WIDGET_REMOVE_DIMMER",SN.CLOTHING_CHANGE="ROWRE_CLOTHING_CHANGE",SN.JUKEBOX_PLAYLIST_EDITOR="ROWRE_JUKEBOX_PLAYLIST_EDITOR",SN.MANNEQUIN="ROWRE_MANNEQUIN",SN.PET_PRODUCT_MENU="ROWRE_PET_PRODUCT_MENU",SN.GUILD_FURNI_CONTEXT_MENU="ROWRE_GUILD_FURNI_CONTEXT_MENU",SN.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",SN.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",SN.BACKGROUND_COLOR="ROWRE_BACKGROUND_COLOR",SN.MYSTERYBOX_OPEN_DIALOG="ROWRE_MYSTERYBOX_OPEN_DIALOG",SN.EFFECTBOX_OPEN_DIALOG="ROWRE_EFFECTBOX_OPEN_DIALOG",SN.MYSTERYTROPHY_OPEN_DIALOG="ROWRE_MYSTERYTROPHY_OPEN_DIALOG",SN.ACHIEVEMENT_RESOLUTION_OPEN="ROWRE_ACHIEVEMENT_RESOLUTION_OPEN",SN.ACHIEVEMENT_RESOLUTION_ENGRAVING="ROWRE_ACHIEVEMENT_RESOLUTION_ENGRAVING",SN.ACHIEVEMENT_RESOLUTION_FAILED="ROWRE_ACHIEVEMENT_RESOLUTION_FAILED",SN.FRIEND_FURNITURE_CONFIRM="ROWRE_FRIEND_FURNITURE_CONFIRM",SN.FRIEND_FURNITURE_ENGRAVING="ROWRE_FRIEND_FURNITURE_ENGRAVING",SN.BADGE_DISPLAY_ENGRAVING="ROWRE_BADGE_DISPLAY_ENGRAVING",SN.HIGH_SCORE_DISPLAY="ROWRE_HIGH_SCORE_DISPLAY",SN.HIDE_HIGH_SCORE_DISPLAY="ROWRE_HIDE_HIGH_SCORE_DISPLAY",SN.INERNAL_LINK="ROWRE_INTERNAL_LINK",SN.ROOM_LINK="ROWRE_ROOM_LINK",SN.YOUTUBE="ROWRE_YOUTUBE";class NN extends Le{constructor(t,e){super(t),this._targetLocation=void 0,this._targetLocation=e}get targetLocation(){return this._targetLocation}}NN.ROAME_MOVE_TO="ROAME_MOVE_TO";class MN extends YS{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(MN.ROOM_ZOOM,t),this._level=void 0,this._forceFlip=void 0,this._asDelta=void 0,this._level=e,this._forceFlip=s,this._asDelta=i}get level(){return this._level}get forceFlip(){return this._forceFlip}get asDelta(){return this._asDelta}}MN.ROOM_ZOOM="REE_ROOM_ZOOM";class yN{constructor(){this.id=0,this.data=null,this.image=null}getImage(){return this.image?this.image:this.data?At.generateImage(this.data):null}}class DN extends Ue{constructor(){super(null,null)}}class CN extends DN{constructor(t,e){super(),this._itemType=void 0,this._itemName=void 0,this._itemType=t,this._itemName=e}get itemType(){return this._itemType}get itemName(){return this._itemName}}class LN extends DN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(),this._numberOfWords=void 0,this._numberOfWords=t}get numberOfWords(){return this._numberOfWords}}class UN extends DN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(),this._danceStyle=void 0,this._danceStyle=t}get danceStyle(){return this._danceStyle}}class PN extends DN{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super(),this._effect=void 0,this._delayMilliseconds=void 0,this._effect=t,this._delayMilliseconds=e}get effect(){return this._effect}get delayMilliseconds(){return this._delayMilliseconds}}class bN extends DN{constructor(t){super(),this._gainedExperience=void 0,this._gainedExperience=t}get gainedExperience(){return this._gainedExperience}}class wN extends DN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(),this._expressionType=void 0,this._expressionType=t}get expressionType(){return this._expressionType}}class FN extends DN{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(),this._figure=void 0,this._gender=void 0,this._subType=void 0,this._isRiding=void 0,this._figure=t,this._gender=e,this._subType=s,this._isRiding=i}get figure(){return this._figure}get gender(){return this._gender}get subType(){return this._subType}get isRiding(){return this._isRiding}}class xN extends DN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(),this._level=void 0,this._level=t}get level(){return this._level}}class BN extends DN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(),this._gesture=void 0,this._gesture=t}get gesture(){return this._gesture}}class GN extends DN{constructor(t){super(),this._guideStatus=void 0,this._guideStatus=t}get guideStatus(){return this._guideStatus}}class HN extends DN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(),this._isMuted=void 0,this._isMuted=t}get isMuted(){return this._isMuted}}class VN extends DN{}class jN extends DN{constructor(t){super(),this._gesture=void 0,this._gesture=t}get gesture(){return this._gesture}}class kN extends DN{constructor(t){super(),this._value=void 0,this._value=t}get value(){return this._value}}class YN extends DN{constructor(t){super(),this._isPlayingGame=void 0,this._isPlayingGame=t}get isPlayingGame(){return this._isPlayingGame}}class zN extends DN{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";super(),this._postureType=void 0,this._parameter=void 0,this._postureType=t,this._parameter=e}get postureType(){return this._postureType}get parameter(){return this._parameter}}class WN extends DN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;super(),this._signType=void 0,this._signType=t}get signType(){return this._signType}}class KN extends DN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(),this._isSleeping=void 0,this._isSleeping=t}get isSleeping(){return this._isSleeping}}class XN extends DN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(),this._isTyping=void 0,this._isTyping=t}get isTyping(){return this._isTyping}}class qN extends Ue{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(t,s),this._targetLocation=void 0,this._isSlide=void 0,this._targetLocation=e,this._isSlide=i}get targetLocation(){return this._targetLocation?this._targetLocation:this.location}get isSlide(){return this._isSlide}}class QN extends qN{constructor(t,e,s,i,r,n){super(t,e,s),this._headDirection=void 0,this._canStandUp=void 0,this._baseY=void 0,this._headDirection=i,this._canStandUp=r,this._baseY=n}get headDirection(){return this._headDirection}get canStandUp(){return this._canStandUp}get baseY(){return this._baseY}}class ZN extends DN{constructor(t){super(),this._itemType=void 0,this._itemType=t}get itemType(){return this._itemType}}class JN extends Ue{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(null,null),this._state=void 0,this._data=void 0,this._extra=void 0,this._state=t,this._data=e,this._extra=s}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}}class $N extends Ue{constructor(t,e){super(null,null),this._badgeId=void 0,this._assetName=void 0,this._badgeId=t,this._assetName=e}get badgeId(){return this._badgeId}get assetName(){return this._assetName}}$N.BADGE_LOADED="ROGBUM_BADGE_LOADED";class tM extends Ue{constructor(t,e,s){super(t,e),this._height=void 0,this._height=s}get height(){return this._height}}class eM extends Ue{constructor(t){super(null,null),this._data=void 0,this._data=t}get data(){return this._data}}class sM extends Ue{constructor(t,e){super(null,null),this._numberKey=void 0,this._numberValue=void 0,this._numberKey=t,this._numberValue=e}get numberKey(){return this._numberKey}get numberValue(){return this._numberValue}}class iM extends Ue{constructor(t,e,s,i){super(null,null),this._type=void 0,this._color=void 0,this._light=void 0,this._backgroundOnly=void 0,this._type=t,this._color=e,this._light=s,this._backgroundOnly=i}get type(){return this._type}get color(){return this._color}get light(){return this._light}get backgroundOnly(){return this._backgroundOnly}}iM.BACKGROUND_COLOR="RORCUM_BACKGROUND_COLOR";class rM extends Ue{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;super(null,null),this._type=void 0,this._id=void 0,this._x=void 0,this._y=void 0,this._width=void 0,this._height=void 0,this._type=t,this._id=e,this._x=s,this._y=i,this._width=r,this._height=n}get type(){return this._type}get id(){return this._id}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}rM.ADD="ORPFHUM_ADD",rM.REMOVE="ORPFHUM_REMOVE";class nM extends Ue{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"window";super(null,null),this._type=void 0,this._maskId=void 0,this._maskType=void 0,this._maskLocation=void 0,this._maskCategory=void 0,this._type=t,this._maskId=e,this._maskType=s,this._maskLocation=i?new dt(i.x,i.y,i.z):null,this._maskCategory=r}get type(){return this._type}get maskId(){return this._maskId}get maskType(){return this._maskType}get maskLocation(){return this._maskLocation}get maskCategory(){return this._maskCategory}}nM.ADD_MASK="RORMUM_ADD_MASK",nM.REMOVE_MASK="RORMUM_ADD_MASK",nM.DOOR="door",nM.WINDOW="window",nM.HOLE="hole";class aM extends Ue{constructor(t,e){super(null,null),this._type=void 0,this._value=void 0,this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}}aM.WALL_THICKNESS="RORPPUM_WALL_THICKNESS",aM.FLOOR_THICKNESS="RORPVUM_FLOOR_THICKNESS";class oM extends Ue{constructor(t,e){super(null,null),this._type=void 0,this._visible=void 0,this._type=t,this._visible=e}get type(){return this._type}get visible(){return this._visible}}oM.WALL_VISIBILITY="RORPVUM_WALL_VISIBILITY",oM.FLOOR_VISIBILITY="RORPVUM_FLOOR_VISIBILITY";class hM extends Ue{constructor(t,e){super(null,null),this._type=void 0,this._value=void 0,this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}}hM.ROOM_WALL_UPDATE="RORUM_ROOM_WALL_UPDATE",hM.ROOM_FLOOR_UPDATE="RORUM_ROOM_FLOOR_UPDATE",hM.ROOM_LANDSCAPE_UPDATE="RORUM_ROOM_LANDSCAPE_UPDATE";class _M{}_M.NONE=0,_M.GUIDE=1,_M.REQUESTER=2;class dM{constructor(t,e,s){this._id=void 0,this._type=void 0,this._visualization=void 0,this._id=t,this._type=e,this._visualization=s}dispose(){this._visualization=null}update(t,e){}animate(t){return!1}get id(){return this._id}get type(){return this._type}get visualization(){return this._visualization}}class uM extends dM{constructor(t,e,s){super(t,e,s),this._asset=void 0,this._startTime=void 0,this._delta=void 0,this._offsetY=void 0,this._scale=void 0,this._state=void 0,this._asset=null,this._startTime=SU.instance.time,this._delta=0,this._offsetY=0,this._scale=0,this._state=0}update(t,e){if(!t)return;this._scale=e;let s=64,i=0;if(e<48?(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss_small"),i=90===this.visualization.angle||270===this.visualization.angle?0:135===this.visualization.angle||180===this.visualization.angle||225===this.visualization.angle?6:-6,this._offsetY=-38,s=32):(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss"),i=90===this.visualization.angle||270===this.visualization.angle?-3:135===this.visualization.angle||180===this.visualization.angle||225===this.visualization.angle?22:-30,this._offsetY=-70),this.visualization.posture===Bt.POSTURE_SIT?this._offsetY+=s/2:this.visualization.posture===Bt.POSTURE_LAY&&(this._offsetY+=s),this._asset){t.texture=this._asset,t.offsetX=i,t.offsetY=this._offsetY,t.relativeDepth=-.02,t.alpha=0;const e=this._delta;this.animate(t),this._delta=e}}animate(t){if(!t)return!1;if(this._asset&&(t.texture=this._asset),this._state===uM.STATE_DELAY)return!(SU.instance.time-this._startTime<uM.DELAY_BEFORE_ANIMATION)&&(this._state=uM.STATE_FADE_IN,t.alpha=0,t.visible=!0,this._delta=0,!0);if(this._state===uM.STATE_FADE_IN)return this._delta+=.1,t.offsetY=this._offsetY,t.alpha=255*Math.pow(this._delta,.9),this._delta>=1&&(t.alpha=255,this._delta=0,this._state=uM.STATE_FLOAT),!0;if(this._state===uM.STATE_FLOAT){const e=Math.pow(this._delta,.9);this._delta+=.05;const s=this._scale<48?-30:-40;return t.offsetY=this._offsetY+(this._delta<1?e:1)*s,t.alpha=255*(1-e),t.alpha<=0&&(t.visible=!1,this._state=uM.STATE_COMPLETE),!0}return!1}}uM.DELAY_BEFORE_ANIMATION=300,uM.STATE_DELAY=0,uM.STATE_FADE_IN=1,uM.STATE_FLOAT=2,uM.STATE_COMPLETE=3;class cM{static getExpressionAddition(t,e,s){return e===this.BLOW?new uM(t,this.BLOW,s):new dM(t,e,s)}}cM.WAVE=1,cM.BLOW=2,cM.LAUGH=3,cM.CRY=4,cM.IDLE=5;class lM{constructor(t,e){this._id=void 0,this._visualization=void 0,this._asset=void 0,this._startTime=void 0,this._offsetY=void 0,this._scale=void 0,this._state=void 0,this._id=t,this._visualization=e,this._asset=null,this._startTime=SU.instance.time,this._offsetY=0,this._scale=0,this._state=0}dispose(){this._visualization=null,this._asset=null}getSpriteAssetName(t){let e="left";return 135!==this._visualization.angle&&180!==this._visualization.angle&&225!==this._visualization.angle&&270!==this._visualization.angle||(e="right"),"avatar_addition_user_idle_"+e+"_"+t+(this._scale<48?"_small":"")}update(t,e){if(!t)return;this._scale=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(this._state===lM.STATE_FRAME_A?1:2));let s=64,i=0;e<48?(i=135===this._visualization.angle||180===this._visualization.angle||225===this._visualization.angle||270===this._visualization.angle?10:-16,this._offsetY=-38,s=32):(i=135===this._visualization.angle||180===this._visualization.angle||225===this._visualization.angle||270===this._visualization.angle?22:-30,this._offsetY=-70),this._visualization.posture===Bt.POSTURE_SIT?this._offsetY+=s/2:this._visualization.posture===Bt.POSTURE_LAY&&(this._offsetY+=s-.3*s),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=this._offsetY,t.relativeDepth=-.02,t.alpha=0)}animate(t){if(!t)return!1;const e=SU.instance.time;return this._state===lM.STATE_DELAY&&e-this._startTime>=lM.DELAY_BEFORE_ANIMATION&&(this._state=lM.STATE_FRAME_A,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._state===lM.STATE_FRAME_A&&e-this._startTime>=lM.DELAY_PER_FRAME&&(this._state=lM.STATE_FRAME_B,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(2))),this._state===lM.STATE_FRAME_B&&e-this._startTime>=lM.DELAY_PER_FRAME&&(this._state=lM.STATE_FRAME_A,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._asset?(t.texture=this._asset,t.alpha=255,t.visible=!0):t.visible=!1,!1}get id(){return this._id}}lM.DELAY_BEFORE_ANIMATION=2e3,lM.DELAY_PER_FRAME=2e3,lM.STATE_DELAY=0,lM.STATE_FRAME_A=1,lM.STATE_FRAME_B=2;class gM{constructor(t){this._id=void 0,this._asset=void 0,this._disposed=void 0,this._id=t,this._asset=null,this._disposed=!1}dispose(){this._asset=null}update(t,e){if(t){if(!this._asset){const t=new z.a(i.t.WHITE);t.alpha=0,t.width=gM.WIDTH,t.height=gM.HEIGHT,this._asset=At.generateTexture(t)}t.visible=!0,t.texture=this._asset,t.offsetX=gM.OFFSET_X,t.offsetY=gM.OFFSET_Y,t.alphaTolerance=Pe.MATCH_ALL_PIXELS}}animate(t){return!1}get id(){return this._id}}gM.WIDTH=46,gM.HEIGHT=60,gM.OFFSET_X=-23,gM.OFFSET_Y=-48;class EM{constructor(t,e,s){this._id=void 0,this._visualization=void 0,this._asset=void 0,this._relativeDepth=void 0,this._status=void 0,this._id=t,this._visualization=e,this._asset=null,this._relativeDepth=0,this._status=s}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let s=64,i=0,r=0;this._asset=this._visualization.getAvatarRenderAsset(this._status===_M.GUIDE?"avatar_addition_user_guide_bubble":"avatar_addition_user_guide_requester_bubble"),e<48?(i=-19,r=-80,s=32):(i=-19,r=-120),this._visualization.posture===Bt.POSTURE_SIT?r+=s/2:this._visualization.posture===Bt.POSTURE_LAY&&(r+=e),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=r,t.relativeDepth=-.02)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class pM{constructor(t,e){this._id=void 0,this._visualization=void 0,this._asset=void 0,this._id=t,this._visualization=e,this._asset=null}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;let s=64,i=0,r=0;e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted_small"),s=32,i=-12,r=-66):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted"),i=-15,r=-110),this._visualization.posture===Bt.POSTURE_SIT?r+=s/2:this._visualization.posture===Bt.POSTURE_LAY&&(r+=e),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=i,t.offsetY=r,t.relativeDepth=-.02):t.visible=!1}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}}class mM{constructor(t,e,s){this._id=void 0,this._visualization=void 0,this._asset=void 0,this._scale=void 0,this._number=void 0,this._numberValueFadeDirection=void 0,this._numberValueMoving=void 0,this._numberValueMoveCounter=void 0,this._id=t,this._visualization=s,this._asset=null,this._scale=0,this._number=e,this._numberValueFadeDirection=0,this._numberValueMoving=!1,this._numberValueMoveCounter=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;this._scale=e;let s=64,i=0,r=0;this._number>0?(e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number+"_small"),s=32,i=-6,r=-52):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number),i=-8,r=-105),this._visualization.posture===Bt.POSTURE_SIT?r+=s/2:this._visualization.posture===Bt.POSTURE_LAY&&(r+=e),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=i,t.offsetY=r,t.relativeDepth=-.01,t.alpha=0,this._numberValueFadeDirection=1,this._numberValueMoving=!0,this._numberValueMoveCounter=0):t.visible=!1):t.visible&&(this._numberValueFadeDirection=-1)}animate(t){if(!t)return!1;this._asset&&(t.texture=this._asset);let e=t.alpha,s=!1;if(this._numberValueMoving){if(this._numberValueMoveCounter++,this._numberValueMoveCounter<10)return!1;if(this._numberValueFadeDirection<0)this._scale<48?t.offsetY-=2:t.offsetY-=4;else{let e=4;this._scale<48&&(e=8),this._numberValueMoveCounter%e||(t.offsetY--,s=!0)}}return this._numberValueFadeDirection>0?(e<255&&(e+=32),e>=255&&(e=255,this._numberValueFadeDirection=0),t.alpha=e,!0):this._numberValueFadeDirection<0?(e>=0&&(e-=32),e<=0&&(this._numberValueFadeDirection=0,this._numberValueMoving=!1,e=0,t.visible=!1),t.alpha=e,!0):s}get id(){return this._id}}class IM{constructor(t,e){this._id=void 0,this._visualization=void 0,this._asset=void 0,this._relativeDepth=void 0,this._id=t,this._visualization=e,this._asset=null,this._relativeDepth=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let s=64,i=0,r=0;e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing_small"),i=3,r=-42,s=32):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing"),i=14,r=-83),this._visualization.posture===Bt.POSTURE_SIT?r+=s/2:this._visualization.posture===Bt.POSTURE_LAY&&(r+=e),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=r,t.relativeDepth=-.02)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class TM extends c{constructor(){super(),this._avatarRenderer=void 0}initialize(t){return!0}onDispose(){this._avatarRenderer=null}createAvatarImage(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=null;return n=e>48?this._avatarRenderer.createAvatarImage(t,Lt.LARGE,s,i,r):this._avatarRenderer.createAvatarImage(t,Lt.SMALL,s,i,r),n}getAvatarRendererAsset(t){return this._avatarRenderer?this._avatarRenderer.assets.getTexture(t):null}get avatarManager(){return this._avatarRenderer}set avatarManager(t){this._avatarRenderer=t}get layerCount(){return 0}}class RM extends xe{constructor(){super(),this._data=void 0,this._avatarImage=void 0,this._cachedAvatars=void 0,this._cachedAvatarEffects=void 0,this._shadow=void 0,this._lastUpdate=void 0,this._disposed=void 0,this._figure=void 0,this._gender=void 0,this._direction=void 0,this._headDirection=void 0,this._posture=void 0,this._postureParameter=void 0,this._canStandUp=void 0,this._postureOffset=void 0,this._verticalOffset=void 0,this._angle=void 0,this._headAngle=void 0,this._talk=void 0,this._expression=void 0,this._sleep=void 0,this._blink=void 0,this._gesture=void 0,this._sign=void 0,this._highlightEnabled=void 0,this._highlight=void 0,this._dance=void 0,this._effect=void 0,this._carryObject=void 0,this._useObject=void 0,this._ownUser=void 0,this._isLaying=void 0,this._layInside=void 0,this._isAnimating=void 0,this._extraSpritesStartIndex=void 0,this._forcedAnimFrames=void 0,this._updatesUntilFrameUpdate=void 0,this._isAvatarReady=void 0,this._needsUpdate=void 0,this._geometryUpdateCounter=void 0,this._additions=void 0,this._data=null,this._avatarImage=null,this._cachedAvatars=new U,this._cachedAvatarEffects=new U,this._shadow=null,this._lastUpdate=-1e3,this._disposed=!1,this._figure=null,this._gender=null,this._direction=-1,this._headDirection=-1,this._posture="",this._postureParameter="",this._canStandUp=!1,this._postureOffset=0,this._verticalOffset=0,this._angle=-1,this._headAngle=-1,this._talk=!1,this._expression=0,this._sleep=!1,this._blink=!1,this._gesture=0,this._sign=-1,this._highlightEnabled=!1,this._highlight=!1,this._dance=0,this._effect=0,this._carryObject=0,this._useObject=0,this._ownUser=!1,this._isLaying=!1,this._layInside=!1,this._isAnimating=!1,this._extraSpritesStartIndex=2,this._forcedAnimFrames=0,this._updatesUntilFrameUpdate=0,this._isAvatarReady=!1,this._needsUpdate=!1,this._geometryUpdateCounter=-1,this._additions=new Map}initialize(t){return t instanceof TM&&(this._data=t,this.createSprites(RM.INITIAL_RESERVED_SPRITES),super.initialize(t),!0)}dispose(){this._disposed||(super.dispose(),this._avatarImage&&this._avatarImage.dispose(),this._shadow=null,this._disposed=!0)}update(t,e,s,i){if(!this.object||!t||!this._data)return;if(e<this._lastUpdate+RM.UPDATE_TIME_INCREASER)return;this._lastUpdate+=RM.UPDATE_TIME_INCREASER,this._lastUpdate+RM.UPDATE_TIME_INCREASER<e&&(this._lastUpdate=e-RM.UPDATE_TIME_INCREASER);const r=this.object.model,n=t.scale,a=this._effect;let h=!1,_=!1,d=!1,u=!1;const c=this.updateModel(r,n);if(c||n!==this._scale||!this._avatarImage){if(n!==this._scale&&(h=!0,this.updateScale(n)),a!==this._effect&&(_=!0),h||!this._avatarImage||_){if(this._avatarImage=this.createAvatarImage(n,this._effect),!this._avatarImage)return;d=!0;const t=this.getSprite(RM.AVATAR_LAYER_ID);t&&this._avatarImage&&this._avatarImage.isPlaceholder()?t.alpha=150:t&&(t.alpha=255)}if(!this._avatarImage)return;if(_&&this._avatarImage.animationHasResetOnToggle&&this._avatarImage.resetAnimationFrameCounter(),this.updateShadow(n),u=this.updateObject(this.object,t,s,!0),this.processActionsForAvatar(this._avatarImage),this._additions){let t=this._extraSpritesStartIndex;for(const e of this._additions.values())e.update(this.getSprite(t++),n)}this._scale=n}else u=this.updateObject(this.object,t,s);if(this._additions){let t=this._extraSpritesStartIndex;for(const e of this._additions.values())e.animate(this.getSprite(t++))&&this.updateSpriteCounter++}const l=u||c||h,g=(this._isAnimating||this._forcedAnimFrames>0)&&s;if(l&&(this._forcedAnimFrames=RM.ANIMATION_FRAME_UPDATE_INTERVAL),l||g){if(this.updateSpriteCounter++,this._forcedAnimFrames--,this._updatesUntilFrameUpdate--,!(this._updatesUntilFrameUpdate<=0||h||c||d))return;this._avatarImage.updateAnimationByFrames(1),this._updatesUntilFrameUpdate=RM.ANIMATION_FRAME_UPDATE_INTERVAL;let t=this._avatarImage.getCanvasOffsets();(!t||t.length<3)&&(t=RM.DEFAULT_CANVAS_OFFSETS);const e=this.getSprite(RM.SPRITE_INDEX_AVATAR);if(e){const s=1===this.object.model.getValue(rt.FIGURE_HIGHLIGHT_ENABLE)&&1===this.object.model.getValue(rt.FIGURE_HIGHLIGHT),i=this._avatarImage.getImage(Gt.FULL,s);i&&(e.texture=i,s||(e.filters=[])),e.texture&&(e.offsetX=-1*n/2+t[0]-(e.texture.width-n)/2,e.offsetY=-e.texture.height+n/4+t[1]+this._postureOffset),this._isLaying?this._layInside?e.relativeDepth=-.5:e.relativeDepth=RM.AVATAR_SPRITE_LAYING_DEPTH+t[2]:e.relativeDepth=RM.AVATAR_SPRITE_DEFAULT_DEPTH+t[2],this._ownUser?(e.relativeDepth-=RM.AVATAR_OWN_DEPTH_ADJUST,e.spriteType=be.AVATAR_OWN):e.spriteType=be.AVATAR}const s=this.getAddition(RM.TYPING_BUBBLE_ID);s&&(this._isLaying?s.relativeDepth=RM.AVATAR_SPRITE_LAYING_DEPTH-.01+t[2]:s.relativeDepth=RM.AVATAR_SPRITE_DEFAULT_DEPTH-.01+t[2]),this._isAnimating=this._avatarImage.isAnimating();let i=RM.INITIAL_RESERVED_SPRITES;const r=this._avatarImage.getDirection();for(const a of this._avatarImage.getSprites())if(a.id===RM.AVATAR){const t=this.getSprite(RM.SPRITE_INDEX_AVATAR);if(t){const e=this._avatarImage.getLayerData(a);let s=a.getDirectionOffsetX(r),i=a.getDirectionOffsetY(r);e&&(s+=e.dx,i+=e.dy),n<48&&(s/=2,i/=2),this._canStandUp||(t.offsetX+=s,t.offsetY+=i)}}else{const t=this.getSprite(i);if(t){t.alphaTolerance=Pe.MATCH_NOTHING,t.visible=!0;const e=this._avatarImage.getLayerData(a);let s=0,i=a.getDirectionOffsetX(r),h=a.getDirectionOffsetY(r);const _=a.getDirectionOffsetZ(r);let d=0;a.hasDirections&&(d=r),e&&(s=e.animationFrame,i+=e.dx,h+=e.dy,d+=e.dd),n<48&&(i/=2,h/=2),d<0?d+=8:d>7&&(d-=8);const u=this._avatarImage.getScale()+"_"+a.member+"_"+d+"_"+s,c=this._avatarImage.getAsset(u);if(!c)continue;t.texture=c.texture,t.offsetX=c.offsetX-n/2+i,t.offsetY=c.offsetY+h,t.flipH=c.flipH,a.hasStaticY?t.offsetY+=this._verticalOffset*n/(2*RM.BASE_Y_SCALE):t.offsetY+=this._postureOffset,this._isLaying?t.relativeDepth=RM.AVATAR_SPRITE_LAYING_DEPTH-.001*this.totalSprites*_:t.relativeDepth=RM.AVATAR_SPRITE_DEFAULT_DEPTH-.001*this.totalSprites*_,33===a.ink?t.blendMode=o.b.ADD:t.blendMode=o.b.NORMAL}i++}}}createAvatarImage(t,e){let s=null,i="avatarImage"+t.toString();if(e?(i+="-"+e,s=this._cachedAvatarEffects.getValue(i)):s=this._cachedAvatars.getValue(i),!s&&(s=this._data.createAvatarImage(this._figure,t,this._gender,this,this),s))if(e){if(this._cachedAvatarEffects.length>=RM.MAX_EFFECT_CACHE){const t=this._cachedAvatarEffects.remove(this._cachedAvatarEffects.getKey(0));t&&t.dispose()}this._cachedAvatarEffects.add(i,s)}else this._cachedAvatars.add(i,s);return s}updateObject(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!i&&this.updateObjectCounter===t.updateCounter&&this._geometryUpdateCounter===e.updateId)return!1;let r=t.getDirection().x-e.direction.x,n=this._headDirection-e.direction.x;return"float"===this._posture&&(n=r),r=(r%360+360)%360,n=(n%360+360)%360,"sit"===this._posture&&this._canStandUp&&(r-=r%90-45,n-=n%90-45),(r!==this._angle||i)&&(s=!0,this._angle=r,r-=112.5,r=(r+360)%360,this._avatarImage.setDirectionAngle(Gt.FULL,r)),(n!==this._headAngle||i)&&(s=!0,this._headAngle=n,this._headAngle!==this._angle&&(n-=112.5,n=(n+360)%360,this._avatarImage.setDirectionAngle(Gt.HEAD,n))),this._geometryUpdateCounter=e.updateId,this.updateObjectCounter=this.object.updateCounter,s}updateModel(t,e){if(!t)return!1;if(this.updateModelCounter===t.updateCounter)return!1;let s=!1;const i=t.getValue(rt.FIGURE_TALK)>0;i!==this._talk&&(this._talk=i,s=!0);const r=t.getValue(rt.FIGURE_EXPRESSION);r!==this._expression&&(this._expression=r,s=!0);const n=t.getValue(rt.FIGURE_SLEEP)>0;n!==this._sleep&&(this._sleep=n,s=!0);const a=t.getValue(rt.FIGURE_BLINK)>0;a!==this._blink&&(this._blink=a,s=!0);const o=t.getValue(rt.FIGURE_GESTURE)||0;o!==this._gesture&&(this._gesture=o,s=!0);const h=t.getValue(rt.FIGURE_POSTURE);h!==this._posture&&(this._posture=h,s=!0);const _=t.getValue(rt.FIGURE_POSTURE_PARAMETER);_!==this._postureParameter&&(this._postureParameter=_,s=!0);const d=t.getValue(rt.FIGURE_CAN_STAND_UP);d!==this._canStandUp&&(this._canStandUp=d,s=!0);const u=t.getValue(rt.FIGURE_VERTICAL_OFFSET)*RM.BASE_Y_SCALE;u!==this._verticalOffset&&(this._verticalOffset=u,s=!0);const c=t.getValue(rt.FIGURE_DANCE)||0;c!==this._dance&&(this._dance=c,s=!0);const l=t.getValue(rt.FIGURE_EFFECT)||0;l!==this._effect&&(this._effect=l,s=!0);const g=t.getValue(rt.FIGURE_CARRY_OBJECT)||0;g!==this._carryObject&&(this._carryObject=g,s=!0);const E=t.getValue(rt.FIGURE_USE_OBJECT)||0;E!==this._useObject&&(this._useObject=E,s=!0);const p=t.getValue(rt.HEAD_DIRECTION);p!==this._headDirection&&(this._headDirection=p,s=!0),this._carryObject>0&&E>0?this._useObject!==this._carryObject&&(this._useObject=this._carryObject,s=!0):0!==this._useObject&&(this._useObject=0,s=!0);let m=this.getAddition(RM.FLOATING_IDLE_Z_ID);this._sleep?(m||(m=this.addAddition(new lM(RM.FLOATING_IDLE_Z_ID,this))),s=!0):m&&this.removeAddition(RM.FLOATING_IDLE_Z_ID);const I=t.getValue(rt.FIGURE_IS_MUTED)>0;let T=this.getAddition(RM.MUTED_BUBBLE_ID);if(I)T||(T=this.addAddition(new pM(RM.MUTED_BUBBLE_ID,this))),s=!0;else{T&&(this.removeAddition(RM.MUTED_BUBBLE_ID),s=!0);const e=t.getValue(rt.FIGURE_IS_TYPING)>0;let i=this.getAddition(RM.TYPING_BUBBLE_ID);e?(i||(i=this.addAddition(new IM(RM.TYPING_BUBBLE_ID,this))),s=!0):i&&(this.removeAddition(RM.TYPING_BUBBLE_ID),s=!0)}const R=t.getValue(rt.FIGURE_GUIDE_STATUS)||0;R!==_M.NONE?(this.removeAddition(RM.GUIDE_BUBBLE_ID),this.addAddition(new EM(RM.GUIDE_BUBBLE_ID,this,R)),s=!0):this.getAddition(RM.GUIDE_BUBBLE_ID)&&(this.removeAddition(RM.GUIDE_BUBBLE_ID),s=!0);const f=t.getValue(rt.FIGURE_IS_PLAYING_GAME)>0;let O=this.getAddition(RM.GAME_CLICK_TARGET_ID);f?(O||(O=this.addAddition(new gM(RM.GAME_CLICK_TARGET_ID))),s=!0):O&&this.removeAddition(RM.GAME_CLICK_TARGET_ID);const v=t.getValue(rt.FIGURE_NUMBER_VALUE);let A=this.getAddition(RM.NUMBER_BUBBLE_ID);v>0?(A||(A=this.addAddition(new mM(RM.NUMBER_BUBBLE_ID,v,this))),s=!0):A&&this.removeAddition(RM.NUMBER_BUBBLE_ID);let S=this.getAddition(RM.EXPRESSION_ID);this._expression>0?S||(S=cM.getExpressionAddition(RM.EXPRESSION_ID,this._expression,this),S&&this.addAddition(S)):S&&this.removeAddition(RM.EXPRESSION_ID),this.updateScale(e);const N=t.getValue(rt.GENDER);N!==this._gender&&(this._gender=N,s=!0),this.updateFigure(t.getValue(rt.FIGURE))&&(s=!0);let M=t.getValue(rt.FIGURE_SIGN);null===M&&(M=-1),this._sign!==M&&(this._sign=M,s=!0);const y=t.getValue(rt.FIGURE_HIGHLIGHT_ENABLE)>0;if(y!==this._highlightEnabled&&(this._highlightEnabled=y,s=!0),this._highlightEnabled){const e=t.getValue(rt.FIGURE_HIGHLIGHT)>0;e!==this._highlight&&(this._highlight=e,s=!0)}const D=t.getValue(rt.OWN_USER)>0;return D!==this._ownUser&&(this._ownUser=D,s=!0),this.updateModelCounter=t.updateCounter,s}setDirection(t){this._direction!==t&&(this._direction=t,this._needsUpdate=!0)}updateScale(t){if(t<48&&(this._blink=!1),"sit"===this._posture||"lay"===this._posture?this._postureOffset=t/2:this._postureOffset=0,this._layInside=!1,this._isLaying=!1,"lay"===this._posture){this._isLaying=!0;parseInt(this._postureParameter)<0&&(this._layInside=!0)}}processActionsForAvatar(t){if(!t)return;if(t.initActionAppends(),t.appendAction(Bt.POSTURE,this._posture,this._postureParameter),this._gesture>0&&this._avatarImage.appendAction(Bt.GESTURE,Bt.getGesture(this._gesture)),this._dance>0&&this._avatarImage.appendAction(Bt.DANCE,this._dance),this._sign>-1&&this._avatarImage.appendAction(Bt.SIGN,this._sign),this._carryObject>0&&this._avatarImage.appendAction(Bt.CARRY_OBJECT,this._carryObject),this._useObject>0&&this._avatarImage.appendAction(Bt.USE_OBJECT,this._useObject),this._talk&&this._avatarImage.appendAction(Bt.TALK),(this._sleep||this._blink)&&this._avatarImage.appendAction(Bt.SLEEP),this._expression>0){const t=Bt.getExpression(this._expression);if(""!==t)if(t===Bt.DANCE)this._avatarImage.appendAction(Bt.DANCE,2);else this._avatarImage.appendAction(t)}this._effect>0&&this._avatarImage.appendAction(Bt.EFFECT,this._effect),t.endActionAppends(),this._isAnimating=t.isAnimating();let e=RM.INITIAL_RESERVED_SPRITES;for(const s of this._avatarImage.getSprites())s.id!==RM.AVATAR&&e++;if(e!==this.totalSprites&&this.createSprites(e),this._extraSpritesStartIndex=e,this._additions)for(const s of this._additions.values())this.createSprite()}updateFigure(t){return this._figure!==t&&(this._figure=t,this.clearAvatar(),!0)}resetFigure(t){this.clearAvatar()}resetEffect(t){this.clearAvatar()}clearAvatar(){for(const e of this._cachedAvatars.getValues())e&&e.dispose();for(const e of this._cachedAvatarEffects.getValues())e&&e.dispose();this._cachedAvatars.reset(),this._cachedAvatarEffects.reset(),this._avatarImage=null;const t=this.getSprite(RM.AVATAR_LAYER_ID);t&&(t.texture=i.t.EMPTY,t.alpha=255)}getAddition(t){if(!this._additions)return null;const e=this._additions.get(t);return e||null}addAddition(t){if(!this.getAddition(t.id))return this._additions.set(t.id,t),t}removeAddition(t){const e=this.getAddition(t);e&&(this._additions.delete(e.id),e.dispose())}updateShadow(t){this._shadow=null;const e=this.getSprite(RM.SHADOW_LAYER_ID);if(!e)return;let s="mv"===this._posture||"std"===this._posture||"sit"===this._posture&&this._canStandUp;if(this._effect===RM.SNOWBOARDING_EFFECT&&(s=!1),s){if(e.visible=!0,!this._shadow||t!==this._scale){let s=0,i=0;t<48?(e.libraryAssetName="sh_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(e.libraryAssetName),s=-8,i=this._canStandUp?6:-3):(e.libraryAssetName="h_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(e.libraryAssetName),s=-17,i=this._canStandUp?10:-7),this._shadow?(e.texture=this._shadow.texture,e.offsetX=s,e.offsetY=i,e.alpha=50,e.relativeDepth=1):e.visible=!1}}else this._shadow=null,e.visible=!1}getAvatarRenderAsset(t){return this._data?this._data.getAvatarRendererAsset(t):null}get direction(){return this._direction}get posture(){return this._posture}get angle(){return this._angle}get disposed(){return this._disposed}}RM.AVATAR="avatar",RM.FLOATING_IDLE_Z_ID=1,RM.TYPING_BUBBLE_ID=2,RM.EXPRESSION_ID=3,RM.NUMBER_BUBBLE_ID=4,RM.GAME_CLICK_TARGET_ID=5,RM.MUTED_BUBBLE_ID=6,RM.GUIDE_BUBBLE_ID=7,RM.OWN_USER_ID=4,RM.UPDATE_TIME_INCREASER=41,RM.AVATAR_LAYER_ID=0,RM.SHADOW_LAYER_ID=1,RM.SNOWBOARDING_EFFECT=97,RM.INITIAL_RESERVED_SPRITES=2,RM.ANIMATION_FRAME_UPDATE_INTERVAL=2,RM.DEFAULT_CANVAS_OFFSETS=[0,0,0],RM.MAX_EFFECT_CACHE=2,RM.SPRITE_INDEX_AVATAR=0,RM.BASE_Y_SCALE=1e3,RM.AVATAR_SPRITE_DEFAULT_DEPTH=-.01,RM.AVATAR_OWN_DEPTH_ADJUST=.001,RM.AVATAR_SPRITE_LAYING_DEPTH=-.409;class fM{constructor(){this._id=void 0,this._x=void 0,this._y=void 0,this._repeats=void 0,this._frameRepeats=void 0,this._remainingFrameRepeats=void 0,this._activeSequence=void 0,this._activeSequenceOffset=void 0,this._isLastFrame=void 0,this._isRecycled=void 0}static allocate(t,e,s,i,r,n){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;const h=fM.POOL.length?fM.POOL.pop():new fM;return i<1&&(i=1),r<0&&(r=fM.FRAME_REPEAT_FOREVER),h._id=t,h._x=e||0,h._y=s||0,h._repeats=i,h._frameRepeats=r,h._remainingFrameRepeats=r,h._isLastFrame=n,h._isRecycled=!1,a>=0?(h._activeSequence=a,h._activeSequenceOffset=o):(h._activeSequence=-1,h._activeSequenceOffset=0),h}get id(){return this._id>=0?this._id:-this._id*Math.random()}get x(){return this._x}get y(){return this._y}get repeats(){return this._repeats}get frameRepeats(){return this._frameRepeats}get isLastFrame(){return this._isLastFrame}get remainingFrameRepeats(){return this._frameRepeats<0?fM.FRAME_REPEAT_FOREVER:this._remainingFrameRepeats}set remainingFrameRepeats(t){t<0&&(t=0),this._frameRepeats>0&&t>this._frameRepeats&&(t=this._frameRepeats),this._remainingFrameRepeats=t}get activeSequence(){return this._activeSequence}get activeSequenceOffset(){return this._activeSequenceOffset}recycle(){this._isRecycled||(this._isRecycled=!0,fM.POOL.length<fM.POOL_SIZE_LIMIT&&fM.POOL.push(this))}}fM.FRAME_REPEAT_FOREVER=-1,fM.SEQUENCE_NOT_DEFINED=-1,fM.POOL_SIZE_LIMIT=3e3,fM.POOL=[];class OM{constructor(t,e,s,i,r,n){this._id=0,this._x=0,this._y=0,this._randomX=0,this._randomY=0,this._repeats=1,this._id=t,this._x=e,this._y=s,this._randomX=i,this._randomY=r,this._repeats=n}get id(){return this._id}hasDirectionalOffsets(){return!1}getX(t){return this._x}getY(t){return this._y}get x(){return this._x}get y(){return this._x}get randomX(){return this._randomX}get randomY(){return this._randomY}get repeats(){return this._repeats}}class vM extends OM{constructor(t,e,s,i,r,n,a){super(t,e,s,i,r,a),this._directionalOffsets=void 0,this._directionalOffsets=n}hasDirectionalOffsets(){return null!==this._directionalOffsets}getX(t){return this._directionalOffsets?this._directionalOffsets.getXOffset(t,super.getX(t)):super.getX(t)}getY(t){return this._directionalOffsets?this._directionalOffsets.getYOffset(t,super.getY(t)):super.getY(t)}}class AM{constructor(t,e){this._frames=void 0,this._frameIndexes=void 0,this._frameRepeats=void 0,this._isRandom=void 0,this._loopCount=void 0,this._frames=[],this._frameIndexes=[],this._frameRepeats=[],this._isRandom=e,this._loopCount=t<1?1:t}get isRandom(){return this._isRandom}get frameCount(){return this._frameIndexes.length*this._loopCount}dispose(){this._frames=[]}initialize(){let t=this._frameIndexes.length-1,e=-1,s=1;for(;t>=0;)this._frameIndexes[t]===e?s++:(e=this._frameIndexes[t],s=1),this._frameRepeats[t]=s,t--}addFrame(t,e,s,i,r,n){let a=1;if(this._frames.length>0){const n=this._frames[this._frames.length-1];n.id!==t||n.hasDirectionalOffsets()||n.x!==e||n.y!==s||n.randomX!==i||0!==i||n.randomY!==r||0!==r||(a+=n.repeats,this._frames.pop())}const o=n?new vM(t,e,s,i,r,n,a):new OM(t,e,s,i,r,a);this._frames.push(o),this._frameIndexes.push(this._frames.length-1),this._frameRepeats.push(1)}getFrame(t){return!this._frames.length||t<0||t>=this.frameCount?null:this._frames[this._frameIndexes[t%this._frameIndexes.length]]}getFrameIndex(t){return t<0||t>=this.frameCount?-1:(this._isRandom&&(t=Math.round(Math.random()*this._frameIndexes.length))===this._frameIndexes.length&&t--,t)}getRepeats(t){return t<0||t>=this.frameCount?0:this._frameRepeats[t%this._frameRepeats.length]}}class SM{constructor(t,e,s){this._frameSequences=void 0,this._frameCount=void 0,this._loopCount=void 0,this._frameRepeat=void 0,this._isRandom=void 0,this._frameSequences=[],this._frameCount=-1,this._loopCount=t<0?0:t,this._frameRepeat=e<1?1:e,this._isRandom=s}get frameCount(){return this._frameCount<0&&this.calculateLength(),this._frameCount}dispose(){if(this._frameSequences&&this._frameSequences.length){for(const t of this._frameSequences)t&&t.dispose();this._frameSequences=[]}}addFrameSequence(t,e){const s=new AM(t,e);return this._frameSequences.push(s),s}calculateLength(){this._frameCount=0;for(const t of this._frameSequences)t&&(this._frameCount+=t.frameCount)}getFrame(t,e){if(this._frameCount<1)return null;if(e/=this._frameRepeat,!this._isRandom){const s=Math.floor(e/this._frameCount);e=Math.floor(e%this._frameCount);let i=!1,r=null;(this._loopCount>0&&s>=this._loopCount||this._loopCount<=0&&1===this._frameCount)&&(e=this._frameCount-1,i=!0);let n=0,a=0;for(;a<this._frameSequences.length;){if(r=this._frameSequences[a],r){if(e<n+r.frameCount)break;n+=r.frameCount}a++}return this.getFrameFromSpecificSequence(t,r,a,e-n,i)}const s=Math.trunc(this._frameSequences.length*Math.random()),i=this._frameSequences[s];return i.frameCount<1?null:this.getFrameFromSpecificSequence(t,i,s,0,!1)}getFrameFromSequence(t,e,s,i){if(e<0||e>=this._frameSequences.length)return null;const r=this._frameSequences[e];return r?s>=r.frameCount?this.getFrame(t,i):this.getFrameFromSpecificSequence(t,r,e,s,!1):null}getFrameFromSpecificSequence(t,e,s,i,r){if(!e)return null;const n=e.getFrameIndex(i),a=e.getFrame(n);if(!a)return null;let o=a.getX(t),h=a.getY(t);const _=a.randomX,d=a.randomY;let u=a.repeats,c=!1;_&&(o=Math.trunc(o+_*Math.random())),d&&(h=Math.trunc(h+d*Math.random())),u>1&&(u=e.getRepeats(n));let l=this._frameRepeat*u;return r&&(l=fM.FRAME_REPEAT_FOREVER),this._isRandom||e.isRandom||s===this._frameSequences.length-1&&i===e.frameCount-1&&(c=!0),fM.allocate(a.id,o,h,u,l,c,s,i)}}class NM{constructor(){this._offsetX=void 0,this._offsetY=void 0,this._offsetX=new Map,this._offsetY=new Map}getXOffset(t,e){const s=this._offsetX.get(t);return void 0===s||null===s?e:s}getYOffset(t,e){const s=this._offsetY.get(t);return void 0===s||null===s?e:s}setDirection(t,e,s){this._offsetX.set(t,e),this._offsetY.set(t,s)}}class MM{constructor(){this._layers=void 0,this._frameCount=void 0,this._randomStart=void 0,this._immediateChanges=void 0,this._layers=new Map,this._frameCount=-1,this._randomStart=!1,this._immediateChanges=null}static getTransitionToAnimationId(t){return MM.TRANSITION_TO_ANIMATION_OFFSET+t}static getTransitionFromAnimationId(t){return MM.TRANSITION_FROM_ANIMATION_OFFSET+t}static isTransitionToAnimation(t){return t>=MM.TRANSITION_TO_ANIMATION_OFFSET&&t<MM.TRANSITION_FROM_ANIMATION_OFFSET}static isTransitionFromAnimation(t){return t>=MM.TRANSITION_FROM_ANIMATION_OFFSET}dispose(){for(const t of this._layers.values())t&&t.dispose();this._layers.clear(),this._immediateChanges=null}setImmediateChanges(t){this._immediateChanges=t}isImmediateChange(t){return!(!this._immediateChanges||-1===this._immediateChanges.indexOf(t))}getStartFrame(t){return this._randomStart?Math.random()*this._frameCount:0}initialize(t){if(t.randomStart&&(this._randomStart=!0),t.layers)for(const e in t.layers){const s=t.layers[e];if(!s)return!1;const i=parseInt(e),r=void 0!==s.loopCount?s.loopCount:1,n=void 0!==s.frameRepeat?s.frameRepeat:1,a=void 0!==s.random&&0!==s.random;if(!this.addLayer(i,r,n,a,s))return!1}return!0}addLayer(t,e,s,i,r){const n=new SM(e,s,i);if(r.frameSequences)for(const o in r.frameSequences){const t=r.frameSequences[o];if(!t)continue;const e=void 0!==t.loopCount?t.loopCount:1,s=void 0!==t.random&&0!==t.random,i=n.addFrameSequence(e,s);if(t.frames)for(const r in t.frames){const e=t.frames[r];if(!e)return n.dispose(),!1;i.addFrame(e.id,e.x||0,e.y||0,e.randomX||0,e.randomY||0,this.readDirectionalOffsets(e))}i.initialize()}n.calculateLength(),this._layers.set(t,n);const a=n.frameCount;return a>this._frameCount&&(this._frameCount=a),!0}readDirectionalOffsets(t){let e=null;if(t&&t.offsets)for(const s in t.offsets){const i=t.offsets[s];i&&(e||(e=new NM),e.setDirection(i.direction,i.x,i.y))}return e}getFrame(t,e,s){const i=this._layers.get(e);return i?i.getFrame(t,s):null}getFrameFromSequence(t,e,s,i,r){const n=this._layers.get(e);return n?n.getFrameFromSequence(t,s,i,r):null}}MM.TRANSITION_TO_ANIMATION_OFFSET=1e6,MM.TRANSITION_FROM_ANIMATION_OFFSET=2e6,MM.DEFAULT_FRAME_NUMBER=0;class yM{constructor(){this._animationId=void 0,this._animationAfterTransitionId=void 0,this._animationOver=void 0,this._frameCounter=void 0,this._frames=void 0,this._lastFramePlayed=void 0,this._animationPlayed=void 0,this._layerCount=void 0,this._animationId=-1,this._animationAfterTransitionId=0,this._animationOver=!1,this._frameCounter=0,this._frames=[],this._lastFramePlayed=[],this._animationPlayed=[],this._layerCount=0}get animationOver(){return this._animationOver}set animationOver(t){this._animationOver=t}get frameCounter(){return this._frameCounter}set frameCounter(t){this._frameCounter=t}get animationId(){return this._animationId}set animationId(t){t!==this._animationId&&(this._animationId=t,this.resetAnimationFrames(!1))}get animationAfterTransitionId(){return this._animationAfterTransitionId}set animationAfterTransitionId(t){this._animationAfterTransitionId=t}dispose(){this.recycleFrames(),this._frames=null,this._lastFramePlayed=null,this._animationPlayed=null}setLayerCount(t){this._layerCount=t,this.resetAnimationFrames()}resetAnimationFrames(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!t&&this._frames||(this.recycleFrames(),this._frames=[]),this._lastFramePlayed=[],this._animationPlayed=[],this._animationOver=!1,this._frameCounter=0;let e=0;for(;e<this._layerCount;){if(t||this._frames.length<=e)this._frames[e]=null;else{const t=this._frames[e];t&&(t.recycle(),this._frames[e]=fM.allocate(t.id,t.x,t.y,t.repeats,0,t.isLastFrame))}this._lastFramePlayed[e]=!1,this._animationPlayed[e]=!1,e++}}recycleFrames(){if(this._frames&&this._frames.length)for(const t of this._frames)t&&t.recycle()}getFrame(t){return t<0||t>=this._layerCount?null:this._frames[t]}setFrame(t,e){if(t<0||t>=this._layerCount)return;const s=this._frames[t];s&&s.recycle(),this._frames[t]=e}getAnimationPlayed(t){return t<0||t>=this._layerCount||this._animationPlayed[t]}setAnimationPlayed(t,e){t<0||t>=this._layerCount||(this._animationPlayed[t]=e)}getLastFramePlayed(t){return t<0||t>=this._layerCount||this._lastFramePlayed[t]}setLastFramePlayed(t,e){t<0||t>=this._layerCount||(this._lastFramePlayed[t]=e)}}class DM{constructor(t){this._colors=void 0,this._colors=[],this.createColors(t)}createColors(t){if(t)for(let e=0;e<t;e++)this._colors.push(DM.DEFAULT_COLOR)}dispose(){this._colors=[]}getLayerColor(t){const e=this._colors[t];return e||DM.DEFAULT_COLOR}setColorLayer(t,e){this._colors[t]&&(this._colors[t]=e)}}DM.DEFAULT_COLOR=16777215;class CM{constructor(){this._tag=void 0,this._ink=void 0,this._alpha=void 0,this._ignoreMouse=void 0,this._xOffset=void 0,this._yOffset=void 0,this._zOffset=void 0,this._tag=CM.DEFAULT_TAG,this._ink=CM.DEFAULT_INK,this._alpha=CM.DEFAULT_ALPHA,this._ignoreMouse=CM.DEFAULT_IGNORE_MOUSE,this._xOffset=CM.DEFAULT_XOFFSET,this._yOffset=CM.DEFAULT_YOFFSET,this._zOffset=CM.DEFAULT_ZOFFSET}setFromLayer(t){t&&(this._tag=t.tag,this._ink=t.ink,this._alpha=t.alpha,this._ignoreMouse=t.ignoreMouse,this._xOffset=t.xOffset,this._yOffset=t.yOffset,this._zOffset=t.zOffset)}get tag(){return this._tag}set tag(t){this._tag=t}get ink(){return this._ink}set ink(t){this._ink=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get ignoreMouse(){return this._ignoreMouse}set ignoreMouse(t){this._ignoreMouse=t}get xOffset(){return this._xOffset}set xOffset(t){this._xOffset=t}get yOffset(){return this._yOffset}set yOffset(t){this._yOffset=t}get zOffset(){return this._zOffset}set zOffset(t){this._zOffset=t}}CM.DEFAULT_COUNT=0,CM.DEFAULT_DIRECTION=0,CM.DEFAULT_TAG="",CM.DEFAULT_INK=o.b.NORMAL,CM.DEFAULT_ALPHA=255,CM.DEFAULT_IGNORE_MOUSE=!1,CM.DEFAULT_XOFFSET=0,CM.DEFAULT_YOFFSET=0,CM.DEFAULT_ZOFFSET=0;class LM{constructor(t){this._layers=void 0,this._layers=[],this.createLayers(t)}createLayers(t){if(t)for(let e=0;e<t;e++)this._layers.push(new CM)}dispose(){this._layers=[]}setFromDirection(t){if(!t)return;const e=this.layerCount;if(e===t.layerCount)for(let s=0;s<e;s++){const e=this.getLayer(s),i=t.getLayer(s);e&&e.setFromLayer(i)}}getLayer(t){const e=this._layers[t];return e||null}getLayerTag(t){const e=this.getLayer(t);return e?e.tag:CM.DEFAULT_TAG}setLayerTag(t,e){const s=this.getLayer(t);s&&(s.tag=e)}getLayerInk(t){const e=this.getLayer(t);return e?e.ink:CM.DEFAULT_INK}setLayerInk(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.ink=e))}getLayerAlpha(t){const e=this.getLayer(t);return e?e.alpha:CM.DEFAULT_ALPHA}setLayerAlpha(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.alpha=e))}getLayerIgnoreMouse(t){const e=this.getLayer(t);return e?e.ignoreMouse:CM.DEFAULT_IGNORE_MOUSE}setLayerIgnoreMouse(t,e){const s=this.getLayer(t);s&&(s.ignoreMouse=e||!1)}getLayerXOffset(t){const e=this.getLayer(t);return e?e.xOffset:CM.DEFAULT_XOFFSET}setLayerXOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.xOffset=e))}getLayerYOffset(t){const e=this.getLayer(t);return e?e.yOffset:CM.DEFAULT_YOFFSET}setLayerYOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.yOffset=e))}getLayerZOffset(t){const e=this.getLayer(t);return e?e.zOffset:CM.DEFAULT_ZOFFSET}setLayerZOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.zOffset=e))}get layerCount(){return this._layers.length}}LM.USE_DEFAULT_DIRECTION=-1;class UM{constructor(t,e){this._layerCount=void 0,this._angle=void 0,this._defaultDirection=void 0,this._directions=void 0,this._colors=void 0,this._lastDirectionData=void 0,this._lastDirection=void 0,this._layerCount=t<0?0:t>UM.MAX_LAYERS?UM.MAX_LAYERS:t,this._angle=e<1?1:e>360?360:e,this._defaultDirection=new LM(this._layerCount),this._directions=new Map,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1}dispose(){this._defaultDirection&&this._defaultDirection.dispose();for(const t of this._directions.values())t&&t.dispose();for(const t of this._colors)t&&t.dispose();this.reset()}reset(){this._defaultDirection=null,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1,this._directions.clear()}processLayers(t){return!!t&&this.setDirectionLayers(this._defaultDirection,t)}processDirections(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const i=parseInt(e);if(this._directions.get(i))return!1;const r=new LM(this._layerCount);r.setFromDirection(this._defaultDirection),this.setDirectionLayers(r,s.layers),this._directions.set(i,r),this._lastDirectionData=null,this._lastDirection=-1}return!0}processColors(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const i=parseInt(e);if(this._colors[i])return!1;const r=new DM(this._layerCount);for(const t in s.layers){const e=s.layers[t];if(!e)continue;const i=parseInt(t),n=e.color;r.setColorLayer(i,n)}this._colors[i]=r}return!0}setDirectionLayers(t,e){if(!t||!e)return!1;for(const s in e){const i=e[s];if(!i)continue;const r=parseInt(s);if(r<0||r>=this._layerCount)return!1;void 0!==i.ink&&t.setLayerInk(r,Xe.inkToBlendMode(i.ink)),void 0!==i.tag&&t.setLayerTag(r,i.tag),void 0!==i.alpha&&t.setLayerAlpha(r,i.alpha),void 0!==i.ignoreMouse&&t.setLayerIgnoreMouse(r,i.ignoreMouse),void 0!==i.x&&t.setLayerXOffset(r,i.x),void 0!==i.y&&t.setLayerYOffset(r,i.y),void 0!==i.z&&t.setLayerZOffset(r,i.z/-1e3)}return!0}getValidDirection(t){if(this._directions.get(t))return t;t=(t%360+360)%360;let e=-1,s=-1;for(const i of this._directions.keys()){let r=(i*this._angle-t+360)%360;r>180&&(r=360-r),(r<e||e<0)&&(e=r,s=i)}return s>=0?Math.trunc(s):0}getDirectionData(t){if(t===this._lastDirection&&this._lastDirectionData)return this._lastDirectionData;let e=this._directions.get(t);return e||(e=this._defaultDirection),this._lastDirection=t,this._lastDirectionData=e,this._lastDirectionData}getLayerTag(t,e){const s=this.getDirectionData(t);return s?s.getLayerTag(e):CM.DEFAULT_TAG}getLayerInk(t,e){const s=this.getDirectionData(t);return s?s.getLayerInk(e):CM.DEFAULT_INK}getLayerAlpha(t,e){const s=this.getDirectionData(t);return s?s.getLayerAlpha(e):CM.DEFAULT_ALPHA}getLayerColor(t,e){const s=this._colors[e];return s?s.getLayerColor(t):DM.DEFAULT_COLOR}getLayerIgnoreMouse(t,e){const s=this.getDirectionData(t);return s?s.getLayerIgnoreMouse(e):CM.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerXOffset(e):CM.DEFAULT_XOFFSET}getLayerYOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerYOffset(e):CM.DEFAULT_YOFFSET}getLayerZOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerZOffset(e):CM.DEFAULT_ZOFFSET}get layerCount(){return this._layerCount}}UM.MAX_LAYERS=26;class PM extends UM{constructor(t,e){super(t,e),this._animations=void 0,this._animationIds=void 0,this._animations=new Map,this._animationIds=[]}dispose(){super.dispose();for(const t of this._animations.values())t&&t.dispose();this._animations.clear(),this._animationIds=[]}defineAnimations(t){if(!t)return!0;for(const e in t){const s=t[e];if(!s)return!1;let i=parseInt(e.split("_")[0]),r=!1;const n=s.transitionTo,a=s.transitionFrom;void 0!==n&&(i=MM.getTransitionToAnimationId(n),r=!0),void 0!==a&&(i=MM.getTransitionFromAnimationId(a),r=!0);const o=this.createAnimationData();if(!o.initialize(s))return o.dispose(),!1;const h=s.immediateChangeFrom;if(void 0!==h){const t=h.split(","),e=[];for(const s of t){const t=parseInt(s);-1===e.indexOf(t)&&e.push(t)}o.setImmediateChanges(e)}this._animations.set(i,o),r||this._animationIds.push(i)}return!0}createAnimationData(){return new MM}hasAnimation(t){return!!this._animations.get(t)}getAnimationCount(){return this._animationIds.length||0}getAnimationId(t){const e=this.getAnimationCount();return t<0||e<=0?0:this._animationIds[t%e]}isImmediateChange(t,e){const s=this._animations.get(t);return!!s&&s.isImmediateChange(e)}getStartFrame(t,e){const s=this._animations.get(t);return s?s.getStartFrame(e):0}getFrame(t,e,s,i){const r=this._animations.get(t);return r?r.getFrame(e,s,i):null}getFrameFromSequence(t,e,s,i,r,n){const a=this._animations.get(t);return a?a.getFrameFromSequence(e,s,i,r,n):null}}class bM{constructor(){this._type=void 0,this._sizes=void 0,this._sizeDatas=void 0,this._lastSize=void 0,this._lastSizeScale=void 0,this._lastSizeData=void 0,this._lastSizeDataScale=void 0,this._type="",this._sizes=[],this._sizeDatas=new Map,this._lastSize=-1,this._lastSizeScale=-1,this._lastSizeData=null,this._lastSizeDataScale=-1}initialize(t){return this.reset(),!!t&&(this._type=t.name,!!this.defineVisualizations(t.visualizations)||(this.reset(),!1))}dispose(){if(this._sizeDatas&&this._sizeDatas.size){for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas=null}this._lastSizeData=null,this._sizes=null}reset(){if(this._type="",this._sizeDatas&&this._sizeDatas.size)for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas.clear(),this._sizes=[],this._lastSizeData=null,this._lastSizeDataScale=-1}createSizeData(t,e,s){return new UM(e,s)}defineVisualizations(t){if(!t)return!1;for(const e in t){const s=t[e],i=s.layerCount,r=s.angle;let n=s.size;if(n<1&&(n=1),this._sizeDatas.get(n))return!1;const a=this.createSizeData(n,i,r);if(!a)return!1;for(const t in s){const e=s[t];if(!this.processVisualElement(a,t,e))return a.dispose(),!1}this._sizeDatas.set(n,a),this._sizes.push(n)}return this._sizes.sort(),!0}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"layers":if(!t.processLayers(s))return!1;break;case"directions":if(!t.processDirections(s))return!1;break;case"colors":if(!t.processColors(s))return!1}return!0}getValidSize(t){if(t===this._lastSizeScale)return this._lastSize;const e=this.getSizeIndex(t);let s=-1;return e<this._sizes.length&&(s=this._sizes[e]),this._lastSizeScale=t,this._lastSize=s,s}getSizeIndex(t){if(t<=0)return 0;let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]/t<t/this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getSizeData(t){if(t===this._lastSizeDataScale)return this._lastSizeData;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastSizeData=this._sizeDatas.get(this._sizes[e]):this._lastSizeData=null,this._lastSizeDataScale=t,this._lastSizeData}getLayerCount(t){const e=this.getSizeData(t);return e?e.layerCount:CM.DEFAULT_COUNT}getValidDirection(t,e){const s=this.getSizeData(t);return s?s.getValidDirection(e):CM.DEFAULT_DIRECTION}getLayerTag(t,e,s){const i=this.getSizeData(t);return i?i.getLayerTag(e,s):CM.DEFAULT_TAG}getLayerInk(t,e,s){const i=this.getSizeData(t);return i?i.getLayerInk(e,s):CM.DEFAULT_INK}getLayerAlpha(t,e,s){const i=this.getSizeData(t);return i?i.getLayerAlpha(e,s):CM.DEFAULT_ALPHA}getLayerColor(t,e,s){const i=this.getSizeData(t);return i?i.getLayerColor(e,s):DM.DEFAULT_COLOR}getLayerIgnoreMouse(t,e,s){const i=this.getSizeData(t);return i?i.getLayerIgnoreMouse(e,s):CM.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerXOffset(e,s):CM.DEFAULT_XOFFSET}getLayerYOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerYOffset(e,s):CM.DEFAULT_YOFFSET}getLayerZOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerZOffset(e,s):CM.DEFAULT_ZOFFSET}get type(){return this._type}}bM.LAYER_LETTERS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];class wM extends bM{createSizeData(t,e,s){return new PM(e,s)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;if("animations"===e){if(!(t instanceof PM)||!t.defineAnimations(s))return!1}else if(!super.processVisualElement(t,e,s))return!1;return!0}hasAnimation(t,e){const s=this.getSizeData(t);return s?s.hasAnimation(e):null}getAnimationCount(t){const e=this.getSizeData(t);return e?e.getAnimationCount():null}getAnimationId(t,e){const s=this.getSizeData(t);return s?s.getAnimationId(e):null}isImmediateChange(t,e,s){const i=this.getSizeData(t);return i?i.isImmediateChange(e,s):null}getStartFrame(t,e,s){const i=this.getSizeData(t);return i?i.getStartFrame(e,s):null}getFrame(t,e,s,i,r){const n=this.getSizeData(t);return n?n.getFrame(e,s,i,r):null}getFrameFromSequence(t,e,s,i,r,n,a){const o=this.getSizeData(t);return o?o.getFrameFromSequence(e,s,i,r,n,a):null}}class FM extends xe{constructor(){super(),this._data=void 0,this._type=void 0,this._direction=void 0,this._lastCameraAngle=void 0,this._selectedColor=void 0,this._furnitureLift=void 0,this._alphaMultiplier=void 0,this._alphaChanged=void 0,this._clickUrl=void 0,this._clickHandling=void 0,this._cacheDirection=void 0,this._cacheScale=void 0,this._cacheSize=void 0,this._layerCount=void 0,this._shadowLayerIndex=void 0,this._updatedLayers=void 0,this._assetNames=void 0,this._spriteTags=void 0,this._spriteInks=void 0,this._spriteAlphas=void 0,this._spriteColors=void 0,this._spriteMouseCaptures=void 0,this._spriteXOffsets=void 0,this._spriteYOffsets=void 0,this._spriteZOffsets=void 0,this._animationNumber=void 0,this._data=null,this._type=null,this._direction=0,this._lastCameraAngle=NaN,this._selectedColor=0,this._furnitureLift=0,this._alphaMultiplier=1,this._alphaChanged=!1,this._clickUrl=null,this._clickHandling=!1,this._cacheDirection=-1,this._cacheScale=0,this._cacheSize=-1,this._layerCount=0,this._shadowLayerIndex=-1,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._animationNumber=0}initialize(t){return this.reset(),t instanceof bM&&(this._type=t.type,this._data=t,!0)}dispose(){super.dispose(),this._data=null,this._updatedLayers=null,this._assetNames=null,this._spriteTags=null,this._spriteInks=null,this._spriteAlphas=null,this._spriteColors=null,this._spriteMouseCaptures=null,this._spriteXOffsets=null,this._spriteYOffsets=null,this._spriteZOffsets=null}reset(){super.reset(),this.setDirection(-1),this._data=null,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this.createSprites(0)}resetLayers(t,e){this._cacheDirection===e&&this._cacheScale===t||(this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._cacheDirection=e,this._cacheScale=t,this._cacheSize=this.getValidSize(t),this.setLayerCount((this._data&&this._data.getLayerCount(t)||0)+this.getAdditionalLayerCount()))}update(t,e,s,i){if(!t)return;const r=t.scale;let n=!1;this.updateObject(r,t.direction.x)&&(n=!0),this.updateModel(r)&&(n=!0);let a=0;i?this._animationNumber=this._animationNumber|this.updateAnimation(r):(a=this.updateAnimation(r)|this._animationNumber,this._animationNumber=0),(n||0!==a)&&(this.updateSprites(r,n,a),this._scale=r,this.updateSpriteCounter++)}updateObject(t,e){if(!this.object)return!1;if(this.updateObjectCounter===this.object.updateCounter&&t===this._scale&&this._lastCameraAngle===e)return!1;let s=this.object.getDirection().x-(e+135);if(s=(s%360+360)%360,this._data){const e=this._data.getValidDirection(t,s);this.setDirection(e)}return this._lastCameraAngle=e,this._scale=t,this.updateObjectCounter=this.object.updateCounter,this.resetLayers(t,this._direction),!0}updateModel(t){const e=this.object&&this.object.model;if(!e)return!1;if(this.updateModelCounter===e.updateCounter)return!1;this._selectedColor=e.getValue(rt.FURNITURE_COLOR),this._clickUrl=e.getValue(rt.FURNITURE_AD_URL),this._clickHandling=this._clickUrl&&""!==this._clickUrl&&0===this._clickUrl.indexOf("http")||!1,this._furnitureLift=e.getValue(rt.FURNITURE_LIFT_AMOUNT)||0;let s=e.getValue(rt.FURNITURE_ALPHA_MULTIPLIER);return isNaN(s)&&(s=1),this._alphaMultiplier!==s&&(this._alphaMultiplier=s,this._alphaChanged=!0),this.updateModelCounter=e.updateCounter,!0}updateSprites(t,e,s){if(this._layerCount!==this.totalSprites&&this.createSprites(this._layerCount),e){let e=this.totalSprites-1;for(;e>=0;)this.updateSprite(t,e),e--}else{let e=0;for(;s>0;)s&&this.updateSprite(t,e),e++,s>>=1}this._alphaChanged=!1}updateSprite(t,e){const s=this.getSpriteAssetName(t,e),i=this.getSprite(e);if(s&&i){const r=this.getAsset(s,e);if(r&&r.texture){i.visible=!0,i.type=this._type,i.texture=r.texture,i.flipH=r.flipH,i.flipV=r.flipV,i.direction=this._direction;let n=0;e!==this._shadowLayerIndex?(i.tag=this.getLayerTag(t,this._direction,e),i.alpha=this.getLayerAlpha(t,this._direction,e),i.color=this.getLayerColor(t,e,this._selectedColor),i.offsetX=r.offsetX+this.getLayerXOffset(t,this._direction,e),i.offsetY=r.offsetY+this.getLayerYOffset(t,this._direction,e),i.blendMode=this.getLayerInk(t,this._direction,e),i.alphaTolerance=this.getLayerIgnoreMouse(t,this._direction,e)?Pe.MATCH_NOTHING:Pe.MATCH_OPAQUE_PIXELS,n=this.getLayerZOffset(t,this._direction,e),n-=.001*e):(i.offsetX=r.offsetX,i.offsetY=r.offsetY+this.getLayerYOffset(t,this._direction,e),i.alpha=48*this._alphaMultiplier,i.alphaTolerance=Pe.MATCH_NOTHING,n=1),i.relativeDepth=n*FM.DEPTH_MULTIPLIER,i.name=s,i.libraryAssetName=this.getLibraryAssetNameForSprite(r,i),i.posture=this.getPostureForAsset(t,r.source),i.clickHandling=this._clickHandling}else this.resetSprite(i)}else i&&this.resetSprite(i)}getLibraryAssetNameForSprite(t,e){return t.source}getPostureForAssetFile(t,e){return null}resetSprite(t){t&&(t.texture=null,t.libraryAssetName="",t.posture="",t.tag="",t.offsetX=0,t.offsetY=0,t.flipH=!1,t.flipV=!1,t.relativeDepth=0,t.clickHandling=!1)}getSpriteAssetName(t,e){if(!this._data||e>=bM.LAYER_LETTERS.length)return"";let s=this._assetNames[e],i=this._updatedLayers[e];return s&&s.length||(s=this.cacheSpriteAssetName(t,e,!0),i=1!==this._cacheSize),i&&(s+=this.getFrameNumber(t,e)),s}cacheSpriteAssetName(t,e,s){this._type;const i=s?this._cacheSize:this.getValidSize(t);let r="";const n=1!==i;if(r=e!==this._shadowLayerIndex?bM.LAYER_LETTERS[e]||"":"sd",""===r)return null;const a=this._type+(n?"_"+i+"_"+r+"_"+this._direction+"_":"_icon_"+r);return s&&(this._assetNames[e]=a,this._updatedLayers[e]=n),a}getLayerTag(t,e,s){const i=this._spriteTags[s];if(void 0!==i)return i;if(!this._data)return CM.DEFAULT_TAG;const r=this._data.getLayerTag(t,e,s);return this._spriteTags[s]=r,r}getLayerInk(t,e,s){const i=this._spriteInks[s];if(void 0!==i)return i;if(!this._data)return CM.DEFAULT_INK;const r=this._data.getLayerInk(t,e,s);return this._spriteInks[s]=r,r}getLayerAlpha(t,e,s){if(!this._alphaChanged){const t=this._spriteAlphas[s];if(void 0!==t)return t}if(!this._data)return CM.DEFAULT_ALPHA;let i=this._data.getLayerAlpha(t,e,s);return null!==this._alphaMultiplier&&(i*=this._alphaMultiplier),this._spriteAlphas[s]=i,i}getLayerColor(t,e,s){const i=this._spriteColors[e];if(void 0!==i)return i;if(!this._data)return DM.DEFAULT_COLOR;const r=this._data.getLayerColor(t,e,s);return this._spriteColors[e]=r,r}getLayerIgnoreMouse(t,e,s){const i=this._spriteMouseCaptures[s];if(void 0!==i)return i;if(!this._data)return CM.DEFAULT_IGNORE_MOUSE;const r=this._data.getLayerIgnoreMouse(t,e,s);return this._spriteMouseCaptures[s]=r,r}getLayerXOffset(t,e,s){const i=this._spriteXOffsets[s];if(void 0!==i)return i;if(!this._data)return CM.DEFAULT_XOFFSET;const r=this._data.getLayerXOffset(t,e,s);return this._spriteXOffsets[s]=r,r}getLayerYOffset(t,e,s){if(s===this._shadowLayerIndex)return Math.ceil(this._furnitureLift*(t/2));const i=this._spriteYOffsets[s];if(void 0!==i)return i;if(!this._data)return CM.DEFAULT_YOFFSET;const r=this._data.getLayerYOffset(t,e,s);return this._spriteYOffsets[s]=r,r}getLayerZOffset(t,e,s){const i=this._spriteZOffsets[s];if(void 0!==i)return i;if(!this._data)return CM.DEFAULT_ZOFFSET;const r=this._data.getLayerZOffset(t,e,s);return this._spriteZOffsets[s]=r,r}getValidSize(t){return this._data?this._data.getValidSize(t):t}setLayerCount(t){this._layerCount=t,this._shadowLayerIndex=t-this.getAdditionalLayerCount()}setDirection(t){this._direction!==t&&(this._direction=t)}getAdditionalLayerCount(){return 1}updateAnimation(t){return 0}getFrameNumber(t,e){return 0}getPostureForAsset(t,e){return null}getAsset(t){return this.asset?this.asset.getAsset(t):null}get direction(){return this._direction}}FM.DEPTH_MULTIPLIER=Math.sqrt(.5),FM.TYPE=nt.FURNITURE_STATIC;class xM extends FM{constructor(){super(),this._data=void 0,this._state=void 0,this._frameIncrease=void 0,this._animationData=void 0,this._animationScale=void 0,this._animationChangeTime=void 0,this._animatedLayerCount=void 0,this._directionChanged=void 0,this._state=-1,this._frameIncrease=1,this._animationData=new yM,this._animationScale=0,this._animationChangeTime=0,this._animatedLayerCount=0,this._directionChanged=!1}initialize(t){return t instanceof wM&&super.initialize(t)}dispose(){super.dispose(),this._animationData&&(this._animationData.dispose(),this._animationData=null)}get animatedLayerCount(){return this._animatedLayerCount}get animationId(){return this._animationData.animationId}getAnimationId(t){return this.animationId!==xM.DEFAULT_ANIMATION_ID&&this._data.hasAnimation(this._animationScale,this.animationId)?this.animationId:xM.DEFAULT_ANIMATION_ID}updateObject(t,e){if(super.updateObject(t,e)){const t=this.object.getState(0);return t!==this._state&&(this.setAnimation(t),this._state=t,this._animationChangeTime=this.object.model.getValue(rt.FURNITURE_STATE_UPDATE_TIME)||0),!0}return!1}updateModel(t){if(super.updateModel(t)){if(this.usesAnimationResetting()){const t=this.object.model.getValue(rt.FURNITURE_STATE_UPDATE_TIME);t>this._animationChangeTime&&(this._animationChangeTime=t,this.setAnimation(this._state))}const t=this.object.model.getValue(rt.FURNITURE_AUTOMATIC_STATE_INDEX);if(!isNaN(t)){const e=this._data.getAnimationId(this._animationScale,t);this.setAnimation(e)}return!0}return!1}isPlayingTransition(t,e){return!(!MM.isTransitionFromAnimation(t.animationId)&&!MM.isTransitionToAnimation(t.animationId))&&(e===t.animationAfterTransitionId&&!t.animationOver)}getCurrentState(t){const e=t.animationId;return MM.isTransitionFromAnimation(e)||MM.isTransitionToAnimation(e)?t.animationAfterTransitionId:e}setAnimation(t){this._data&&this.setSubAnimation(this._animationData,t,this._state>=0)}setSubAnimation(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=t.animationId;if(s){if(this.isPlayingTransition(t,e))return!1;const s=this.getCurrentState(t);if(e!==s){if(!this._data.isImmediateChange(this._animationScale,e,s)){let i=MM.getTransitionFromAnimationId(s);this._data.hasAnimation(this._animationScale,i)?(t.animationAfterTransitionId=e,e=i):(i=MM.getTransitionToAnimationId(e),this._data.hasAnimation(this._animationScale,i)&&(t.animationAfterTransitionId=e,e=i))}}else if(MM.isTransitionFromAnimation(t.animationId)){const s=MM.getTransitionToAnimationId(e);this._data.hasAnimation(this._animationScale,s)&&(t.animationAfterTransitionId=e,e=s)}else if(!MM.isTransitionToAnimation(t.animationId)&&this.usesAnimationResetting()){const i=MM.getTransitionFromAnimationId(s);if(this._data.hasAnimation(this._animationScale,i))t.animationAfterTransitionId=e,e=i;else{const s=MM.getTransitionToAnimationId(e);this._data.hasAnimation(this._animationScale,s)&&(t.animationAfterTransitionId=e,e=s)}}}return i!==e&&(t.animationId=e,!0)}getLastFramePlayed(t){return this._animationData.getLastFramePlayed(t)}resetAllAnimationFrames(){this._animationData&&this._animationData.setLayerCount(this._animatedLayerCount)}updateAnimation(t){if(!this._data)return 0;t!==this._animationScale&&(this._animationScale=t,this._animatedLayerCount=this._data.getLayerCount(t),this.resetAllAnimationFrames());const e=this.updateAnimations(t);return this._directionChanged=!1,e}updateAnimations(t){if(this._animationData.animationOver&&!this._directionChanged)return 0;const e=this.updateFramesForAnimation(this._animationData,t);return this._animationData.animationOver&&(MM.isTransitionFromAnimation(this._animationData.animationId)||MM.isTransitionToAnimation(this._animationData.animationId))&&(this.setAnimation(this._animationData.animationAfterTransitionId),this._animationData.animationOver=!1),e}updateFramesForAnimation(t,e){if(t.animationOver&&!this._directionChanged)return 0;const s=this.getAnimationId(t);let i=t.frameCounter;i||(i=this._data.getStartFrame(e,s,this._direction)),i+=this.frameIncrease,t.frameCounter=i,t.animationOver=!0;let r=!1,n=this._animatedLayerCount-1,a=0,o=1<<this._animatedLayerCount-1;for(;n>=0;){let h=0;if(r=t.getAnimationPlayed(n),!r||this._directionChanged){let _=t.getLastFramePlayed(n),d=t.getFrame(n);d&&d.isLastFrame&&d.remainingFrameRepeats<=this.frameIncrease&&(_=!0),(this._directionChanged||!d||d.remainingFrameRepeats>=0&&(d.remainingFrameRepeats=d.remainingFrameRepeats-this.frameIncrease)<=0)&&(h=fM.SEQUENCE_NOT_DEFINED,d&&(h=d.activeSequence),d=h===fM.SEQUENCE_NOT_DEFINED?this._data.getFrame(e,s,this._direction,n,i):this._data.getFrameFromSequence(e,s,this._direction,n,h,d.activeSequenceOffset+d.repeats,i),t.setFrame(n,d),a|=o),d&&d.remainingFrameRepeats!=fM.FRAME_REPEAT_FOREVER?t.animationOver=!1:(_=!0,r=!0),t.setLastFramePlayed(n,_),t.setAnimationPlayed(n,r)}o>>=1,n--}return a}getFrameNumber(t,e){const s=this._animationData.getFrame(e);return s?s.id:super.getFrameNumber(t,e)}getLayerXOffset(t,e,s){const i=super.getLayerXOffset(t,e,s),r=this._animationData.getFrame(s);return r?i+r.x:i}getLayerYOffset(t,e,s){const i=super.getLayerYOffset(t,e,s),r=this._animationData.getFrame(s);return r?i+r.y:i}usesAnimationResetting(){return!1}setDirection(t){this._direction!==t&&(super.setDirection(t),this._directionChanged=!0)}get frameIncrease(){return this._frameIncrease}}xM.TYPE=nt.FURNITURE_ANIMATED,xM.DEFAULT_ANIMATION_ID=0;class BM extends xM{constructor(){super(),this._badgeId=void 0,this._badgeAssetNameNormalScale=void 0,this._badgeAssetNameSmallScale=void 0,this._badgeVisibleInState=void 0,this._badgeId="",this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="",this._badgeVisibleInState=-1}updateModel(t){let e=super.updateModel(t);const s=this.object.model.getValue(rt.FURNITURE_BADGE_IMAGE_STATUS),i=this.object.model.getValue(rt.FURNITURE_BADGE_ASSET_NAME);if(-1===s)this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="";else if(1===s&&i!==this._badgeId){this._badgeId=i,this._badgeAssetNameNormalScale=this._badgeId,""===this._badgeAssetNameSmallScale&&(this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32");const t=this.object.model.getValue(rt.FURNITURE_BADGE_VISIBLE_IN_STATE);isNaN(t)||(this._badgeVisibleInState=t),e=!0}return e}getSpriteAssetName(t,e){return this.getLayerTag(t,this.direction,e)!==BM.BADGE||-1!==this._badgeVisibleInState&&this.object.getState(0)!==this._badgeVisibleInState?super.getSpriteAssetName(t,e):32===t?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale}getLayerXOffset(t,e,s){let i=super.getLayerXOffset(t,e,s);if(this.getLayerTag(t,e,s)===BM.BADGE){const e=this.getAsset(32===t?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);e&&(i+=64===t?(40-e.width)/2:(20-e.width)/2)}return i}getLayerYOffset(t,e,s){let i=super.getLayerYOffset(t,e,s);if(this.getLayerTag(t,e,s)===BM.BADGE){const e=this.getAsset(32===t?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);e&&(i+=64===t?(40-e.height)/2:(20-e.height)/2)}return i}}BM.BADGE="BADGE";class GM extends FM{constructor(){super(),this._imageUrl=void 0,this._shortUrl=void 0,this._imageReady=void 0,this._isAnimated=void 0,this._gifCollection=void 0,this._offsetX=void 0,this._offsetY=void 0,this._offsetZ=void 0,this._currentFrame=void 0,this._totalFrames=void 0,this._imageUrl=null,this._shortUrl=null,this._imageReady=!1,this._isAnimated=!1,this._gifCollection=null,this._offsetX=0,this._offsetY=0,this._offsetZ=0,this._currentFrame=-1,this._totalFrames=-1}dispose(){super.dispose(),this._imageUrl&&this.asset&&this.asset.disposeAsset(this._imageUrl)}updateObject(t,e){return!!super.updateObject(t,e)&&(this._imageReady&&this.checkAndCreateImageForCurrentState(),!0)}updateModel(t){const e=super.updateModel(t);if(e&&(this._offsetX=this.object.model.getValue(rt.FURNITURE_BRANDING_OFFSET_X)||0,this._offsetY=this.object.model.getValue(rt.FURNITURE_BRANDING_OFFSET_Y)||0,this._offsetZ=this.object.model.getValue(rt.FURNITURE_BRANDING_OFFSET_Z)||0,this._isAnimated=this.object.model.getValue(rt.FURNITURE_BRANDING_IS_ANIMATED)||!1),this._imageReady){if(this.checkIfImageChanged())return this._imageReady=!1,this._imageUrl=null,!0}else if(this._imageReady=this.checkIfImageReady(),this._imageReady)return this.checkAndCreateImageForCurrentState(),!0;return e}checkIfImageChanged(){const t=this.object.model.getValue(rt.FURNITURE_BRANDING_IMAGE_URL);return(!t||t!==this._imageUrl)&&(this._gifCollection,this.asset&&this.asset.disposeAsset(this._imageUrl),!0)}checkIfImageReady(){if(!(this.object&&this.object.model))return!1;const t=this.object.model.getValue(rt.FURNITURE_BRANDING_IMAGE_URL);if(!t)return!1;if(this._imageUrl&&this._imageUrl===t)return!1;if(1===this.object.model.getValue(rt.FURNITURE_BRANDING_IMAGE_STATUS)){let e=null;if(this._isAnimated){const s=SU.instance.roomEngine.roomContentLoader.getGifCollection(t);s&&(this._gifCollection=s,e=s.textures[0])}else e=SU.instance.core.asset.getTexture(t);return!!e&&(this.imageReady(e,t),!0)}return!1}imageReady(t,e){this._imageUrl=t?e:null}checkAndCreateImageForCurrentState(){if(this._isAnimated)return void this.buildAssetsForGif();if(!this._imageUrl)return;const t=SU.instance.core.asset.getTexture(this._imageUrl);if(!t)return;const e=this.object.getState(0);this.addBackgroundAsset(t,e,0)}buildAssetsForGif(){if(!this._gifCollection)return;const t=this._gifCollection.textures,e=this._gifCollection.durations;if(!t.length||!e.length||t.length!==e.length)return;const s=this.object.getState(0);for(let i=0;i<t.length;i++){const r=t[i];e[i];r&&this.addBackgroundAsset(r,s,i)}this._currentFrame=-1,this._totalFrames=t.length}addBackgroundAsset(t,e,s){let i=0,r=0,n=!1,a=!1;switch(e){case GM.STATE_0:i=0,r=0,n=!1,a=!1;break;case GM.STATE_1:i=-t.width,r=0,n=!0,a=!1;break;case GM.STATE_2:i=-t.width,r=-t.height,n=!0,a=!0;break;case GM.STATE_3:i=0,r=-t.height,n=!1,a=!0}this.asset.addAsset(`${this._imageUrl}_${s}`,t,!0,i,r,n,a)}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===GM.BRANDED_IMAGE&&this._imageUrl?`${this._imageUrl}_${this.getFrameNumber(t,e)}`:super.getSpriteAssetName(t,e)}updateAnimation(t){return!this._imageReady||!this._isAnimated||this._totalFrames<=0?0:1}getFrameNumber(t,e){if(!this._imageReady||!this._isAnimated||this._totalFrames<=0)return 0;if(this.getLayerTag(t,this._direction,e)===GM.BRANDED_IMAGE&&this._imageUrl){let t=this._currentFrame;return t<0?t=0:t+=1,t===this._totalFrames&&(t=0),this._currentFrame=t,this._currentFrame}return 0}}GM.BRANDED_IMAGE="branded_image",GM.STATE_0=0,GM.STATE_1=1,GM.STATE_2=2,GM.STATE_3=3;class HM extends GM{getLayerXOffset(t,e,s){return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+this._offsetZ}}class VM extends xM{constructor(){super(),this._stateQueue=void 0,this._running=void 0,this._stateQueue=[],this._running=!1}setAnimation(t){if(-1===t&&!this._running)return this._running=!0,this._stateQueue=[],void this._stateQueue.push(VM.ANIMATION_ID_ROLL);if(t>=0&&t<=7){if(this._running)return this._running=!1,this._stateQueue=[],this._stateQueue.push(VM.ANIMATION_ID_OFFSET_SLOW1),this._stateQueue.push(VM.ANIMATION_ID_OFFSET_SLOW2+t),void this._stateQueue.push(t);super.setAnimation(t)}}updateAnimation(t){return this.getLastFramePlayed(0)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}}VM.ANIMATION_ID_OFFSET_SLOW1=20,VM.ANIMATION_ID_OFFSET_SLOW2=9,VM.ANIMATION_ID_ROLL=-1;class jM extends FM{}class kM extends xM{getFrameNumber(t,e){const s=this.getLayerTag(t,this.direction,e),i=this.object.getState(0);switch(s){case kM.SECONDS_SPRITE:return Math.floor(i%60%10);case kM.TEN_SECONDS_SPRITE:return Math.floor(i%60/10);case kM.MINUTES_SPRITE:return Math.floor(i/60%10);case kM.TEN_MINUTES_SPRITE:return Math.floor(i/60/10%10);default:return super.getFrameNumber(t,e)}}get animationId(){return 0}}kM.SECONDS_SPRITE="seconds_sprite",kM.TEN_SECONDS_SPRITE="ten_seconds_sprite",kM.MINUTES_SPRITE="minutes_sprite",kM.TEN_MINUTES_SPRITE="ten_minutes_sprite";class YM extends xe{}class zM extends xM{constructor(){super(),this._thumbnailAssetNameNormal=void 0,this._thumbnailImageNormal=void 0,this._thumbnailDirection=void 0,this._thumbnailChanged=void 0,this._hasOutline=void 0,this._thumbnailAssetNameNormal=null,this._thumbnailImageNormal=null,this._thumbnailDirection=-1,this._thumbnailChanged=!1,this._hasOutline=!1}get hasThumbnailImage(){return!(null==this._thumbnailImageNormal)}setThumbnailImages(t){this._thumbnailImageNormal=t,this._thumbnailChanged=!0}updateModel(t){const e=super.updateModel(t);return this._thumbnailChanged||this._thumbnailDirection!==this.direction?(this.refreshThumbnail(),!0):e}refreshThumbnail(){null!=this.asset&&(this._thumbnailImageNormal?this.addThumbnailAsset(this._thumbnailImageNormal,64):this.asset.disposeAsset(this.getThumbnailAssetName(64)),this._thumbnailChanged=!1,this._thumbnailDirection=this.direction)}addThumbnailAsset(t,e){let s=0;for(;s<this.totalSprites;){if(this.getLayerTag(e,this.direction,s)===zM.THUMBNAIL){const i=this.cacheSpriteAssetName(e,s,!1)+this.getFrameNumber(e,s),r=this.getAsset(i,s);if(r){const s=this.generateTransformedThumbnail(t,r),i=this.getThumbnailAssetName(e);this.asset.disposeAsset(i),this.asset.addAsset(i,s,!0,r.offsetX,r.offsetY,!1,!1)}return}s++}}generateTransformedThumbnail(t,e){if(this._hasOutline){const e=new W,s=new W(K.WHITE);s.tint=0,s.width=t.width+40,s.height=t.height+40;const i=new W(t),r=(s.width-i.width)/2,n=(s.height-i.height)/2;i.position.set(r,n),e.addChild(s,i),t=At.generateTexture(e)}const s=new j.d,i=e.width/t.width;switch(this.direction){case 2:s.a=i,s.b=-.5*i,s.c=0,s.d=1.1*i,s.tx=0,s.ty=.5*i*t.width;break;case 0:case 4:s.a=i,s.b=.5*i,s.c=0,s.d=1.1*i,s.tx=0,s.ty=0;break;default:s.a=i,s.b=0,s.c=0,s.d=i,s.tx=0,s.ty=0}const r=new W(t);return r.transform.setFromMatrix(s),At.generateTexture(r)}getSpriteAssetName(t,e){return this._thumbnailImageNormal&&this.getLayerTag(t,this.direction,e)===zM.THUMBNAIL?this.getThumbnailAssetName(t):super.getSpriteAssetName(t,e)}getThumbnailAssetName(t){return this._thumbnailAssetNameNormal=this.getFullThumbnailAssetName(this.object.id,64),this._thumbnailAssetNameNormal}getFullThumbnailAssetName(t,e){return[this._type,t,"thumb",e].join("_")}}zM.THUMBNAIL="THUMBNAIL";class WM extends zM{constructor(){super(),this._cachedUrl=void 0,this._cachedUrl=null,this._hasOutline=!0}updateModel(t){if(this.object){const t=this.getThumbnailURL();if(this._cachedUrl!==t)if(this._cachedUrl=t,this._cachedUrl&&""!==this._cachedUrl){const e=new Image;e.src=t,e.crossOrigin="*",e.onload=()=>{const t=i.t.from(e);t.baseTexture.scaleMode=o.p.LINEAR,this.setThumbnailImages(t)}}else this.setThumbnailImages(null)}return super.updateModel(t)}getThumbnailURL(){throw new Error("This method must be overridden!")}}class KM extends WM{constructor(){super(),this._url=void 0,this._typePrefix=void 0,this._url=null,this._typePrefix=null}getThumbnailURL(){if(!this.object)return null;if(this._url)return this._url;const t=this.object.model.getValue(rt.FURNITURE_DATA);if(!t||""===t)return null;this.object.type.indexOf("")>=0&&(this._typePrefix=this.object.type.indexOf("")>=0?"":"postcards/selfie/");let e=JSON.parse(t).w||"";return e=this.buildThumbnailUrl(e),this._url=e,this._url}buildThumbnailUrl(t){return-1===(t=t.replace(".png","_small.png")).indexOf(".png")&&(t+="_small.png"),t}}class XM{}XM.GENERIC="hd",XM.HEAD="head",XM.TORSO="torso",XM.LEGS="legs",XM.HOTLOOKS="hotlooks",XM.WARDROBE="wardrobe",XM.EFFECTS="effects";class qM{}qM.OWN_AVATAR_EDITOR=0,qM.FURNITURE_AVATAR_EDITOR=1,qM.BOT_EDITOR=2,qM.DEV_TOOL_EDITOR=3;class QM{}QM.NOTHING="nothing",QM.WARDROBE="wardrobe";class ZM{}ZM.TOOL="tool",ZM.COMPONENT="component",ZM.ONLINE_TOOL="online_tool",ZM.LOCAL_ONLY="local_only";class JM{constructor(){this._x=void 0,this._y=void 0,this._z=void 0,this._lastX=void 0,this._lastY=void 0,this._lastZ=void 0,this._hasMoved=!1,this._particleDirection=void 0,this._age=0,this._lifeTime=void 0,this._isEmitter=!1,this._fade=!1,this._fadeTime=void 0,this._alphaMultiplier=1,this._frames=void 0}init(t,e,s,i,r,n,a){let o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,_=arguments.length>9&&void 0!==arguments[9]&&arguments[9];this._x=t,this._y=e,this._z=s,this._particleDirection=new te(i.x,i.y,i.z),this._particleDirection.scaleBy(r),this._lastX=this._x-this._particleDirection.x*n,this._lastY=this._y-this._particleDirection.y*n,this._lastZ=this._z-this._particleDirection.z*n,this._age=0,this._hasMoved=!1,this._lifeTime=a,this._isEmitter=o,this._frames=h,this._fade=_,this._alphaMultiplier=1,this._fadeTime=.5+.5*Math.random()}dispose(){this._particleDirection=null}update(){this._age++,this._age===this._lifeTime&&this.ignite(),this._fade&&this._age/this._lifeTime>this._fadeTime&&(this._alphaMultiplier=(this._lifeTime-this._age)/(this._lifeTime*(1-this._fadeTime)))}getAsset(){return this._frames&&this._frames.length>0?this._frames[this._age%this._frames.length]:null}ignite(){}get fade(){return this._fade}get alphaMultiplier(){return this._alphaMultiplier}get direction(){return this._particleDirection}get age(){return this._age}get isEmitter(){return this._isEmitter}get isAlive(){return this._age<=this._lifeTime}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}get lastX(){return this._lastX}set lastX(t){this._hasMoved=!0,this._lastX=t}get lastY(){return this._lastY}set lastY(t){this._hasMoved=!0,this._lastY=t}get lastZ(){return this._lastZ}set lastZ(t){this._hasMoved=!0,this._lastZ=t}get hasMoved(){return this._hasMoved}toString(){return[this._x,this._y,this._z].toString()}copy(t,e){this._x=t._x*e,this._y=t._y*e,this._z=t._z*e,this._lastX=t._lastX*e,this._lastY=t._lastY*e,this._lastZ=t._lastZ*e,this._hasMoved=t.hasMoved,this._particleDirection=t._particleDirection,this._age=t._age,this._lifeTime=t._lifeTime,this._isEmitter=t._isEmitter,this._fade=t._fade,this._fadeTime=t._fadeTime,this._alphaMultiplier=t._alphaMultiplier}}class $M extends JM{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;super(),this._name=void 0,this._roomObjectSpriteId=-1,this._force=void 0,this._timeStep=.1,this._gravity=void 0,this._airFriction=void 0,this._explosionShape=void 0,this._particleConfigurations=void 0,this._particles=void 0,this._maxNumberOfParticles=void 0,this._particlesPerFrame=void 0,this._emittedParticles=void 0,this._fuseTime=10,this._energy=1,this._hasIgnited=!1,this._burstPulse=1,this._emitterDirection=void 0,this._particles=[],this._name=t,this._roomObjectSpriteId=e,this._particleConfigurations=[]}dispose(){for(const t of this._particles)t.dispose();this._particles=null,this._particleConfigurations=null,super.dispose()}setup(t,e,s,i,r,n,a,o,h,_){this._maxNumberOfParticles=t,this._particlesPerFrame=e,this._force=s,this._emitterDirection=i,this._emitterDirection.normalize(),this._gravity=r,this._airFriction=n,this._explosionShape=a,this._fuseTime=h,this._energy=o,this._burstPulse=_,this.reset()}reset(){for(const t of this._particles)t.dispose();this._particles=[],this._emittedParticles=0,this._hasIgnited=!1,this.init(0,0,0,this._emitterDirection,this._force,this._timeStep,this._fuseTime,!0)}copyStateFrom(t,e){super.copy(t,e),this._force=t._force,this._emitterDirection=t._emitterDirection,this._gravity=t._gravity,this._airFriction=t._airFriction,this._explosionShape=t._explosionShape,this._fuseTime=t._fuseTime,this._energy=t._energy,this._burstPulse=t._burstPulse,this._timeStep=t._timeStep,this._hasIgnited=t._hasIgnited}configureParticle(t,e,s,i){const r={};r.lifeTime=t,r.isEmitter=e,r.frames=s,r.fade=i,this._particleConfigurations.push(r)}ignite(){this._hasIgnited=!0,this._emittedParticles<this._maxNumberOfParticles&&this.age>1&&this.releaseParticles(this,this.direction)}releaseParticles(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e||(e=new te);const s=new te,i=this.getRandomParticleConfiguration();let r=0;for(;r<this._particlesPerFrame;){switch(this._explosionShape){case $M.CONE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=-(Math.random()+1),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case $M.PLANE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=0,s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case $M.SPHERE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=this.randomBoolean(.5)?Math.random():-Math.random(),s.z=this.randomBoolean(.5)?Math.random():-Math.random()}s.normalize();const e=new JM;let n=0,a=!1,o=!1,h=[];i?(n=Math.floor(Math.random()*i.lifeTime+10),a=i.isEmitter,h=i.frames,o=i.fade):(n=Math.trunc(Math.floor(20*Math.random()+10)),a=!1,h=[]),e.init(t.x,t.y,t.z,s,this._energy,this._timeStep,n,a,h,o),this._particles.push(e),this._emittedParticles++,r++}}getRandomParticleConfiguration(){const t=Math.trunc(Math.floor(Math.random()*this._particleConfigurations.length));return this._particleConfigurations[t]}update(){super.update(),this.accumulateForces(),this.verlet(),this.satisfyConstraints(),!this.isAlive&&this._emittedParticles<this._maxNumberOfParticles&&this.age%this._burstPulse===0&&this.releaseParticles(this,this.direction)}verlet(){if(this.isAlive||this._emittedParticles<this._maxNumberOfParticles){const t=this.x,e=this.y,s=this.z;this.x=(2-this._airFriction)*this.x-(1-this._airFriction)*this.lastX,this.y=(2-this._airFriction)*this.y-(1-this._airFriction)*this.lastY+this._gravity*this._timeStep*this._timeStep,this.z=(2-this._airFriction)*this.z-(1-this._airFriction)*this.lastZ,this.lastX=t,this.lastY=e,this.lastZ=s}const t=[];for(const e of this._particles){e.update();const s=e.x,i=e.y,r=e.z;e.x=(2-this._airFriction)*e.x-(1-this._airFriction)*e.lastX,e.y=(2-this._airFriction)*e.y-(1-this._airFriction)*e.lastY+this._gravity*this._timeStep*this._timeStep,e.z=(2-this._airFriction)*e.z-(1-this._airFriction)*e.lastZ,e.lastX=s,e.lastY=i,e.lastZ=r,(e.y>10||!e.isAlive)&&t.push(e)}for(const e of t)e.isEmitter,this._particles.splice(this._particles.indexOf(e),1),e.dispose()}satisfyConstraints(){}accumulateForces(){for(const t of this._particles);}get particles(){return this._particles}get hasIgnited(){return this._hasIgnited}randomBoolean(t){return Math.random()<t}get roomObjectSpriteId(){return this._roomObjectSpriteId}}$M.CONE="cone",$M.PLANE="plane",$M.SPHERE="sphere";class ty{constructor(t){this._emitters=void 0,this._visualization=void 0,this._size=void 0,this._canvasId=-1,this._offsetY=void 0,this._currentEmitter=void 0,this._canvasTexture=void 0,this._roomSprite=void 0,this._hasIgnited=!1,this._centerX=0,this._centerY=0,this._scaleMultiplier=1,this._blackOverlay=void 0,this._blackOverlayAlphaTransform=void 0,this._particleColorTransform=void 0,this._identityMatrix=void 0,this._translationMatrix=void 0,this._blend=1,this._bgColor=4278190080,this._emptySprite=void 0,this._isDone=!1,this._emitters=new U,this._visualization=t,this._blackOverlayAlphaTransform=new F.a,this._blackOverlayAlphaTransform.alpha=1,this._particleColorTransform=new F.a,this._identityMatrix=new j.d,this._translationMatrix=new j.d}dispose(){for(const t of this._emitters.getValues())t.dispose();this._emitters=null,this._canvasTexture&&(this._canvasTexture.destroy(),this._canvasTexture=null),this._blackOverlay&&(this._blackOverlay.destroy(),this._blackOverlay=null),this._emptySprite&&(this._emptySprite.destroy(),this._emptySprite=null),this._blackOverlayAlphaTransform=null,this._particleColorTransform=null,this._identityMatrix=null,this._translationMatrix=null}reset(){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=null,this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}setAnimation(t){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=this._emitters.getValue(t),this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}updateCanvas(){if(this._currentEmitter&&-1!==this._canvasId&&(this._roomSprite=this._visualization.getSprite(this._canvasId),this._roomSprite&&this._roomSprite.texture)){if(this._roomSprite.width<=1||this._roomSprite.height<=1)return;!this._canvasTexture||this._canvasTexture.width===this._roomSprite.width&&this._canvasTexture.height===this._roomSprite.height||(this._canvasTexture=null),this.clearCanvas(),this._centerX=-this._roomSprite.offsetX,this._centerY=-this._roomSprite.offsetY,this._roomSprite.texture=this._canvasTexture}}getLayerYOffset(t,e,s){return this._currentEmitter&&this._currentEmitter.roomObjectSpriteId===s?this._currentEmitter.y*this._scaleMultiplier:0}controlsSprite(t){return!!this._currentEmitter&&this._currentEmitter.roomObjectSpriteId==t}updateSprites(){this._currentEmitter&&this._roomSprite&&(this._canvasTexture&&this._roomSprite.texture!==this._canvasTexture&&(this._roomSprite.texture=this._canvasTexture),this._hasIgnited&&this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1))}updateAnimation(){if(!this._currentEmitter||!this._roomSprite||this._isDone)return;!this._hasIgnited&&this._currentEmitter.hasIgnited&&(this._hasIgnited=!0);const t=this._offsetY*this._scaleMultiplier;if(this._currentEmitter.update(),this._hasIgnited){this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1),this._canvasTexture||this.updateCanvas(),this.clearCanvas();for(const e of this._currentEmitter.particles){const s=this._centerX+10*(e.x-e.z)/10*this._scaleMultiplier,r=this._centerY-t+10*(e.y+(e.x+e.z)/2)/10*this._scaleMultiplier,n=e.getAsset();if(n&&n.texture)if(e.fade&&e.alphaMultiplier<1){this._translationMatrix.identity(),this._translationMatrix.translate(s+n.offsetX,r+n.offsetY);const t=new W(n.texture);this._particleColorTransform.alpha=e.alphaMultiplier,t.filters=[this._particleColorTransform],SU.instance.renderer.render(t,{renderTexture:this._canvasTexture,transform:this._translationMatrix,clear:!1})}else{const t=new k(s+n.offsetX,r+n.offsetY),e=new W(n.texture);e.x=t.x,e.y=t.y,SU.instance.renderer.render(e,{renderTexture:this._canvasTexture,clear:!1})}else{const t=new W(i.t.WHITE);t.tint=16777215,t.x=s-1,t.y=r-1,t.width=2,t.height=2,SU.instance.renderer.render(t,{renderTexture:this._canvasTexture,clear:!1})}}if(!this._currentEmitter.particles.length)return void(this._isDone=!0)}}parseData(t){this._size=t.size,this._canvasId=void 0!==t.canvasId?t.canvasId:-1,this._offsetY=void 0!==t.offsetY?t.offsetY:10,this._scaleMultiplier=this._size/64,this._blend=void 0!==t.blend?t.blend:1,this._blend=Math.min(this._blend,1),this._blackOverlayAlphaTransform.alpha=this._blend;const e=void 0!==t.bgColor?t.bgColor:"0";if(this._bgColor=parseInt(e,16)||0,t.emitters&&t.emitters.length)for(const s of t.emitters){const t=s.id,e=s.name,i=s.spriteId,r=new $M(e,i);this._emitters.add(t,r);const n=s.maxNumParticles,a=s.particlesPerFrame,o=void 0!==s.burstPulse?s.burstPulse:1,h=s.fuseTime,_=s.simulation.force,d=s.simulation.direction,u=s.simulation.gravity,c=s.simulation.airFriction,l=s.simulation.shape,g=s.simulation.energy;for(const E of s.particles){const t=E.lifeTime,e=E.isEmitter||!1,s=E.fade||!1,i=[];for(const r of E.frames)i.push(this._visualization.asset.getAsset(r));r.configureParticle(t,e,i,s)}r.setup(n,a,_,new te(0,d,0),u,c,l,g,h,o)}}_Str_17988(t){let e=0;t._emitters&&t._currentEmitter&&(e=t._emitters.getKey(t._emitters.getValues().indexOf(t._currentEmitter))),this.setAnimation(e),this._currentEmitter&&this._currentEmitter.copyStateFrom(t._currentEmitter,t._size/this._size),this._canvasTexture=null}clearCanvas(){this._emptySprite||(this._emptySprite=new W(i.t.EMPTY),this._emptySprite.alpha=0),this._canvasTexture?SU.instance.renderer.render(this._emptySprite,{renderTexture:this._canvasTexture,clear:!0}):this._canvasTexture=i.o.create({width:this._roomSprite.width,height:this._roomSprite.height})}}class ey extends xM{constructor(){super(...arguments),this._particleSystems=void 0,this._currentParticleSystem=void 0}dispose(){if(super.dispose(),this._currentParticleSystem=null,this._particleSystems){for(const t of this._particleSystems.getValues())t.dispose();this._particleSystems=null}}updateObject(t,e){if(super.updateObject(t,e)){if(this._particleSystems){if(t!==this._scale||this._particleSystems.getValue(t)!==this._currentParticleSystem){const e=this._particleSystems.getValue(t);e._Str_17988(this._currentParticleSystem),this._currentParticleSystem&&this._currentParticleSystem.reset(),this._currentParticleSystem=e}}else this._Str_18684(),this._particleSystems?this._currentParticleSystem=this._particleSystems.getValue(t):l.log("ERROR Particle systems could not be read!",this.object.type);return!0}return!1}updateSprites(t,e,s){super.updateSprites(t,e,s),this._currentParticleSystem&&this._currentParticleSystem.updateSprites()}updateAnimation(t){return this._currentParticleSystem&&this._currentParticleSystem.updateAnimation(),super.updateAnimation(t)}setAnimation(t){this._currentParticleSystem&&this._currentParticleSystem.setAnimation(t),super.setAnimation(t)}getLayerYOffset(t,e,s){return this._currentParticleSystem&&this._currentParticleSystem.controlsSprite(s)?this._currentParticleSystem.getLayerYOffset(t,e,s):super.getLayerYOffset(t,e,s)}_Str_18684(){if(!this.object||!this.object.model)return!1;const t=this.object.model.getValue(rt.FURNITURE_FIREWORKS_DATA);if(!t||!t.length)return!1;this._particleSystems=new U;for(const e of t){const t=e.size,s=new ty(this);s.parseData(e),this._particleSystems.add(t,s)}return!0}}class sy extends ey{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0,this._lastAnimationId=0}update(t,e,s,i){this.updatePresentWrap(),super.update(t,e,s,i)}updatePresentWrap(){if(!this.object)return;const t=this.object.model.getValue(rt.FURNITURE_EXTRAS),e=parseInt(t),s=Math.floor(e/1e3),i=e%1e3;this._packetType=s>sy.MAX_PACKET_TYPE_VALUE?0:s,this._ribbonType=i>sy.MAX_RIBBON_TYPE_VALUE?0:i}getFrameNumber(t,e){if(this._lastAnimationId===sy.PRESENT_DEFAULT_STATE){if(e<=1)return this._packetType;if(2===e)return this._ribbonType}return super.getFrameNumber(t,e)}getSpriteAssetName(t,e){const s=this.getValidSize(t);let i=this._type,r="";r=e<this.spriteCount-1?String.fromCharCode("a".charCodeAt(0)+e):"sd";const n=this.getFrameNumber(t,e);return i=i+"_"+s+"_"+r+"_"+this.direction,i=i+"_"+n,i}setAnimation(t){this._lastAnimationId=t,super.setAnimation(t)}}sy.PRESENT_DEFAULT_STATE=0,sy.MAX_PACKET_TYPE_VALUE=9,sy.MAX_RIBBON_TYPE_VALUE=11;class iy extends FM{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0}update(t,e,s,i){this.updatePresentWrap(),super.update(t,e,s,i)}updatePresentWrap(){if(!this.object)return;const t=this.object.model.getValue(rt.FURNITURE_EXTRAS),e=parseInt(t);this._packetType=Math.floor(e/1e3),this._ribbonType=e%1e3}getFrameNumber(t,e){return e<=1?this._packetType:this._ribbonType}getSpriteAssetName(t,e){const s=this.getValidSize(t);let i=this._type,r="";r=e<this.spriteCount-1?String.fromCharCode("a".charCodeAt(0)+e):"sd";const n=this.getFrameNumber(t,e);return i=i+"_"+s+"_"+r+"_"+this.direction,i=i+"_"+n,i}}class ry extends xM{constructor(){super(),this._color1=void 0,this._color2=void 0,this._badgeAssetNameNormalScale=void 0,this._badgeAssetNameSmallScale=void 0,this._color1=ry.DEFAULT_COLOR_1,this._color2=ry.DEFAULT_COLOR_2,this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale=""}updateModel(t){const e=super.updateModel(t);if(""===this._badgeAssetNameNormalScale){const t=this.object.model.getValue(rt.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);t&&(this._badgeAssetNameNormalScale=t,this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32")}const s=this.object.model.getValue(rt.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||ry.DEFAULT_COLOR_1;const i=this.object.model.getValue(rt.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||ry.DEFAULT_COLOR_2,e}getLayerColor(t,e,s){switch(this.getLayerTag(t,this._direction,e)){case ry.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case ry.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(t,e,s)}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===ry.BADGE?32===t?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale:super.getSpriteAssetName(t,e)}getLibraryAssetNameForSprite(t,e){return e.tag===ry.BADGE?"%group.badge.url%"+e.libraryAssetName.replace("badge_",""):super.getLibraryAssetNameForSprite(t,e)}}ry.PRIMARY_COLOUR_SPRITE_TAG="COLOR1",ry.SECONDARY_COLOUR_SPRITE_TAG="COLOR2",ry.BADGE="BADGE",ry.DEFAULT_COLOR_1=15658734,ry.DEFAULT_COLOR_2=4934475;class ny extends zM{constructor(){super(...arguments),this._color1=void 0,this._color2=void 0}updateModel(t){const e=super.updateModel(t);if(!this.hasThumbnailImage){const t=this.object.model.getValue(rt.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);t&&t.length&&this.setThumbnailImages(this.getBitmapAsset(t))}const s=this.object.model.getValue(rt.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||ny.DEFAULT_COLOR_1;const i=this.object.model.getValue(rt.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||ny.DEFAULT_COLOR_2,e}getLayerColor(t,e,s){switch(this.getLayerTag(t,this._direction,e)){case ny.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case ny.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(t,e,s)}getLibraryAssetNameForSprite(t,e){return e.tag===ny.THUMBNAIL&&this.object&&this.object.model.getValue(rt.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME)?"%group.badge.url%"+this.object.model.getValue(rt.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME):super.getLibraryAssetNameForSprite(t,e)}getBitmapAsset(t){const e=this.asset.getAsset(t);return e&&e.texture?e.texture:null}}ny.PRIMARY_COLOUR_SPRITE_TAG="COLOR1",ny.SECONDARY_COLOUR_SPRITE_TAG="COLOR2",ny.DEFAULT_COLOR_1=15658734,ny.DEFAULT_COLOR_2=4934475;class ay extends xM{constructor(){super(),this._stateQueue=void 0,this._running=void 0,this._stateQueue=[],this._running=!1}setAnimation(t){if(-1===t&&!this._running)return this._running=!0,this._stateQueue=[],this._stateQueue.push(ay.ANIMATION_ID_START_ROLL),void this._stateQueue.push(ay.ANIMATION_ID_ROLL);if(t>0&&t<=ay.ANIMATION_ID_OFFSET_SLOW1){if(this._running)return this._running=!1,this._stateQueue=[],this._stateQueue.push(ay.ANIMATION_ID_OFFSET_SLOW1+t),this._stateQueue.push(ay.ANIMATION_ID_OFFSET_SLOW2+t),void this._stateQueue.push(t);super.setAnimation(t)}}updateAnimation(t){return this.getLastFramePlayed(1)&&this.getLastFramePlayed(2)&&this.getLastFramePlayed(3)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}}ay.ANIMATION_ID_OFFSET_SLOW1=10,ay.ANIMATION_ID_OFFSET_SLOW2=20,ay.ANIMATION_ID_START_ROLL=31,ay.ANIMATION_ID_ROLL=32;class oy extends HM{constructor(){super(...arguments),this._needsTransform=!0}transformGifTextures(t){if(!this._gifCollection)return;const e=this._gifCollection.textures;if(e.length){for(let s=0;s<e.length;s++){const r=e[s];if(!r)continue;if(!this.getAsset(`${this._imageUrl}_${s}`))continue;const n=1.1,a=new j.d,o=t.width/r.width;switch(this.direction){case 2:a.a=o,a.b=-.5*o,a.c=0,a.d=o*n,a.tx=0,a.ty=.5*o*r.width;break;case 0:case 4:a.a=o,a.b=.5*o,a.c=0,a.d=o*n,a.tx=0,a.ty=0;break;default:a.a=o,a.b=0,a.c=0,a.d=o,a.tx=0,a.ty=0}const h=new W(r),_=i.o.create({width:t.width+a.tx,height:t.height+a.ty});SU.instance.renderer.render(h,{renderTexture:_,clear:!0,transform:a}),this.asset.disposeAsset(`${this._imageUrl}_${s}`),this.asset.addAsset(`${this._imageUrl}_${s}`,_,!0,t.x,t.y,t.flipH,t.flipV)}this._needsTransform=!1}}generateTransformedImage(t,e){const s=new j.d,r=e.width/t.width;switch(this.direction){case 2:s.a=r,s.b=-.5*r,s.c=0,s.d=1.1*r,s.tx=0,s.ty=.5*r*t.width;break;case 0:case 4:s.a=r,s.b=.5*r,s.c=0,s.d=1.1*r,s.tx=0,s.ty=0;break;default:s.a=r,s.b=0,s.c=0,s.d=r,s.tx=0,s.ty=0}const n=new W(t),a=i.o.create({width:e.width+s.tx,height:e.height+s.ty});SU.instance.renderer.render(n,{renderTexture:a,clear:!0,transform:s}),this.asset.disposeAsset(`${this._imageUrl}_0`),this.asset.addAsset(`${this._imageUrl}_0`,a,!0,n.x,n.y,e.flipH,e.flipV),this._needsTransform=!1}checkAndCreateImageForCurrentState(){super.checkAndCreateImageForCurrentState(),this._needsTransform=!0}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===GM.BRANDED_IMAGE&&this._imageUrl?(this._needsTransform&&(this._isAnimated?this.transformGifTextures(this.getAsset(super.getSpriteAssetName(t,e))):this.generateTransformedImage(SU.instance.core.asset.getTexture(this._imageUrl),this.getAsset(super.getSpriteAssetName(t,e)))),`${this._imageUrl}_${this.getFrameNumber(t,e)}`):super.getSpriteAssetName(t,e)}}class hy extends bM{constructor(){super(),this._avatarData=void 0,this._avatarData=new TM}dispose(){super.dispose(),this._avatarData&&(this._avatarData.dispose(),this._avatarData=null)}createAvatarImage(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return this._avatarData.createAvatarImage(t,e,s,i,r)}set avatarManager(t){this._avatarData.avatarManager=t}}class _y extends FM{constructor(){super(),this._data=void 0,this._mannequinScale=void 0,this._figure=void 0,this._gender=void 0,this._dynamicAssetName=void 0,this._needsUpdate=void 0,this._placeHolderFigure=void 0,this._disposed=void 0,this._mannequinScale=-1,this._figure=null,this._gender=null,this._dynamicAssetName=null,this._needsUpdate=!1,this._placeHolderFigure="hd-99999-99998",this._disposed=!1}initialize(t){return t instanceof hy&&super.initialize(t)}dispose(){this._disposed||(this._disposed=!0,this._dynamicAssetName&&this.asset&&(this.asset.disposeAsset(this._dynamicAssetName),this._dynamicAssetName=null),super.dispose())}updateObject(t,e){const s=super.updateObject(t,e);return s&&this._mannequinScale!==t&&(this._mannequinScale=t,this.updateAvatar()),s}updateModel(t){let e=super.updateModel(t);if(e){const t=this.object.model.getValue(rt.FURNITURE_MANNEQUIN_FIGURE)||null;t&&(this._figure=t+"."+this._placeHolderFigure,this._gender=this.object.model.getValue(rt.FURNITURE_MANNEQUIN_GENDER)||null,this.updateAvatar())}return e=e||this._needsUpdate,this._needsUpdate=!1,e}updateAvatar(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.avatarExists()||t){const t=this._data.createAvatarImage(this._figure,this._mannequinScale,this._gender,this);t&&(t.setDirection(Gt.FULL,this.direction),this._dynamicAssetName&&this.asset.disposeAsset(this._dynamicAssetName),this.asset.addAsset(this.getAvatarAssetName(),t.getImage(Gt.FULL,!1,1,!1),!0),this._dynamicAssetName=this.getAvatarAssetName(),this._needsUpdate=!0,t.dispose())}}avatarExists(){return this._figure&&null!==this.getAsset(this.getAvatarAssetName())}getAvatarAssetName(){return"mannequin_"+this._figure+"_"+this._mannequinScale+"_"+this.direction+"_"+this.object.id}resetFigure(t){t===this._figure&&this.updateAvatar(!0)}getSpriteAssetName(t,e){const s=this.getLayerTag(t,this.direction,e);return this._figure&&s===_y.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?this.getAvatarAssetName():super.getSpriteAssetName(t,e)}getLayerXOffset(t,e,s){return this.getLayerTag(t,e,s)===_y.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).width/2:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return this.getLayerTag(t,e,s)===_y.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).height:super.getLayerYOffset(t,e,s)}get disposed(){return this._disposed}}_y.AVATAR_IMAGE_SPRITE_TAG="avatar_image";class dy extends xM{constructor(){super(),this._animPhaseIndex=void 0,this._animDirectionIndex=void 0,this._animSpeedIndex=void 0,this._animFactorIndex=void 0,this._animOffsetIndex=void 0,this._animOffsetIndex=[]}updateAnimation(t){this._animSpeedIndex||this.initItems(t);let e=this.getSprite(2);return e&&(this._animOffsetIndex[0]=this.getNewPoint(t,0)),e=this.getSprite(3),e&&(this._animOffsetIndex[1]=this.getNewPoint(t,1)),super.updateAnimation(t)}getNewPoint(t,e){let s=0,i=this._animPhaseIndex[e],r=this._animDirectionIndex[e];const n=this._animSpeedIndex[e],a=this._animFactorIndex[e];let o=1;32==t?(s=dy.AREA_DIAMETER_SMALL,o=.5):s=dy.AREA_DIAMETER_LARGE;const h=i+r*n;Math.abs(h)>=s&&(r>0?i-=h-s:i+=-s-h,r=-r,this._animDirectionIndex[e]=r);const _=(s-Math.abs(i))*a;let d=r*Math.sin(Math.abs(i/4))*_;return r>0?d-=_:d+=_,i+=r*n*o,this._animPhaseIndex[e]=i,0==Math.trunc(d)&&(this._animFactorIndex[e]=this.getRandomAmplitudeFactor()),new k(i,d)}initItems(t){let e;e=32===t?dy.AREA_DIAMETER_SMALL:dy.AREA_DIAMETER_LARGE,this._animPhaseIndex=[],this._animPhaseIndex.push(Math.random()*e*1.5),this._animPhaseIndex.push(Math.random()*e*1.5),this._animDirectionIndex=[],this._animDirectionIndex.push(1),this._animDirectionIndex.push(-1),this._animSpeedIndex=[],this._animSpeedIndex.push(dy.ANIM_SPEED_FAST),this._animSpeedIndex.push(dy.ANIM_SPEED_SLOW),this._animFactorIndex=[],this._animFactorIndex.push(this.getRandomAmplitudeFactor()),this._animFactorIndex.push(this.getRandomAmplitudeFactor())}getLayerXOffset(t,e,s){return 2!==s&&3!==s||2!=this._animOffsetIndex.length?super.getLayerXOffset(t,e,s):this._animOffsetIndex[s-2].x}getLayerYOffset(t,e,s){return 2!==s&&3!==s||2!=this._animOffsetIndex.length?super.getLayerYOffset(t,e,s):this._animOffsetIndex[s-2].y}getRandomAmplitudeFactor(){return 30*Math.random()/100+.15}}dy.UPDATE_INTERVAL=2,dy.AREA_DIAMETER_SMALL=15,dy.AREA_DIAMETER_LARGE=31,dy.ANIM_SPEED_FAST=2,dy.ANIM_SPEED_SLOW=1;class uy{constructor(t,e,s,i,r,n){this._name=void 0,this._index=void 0,this._radius=void 0,this._arcSpeed=void 0,this._arcOffset=void 0,this._height=void 0,this._position=void 0,this._positionVector=void 0,this._children=void 0,this._name=t,this._index=e,this._radius=s,this._arcSpeed=i*Math.PI*2/360,this._arcOffset=r*Math.PI*2/360,this._height=n,this._position=0,this._positionVector=new dt(0,0,0),this._children=[]}dispose(){for(;this._children.length>0;){this._children.shift().dispose()}}update(t,e,s){this._position=this._position+this._arcSpeed/uy.SYSTEM_TEMPO,t[this._index]=this.getPositionVector(e,s);for(const i of this._children)i.update(t,this._positionVector,s)}getPositionVector(t,e){const s=this._radius*Math.cos(this._position+this._arcOffset),i=this._radius*Math.sin(this._position+this._arcOffset);return this._positionVector.x=e/2*(s-i),this._positionVector.y=(i+s)*(e/2)*.5-this._height*(e/2),this._positionVector.z=-Math.trunc(4*(s+i)-.7),t&&this._positionVector.add(t),this._positionVector}addChild(t){this._children.indexOf(t)>=0||this._children.push(t)}hasChild(t){return!!this.getChild(t)}getChild(t){for(const e of this._children){if(e.name===t)return e;if(e.hasChild(t))return e.getChild(t)}return null}get name(){return this._name}}uy.SYSTEM_TEMPO=30;class cy extends xM{constructor(){super(),this._planetIndex=void 0,this._planetNameIndex=void 0,this._offsetArray=void 0,this._rootPosition=void 0,this._offsetArray=[],this._rootPosition=new dt}dispose(){if(this._planetIndex)for(;this._planetIndex.length>0;){this._planetIndex.shift().dispose()}this._planetIndex=null,this._planetNameIndex=null}updateAnimation(t){if(!this._planetIndex&&this.spriteCount>0&&!this.processPlanets())return 0;if(this._planetIndex){for(const e of this._planetIndex)e.update(this._offsetArray,this._rootPosition,t);return super.updateAnimation(t)}return 0}getLayerXOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].x:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].y:super.getLayerYOffset(t,e,s)}getLayerZOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].z:super.getLayerZOffset(t,e,s)}processPlanets(){if(!this.object||!this.object.model)return;const t=this.object.model.getValue(rt.FURNITURE_PLANETSYSTEM_DATA);if(!t)return!1;this._planetIndex=[],this._planetNameIndex=[];for(const e of t){this.getSprite(e.id)&&this.addPlanet(e.name,e.id,e.parent,e.radius||0,e.arcSpeed||0,e.arcOffset||0,e.height||0)}return!0}addPlanet(t,e,s,i,r,n,a){if(!this._planetIndex)return;const o=new uy(t,e,i,r,n,a),h=this.getPlanet(s);h?h.addChild(o):(this._planetIndex.push(o),this._planetNameIndex.push(t))}getPlanet(t){for(const e of this._planetIndex){if(e.name===t)return e;if(e.hasChild(t))return e.getChild(t)}return null}}class ly extends xM{}class gy extends xM{constructor(){super(),this._stateQueue=void 0,this._animationCounter=void 0,this._stateQueue=[],this._animationCounter=-1}setAnimation(t){return t===gy.ANIMATION_ID_ROLL_ONCE&&(this._stateQueue=[],this._stateQueue.push(gy.ANIMATION_ID_NORMAL),this._animationCounter=gy.ANIMATION_DURATION),super.setAnimation(t)}updateAnimation(t){return this._animationCounter>0&&this._animationCounter--,this._animationCounter||this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}usesAnimationResetting(){return!0}}gy.ANIMATION_ID_ROLL=3,gy.ANIMATION_ID_ROLL_ONCE=2,gy.ANIMATION_ID_NORMAL=1,gy.ANIMATION_DURATION=15;class Ey extends xM{usesAnimationResetting(){return!0}}class py extends GM{constructor(){super(...arguments),this._imageOffset=void 0}imageReady(t,e){super.imageReady(t,e),t&&this.setImageOffset(t.width,t.height)}setImageOffset(t,e){const s=new NM;s.setDirection(1,0,-e),s.setDirection(3,0,0),s.setDirection(5,-t,0),s.setDirection(7,-t,-e),s.setDirection(4,-t/2,-e/2),this._imageOffset=s}getLayerXOffset(t,e,s){if(this._imageOffset){const t=this._imageOffset.getXOffset(e,0);if(void 0!==t)return t+this._offsetX}return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){if(this._imageOffset){const t=this._imageOffset.getYOffset(e,0);if(void 0!==t)return t+this._offsetY}return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+-this._offsetZ}getLayerIgnoreMouse(t,e,s){return!0}}class my extends xM{getFrameNumber(t,e){const s=this.getLayerTag(t,this.direction,e),i=this.object.getState(0);switch(s){case my.ONES_SPRITE:return Math.floor(i%10);case my.TENS_SPRITE:return Math.floor(i/10%10);case my.HUNDREDS_SPRITE:return Math.floor(i/100%10);case my.THOUSANDS_SPRITE:return Math.floor(i/1e3%10);default:return super.getFrameNumber(t,e)}}}my.ONES_SPRITE="ones_sprite",my.TENS_SPRITE="tens_sprite",my.HUNDREDS_SPRITE="hundreds_sprite",my.THOUSANDS_SPRITE="thousands_sprite";class Iy extends xM{constructor(){super(...arguments),this._internalFrameIncreaseCounter=0}updateAnimations(t){return this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter+this.object.model.getValue(rt.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED),this._frameIncrease=this._internalFrameIncreaseCounter,this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter-this._frameIncrease,super.updateAnimations(t)}}class Ty extends FM{getLayerColor(t,e,s){return this._data?this._data.getLayerColor(t,e,s):DM.DEFAULT_COLOR}}class Ry extends xM{constructor(){super(),this._stateQueue=void 0,this._running=void 0,this._stateQueue=[],this._running=!1,super.setAnimation(Ry.ANIMATION_ID_OFF)}setAnimation(t){if(0===t&&!this._running)return this._running=!0,this._stateQueue=[],this._stateQueue.push(Ry.ANIMATION_ID_START_ROLL),void this._stateQueue.push(Ry.ANIMATION_ID_ROLL);if(t>0&&t<=Ry.ANIMATION_ID_OFFSET_SLOW2){if(this._running)return this._running=!1,this._stateQueue=[],2===this.direction?(this._stateQueue.push(Ry.ANIMATION_ID_OFFSET_SLOW1+5),this._stateQueue.push(Ry.ANIMATION_ID_OFFSET_SLOW2+5)):(this._stateQueue.push(Ry.ANIMATION_ID_OFFSET_SLOW1+t),this._stateQueue.push(Ry.ANIMATION_ID_OFFSET_SLOW2+t)),void this._stateQueue.push(Ry.ANIMATION_ID_OFF);super.setAnimation(Ry.ANIMATION_ID_OFF)}}updateAnimation(t){return this.getLastFramePlayed(11)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}}Ry.ANIMATION_ID_OFFSET_SLOW1=20,Ry.ANIMATION_ID_OFFSET_SLOW2=10,Ry.ANIMATION_ID_START_ROLL=31,Ry.ANIMATION_ID_ROLL=32,Ry.ANIMATION_ID_OFF=30;class fy extends xM{updateObject(t,e){return super.updateObject(t,e),!0}getFrameNumber(t,e){const s=this.object.model.getValue(rt.FURNITURE_VOTE_COUNTER_COUNT);switch(this.getLayerTag(t,this.direction,e)){case fy.ONES_SPRITE:return s%10;case fy.TENS_SPRITE:return s/10%10;case fy.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(t,e)}}getLayerAlpha(t,e,s){if(this.object.model.getValue(rt.FURNITURE_VOTE_COUNTER_COUNT)===fy.HIDE_COUNTER_SCORE){switch(this.getLayerTag(t,e,s)){case fy.ONES_SPRITE:case fy.TENS_SPRITE:case fy.HUNDREDS_SPRITE:return 0}}return super.getLayerAlpha(t,e,s)}}fy.ONES_SPRITE="ones_sprite",fy.TENS_SPRITE="tens_sprite",fy.HUNDREDS_SPRITE="hundreds_sprite",fy.HIDE_COUNTER_SCORE=-1;class Oy extends xM{getFrameNumber(t,e){const s=this.object.model.getValue(rt.FURNITURE_VOTE_MAJORITY_RESULT);switch(this.getLayerTag(t,this.direction,e)){case Oy.ONES_SPRITE:return s%10;case Oy.TENS_SPRITE:return s/10%10;case Oy.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(t,e)}}getLayerAlpha(t,e,s){const i=this.object.model.getValue(rt.FURNITURE_VOTE_MAJORITY_RESULT);if(-1!==Oy.HIDE_RESULTS_STATES.indexOf(this.object.getState(0))||i===Oy.HIDE_RESULTS_VALUE){switch(this.getLayerTag(t,e,s)){case Oy.ONES_SPRITE:case Oy.TENS_SPRITE:case Oy.HUNDREDS_SPRITE:return 0}}return super.getLayerAlpha(t,e,s)}}Oy.ONES_SPRITE="ones_sprite",Oy.TENS_SPRITE="tens_sprite",Oy.HUNDREDS_SPRITE="hundreds_sprite",Oy.HIDE_RESULTS_STATES=[-1,1],Oy.HIDE_RESULTS_VALUE=-1;class vy extends xM{}class Ay extends WM{getThumbnailURL(){if(!this.object)return null;const t=this.object.model.getValue(rt.FURNITURE_DATA);return t&&t[Ay.THUMBNAIL_URL]||null}}Ay.THUMBNAIL_URL="THUMBNAIL_URL";class Sy{constructor(t){this._sprite=void 0,this._texture=void 0,this._amount=void 0,this._alpha=void 0,this._sprite=new W(t),this._texture=null,this._amount=-1,this._alpha=0}renderBubble(t){if(!this._sprite||this._amount===t)return null;const e=new H;e.addChild(this._sprite);const s=new kS.a("+"+t,{fontFamily:"Arial",fontSize:9,fill:16777215,align:"center"});return s.anchor.x=.5,s.x=this._sprite.width/2,s.y=19,e.addChild(s),this._texture?SU.instance.renderer.render(e,{renderTexture:this._texture,clear:!0}):this._texture=At.generateTexture(e),this._texture}get amount(){return this._amount}set amount(t){this._amount=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}}class Ny extends PM{constructor(t,e){super(t,e),this._posturesToAnimations=void 0,this._gesturesToAnimations=void 0,this._defaultPosture=void 0,this._posturesToAnimations=new Map,this._gesturesToAnimations=new Map,this._defaultPosture=null}processPostures(t){if(!t)return!1;if(t.defaultPosture&&t.defaultPosture.length&&(this._defaultPosture=t.defaultPosture),!t.postures)return!1;for(const e of t.postures)this._posturesToAnimations.get(e.id)||(null===this._defaultPosture&&(this._defaultPosture=e.id),this._posturesToAnimations.set(e.id,e.animationId));return void 0!==this._posturesToAnimations.get(this._defaultPosture)}processGestures(t){if(!t)return!1;for(const e of t)this._gesturesToAnimations.get(e.id)||this._gesturesToAnimations.set(e.id,e.animationId);return!0}postureToAnimation(t){return this._posturesToAnimations.get(t)||(t=this._defaultPosture),this._posturesToAnimations.get(t)}getGestureDisabled(t){return"ded"===t}gestureToAnimation(t){return this._gesturesToAnimations.get(t)?this._gesturesToAnimations.get(t):Ny.DEFAULT}animationToPosture(t,e){if(t>=0&&t<this._posturesToAnimations.size){const e=this._posturesToAnimations.keys();for(;;){const s=e.next();if(s.done)return null;if(t<=0)return s.value;--t}}return e?this._defaultPosture:null}animationToGesture(t){if(t>=0&&t<this._gesturesToAnimations.size){const e=this._gesturesToAnimations.keys();for(;;){const s=e.next();if(s.done)return null;if(t<=0)return s.value;--t}}return null}getGestureForAnimationId(t){for(const e of this._gesturesToAnimations.keys())if(this._gesturesToAnimations.get(e)===t)return e;return null}get totalPostures(){return this._posturesToAnimations.size}get totalGestures(){return this._gesturesToAnimations.size}}Ny.DEFAULT=-1;class My extends wM{constructor(){super(),this._isAllowedToTurnHead=void 0,this._isAllowedToTurnHead=!0}createSizeData(t,e,s){return t>1?new Ny(e,s):new PM(e,s)}defineVisualizations(t){return this._isAllowedToTurnHead=!0,super.defineVisualizations(t)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"postures":if(!(t instanceof Ny)||!t.processPostures(s))return!1;break;case"gestures":if(!(t instanceof Ny)||!t.processGestures(s))return!1;break;default:if(!super.processVisualElement(t,e,s))return!1}return!0}postureToAnimation(t,e){const s=this.getSizeData(t);return s?s.postureToAnimation(e):Ny.DEFAULT}getGestureDisabled(t,e){const s=this.getSizeData(t);return!!s&&s.getGestureDisabled(e)}gestureToAnimation(t,e){const s=this.getSizeData(t);return s?s.gestureToAnimation(e):Ny.DEFAULT}animationToPosture(t,e,s){const i=this.getSizeData(t);return i?i.animationToPosture(e,s):null}animationToGesture(t,e){const s=this.getSizeData(t);return s?s.animationToGesture(e):null}getGestureForAnimationId(t,e){const s=this.getSizeData(t);return s?s.getGestureForAnimationId(e):null}totalPostures(t){const e=this.getSizeData(t);return e?e.totalPostures:0}totalGestures(t){const e=this.getSizeData(t);return e?e.totalGestures:0}get isAllowedToTurnHead(){return this._isAllowedToTurnHead}}class yy extends xM{constructor(){for(super(),this._data=void 0,this._posture=void 0,this._gesture=void 0,this._isSleeping=void 0,this._headDirection=void 0,this._headOnly=void 0,this._nonHeadSprites=void 0,this._headSprites=void 0,this._saddleSprites=void 0,this._animationOver=void 0,this._paletteIndex=void 0,this._paletteName=void 0,this._customLayerIds=void 0,this._customPartIds=void 0,this._customPaletteIds=void 0,this._isRiding=void 0,this._color=void 0,this._experience=void 0,this._experienceTimestamp=void 0,this._experienceData=void 0,this._previousAnimationDirection=void 0,this._animationStates=void 0,this._data=null,this._posture="",this._gesture="",this._isSleeping=!1,this._headDirection=-1,this._headOnly=!1,this._nonHeadSprites=[],this._headSprites=[],this._saddleSprites=[],this._animationOver=!1,this._paletteIndex=-1,this._paletteName="",this._customLayerIds=[],this._customPartIds=[],this._customPaletteIds=[],this._isRiding=!1,this._color=16777215,this._experience=0,this._experienceTimestamp=0,this._experienceData=null,this._previousAnimationDirection=-1,this._animationStates=[];this._animationStates.length<yy.ANIMATION_INDEX_COUNT;)this._animationStates.push(new yM)}initialize(t){if(!(t instanceof My))return!1;const e=this.getPetAdditionAsset(yy.PET_EXPERIENCE_BUBBLE);return e&&(this._experienceData=new Sy(e)),super.initialize(t)}dispose(){if(super.dispose(),this._animationStates){for(;this._animationStates.length;){const t=this._animationStates[0];t&&t.dispose(),this._animationStates.pop()}this._animationStates=null}}getAnimationId(t){return t.animationId}update(t,e,s,i){super.update(t,e,s,i),this.updateExperienceBubble(e)}updateExperienceBubble(t){if(this._experienceData&&(this._experienceData.alpha=0,this._experienceTimestamp)){const e=t-this._experienceTimestamp;e<yy.EXPERIENCE_BUBBLE_VISIBLE_IN_MS?this._experienceData.alpha=255*Math.sin(e/yy.EXPERIENCE_BUBBLE_VISIBLE_IN_MS*Math.PI):this._experienceTimestamp=0;const s=this.getSprite(this.totalSprites-1);if(s){if(this._experienceData.alpha>0){const t=this._experienceData.renderBubble(this._experience);if(t)return s.texture=t,s.offsetX=-20,s.offsetY=-80,s.alpha=this._experienceData.alpha,s.visible=!0,void(s.relativeDepth=-.2)}s.texture=null,s.visible=!1}}}updateModel(t){const e=this.object&&this.object.model;if(!e)return!1;if(this.updateModelCounter===e.updateCounter)return!1;const s=e.getValue(rt.FIGURE_POSTURE),i=e.getValue(rt.FIGURE_GESTURE);this.setPostureAndGesture(s,i);let r=e.getValue(rt.FURNITURE_ALPHA_MULTIPLIER)||null;(null===r||isNaN(r))&&(r=1),this._alphaMultiplier!==r&&(this._alphaMultiplier=r,this._alphaChanged=!0),this._isSleeping=e.getValue(rt.FIGURE_SLEEP)>0;const n=e.getValue(rt.HEAD_DIRECTION);!isNaN(n)&&this._data.isAllowedToTurnHead?this._headDirection=n:this._headDirection=this.object.getDirection().x,this._experience=e.getValue(rt.FIGURE_GAINED_EXPERIENCE),this._experienceTimestamp=e.getValue(rt.FIGURE_EXPERIENCE_TIMESTAMP);const a=e.getValue(rt.PET_PALETTE_INDEX),o=e.getValue(rt.PET_CUSTOM_LAYER_IDS),h=e.getValue(rt.PET_CUSTOM_PARTS_IDS),_=e.getValue(rt.PET_CUSTOM_PALETTE_IDS),d=e.getValue(rt.PET_IS_RIDING),u=e.getValue(rt.PET_HEAD_ONLY),c=e.getValue(rt.PET_COLOR);return a!==this._paletteIndex&&(this._paletteIndex=a,this._paletteName=this._paletteIndex.toString()),this._customLayerIds=o||[],this._customPartIds=h||[],this._customPaletteIds=_||[],this._isRiding=!isNaN(d)&&d>0,this._headOnly=!isNaN(u)&&u>0,isNaN(c)||this._color===c||(this._color=c),this.updateModelCounter=e.updateCounter,!0}updateAnimation(t){if(this.object){const t=this.object.getDirection().x;t!==this._previousAnimationDirection&&(this._previousAnimationDirection=t,this.resetAllAnimationFrames())}return super.updateAnimation(t)}setPostureAndGesture(t,e){this._data&&(t!==this._posture&&(this._posture=t,this.setAnimationForIndex(yy.POSTURE_ANIMATION_INDEX,this._data.postureToAnimation(this._scale,t))),this._data.getGestureDisabled(this._scale,t)&&(e=null),e!==this._gesture&&(this._gesture=e,this.setAnimationForIndex(yy.GESTURE_ANIMATION_INDEX,this._data.gestureToAnimation(this._scale,e))))}getAnimationStateData(t){return t>=0&&t<this._animationStates.length?this._animationStates[t]:null}setAnimationForIndex(t,e){const s=this.getAnimationStateData(t);s&&this.setSubAnimation(s,e)&&(this._animationOver=!1)}resetAllAnimationFrames(){this._animationOver=!1;let t=this._animationStates.length-1;for(;t>=0;){const e=this._animationStates[t];e&&e.setLayerCount(this.animatedLayerCount),t--}}updateAnimations(t){if(this._animationOver)return 0;let e=!0,s=0,i=0;for(;i<this._animationStates.length;){const r=this._animationStates[i];if(r&&!r.animationOver){s|=this.updateFramesForAnimation(r,t),r.animationOver?(MM.isTransitionFromAnimation(r.animationId)||MM.isTransitionToAnimation(r.animationId))&&(this.setAnimationForIndex(i,r.animationAfterTransitionId),e=!1):e=!1}i++}return this._animationOver=e,s}getSpriteAssetName(t,e){if(this._headOnly&&this.isNonHeadSprite(e))return null;if(this._isRiding&&this._parser3(e))return null;const s=this.totalSprites;if(e<s-yy.ADDITIONAL_SPRITE_COUNT){const i=this.getValidSize(t);if(e<s-(1+yy.ADDITIONAL_SPRITE_COUNT)){if(e>=bM.LAYER_LETTERS.length)return null;const s=bM.LAYER_LETTERS[e];return 1===i?this._type+"_icon_"+s:this._type+"_"+i+"_"+s+"_"+this.getDirection(t,e)+"_"+this.getFrameNumber(i,e)}return this._type+"_"+i+"_sd_"+this.getDirection(t,e)+"_0"}return null}getLayerColor(t,e,s){return e<this.totalSprites-yy.ADDITIONAL_SPRITE_COUNT?this._color:16777215}getLayerXOffset(t,e,s){let i=super.getLayerXOffset(t,e,s),r=this._animationStates.length-1;for(;r>=0;){const t=this._animationStates[r];if(t){const e=t.getFrame(s);e&&(i+=e.x)}r--}return i}getLayerYOffset(t,e,s){let i=super.getLayerYOffset(t,e,s),r=this._animationStates.length-1;for(;r>=0;){const t=this._animationStates[r];if(t){const e=t.getFrame(s);e&&(i+=e.y)}r--}return i}getLayerZOffset(t,e,s){return this._data?this._data.getLayerZOffset(t,this.getDirection(t,s),s):CM.DEFAULT_ZOFFSET}getDirection(t,e){return this.isHeadSprite(e)?this._data.getValidDirection(t,this._headDirection):this._direction}getFrameNumber(t,e){let s=this._animationStates.length-1;for(;s>=0;){const t=this._animationStates[s];if(t){const s=t.getFrame(e);if(s)return s.id}s--}return super.getFrameNumber(t,e)}isHeadSprite(t){if(void 0===this._headSprites[t]){const e=this._data.getLayerTag(this._scale,LM.USE_DEFAULT_DIRECTION,t)===yy.HEAD,s=this._data.getLayerTag(this._scale,LM.USE_DEFAULT_DIRECTION,t)===yy.HAIR;this._headSprites[t]=!(!e&&!s)}return this._headSprites[t]}isNonHeadSprite(t){if(void 0===this._nonHeadSprites[t])if(t<this.totalSprites-(1+yy.ADDITIONAL_SPRITE_COUNT)){const e=this._data.getLayerTag(this._scale,LM.USE_DEFAULT_DIRECTION,t);e&&e.length>0&&e!==yy.HEAD&&e!==yy.HAIR?this._nonHeadSprites[t]=!0:this._nonHeadSprites[t]=!1}else this._nonHeadSprites[t]=!0;return this._nonHeadSprites[t]}_parser3(t){return void 0===this._saddleSprites[t]&&(this._data.getLayerTag(this._scale,LM.USE_DEFAULT_DIRECTION,t)===yy.SADDLE?this._saddleSprites[t]=!0:this._saddleSprites[t]=!1),this._saddleSprites[t]}getAsset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(!this.asset)return null;const s=this._customLayerIds.indexOf(e);let i=this._paletteName,r=-1,n=-1;return s>-1&&(r=this._customPartIds[s],n=this._customPaletteIds[s],i=n>-1?n.toString():this._paletteName),!isNaN(r)&&r>-1&&(t=t+"_"+r),this.asset.getAssetWithPalette(t,i)}getAdditionalLayerCount(){return super.getAdditionalLayerCount()+yy.ADDITIONAL_SPRITE_COUNT}setLayerCount(t){super.setLayerCount(t),this._headSprites=[]}getPostureForAsset(t,e){const s=e.split("_");let i=s.length,r=0;for(;r<s.length;){if("64"===s[r]||"32"===s[r]){i=r+3;break}r++}let n=null;if(i<s.length){let e=s[i];e=e.split("@")[0],n=this._data.animationToPosture(t,parseInt(e)/100,!1),n||(n=this._data.getGestureForAnimationId(t,parseInt(e)/100))}return n}getPetAdditionAsset(t){return SU.instance.core.asset.getTexture(t)}}yy.TYPE=nt.PET_ANIMATED,yy.HEAD="head",yy.SADDLE="saddle",yy.HAIR="hair",yy.ADDITIONAL_SPRITE_COUNT=1,yy.EXPERIENCE_BUBBLE_VISIBLE_IN_MS=1e3,yy.PET_EXPERIENCE_BUBBLE="avatar_addition_pet_experience_bubble",yy.POSTURE_ANIMATION_INDEX=0,yy.GESTURE_ANIMATION_INDEX=1,yy.ANIMATION_INDEX_COUNT=2;class Dy{constructor(t,e,s){this._loc=void 0,this._type=void 0,this._category=void 0,this.type=t,this.loc=e,this.category=s}get loc(){return this._loc}set loc(t){this._loc||(this._loc=new dt),this._loc.assign(t)}get type(){return this._type}set type(t){this._type=t}get category(){return this._category}set category(t){this._category=t}dispose(){this._loc=null}}Dy.WINDOW="window",Dy.HOLE="hole";class Cy{constructor(){this._masks=void 0,this._masks=[]}get masks(){return this._masks}}class Ly{constructor(){this._masks=void 0,this._masks=new Map}get maskCount(){return this._masks.size}dispose(){this._masks&&(this.reset(),this._masks=null)}initialize(t){if(!t)return!1;if(this._masks.clear(),t.masks.length)for(const e of t.masks){if(!e)continue;const t=e.locations.length?e.locations[0]:null;t&&this._masks.set(e.id,new Dy(e.type,t,e.category))}return!0}reset(){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}addMask(t,e,s,i){const r=new Dy(e,s,i);this._masks.delete(t),this._masks.set(t,r)}removeMask(t){const e=this._masks.get(t);return!!e&&(this._masks.delete(t),e.dispose(),!0)}getXML(){const t=new Cy;for(const[e,s]of this._masks.entries()){if(!s)continue;const i=this.getMaskType(s),r=this.getMaskCategory(s),n=this.getMaskLocation(s);if(i&&r&&n){const s={id:e,type:i,category:r,locations:[{x:n.x,y:n.y,z:n.z}]};t.masks.push(s)}}return t}getMaskLocation(t){return t?t.loc:null}getMaskType(t){return t?t.type:null}getMaskCategory(t){return t?t.category:null}get masks(){return this._masks}}class Uy{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._z=void 0,this._points=void 0,this._color=void 0,this._maskAssetNames=void 0,this._maskAssetLocations=void 0,this._maskAssetFlipHs=void 0,this._maskAssetFlipVs=void 0,this._alignBottom=void 0,this._assetNames=void 0,this._assetNames=[],this._maskAssetNames=[],this._maskAssetLocations=[],this._maskAssetFlipHs=[],this._maskAssetFlipVs=[],null!=t&&(this._maskAssetNames=t._maskAssetNames,this._maskAssetLocations=t._maskAssetLocations,this._maskAssetFlipHs=t._maskAssetFlipHs,this._maskAssetFlipVs=t._maskAssetFlipVs),this._color=e,this._alignBottom=s}addMask(t,e,s,i){this._maskAssetNames.push(t),this._maskAssetLocations.push(e),this._maskAssetFlipHs.push(s),this._maskAssetFlipVs.push(i)}addAssetColumn(t){this._assetNames.push(t)}set z(t){this._z=t}get z(){return this._z}set cornerPoints(t){this._points=t}get cornerPoints(){return this._points}get color(){return this._color}get maskAssetNames(){return this._maskAssetNames}get maskAssetLocations(){return this._maskAssetLocations}get maskAssetFlipHs(){return this._maskAssetFlipHs}get maskAssetFlipVs(){return this._maskAssetFlipVs}isBottomAligned(){return this._alignBottom}get assetNameColumns(){return this._assetNames}}class Py{constructor(t,e,s){this._type=void 0,this._leftSideLoc=void 0,this._rightSideLoc=void 0,this._type=t,this._leftSideLoc=e,this._rightSideLoc=s}get type(){return this._type}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}}class by{constructor(t,e,s,i){this._leftSideLoc=void 0,this._rightSideLoc=void 0,this._leftSideLength=void 0,this._rightSideLength=void 0,this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}class wy{constructor(t,e){this._bitmap=void 0,this._timeStamp=void 0,this._bitmap=t,this._timeStamp=e}dispose(){this._bitmap=null}get bitmap(){return this._bitmap}get timeStamp(){return this._timeStamp}}class Fy{constructor(){this._seed=1,this._modulus=16777216,this._multiplier=69069,this._increment=5}static setSeed(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Fy._randomizer||(Fy._randomizer=new Fy),Fy._randomizer.seed=t}static setModulus(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16777216;Fy._randomizer||(Fy._randomizer=new Fy),Fy._randomizer.modulus=t}static getValues(t,e,s){return Fy._randomizer||(Fy._randomizer=new Fy),Fy._randomizer.getRandomValues(t,e,s)}static getArray(t,e){return Fy._randomizer||(Fy._randomizer=new Fy),Fy._randomizer.getRandomArray(t,e)}set seed(t){this._seed=t}set modulus(t){t<1&&(t=1),this._modulus=t}dispose(){}getRandomValues(t,e,s){const i=[];let r=0;for(;r<t;)i.push(this.iterateScaled(e,s-e)),r++;return i}getRandomArray(t,e){if(t>e||e>1e3)return null;const s=[];let i=0;for(;i<=e;)s.push(i),i++;const r=[];let n=0;for(;n<t;){const t=this.iterateScaled(0,s.length-1);r.push(s[t]),s.splice(t,1),n++}return r}iterate(){let t=this._multiplier*this._seed+this._increment;return t<0&&(t=-t),t%=this._modulus,this._seed=t,t}iterateScaled(t,e){let s=this.iterate();return e<1?t:(s=t+s/this._modulus*e,s)}}Fy.DEFAULT_SEED=1,Fy.DEFAULT_MODULUS=16777216,Fy._randomizer=null;class xy{constructor(t,e,s,i,r,n,a,o){let h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0;if(this._disposed=void 0,this._randomSeed=void 0,this._origin=void 0,this._location=void 0,this._leftSide=void 0,this._rightSide=void 0,this._normal=void 0,this._secondaryNormals=void 0,this._geometryUpdateId=void 0,this._type=void 0,this._isVisible=void 0,this._bitmapTexture=void 0,this._bitmapData=void 0,this._hasTexture=void 0,this._offset=void 0,this._relativeDepth=void 0,this._color=void 0,this._rasterizer=void 0,this._maskManager=null,this._id=void 0,this._uniqueId=void 0,this._textureOffsetX=void 0,this._textureOffsetY=void 0,this._textureMaxX=void 0,this._textureMaxY=void 0,this._textures=void 0,this._activeTexture=void 0,this._useMask=void 0,this._bitmapMasks=void 0,this._rectangleMasks=void 0,this._maskChanged=void 0,this._maskBitmapData=void 0,this._bitmapMasksOld=void 0,this._rectangleMasksOld=void 0,this._cornerA=void 0,this._cornerB=void 0,this._cornerC=void 0,this._cornerD=void 0,this._width=0,this._height=0,this._canBeVisible=void 0,this._secondaryNormals=[],this._bitmapMasks=[],this._rectangleMasks=[],this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._randomSeed=o,this._bitmapData=null,this._maskBitmapData=null,this._maskChanged=!1,this._activeTexture=null,this._origin=new dt,this._origin.assign(t),this._location=new dt,this._location.assign(e),this._leftSide=new dt,this._leftSide.assign(s),this._rightSide=new dt,this._rightSide.assign(i),this._normal=dt.crossProduct(this._leftSide,this._rightSide),this._normal.length>0&&this._normal.multiply(1/this._normal.length),null!=a)for(const c of a){if(!c)continue;const t=new dt;t.assign(c),this._secondaryNormals.push(t)}this._disposed=!1,this._isVisible=!1,this._id=null,this._hasTexture=!0,this._geometryUpdateId=-1,this._offset=new j.g,this._relativeDepth=0,this._type=r,this._color=0,this._rasterizer=null,this._canBeVisible=!0,this._textures=new Map,this._cornerA=new dt,this._cornerB=new dt,this._cornerC=new dt,this._cornerD=new dt,this._width=0,this._height=0,this._textureOffsetX=h,this._textureOffsetY=_,this._textureMaxX=d,this._textureMaxY=u,this._useMask=n,this._uniqueId=++xy._uniqueIdCounter}static blend(t,e){return 0}set canBeVisible(t){t!==this._canBeVisible&&(this._canBeVisible||this.resetTextureCache(),this._canBeVisible=t)}get canBeVisible(){return this._canBeVisible}get bitmapData(){if(!this.visible||!this._bitmapData)return null;let t=oD.getTextureCache(this._bitmapData);return t||(t=At.generateTexture(this._bitmapData,new j.j(0,0,this._width,this._height)),oD.addTextureCache(this._bitmapData,t)),t}get visible(){return this._isVisible&&this._canBeVisible}get offset(){return this._offset}get relativeDepth(){return this._relativeDepth}get color(){return this._color}set color(t){this._color=t}get type(){return this._type}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get location(){return this._location}get normal(){return this._normal}get hasTexture(){return this._hasTexture}set hasTexture(t){this._hasTexture=t}set rasterizer(t){this._rasterizer=t}set maskManager(t){this._maskManager=t}set id(t){t!==this._id&&(this.resetTextureCache(),this._id=t)}get uniqueId(){return this._uniqueId}dispose(){if(this._bitmapData&&(this._bitmapData.destroy(),this._bitmapData=null),this._textures){for(const t of this._textures.values())t&&(t.bitmap&&t.bitmap.destroy(),t.dispose());this._textures=null}this._activeTexture=null,this._location=null,this._origin=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._rasterizer=null,this._cornerA=null,this._cornerB=null,this._cornerC=null,this._cornerD=null,this._bitmapMasks=null,this._rectangleMasks=null,this._maskBitmapData&&(this._maskBitmapData.destroy(),this._maskBitmapData=null),this._disposed=!0}copyBitmapData(t){return this.visible&&this._bitmapData&&t?this._bitmapData.width!==t.width||this._bitmapData.height!==t.height?null:t:null}cacheTexture(t,e){const s=this._textures.get(t);return s&&(this._textures.delete(t),s.dispose()),this._activeTexture=e,this._textures.set(t,e),!0}resetTextureCache(){if(this._textures&&this._textures.size){for(const t of this._textures.values())t&&t.dispose();this._textures.clear()}this._activeTexture=null}getTextureIdentifier(t){return this._rasterizer?this._rasterizer.getTextureIdentifier(t,this.normal):t.toString()}needsNewTexture(t,e){if(!t)return!1;let s=this._activeTexture;return s||(s=this._textures.get(this.getTextureIdentifier(t.scale))),this.updateMaskChangeStatus(),!(!this._canBeVisible||!(!s||s.timeStamp>=0&&e>s.timeStamp||this._maskChanged))}getTexture(t,e){if(!t)return null;let s=null;if(this.needsNewTexture(t,e)){const i=this.getTextureIdentifier(t.scale),r=this._leftSide.length*t.scale,n=this._rightSide.length*t.scale,a=t.getCoordinatePosition(this._normal);s=this._activeTexture?this._activeTexture:this._textures.get(i);let o=null;if(s&&(o=s.bitmap),this._rasterizer)s=this._rasterizer.render(o,this._id,r,n,t.scale,a,this._hasTexture,this._textureOffsetX,this._textureOffsetY,this._textureMaxX,this._textureMaxY,e),s&&o&&s.bitmap!==o&&o.destroy();else{const t=new Ve.a;t.beginFill(16777215),t.drawRect(0,0,r,n),t.endFill(),s=new wy(t,-1)}s&&(this.updateMask(s.bitmap,t),this.cacheTexture(i,s))}else s=this._activeTexture?this._activeTexture:this._textures.get(this.getTextureIdentifier(t.scale));return s?(this._activeTexture=s,s.bitmap):null}resolveMasks(t){if(!this._useMask)return null;const e=new Uy;for(;0<this._bitmapMasks.length;){const s=this._bitmapMasks[0];if(s){const i=this._maskManager.getMask(s.type);if(i){const r=i.getAssetName(t.scale);if(r){const n=t.getCoordinatePosition(this._normal),a=i.getGraphicAsset(t.scale,n);if(a){const t=this._maskBitmapData.width*(1-s.leftSideLoc/this._leftSide.length),i=this._maskBitmapData.height*(1-s.rightSideLoc/this._rightSide.length),n=new j.g(t+a.offsetX,i+a.offsetY);e.addMask(r,n,a.flipH,a.flipV)}}}}}return e}screenWidth(t){const e=t.getScreenPoint(new dt(0,0,0)),s=t.getScreenPoint(new dt(0,1,0));return Math.round(this._leftSide.length*Math.abs(e.x-s.x))}getDrawingDatas(t){const e=[];if(this._isVisible){const s=this.resolveMasks(t),i=this._rasterizer.getLayers(this._id);let r=0;for(;r<i.length;){const n=i[r];if(n)if(this._hasTexture&&n.getMaterial()){const i=t.getCoordinatePosition(this._normal),r=n.getMaterial().getMaterialCellMatrix(i),a=new Uy(s,this._color,r.isBottomAligned());Fy.setSeed(this._randomSeed);for(const e of r.getColumns(this.screenWidth(t))){const t=[];for(const s of e.getCells()){const e=s.getAssetName(i);e&&t.push(e)}t.length>0&&(e.isRepeated()||t.push(""),a.addAssetColumn(t))}a.assetNameColumns.length>0&&e.push(a)}else{const t=new Uy(s,this._color);e.push(t)}r++}e.length||e.push(new Uy(s,this._color))}return e}update(t,e){if(!t||this._disposed)return!1;let s=!1;if(this._geometryUpdateId!=t.updateId&&(s=!0),(!s||!this._canBeVisible)&&!this.visible)return!1;if(s){this._activeTexture=null;let e=0;if(e=dt.cosAngle(t.directionAxis,this.normal),e>-.001)return!!this._isVisible&&(this._isVisible=!1,!0);let s=0;for(;s<this._secondaryNormals.length;){if(e=dt.cosAngle(t.directionAxis,this._secondaryNormals[s]),e>-.001)return!!this._isVisible&&(this._isVisible=!1,!0);s++}this.updateCorners(t);const i=t.getScreenPosition(this._origin).z;let r=Math.max(this._cornerA.z,this._cornerB.z,this._cornerC.z,this._cornerD.z)-i;this._type===xy.TYPE_FLOOR&&(r-=8*(this._location.z+Math.min(0,this._leftSide.z,this._rightSide.z))),this._type===xy.TYPE_LANDSCAPE&&(r+=.02),this._relativeDepth=r,this._isVisible=!0,this._geometryUpdateId=t.updateId}if(s||this.needsNewTexture(t,e)){if(!this._bitmapData||this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData){if(this._bitmapData.destroy(),this._bitmapData=null,this._width<1||this._height<1)return!0}else if(this._width<1||this._height<1)return!1;const t=new Ve.a;if(t.beginFill(16777215,0),t.drawRect(0,0,this._width,this._height),t.endFill(),this._bitmapData=t,!this._bitmapData)return!1}Fy.setSeed(this._randomSeed);const i=this.getTexture(t,e);return i?(this.renderTexture(t,i),null!==i||s):(this.dispose(),!1)}return!1}updateCorners(t){this._cornerA.assign(t.getScreenPosition(this._location)),this._cornerB.assign(t.getScreenPosition(dt.sum(this._location,this._rightSide))),this._cornerC.assign(t.getScreenPosition(dt.sum(dt.sum(this._location,this._leftSide),this._rightSide))),this._cornerD.assign(t.getScreenPosition(dt.sum(this._location,this._leftSide))),this._offset=t.getScreenPoint(this._origin),this._cornerA.x=Math.round(this._cornerA.x),this._cornerA.y=Math.round(this._cornerA.y),this._cornerB.x=Math.round(this._cornerB.x),this._cornerB.y=Math.round(this._cornerB.y),this._cornerC.x=Math.round(this._cornerC.x),this._cornerC.y=Math.round(this._cornerC.y),this._cornerD.x=Math.round(this._cornerD.x),this._cornerD.y=Math.round(this._cornerD.y),this._offset.x=Math.round(this._offset.x),this._offset.y=Math.round(this._offset.y);const e=Math.min(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x);let s=Math.max(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x);const i=Math.min(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y);let r=Math.max(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y);s-=e,this._offset.x=this._offset.x-e,this._cornerA.x=this._cornerA.x-e,this._cornerB.x=this._cornerB.x-e,this._cornerC.x=this._cornerC.x-e,this._cornerD.x=this._cornerD.x-e,r-=i,this._offset.y=this._offset.y-i,this._cornerA.y=this._cornerA.y-i,this._cornerB.y=this._cornerB.y-i,this._cornerC.y=this._cornerC.y-i,this._cornerD.y=this._cornerD.y-i,this._width=s,this._height=r}renderTexture(t,e){if(null==this._cornerA||null==this._cornerB||null==this._cornerC||null==this._cornerD||null==e||null==this._bitmapData)return;let s=this._cornerD.x-this._cornerC.x,i=this._cornerD.y-this._cornerC.y,r=this._cornerB.x-this._cornerC.x,n=this._cornerB.y-this._cornerC.y;this._type!=xy.TYPE_WALL&&this._type!=xy.TYPE_LANDSCAPE||(Math.abs(r-e.width)<=1&&(r=e.width),Math.abs(n-e.width)<=1&&(n=e.width),Math.abs(s-e.height)<=1&&(s=e.height),Math.abs(i-e.height)<=1&&(i=e.height));const a=r/e.width,o=n/e.width,h=s/e.height,_=i/e.height,d=new j.d;d.a=a,d.b=o,d.c=h,d.d=_,d.translate(this._cornerC.x,this._cornerC.y),this.draw(e,d)}draw(t,e){const s=t.clone();s.transform.setFromMatrix(e),this._bitmapData=s}resetBitmapMasks(){!this._disposed&&this._useMask&&this._bitmapMasks.length&&(this._maskChanged=!0,this._bitmapMasks=[])}addBitmapMask(t,e,s){if(!this._useMask)return!1;let i=0;for(;i<this._bitmapMasks.length;){const r=this._bitmapMasks[i];if(r&&r.type===t&&r.leftSideLoc===e&&r.rightSideLoc===s)return!1;i++}const r=new Py(t,e,s);return this._bitmapMasks.push(r),this._maskChanged=!0,!0}resetRectangleMasks(){this._useMask&&this._rectangleMasks.length&&(this._maskChanged=!0,this._rectangleMasks=[])}addRectangleMask(t,e,s,i){if(this._useMask){for(const n of this._rectangleMasks)if(n&&n.leftSideLoc===t&&n.rightSideLoc===e&&n.leftSideLength===s&&n.rightSideLength===i)return!1;const r=new by(t,e,s,i);return this._rectangleMasks.push(r),this._maskChanged=!0,!0}return!1}updateMaskChangeStatus(){if(!this._maskChanged)return;let t,e=!0;if(this._bitmapMasks.length===this._bitmapMasksOld.length){for(const s of this._bitmapMasks)if(s){t=!1;for(const e of this._bitmapMasksOld)if(e&&e.type===s.type&&e.leftSideLoc===s.leftSideLoc&&e.rightSideLoc===s.rightSideLoc){t=!0;break}if(!t){e=!1;break}}}else e=!1;this._rectangleMasks.length>this._rectangleMasksOld.length&&(e=!1),e&&(this._maskChanged=!1)}updateMask(t,e){if(!t||!e)return;if(!this._useMask||!this._bitmapMasks.length&&!this._rectangleMasks.length&&!this._maskChanged||!this._maskManager)return;const s=t.width,i=t.height;if(this.updateMaskChangeStatus(),!this._maskBitmapData||this._maskBitmapData.width!==s||this._maskBitmapData.height!==i){this._maskBitmapData&&(this._maskBitmapData.destroy(),this._maskBitmapData=null);const t=new Ve.a;t.beginFill(16777215,0).drawRect(0,0,s,i).endFill(),this._maskBitmapData=t,this._maskChanged=!0}if(this._maskChanged){this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._maskBitmapData&&this._maskBitmapData.beginFill(16777215,0).drawRect(0,0,s,i).endFill(),this.resetTextureCache(t);const r=e.getCoordinatePosition(this._normal);let n=null,a=0,o=0,h=0;for(;h<this._bitmapMasks.length;){const t=this._bitmapMasks[h];t&&(n=t.type,a=this._maskBitmapData.width-this._maskBitmapData.width*t.leftSideLoc/this._leftSide.length,o=this._maskBitmapData.height-this._maskBitmapData.height*t.rightSideLoc/this._rightSide.length,this._maskManager.updateMask(this._maskBitmapData,n,e.scale,r,a,o),this._bitmapMasksOld.push(new Py(n,t.leftSideLoc,t.rightSideLoc))),h++}for(h=0;h<this._rectangleMasks.length;){const t=this._rectangleMasks[h];if(t){a=this._maskBitmapData.width-this._maskBitmapData.width*t.leftSideLoc/this._leftSide.length,o=this._maskBitmapData.height-this._maskBitmapData.height*t.rightSideLoc/this._rightSide.length;const e=this._maskBitmapData.width*t.leftSideLength/this._leftSide.length,s=this._maskBitmapData.height*t.rightSideLength/this._rightSide.length;this._maskBitmapData.beginFill(16711680).drawRect(a-e,o-s,e,s).endFill(),this._rectangleMasksOld.push(new by(t.leftSideLength,t.rightSideLoc,t.leftSideLength,t.rightSideLength))}h++}this._maskChanged=!1}this.combineTextureMask(t,this._maskBitmapData)}combineTextureMask(t,e){if(!t||!e)return;const s=At.generateCanvas(e),r=At.generateCanvas(t),n=r.getContext("2d");n.drawImage(s,0,0);const a=n.getImageData(0,0,r.width,r.height),o=a.data;for(let i=0;i<o.length;i+=4){const t=o[i],e=o[i+1],s=o[i+2];o[i+3];t||e||s||(o[i+3]=0)}n.putImageData(a,0,0);const h=i.t.from(r);h&&t.clear().beginTextureFill({texture:h}).drawRect(0,0,h.width,h.height).endFill()}}xy.ZERO_POINT=new j.g(0,0),xy.TYPE_UNDEFINED=0,xy.TYPE_WALL=1,xy.TYPE_FLOOR=2,xy.TYPE_LANDSCAPE=3,xy._uniqueIdCounter=1;class By{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;this._asset=void 0,this._normalMinX=void 0,this._normalMaxX=void 0,this._normalMinY=void 0,this._normalMaxY=void 0,this._normalMinX=e,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=r,this._asset=t}get asset(){return this._asset}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}dispose(){this._asset=null}}By.MIN_NORMAL_COORDINATE_VALUE=-1,By.MAX_NORMAL_COORDINATE_VALUE=1;class Gy{constructor(){this._bitmaps=void 0,this._bitmaps=[]}dispose(){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}addBitmap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;this._bitmaps.push(new By(t,e,s,i,r))}getAsset(t){if(!t)return null;for(const e of this._bitmaps)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e.asset;return null}}Gy.MIN_NORMAL_COORDINATE_VALUE=-1,Gy.MAX_NORMAL_COORDINATE_VALUE=1;class Hy{constructor(){this._maskVisualizations=void 0,this._sizes=void 0,this._assetNames=void 0,this._lastMaskVisualization=void 0,this._lastSize=void 0,this._sizes=[],this._maskVisualizations=new Map,this._assetNames=new Map,this._lastMaskVisualization=null,this._lastSize=-1}dispose(){if(this._maskVisualizations){for(const t of this._maskVisualizations.values())t&&t.dispose();this._maskVisualizations=null}this._lastMaskVisualization=null,this._sizes=null}createMaskVisualization(t){if(this._maskVisualizations.get(t))return null;const e=new Gy;return this._maskVisualizations.set(t,e),this._sizes.push(t),this._sizes.sort(),e}getSizeIndex(t){let e=0;for(;1<this._sizes.length;){if(this._sizes[1]>t){this._sizes[1]-t<t-this._sizes[0]&&(e=1);break}e=1}return e}getMaskVisualization(t){if(t===this._lastSize)return this._lastMaskVisualization;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastMaskVisualization=this._maskVisualizations.get(this._sizes[e]):this._lastMaskVisualization=null,this._lastSize=t,this._lastMaskVisualization}getGraphicAsset(t,e){const s=this.getMaskVisualization(t);return s?s.getAsset(e):null}getAssetName(t){return this._assetNames&&this._assetNames.get(t)||null}setAssetName(t,e){this._assetNames&&this._assetNames.set(t,e)}}class Vy{constructor(){this._assetCollection=void 0,this._masks=void 0,this._data=void 0,this._assetCollection=null,this._masks=new Map,this._data=null}get data(){return this._data}dispose(){if(this._assetCollection=null,this._data=null,this._masks&&this._masks.size){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}}initialize(t){this._data=t}initializeAssetCollection(t){this.data&&(this._assetCollection=t,this.parseMasks(this.data,t))}parseMasks(t,e){if(t&&e&&t.masks&&t.masks.length){let s=0;for(;s<t.masks.length;){const i=t.masks[s];if(i){const t=i.id;if(this._masks.get(t))continue;const s=new Hy;if(i.visualizations&&i.visualizations.length){let t=0;for(;t<i.visualizations.length;){const r=i.visualizations[t];if(r){const t=r.size,i=s.createMaskVisualization(t);if(i){const n=this.parseMaskBitmaps(r.bitmaps,i,e);s.setAssetName(t,n)}}t++}}this._masks.set(t,s)}s++}}}parseMaskBitmaps(t,e,s){if(!t||!t.length)return null;let i=null;for(const r of t){if(!r)continue;const t=r.assetName,n=s.getAsset(t);if(!n)continue;let a=Gy.MIN_NORMAL_COORDINATE_VALUE,o=Gy.MAX_NORMAL_COORDINATE_VALUE,h=Gy.MIN_NORMAL_COORDINATE_VALUE,_=Gy.MAX_NORMAL_COORDINATE_VALUE;void 0!==r.normalMinX&&(a=r.normalMinX),void 0!==r.normalMaxX&&(o=r.normalMaxX),void 0!==r.normalMinY&&(h=r.normalMinY),void 0!==r.normalMaxY&&(_=r.normalMaxY),n.flipH||(i=t),e.addBitmap(n,a,o,h,_)}return i}updateMask(t,e,s,i,r,n){const a=this._masks.get(e);if(!a)return!0;const o=a.getGraphicAsset(s,i);if(!o)return!0;const h=o.texture;if(!h)return!0;const _=new j.g(r+o.offsetX,n+o.offsetY),d=new j.d;let u=1,c=1,l=0,g=0;return o.flipH&&(u=-1,l=-h.width),o.flipV&&(c=-1,g=-h.height),d.scale(u,c),d.translate(_.x+l,_.y+g),t.beginTextureFill({texture:h,matrix:d}).drawRect(d.tx,d.ty,h.width,h.height).endFill(),!0}getMask(t){return this._masks&&this._masks.size&&this._masks.get(t)||null}}class jy{constructor(t,e,s,i,r){this._x=void 0,this._y=void 0,this._speedX=void 0,this._speedY=void 0,this._bitmapData=void 0,this._x=t,this._y=e,this._speedX=s,this._speedY=i,this._bitmapData=r,isNaN(this._x)&&(this._x=0),isNaN(this._y)&&(this._y=0),isNaN(this._speedX)&&(this._speedX=0),isNaN(this._speedY)&&(this._speedY=0)}get bitmapData(){return this._bitmapData}dispose(){this._bitmapData=null}getPosition(t,e,s,i,r){let n=this._x,a=this._y;s>0&&(n+=this._speedX/s*r/1e3),i>0&&(a+=this._speedY/i*r/1e3);const o=n%1*t,h=a%1*e;return new j.g(o,h)}}class ky{constructor(t,e){if(this._color=0,this._bitmapData=null,this._isDisposed=!1,this._items=void 0,this._color=0,this._bitmapData=null,this._isDisposed=!1,this._items=[],t&&e)for(const s of t){if(!s)continue;const t=s.asset;if(t){const i=e.getAsset(t);i&&this._items.push(new jy(s.x,s.y,s.speedX,s.speedY,i))}}}get disposed(){return this._isDisposed}dispose(){if(this._isDisposed=!0,this._bitmapData&&(this._bitmapData.destroy(),this._bitmapData=null),this._items){for(const t of this._items)t&&t.dispose();this._items=[]}}clearCache(){this._bitmapData&&(this._bitmapData.destroy(),this._bitmapData=null)}render(t,e,s,i,r,n,a,o,h,_,d){if(null!=t&&t.width==e&&t.height==s||(null==this._bitmapData||this._bitmapData.width!=e||this._bitmapData.height!=s?(null!=this._bitmapData&&this._bitmapData.destroy(),this._bitmapData=(new Ve.a).drawRect(0,0,e,s)):this._bitmapData.beginFill(16777215).drawRect(0,0,this._bitmapData.width,this._bitmapData.height).endFill(),t=this._bitmapData),a>0&&o>0){let e=0;for(;e<this._items.length;){const s=this._items[e];if(null!=s){const e=s.getPosition(a,o,h,_,d);if(e.x=e.x-r,e.y=e.y-n,s.bitmapData)if(e.x>0&&e.x+s.bitmapData.width<t.width)t.beginFill(65280).beginTextureFill({texture:s.bitmapData.texture,matrix:new j.d(1,0,0,1,e.x,e.y)}).drawRect(e.x,e.y,s.bitmapData.width,s.bitmapData.height).endFill();else if(e.x>0){const i=t.width-e.x;t.beginFill(65280).beginTextureFill({texture:s.bitmapData.texture,matrix:new j.d(1,0,0,1,e.x,e.y)}).drawRect(e.x,e.y,i,s.bitmapData.height).endFill()}else{const i=s.bitmapData.width+e.x;t.beginFill(65280).beginTextureFill({texture:s.bitmapData.texture,matrix:new j.d(1,0,0,1,e.x,e.y)}).drawRect(0,e.y,i,s.bitmapData.height).endFill()}}e++}}return t}}class Yy{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._material=void 0,this._color=void 0,this._offset=void 0,this._align=void 0,this._bitmapData=void 0,this._isDisposed=void 0,this._material=t,this._offset=i,this._align=s,this._color=e,this._bitmapData=null,this._isDisposed=!1}get offset(){return this._offset}get align(){return this._align}get disposed(){return this._isDisposed}dispose(){this._isDisposed=!0,this._material=null,this.clearCache()}clearCache(){this._bitmapData&&(this._bitmapData.destroy(),this._bitmapData=null)}render(t,e,s,i,r,n,a){t&&t.width===e&&t.height===s||(t=null);let o=null;if(this._material)o=this._material.render(null,e,s,i,r,n,a+this.offset,this.align===Yy.ALIGN_TOP),o&&o!==t&&(this._bitmapData&&this._bitmapData.destroy(),this._bitmapData=o.clone(),o=this._bitmapData);else if(t)t.beginFill(16777215).drawRect(0,0,e,s).endFill(),o=t;else{if(this._bitmapData&&this._bitmapData.width===e&&this._bitmapData.height===s)return this._bitmapData;this._bitmapData&&this._bitmapData.destroy();const t=(new Ve.a).beginFill(16777215).drawRect(0,0,e,s).endFill();this._bitmapData=t,o=this._bitmapData}if(o&&(o.tint=this._color,t&&o!==t)){let i=oD.getTextureCache(o);i||(i=At.generateTexture(o,new j.j(0,0,e,s)),oD.addTextureCache(o,i)),t.beginTextureFill({texture:i}).drawRect(0,0,e,s).endFill(),o=t}return o}getMaterial(){return this._material}getColor(){return this._color}}Yy.DEFAULT_OFFSET=0,Yy.ALIGN_TOP=1,Yy.ALIGN_BOTTOM=2,Yy.ALIGN_DEFAULT=Yy.ALIGN_TOP;class zy{constructor(t,e,s){this._layers=void 0,this._geometry=void 0,this._cachedBitmapData=void 0,this._cachedBitmapNormal=void 0,this._isCached=void 0,this._hasAnimationLayers=void 0,this._layers=[],this._geometry=s,this._cachedBitmapData=null,this._cachedBitmapNormal=new dt,this._isCached=!1,this._hasAnimationLayers=!1,e<0&&(e=0);let i=0;for(;i<e;)this._layers.push(null),i++}get geometry(){return this._geometry}get hasAnimationLayers(){return this._hasAnimationLayers}dispose(){if(this._layers&&this._layers.length){for(const t of this._layers)t&&t.dispose();this._layers=null}this._geometry=null,this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&this._cachedBitmapNormal.assign(new dt),this._layers&&this._layers.length)for(const t of this._layers){if(!t)continue;t.clearCache()}this._isCached=!1}}setLayer(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(t<0||t>this._layers.length)return!1;let n=this._layers[t];return n&&n.dispose(),n=new Yy(e,s,i,r),this._layers[t]=n,!0}setAnimationLayer(t,e,s){if(t<0||t>this._layers.length)return!1;let i=this._layers[t];return i&&i.dispose(),i=new ky(e,s),this._layers[t]=i,this._hasAnimationLayers=!0,!0}getLayers(){return this._layers}render(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0;if(e<1&&(e=1),s<1&&(s=1),t&&t.width===e&&t.height===s||(t=null),this._cachedBitmapData)if(this._cachedBitmapData.width===e&&this._cachedBitmapData.height===s&&dt.isEqual(this._cachedBitmapNormal,i)){if(!this.hasAnimationLayers)return t?(t.addChild(this._cachedBitmapData),t):this._cachedBitmapData}else this._cachedBitmapData.destroy(),this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapData?this._cachedBitmapData.beginFill(16777215).drawRect(0,0,e,s).endFill():this._cachedBitmapData=(new Ve.a).beginFill(16777215).drawRect(0,0,e,s).endFill(),t||(t=this._cachedBitmapData),this._cachedBitmapNormal.assign(i),this._layers&&this._layers.length)for(const c of this._layers)c&&(c instanceof Yy?c.render(t,e,s,i,r,n,a):c instanceof ky&&c.render(t,e,s,i,n,a,o,h,_,d,u));return t&&t!==this._cachedBitmapData?(this._cachedBitmapData.addChild(t.clone()),t):this._cachedBitmapData}}class Wy{constructor(){this._planeVisualizations=void 0,this._sizes=void 0,this._lastPlaneVisualization=void 0,this._lastSize=void 0,this._planeVisualizations=new Map,this._sizes=[],this._lastPlaneVisualization=null,this._lastSize=-1}isStatic(t){return!0}dispose(){for(const t of this._planeVisualizations.values())t&&t.dispose();this._planeVisualizations=null,this._lastPlaneVisualization=null,this._sizes=null,this._lastSize=-1}clearCache(){for(const t of this._planeVisualizations.values())t&&t.clearCache()}createPlaneVisualization(t,e,s){if(this._planeVisualizations.get(t.toString()))return null;const i=new zy(t,e,s);return this._planeVisualizations.set(t.toString(),i),this._sizes.push(t),this._sizes.sort(),i}getSizeIndex(t){let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]-t<t-this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getPlaneVisualization(t){if(t===this._lastSize)return this._lastPlaneVisualization;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastPlaneVisualization=this._planeVisualizations.get(this._sizes[e].toString()):this._lastPlaneVisualization=null,this._lastSize=t,this._lastPlaneVisualization}getLayers(){return this.getPlaneVisualization(this._lastSize).getLayers()}}class Ky extends Wy{render(t,e,s,i,r,n,a,o){const h=this.getPlaneVisualization(i);if(!h||!h.geometry)return null;const _=h.geometry.getScreenPoint(new dt(0,0,0)),d=h.geometry.getScreenPoint(new dt(0,s/h.geometry.scale,0)),u=h.geometry.getScreenPoint(new dt(e/h.geometry.scale,0,0));let c=0,l=0;if(_&&d&&u){e=Math.round(Math.abs(_.x-u.x)),s=Math.round(Math.abs(_.x-d.x));const t=_.x-h.geometry.getScreenPoint(new dt(1,0,0)).x;c=a*Math.trunc(Math.abs(t)),l=o*Math.trunc(Math.abs(t))}return h.render(t,e,s,r,n,c,l)}}Ky.DEFAULT_COLOR=16777215,Ky.HORIZONTAL_ANGLE_DEFAULT=45,Ky.VERTICAL_ANGLE_DEFAULT=30;class Xy{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this._cells=void 0,this._repeatMode=void 0,this._width=void 0,this._cachedTexture=void 0,this._cachedBitmapData=void 0,this._cachedBitmapNormal=void 0,this._cachedBitmapDataOffsetX=void 0,this._cachedBitmapDataOffsetY=void 0,this._isCached=void 0,this._isStatic=void 0,this._cells=[],this._repeatMode=s,this._width=t<1?1:t,this._cachedBitmapData=null,this._cachedBitmapNormal=null,this._cachedBitmapDataOffsetX=0,this._cachedBitmapDataOffsetY=0,this._isCached=!1,this._isStatic=!0,e&&e.length){let t=0;for(;t<e.length;){const s=e[t];s&&(this._cells.push(s),s.isStatic||(this._isStatic=!1)),t++}}}get isStatic(){return this._isStatic}isRepeated(){return!(this._repeatMode===Xy.REPEAT_MODE_NONE)}get width(){return this._width}dispose(){if(this._cells&&this._cells.length){for(const t of this._cells)t&&t.dispose();this._cells=null}this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._cells&&this._cells.length)for(const t of this._cells)t&&t.clearCache();this._isCached=!1}}render(t,e,s,i){let r=0;if(this._repeatMode==Xy.REPEAT_MODE_NONE&&(r=this.getCellsHeight(this._cells,e),t=r),this._cachedBitmapNormal||(this._cachedBitmapNormal=new dt),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.height===t&&dt.isEqual(this._cachedBitmapNormal,e)&&this._cachedBitmapDataOffsetX===s&&this._cachedBitmapDataOffsetY===i)return this._cachedBitmapData;this._cachedBitmapData.destroy(),this._cachedBitmapData=null}}else this._cachedBitmapData&&(this._cachedBitmapData.height===t?this._cachedBitmapData.beginFill(16777215).drawRect(0,0,this._cachedBitmapData.width,t).endFill():(this._cachedBitmapData.destroy(),this._cachedBitmapData=null));if(this._isCached=!0,this._cachedBitmapData||(this._cachedBitmapData=(new Ve.a).beginFill(16777215).drawRect(0,0,this._width,t).endFill()),this._cachedBitmapNormal.assign(e),this._cachedBitmapDataOffsetX=s,this._cachedBitmapDataOffsetY=i,!this._cells.length)return this._cachedBitmapData;switch(this._repeatMode){case Xy.REPEAT_MODE_NONE:this.renderRepeatNone(e);break;case Xy.REPEAT_MODE_BORDERS:console.log("REPEAT_MODE_BORDERS");break;case Xy.REPEAT_MODE_CENTER:console.log("REPEAT_MODE_CENTER");break;case Xy.REPEAT_MODE_FIRST:console.log("REPEAT_MODE_FIRST");break;case Xy.REPEAT_MODE_LAST:console.log("REPEAT_MODE_LAST");break;default:this.renderRepeatAll(e,s,i)}return this._cachedBitmapData}getCellsHeight(t,e){if(!t||!t.length)return 0;let s=0,i=0;for(;i<t.length;){const r=t[i];r&&(s+=r.getHeight(e)),i++}return s}renderCells(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(!t||!t.length||!this._cachedBitmapData)return e;let a=0;for(;a<t.length;){let o=null;if(o=s?t[a]:t[t.length-1-a],o){const t=o.render(i,r,n);if(t&&(s||(e-=t.height),t.y=e,this._cachedBitmapData.addChild(t),s&&(e+=t.height),s&&e>=this._cachedBitmapData.height||!s&&e<=0))return e}a++}return e}renderRepeatNone(t){this._cells.length&&this._cachedBitmapData&&this.renderCells(this._cells,0,!0,t)}renderRepeatAll(t,e,s){if(!this._cells.length||!this._cachedBitmapData)return;let i=0;for(;i<this._cachedBitmapData.height;)if(i=this.renderCells(this._cells,i,!0,t,e,s),!i)return}getCells(){return this._cells}}Xy.REPEAT_MODE_NONE=0,Xy.REPEAT_MODE_ALL=1,Xy.REPEAT_MODE_BORDERS=2,Xy.REPEAT_MODE_CENTER=3,Xy.REPEAT_MODE_FIRST=4,Xy.REPEAT_MODE_LAST=5;class qy{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;this._columns=void 0,this._repeatMode=1,this._align=1,this._cachedBitmapData=void 0,this._cachedBitmapNormal=null,this._cachedBitmapHeight=0,this._isCached=!1,this._isStatic=!0,this._normalMinX=-1,this._normalMaxX=1,this._normalMinY=-1,this._normalMaxY=1,this._columns=[],t<1&&(t=1);let o=0;for(;o<t;)this._columns.push(null),o++;this._repeatMode=e,this._align=s,this._normalMinX=i,this._normalMaxX=r,this._normalMinY=n,this._normalMaxY=a,this._repeatMode==qy.REPEAT_MODE_RANDOM&&(this._isStatic=!1)}static nextRandomColumnIndex(t){return Fy.getValues(1,0,17631*t)[0]%t}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}isBottomAligned(){return this._align===qy.ALIGN_BOTTOM}get isStatic(){return this._isStatic}dispose(){this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData.destroy(),this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._columns&&this._columns.length)for(const t of this._columns)t&&t.clearCache();this._isCached=!1}}createColumn(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(t<0||t>=this._columns.length)return!1;const r=new Xy(e,s,i),n=this._columns[t];return n&&n.dispose(),this._columns[t]=r,r&&!r.isStatic&&(this._isStatic=!1),!0}render(t,e,s,i,r,n,a,o){if(e<1&&(e=1),s<1&&(s=1),t&&t.width===e&&t.height===s||(t=null),this._cachedBitmapNormal||(this._cachedBitmapNormal=new dt),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.width===e&&this._cachedBitmapData.height==s&&dt.isEqual(this._cachedBitmapNormal,i))return t?(this.copyCachedBitmapOnCanvas(t,this._cachedBitmapHeight,a,o),t):this._cachedBitmapData;this._cachedBitmapData.destroy(),this._cachedBitmapData=null}}else this._cachedBitmapData&&(this._cachedBitmapData.width===e&&this._cachedBitmapData.height===s?this._cachedBitmapData.beginFill(16777215).drawRect(0,0,e,s).endFill():(this._cachedBitmapData.destroy(),this._cachedBitmapData=null));if(this._isCached=!0,this._cachedBitmapNormal.assign(i),!r){if(this._cachedBitmapHeight=s,this._cachedBitmapData)this._cachedBitmapData.beginFill(16777215).drawRect(0,0,e,s).endFill();else{const t=(new Ve.a).beginFill(16777215).drawRect(0,0,e,s).endFill();this._cachedBitmapData=t}return t?(this.copyCachedBitmapOnCanvas(t,s,a,o),t):this._cachedBitmapData}if(!this._cachedBitmapData){this._cachedBitmapHeight=s;const t=(new Ve.a).beginFill(16777215).drawRect(0,0,e,s).endFill();this._cachedBitmapData=t}const h=[];let _=0;for(;_<this._columns.length;){const t=this._columns[_];if(t){const e=t.render(s,i,n,a);e&&h.push(e)}_++}if(!h.length)return t||this._cachedBitmapData;let d=0;switch(this._repeatMode){case qy.REPEAT_MODE_BORDERS:case qy.REPEAT_MODE_CENTER:case qy.REPEAT_MODE_FIRST:case qy.REPEAT_MODE_LAST:case qy.REPEAT_MODE_RANDOM:break;default:d=this.renderRepeatAll(this._cachedBitmapData,h)}return this._cachedBitmapHeight=d,t?(this.copyCachedBitmapOnCanvas(t,d,a,o),t):this._cachedBitmapData}copyCachedBitmapOnCanvas(t,e,s,i){if(!t||!this._cachedBitmapData||t===this._cachedBitmapData)return;let r;i||(s=t.height-e-s),r=this._align==qy.ALIGN_TOP?new j.j(0,0,this._cachedBitmapData.width,this._cachedBitmapHeight):new j.j(0,this._cachedBitmapData.height-this._cachedBitmapHeight,this._cachedBitmapData.width,this._cachedBitmapHeight);const n=At.generateTexture(this._cachedBitmapData,r);n&&t.beginTextureFill({texture:n}).drawRect(0,s,r.width,r.height).endFill()}getColumnsWidth(t){if(!t||!t.length)return 0;let e=0;for(const s of t)s&&(e+=s.width);return e}renderColumns(t,e,s,i){if(!t||!e||!e.length)return new j.g(s,0);let r=0,n=0;for(;n<e.length;){const a=i?e[n]:e[e.length-1-n];if(a){i||(s-=a.width);let e=0;this._align==qy.ALIGN_BOTTOM&&(e=t.height-a.height);let n=oD.getTextureCache(a);if(n||(n=At.generateTexture(a,new j.j(0,0,a.width,a.height)),oD.addTextureCache(a,n)),t.beginTextureFill({texture:n}),t.drawRect(s,e,n.width,n.height),t.endFill(),a.height>r&&(r=a.height),i&&(s+=a.width),i&&s>=t.width||!i&&s<=0)return new j.g(s,r)}n++}return new j.g(s,r)}renderRepeatAll(t,e){if(!t||!e||!e.length)return 0;this.getColumnsWidth(e);let s=0,i=0;for(;s<t.width;){const r=this.renderColumns(t,e,s,!0);if(s=r.x,r.y>i&&(i=r.y),!r.x)return i}return i}getColumns(t){if(this._repeatMode===qy.REPEAT_MODE_RANDOM){const e=[];let s=0;for(;s<t;){const t=this._columns[qy.nextRandomColumnIndex(this._columns.length)];if(t){if(e.push(t),!(t.width>1))break;s+=t.width}}return e}return this._columns}}qy.REPEAT_MODE_ALL=1,qy.REPEAT_MODE_BORDERS=2,qy.REPEAT_MODE_CENTER=3,qy.REPEAT_MODE_FIRST=4,qy.REPEAT_MODE_LAST=5,qy.REPEAT_MODE_RANDOM=6,qy.REPEAT_MODE_DEFAULT=qy.REPEAT_MODE_ALL,qy.MIN_NORMAL_COORDINATE_VALUE=-1,qy.MAX_NORMAL_COORDINATE_VALUE=1,qy.ALIGN_TOP=1,qy.ALIGN_BOTTOM=2,qy.ALIGN_DEFAULT=qy.ALIGN_TOP;class Qy{constructor(){this._planeMaterialItems=void 0,this._isCached=void 0,this._planeMaterialItems=[],this._isCached=!1}dispose(){if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const t of this._planeMaterialItems)t&&t.dispose();this._planeMaterialItems=null}this._isCached=!1}clearCache(){if(this._isCached){if(this._planeMaterialItems&&this._planeMaterialItems.length)for(const t of this._planeMaterialItems)t&&t.clearCache();this._isCached=!1}}addMaterialCellMatrix(t,e,s){const i=new qy(t,e,s,arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,arguments.length>6&&void 0!==arguments[6]?arguments[6]:1);return this._planeMaterialItems.push(i),i}getMaterialCellMatrix(t){if(!t)return null;if(this._planeMaterialItems&&this._planeMaterialItems.length)for(const e of this._planeMaterialItems)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e;return null}render(t,e,s,i,r,n,a,o){e<1&&(e=1),s<1&&(s=1);const h=this.getMaterialCellMatrix(i);return h?(this._isCached=!0,h.render(t,e,s,i,r,n,a,o)):null}}Qy.MIN_NORMAL_COORDINATE_VALUE=-1,Qy.MAX_NORMAL_COORDINATE_VALUE=1;class Zy{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(this._cachedSprite=void 0,this._texture=void 0,this._extraItemOffsets=void 0,this._extraItemAssets=void 0,this._extraItemCount=0,this._cachedSprite=null,this._texture=t,this._extraItemOffsets=[],this._extraItemAssets=[],this._extraItemCount=0,e&&e.length&&i>0){let t=0;for(;t<e.length;){const s=e[t];s&&this._extraItemAssets.push(s),t++}if(this._extraItemAssets.length){if(s){let t=0;for(;t<s.length;){const e=s[t];e&&this._extraItemOffsets.push(new j.g(e.x,e.y)),t++}}this._extraItemCount=i}}}get isStatic(){return 0==this._extraItemCount}dispose(){this._texture&&(this._texture.dispose(),this._texture=null),this._cachedSprite&&(this._cachedSprite.destroy(),this._cachedSprite=null),this._extraItemAssets=null,this._extraItemOffsets=null,this._extraItemCount=0}clearCache(){this._cachedSprite&&(this._cachedSprite.destroy(),this._cachedSprite=null)}getHeight(t){if(this._texture){const e=this._texture.getBitmap(t);if(e)return e.height}return 0}render(t,e,s){if(!this._texture)return null;const i=this._texture.getBitmap(t);if(!i)return null;const r=new W(i);if(0!==e||0!==s){for(;e<0;)e+=i.width;for(;s<0;)s+=i.height;r.x=e%i.width,r.y=s%i.height,e&&(r.anchor.x=1,r.scale.x=-1),s&&(r.anchor.y=1,r.scale.y=-1)}if(r){if(!this.isStatic){this._cachedSprite&&(this._cachedSprite.width===r.width&&this._cachedSprite.height===r.height||(this._cachedSprite.destroy(),this._cachedSprite=null)),this._cachedSprite||(this._cachedSprite=new W(i));const t=Math.min(this._extraItemCount,this._extraItemOffsets.length),e=Math.max(this._extraItemCount,this._extraItemOffsets.length),s=Fy.getArray(this._extraItemCount,e);let n=0;for(;n<t;){const t=this._extraItemOffsets[s[n]],e=this._extraItemAssets[n%this._extraItemAssets.length];if(t&&e){const s=e.texture;if(s){const i=new j.g(t.x+e.offsetX,t.y+e.offsetY),r=new j.d;let n=1,a=1,o=0,h=0;e.flipH&&(n=-1,o=s.width),e.flipV&&(a=-1,h=s.height);let _=i.x+o;_=_>>1<<1,r.scale(n,a),r.translate(_,i.y+h);const d=new W(s);d.transform.setFromMatrix(r),d.x=r.tx,d.y=r.ty,this._cachedSprite.addChild(d)}}n++}return this._cachedSprite}return r}return null}getAssetName(t){return null==this._texture?null:this._texture.getAssetName(t)}}class Jy{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this._bitmap=void 0,this._normalMinX=void 0,this._normalMaxX=void 0,this._normalMinY=void 0,this._normalMaxY=void 0,this._assetName=void 0,this._normalMinX=e,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=r,this._assetName=n,this._bitmap=t}get bitmap(){return this._bitmap}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}get assetName(){return this._assetName}dispose(){this._bitmap=null}}Jy.MIN_NORMAL_COORDINATE_VALUE=-1,Jy.MAX_NORMAL_COORDINATE_VALUE=1;class $y{constructor(){this._bitmaps=void 0,this._bitmaps=[]}dispose(){if(this._bitmaps){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}}addBitmap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this._bitmaps.push(new Jy(t,e,s,i,r,n))}getBitmap(t){const e=this.getPlaneTextureBitmap(t);return e?e.bitmap:null}getPlaneTextureBitmap(t){if(!t)return null;for(const e of this._bitmaps)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e;return null}getAssetName(t){const e=this.getPlaneTextureBitmap(t);return e?e.assetName:null}}$y.MIN_NORMAL_COORDINATE_VALUE=-1,$y.MAX_NORMAL_COORDINATE_VALUE=1;class tD{constructor(){this._assetCollection=void 0,this._materials=void 0,this._textures=void 0,this._planes=void 0,this._geometries=void 0,this._data=void 0,this._assetCollection=null,this._textures=new Map,this._materials=new Map,this._planes=new Map,this._geometries=new Map,this._data=null}get data(){return this._data}get assetCollection(){return this._assetCollection}initializeDimensions(t,e){return!0}dispose(){if(this._planes){for(const t of this._planes.values())t&&t.dispose();this._planes=null}if(this._materials&&(this.resetMaterials(),this._materials=null),this._textures&&(this.resetTextures(),this._textures=null),this._geometries){for(const t of this._geometries.values())t&&t.dispose();this._geometries=null}this._data=null,this._assetCollection=null}clearCache(){for(const t of this._planes.values())t&&t.clearCache();for(const t of this._materials.values())t&&t.clearCache()}initialize(t){this._data=t}reinitialize(){this.resetTextures(),this.resetMaterials(),this.initializeAll()}resetMaterials(){for(const t of this._materials.values())t&&t.dispose();this._materials.clear()}resetTextures(){for(const t of this._textures.values())t&&t.dispose();this._textures.clear()}getTexture(t){return this._textures.get(t)}getMaterial(t){return this._materials.get(t)}getPlane(t){return this._planes.get(t)}addPlane(t,e){if(!e)return!1;return!this._planes.get(t)&&(this._planes.set(t,e),!0)}initializeAssetCollection(t){this._data&&(this._assetCollection=t,this.initializeAll())}initializeAll(){this._data&&(this.initializeTexturesAndMaterials(),this.initializePlanes())}initializeTexturesAndMaterials(){this._data.textures&&this._data.textures.length&&this.parseTextures(this._data.textures,this.assetCollection),this._data.materials&&this._data.materials.length&&this.parsePlaneMaterials(this._data.materials)}initializePlanes(){}parseTextures(t,e){if(t&&e&&t.length)for(const s of t){if(!s)continue;const t=s.id;if(!this._textures.get(t)){const i=new $y;if(s.bitmaps&&s.bitmaps.length)for(const t of s.bitmaps){if(!t)continue;const s=t.assetName;let r=$y.MIN_NORMAL_COORDINATE_VALUE,n=$y.MAX_NORMAL_COORDINATE_VALUE,a=$y.MIN_NORMAL_COORDINATE_VALUE,o=$y.MAX_NORMAL_COORDINATE_VALUE;void 0!==t.normalMinX&&(r=t.normalMinX),void 0!==t.normalMaxX&&(n=t.normalMaxX),void 0!==t.normalMinY&&(a=t.normalMinY),void 0!==t.normalMaxY&&(o=t.normalMaxY);const h=e.getAsset(s);if(h){const t=h.texture;if(t){let e=t;h.flipH&&(e=je.getFlipHBitmapData(t)),i.addBitmap(e,r,n,a,o,s)}}}this._textures.set(t,i)}}}parsePlaneMaterials(t){if(t&&t.length)for(const e of t){if(!e)continue;const t=e.id,s=new Qy;if(e.matrices&&e.matrices.length)for(const i of e.matrices){if(!i)continue;let t=i.repeatMode,e=i.align;const r=qy.MIN_NORMAL_COORDINATE_VALUE,n=qy.MAX_NORMAL_COORDINATE_VALUE,a=qy.MIN_NORMAL_COORDINATE_VALUE,o=qy.MAX_NORMAL_COORDINATE_VALUE;switch(t){case"borders":t=qy.REPEAT_MODE_BORDERS;break;case"center":t=qy.REPEAT_MODE_CENTER;break;case"first":t=qy.REPEAT_MODE_FIRST;break;case"last":t=qy.REPEAT_MODE_LAST;break;case"random":t=qy.REPEAT_MODE_RANDOM;break;default:t=qy.REPEAT_MODE_DEFAULT}switch(e){case"top":e=qy.ALIGN_TOP;break;case"bottom":e=qy.ALIGN_BOTTOM;break;default:e=qy.ALIGN_DEFAULT}if(i.columns&&i.columns.length){const h=s.addMaterialCellMatrix(i.columns.length,t,e,r,n,a,o);let _=0;for(;_<i.columns.length;){const t=i.columns[_];t&&this.parsePlaneMaterialCellColumn(t,h,_),_++}}}this._materials.set(t,s)}}parsePlaneMaterialCellColumn(t,e,s){if(!t||!e)return;let i=Xy.REPEAT_MODE_ALL;const r=t.width,n=this.parsePlaneMaterialCells(t);switch(t.repeatMode){case"borders":i=Xy.REPEAT_MODE_BORDERS;break;case"center":i=Xy.REPEAT_MODE_CENTER;break;case"first":i=Xy.REPEAT_MODE_FIRST;break;case"last":i=Xy.REPEAT_MODE_LAST;break;case"none":i=Xy.REPEAT_MODE_NONE;break;default:i=Xy.REPEAT_MODE_ALL}e.createColumn(s,r,n,i)}parsePlaneMaterialCells(t){if(!t||!t.cells||!t.cells.length)return null;const e=[];let s=0;for(;s<t.cells.length;){const i=t.cells[s];if(i){const t=i.textureId;let s=null,r=null,n=null,a=0;if(i.extras&&i.extras.length){const t=i.extras[0],e=t.types,n=t.offsets;if(e&&n&&e.length&&n.length){const i=e[0],o=n[0];s=this.parseExtraItemTypes(i),r=this.parseExtraItemOffsets(o),a=r.length,t.limitMax&&(a=t.limitMax)}}if(s&&s.length){n=[];for(const t of s){if(!t)continue;const e=this._assetCollection.getAsset(t);e&&n.push(e)}}const o=this.getTexture(t),h=new Zy(o,n,r,a);e.push(h)}s++}return e&&e.length?e:null}parseExtraItemTypes(t){const e=[];if(t&&t.types&&t.types.length){let s=0;for(;s<t.types.length;){const i=t.types[s].assetName;i&&e.push(i),s++}}return e}parseExtraItemOffsets(t){const e=[];if(t&&t.offsets&&t.offsets.length){let s=0;for(;s<t.offsets.length;){const i=t.offsets[s],r=i.x,n=i.y;e.push(new j.g(r,n)),s++}}return e}getGeometry(t,e,s){(e=Math.abs(e))>90&&(e=90),(s=Math.abs(s))>90&&(s=90);const i=`${t}_${Math.round(e)}_${Math.round(s)}`;let r=this._geometries.get(i);return r||(r=new Ye(t,new dt(e,s),new dt(-10,0,0)),this._geometries.set(i,r),r)}parseVisualizations(t,e){if(t&&e&&e&&e.length)for(const s of e){if(!s)continue;const e=s.size;let i=Ky.HORIZONTAL_ANGLE_DEFAULT,r=Ky.VERTICAL_ANGLE_DEFAULT;s.horizontalAngle&&(i=s.horizontalAngle),s.verticalAngle&&(r=s.verticalAngle);const n=s.layers,a=t.createPlaneVisualization(e,n&&n.length||0,this.getGeometry(e,i,r));if(a&&n&&n.length){let t=0;for(;t<n.length;){const e=n[t];if(e){let s=null,i=Yy.ALIGN_DEFAULT,r=Ky.DEFAULT_COLOR,n=Yy.DEFAULT_OFFSET;e.materialId&&(s=this.getMaterial(e.materialId)),e.color&&(r=e.color),e.offset&&(n=e.offset),e.align&&("bottom"===e.align?i=Yy.ALIGN_BOTTOM:"top"==e.align&&(i=Yy.ALIGN_TOP)),a.setLayer(t,s,r,i,n)}t++}}}}render(t,e,s,i,r,n,a){return null}getTextureIdentifier(t,e){return t.toString()}getLayers(t){let e=this.getPlane(t);return e||(e=this.getPlane(tD.DEFAULT)),e.getLayers()}}tD.DEFAULT="default";class eD extends Wy{constructor(){super(...arguments),this._width=0,this._height=0}isStatic(t){const e=this.getPlaneVisualization(t);return e?!e.hasAnimationLayers:super.isStatic(t)}initializeDimensions(t,e){t<0&&(t=0),e<0&&(e=0),t===this._width&&e===this._height||(this._width=t,this._height=e)}render(t,e,s,i,r,n,a,o,h,_,d){const u=this.getPlaneVisualization(i);if(!u||!u.geometry)return null;const c=u.geometry.getScreenPoint(new dt(0,0,0)),l=u.geometry.getScreenPoint(new dt(0,0,1)),g=u.geometry.getScreenPoint(new dt(0,1,0));if(c&&l&&g){e=Math.round(Math.abs((c.x-g.x)*e/u.geometry.scale)),s=Math.round(Math.abs((c.y-l.y)*s/u.geometry.scale));const i=a*Math.abs(c.x-g.x),E=o*Math.abs(c.y-l.y),p=h*Math.abs(c.x-g.x),m=_*Math.abs(c.y-l.y);return u.render(t,e,s,r,n,i,E,p,m,h,_,d)}return null}}eD.DEFAULT_COLOR=16777215,eD.HORIZONTAL_ANGLE_DEFAULT=45,eD.VERTICAL_ANGLE_DEFAULT=30;class sD extends tD{constructor(){super(...arguments),this._landscapeWidth=0,this._landscapeHeight=0}initializeDimensions(t,e){return t<0&&(t=0),e<0&&(e=0),this._landscapeWidth=t,this._landscapeHeight=e,!0}initializePlanes(){if(!this.data)return;const t=this.data.landscapes;t&&t.length&&this.parseLandscapes(t)}parseLandscapes(t){if(!t)return;const e=Math.trunc(654321*Math.random());for(const s in t){const i=t[s];if(!i)continue;const r=i.id,n=i.animatedVisualizations,a=new eD;for(const t of n){if(!t)continue;const s=t.size;let i=eD.HORIZONTAL_ANGLE_DEFAULT,r=eD.VERTICAL_ANGLE_DEFAULT;t.horizontalAngle&&(i=t.horizontalAngle),t.verticalAngle&&(r=t.verticalAngle);const n=t.layers,o=t.animationLayers,h=n&&n.length||0,_=o&&o.length||0,d=h+_,u=a.createPlaneVisualization(s,d||0,this.getGeometry(s,i,r));if(u){Fy.setSeed(e);let t=0;if(h)for(;t<n.length;){const e=n[t];if(e){let s=null,i=Yy.ALIGN_DEFAULT,r=eD.DEFAULT_COLOR,n=Yy.DEFAULT_OFFSET;e.materialId&&(s=this.getMaterial(e.materialId)),e.color&&(r=e.color),e.offset&&(n=e.offset),e.align&&("bottom"===e.align?i=Yy.ALIGN_BOTTOM:"top"===e.align&&(i=Yy.ALIGN_TOP)),u.setLayer(t,s,r,i,n)}t++}if(t=0,_){const e=[];for(;t<o.length;){const s=o[t];if(s){const t=s.animationItems;if(t&&t.length)for(const s of t)if(s){s.id;const t=s.assetId,i=this.getCoordinateValue(s.x||"",s.randomX||""),r=this.getCoordinateValue(s.y||"",s.randomY||""),n=s.speedX?s.speedX/SU.instance.getConfiguration("system.animation.fps"):0,a=s.speedY?s.speedY/SU.instance.getConfiguration("system.animation.fps"):0;e.push({asset:t,x:i,y:r,speedX:n,speedY:a})}}t++}u.setAnimationLayer(t,e,this.assetCollection)}}}this.addPlane(r,a)||a.dispose()}}getCoordinateValue(t,e){let s=0;if(t.length>0&&"%"===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1),s=parseFloat(t)/100),e.length>0){const t=1e4,i=Fy.getValues(1,0,t)[0]/t;"%"===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1),s+=i*parseFloat(e)/100)}return s}render(t,e,s,i,r,n,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,c=this.getPlane(e);if(c||(c=this.getPlane(sD.DEFAULT)),!c)return null;t&&t.clear();let l=c.render(t,s,i,r,n,a,o,h,_,d,u);if(l&&l!==t&&(l=l.clone(),!l))return null;let g=null;return g=!c.isStatic(r)&&sD.UPDATE_INTERVAL>0?new wy(l,Math.round(u/sD.UPDATE_INTERVAL)*sD.UPDATE_INTERVAL+sD.UPDATE_INTERVAL):new wy(l,-1),g}getTextureIdentifier(t,e){return e?e.x<0?t+"_0":t+"_1":super.getTextureIdentifier(t,e)}}sD.UPDATE_INTERVAL=500;class iD extends tD{initializePlanes(){if(!this.data)return;const t=this.data.floors;t&&t.length&&this.parseFloors(t)}parseFloors(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id,r=s.visualizations,n=new Ky;this.parseVisualizations(n,r),this.addPlane(i,n)||n.dispose()}}render(t,e,s,i,r,n,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,_=this.getPlane(e);if(_||(_=this.getPlane(tD.DEFAULT)),!_)return null;t&&t.clear();let d=_.render(t,s,i,r,n,a,o,h);return d&&d!==t&&(d=d.clone(),!d)?null:new wy(d,-1)}}class rD extends Wy{render(t,e,s,i,r,n){const a=this.getPlaneVisualization(i);if(!a||!a.geometry)return null;const o=a.geometry.getScreenPoint(new dt(0,0,0)),h=a.geometry.getScreenPoint(new dt(0,0,s/a.geometry.scale)),_=a.geometry.getScreenPoint(new dt(0,e/a.geometry.scale,0));return o&&h&&_&&(e=Math.round(Math.abs(o.x-_.x)),s=Math.round(Math.abs(o.y-h.y))),a.render(t,e,s,r,n)}}rD.DEFAULT_COLOR=16777215,rD.HORIZONTAL_ANGLE_DEFAULT=45,rD.VERTICAL_ANGLE_DEFAULT=30;class nD extends tD{initializePlanes(){if(!this.data)return;const t=this.data.walls;t&&t.length&&this.parseWalls(t)}parseWalls(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id,r=s.visualizations,n=new rD;this.parseVisualizations(n,r),this.addPlane(i,n)||n.dispose()}}render(t,e,s,i,r,n,a){let o=this.getPlane(e);if(o||(o=this.getPlane(tD.DEFAULT)),!o)return null;if(t){const e=t.getBounds();t.clear(),t.drawRect(e.x,e.y,e.width,e.height)}let h=o.render(t,s,i,r,n,a);return h&&h!==t&&(h=h.clone(),!h)?null:new wy(h,-1)}getTextureIdentifier(t,e){return e?`${t}_${e.x}_${e.y}_${e.z}`:super.getTextureIdentifier(t,e)}}class aD extends c{constructor(){super(),this._wallRasterizer=void 0,this._floorRasterizer=void 0,this._landscapeRasterizer=void 0,this._maskManager=void 0,this._initialized=void 0,this._wallRasterizer=new nD,this._floorRasterizer=new iD,this._landscapeRasterizer=new sD,this._maskManager=new Vy,this._initialized=!1}initialize(t){const e=t.wallData;e&&this._wallRasterizer.initialize(e);const s=t.floorData;s&&this._floorRasterizer.initialize(s);const i=t.landscapeData;i&&this._landscapeRasterizer.initialize(i);const r=t.maskData;return r&&this._maskManager.initialize(r),!0}onDispose(){this._wallRasterizer&&(this._wallRasterizer.dispose(),this._wallRasterizer=null),this._floorRasterizer&&(this._floorRasterizer.dispose(),this._floorRasterizer=null),this._landscapeRasterizer&&(this._landscapeRasterizer.dispose(),this._landscapeRasterizer=null),this._maskManager&&(this._maskManager.dispose(),this._maskManager=null),super.onDispose()}setGraphicAssetCollection(t){this._initialized||(this._wallRasterizer.initializeAssetCollection(t),this._floorRasterizer.initializeAssetCollection(t),this._landscapeRasterizer.initializeAssetCollection(t),this._maskManager.initializeAssetCollection(t),this._initialized=!0)}clearCache(){this._wallRasterizer&&this._wallRasterizer.clearCache(),this._floorRasterizer&&this._floorRasterizer.clearCache(),this._landscapeRasterizer&&this._landscapeRasterizer.clearCache()}get wallRasterizer(){return this._wallRasterizer}get floorRasterizer(){return this._floorRasterizer}get landscapeRasterizer(){return this._landscapeRasterizer}get maskManager(){return this._maskManager}}class oD extends xe{constructor(){super(),this._data=void 0,this._roomPlaneParser=void 0,this._roomPlaneBitmapMaskParser=void 0,this._geometryUpdateId=void 0,this._boundingRectangle=void 0,this._directionX=void 0,this._directionY=void 0,this._directionZ=void 0,this._floorThickness=void 0,this._wallThickness=void 0,this._holeUpdateTime=void 0,this._planes=void 0,this._visiblePlanes=void 0,this._visiblePlaneSpriteNumbers=void 0,this._roomScale=void 0,this._lastUpdateTime=void 0,this._updateIntervalTime=void 0,this._wallType=void 0,this._floorType=void 0,this._landscapeType=void 0,this._colorBackgroundOnly=void 0,this._color=void 0,this._redColor=void 0,this._greenColor=void 0,this._blueColor=void 0,this._typeVisibility=void 0,this._assetUpdateCounter=void 0,this._maskData=void 0,this._isPlaneSet=void 0,this._data=null,this._roomPlaneParser=new jh,this._roomPlaneBitmapMaskParser=new Ly,this._geometryUpdateId=-1,this._directionX=0,this._directionY=0,this._directionZ=0,this._floorThickness=1,this._wallThickness=1,this._holeUpdateTime=NaN,this._planes=[],this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],this._roomScale=0,this._lastUpdateTime=-1e3,this._updateIntervalTime=250,this._wallType=null,this._floorType=null,this._landscapeType=null,this._colorBackgroundOnly=!0,this._color=16777215,this._redColor=255,this._greenColor=255,this._blueColor=255,this._typeVisibility=[],this._assetUpdateCounter=0,this._maskData=null,this._isPlaneSet=!1,this._typeVisibility[xy.TYPE_UNDEFINED]=!1,this._typeVisibility[xy.TYPE_FLOOR]=!0,this._typeVisibility[xy.TYPE_WALL]=!0,this._typeVisibility[xy.TYPE_LANDSCAPE]=!0}static getTextureCache(t){const e=oD.RENDER_TEXTURE_CACHE.get(oD.LAST_VISUALIZATION);return e?e.getValue(t):null}static addTextureCache(t,e){if(!oD.LAST_VISUALIZATION)return;let s=oD.RENDER_TEXTURE_CACHE.get(oD.LAST_VISUALIZATION);s||(s=new U,oD.RENDER_TEXTURE_CACHE.set(oD.LAST_VISUALIZATION,s)),s.add(t,e)}initialize(t){return t instanceof aD&&(this._data=t,super.initialize(t),this._data.setGraphicAssetCollection(this.asset),!0)}dispose(){super.dispose(),this.clearPlanes(),this._planes=null,this._visiblePlanes=null,this._visiblePlaneSpriteNumbers=null,this._roomPlaneParser&&(this._roomPlaneParser.dispose(),this._roomPlaneParser=null),this._roomPlaneBitmapMaskParser&&(this._roomPlaneBitmapMaskParser.dispose(),this._roomPlaneBitmapMaskParser=null),this._data&&(this._data.clearCache(),this._data=null);const t=oD.RENDER_TEXTURE_CACHE.get(this);if(t){for(const e of t.getValues())e.destroy(!0);t.dispose(),oD.RENDER_TEXTURE_CACHE.delete(this)}}reset(){super.reset(),this._floorType=null,this._wallType=null,this._landscapeType=null,this._maskData=null,this._geometryUpdateId=-1,this._roomScale=0}update(t,e,s,i){if(!this.object||!t)return;oD.LAST_VISUALIZATION=this;let r=0;const n=oD.RENDER_TEXTURE_CACHE.get(oD.LAST_VISUALIZATION);n&&(r=n.length);const a=this.updateGeometry(t),o=this.object.model;let h=!1;if(this.updateThickness(o)&&(h=!0),this.updateHole(o)&&(h=!0),this.initializeRoomPlanes()&&n&&r&&setTimeout((()=>{for(;r;){const t=n.getWithIndex(0);t&&(t.destroy(!0),n.remove(n.getKey(0))),r--}}),0),h=this.updateMasks(o),!(e<this._lastUpdateTime+this._updateIntervalTime)||a||h){if(this.updatePlaneTexturesAndVisibilities(o)&&(h=!0),this.updatePlanes(t,a,e)&&(h=!0),h){let t=0;for(;t<this._visiblePlanes.length;){const e=this._visiblePlaneSpriteNumbers[t],s=this.getSprite(e),i=this._visiblePlanes[t];if(s&&i&&i.type!==xy.TYPE_LANDSCAPE)if(this._colorBackgroundOnly){let t=i.color;const e=(255&t)*this._redColor/255,r=(t>>8&255)*this._greenColor/255;t=(t>>24<<24)+((t>>16&255)*this._blueColor/255<<16)+(r<<8)+e,s.color=t}else s.color=i.color;t++}this.updateSpriteCounter++}this.updateModelCounter=o.updateCounter,this._lastUpdateTime=e}}updateGeometry(t){if(!t)return!1;if(this._geometryUpdateId===t.updateId)return!1;this._geometryUpdateId=t.updateId,this._boundingRectangle=null;const e=t.direction;return!(!e||e.x===this._directionX&&e.y===this._directionY&&e.z===this._directionZ&&t.scale===this._roomScale)&&(this._directionX=e.x,this._directionY=e.y,this._directionZ=e.z,this._roomScale=t.scale,!0)}updateThickness(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(rt.ROOM_FLOOR_THICKNESS),s=t.getValue(rt.ROOM_WALL_THICKNESS);return!(isNaN(e)||isNaN(s)||e===this._floorThickness&&s===this._wallThickness)&&(this._floorThickness=e,this._wallThickness=s,this.clearPlanes(),!0)}updateHole(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(rt.ROOM_FLOOR_HOLE_UPDATE_TIME);return!isNaN(e)&&e!==this._holeUpdateTime&&(this._holeUpdateTime=e,this.clearPlanes(),!0)}updateMasks(t){if(this.updateModelCounter===t.updateCounter)return!1;let e=!1;const s=t.getValue(rt.ROOM_PLANE_MASK_XML);s!==this._maskData&&(this.updatePlaneMasks(s),this._maskData=s,e=!0);const i=t.getValue(rt.ROOM_BACKGROUND_COLOR);i!==this._color&&(this._color=i,this._redColor=255&this._color,this._greenColor=this._color>>8&255,this._blueColor=this._color>>16&255,e=!0);const r=t.getValue(rt.ROOM_COLORIZE_BG_ONLY)||!1;return r!==this._colorBackgroundOnly&&(this._colorBackgroundOnly=r,e=!0),e}updatePlaneTexturesAndVisibilities(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(rt.ROOM_FLOOR_TYPE),s=t.getValue(rt.ROOM_WALL_TYPE),i=t.getValue(rt.ROOM_LANDSCAPE_TYPE);this.updatePlaneTypes(e,s,i);const r=1===t.getValue(rt.ROOM_FLOOR_VISIBILITY),n=1===t.getValue(rt.ROOM_WALL_VISIBILITY),a=1===t.getValue(rt.ROOM_LANDSCAPE_VISIBILITY);return this.updatePlaneVisibility(r,n,a),!0}clearPlanes(){if(this._planes){for(;this._planes.length;){const t=this._planes[0];t&&t.dispose(),this._planes.pop()}this._planes=[],this._planes=[]}this._isPlaneSet=!1,this._assetUpdateCounter=this._assetUpdateCounter+1,this.reset()}initializeRoomPlanes(){if(!this.object||this._isPlaneSet)return!1;isNaN(this._floorThickness)||(this._roomPlaneParser.floorThicknessMultiplier=this._floorThickness),isNaN(this._wallThickness)||(this._roomPlaneParser.wallThicknessMultiplier=this._wallThickness);const t=this.object.model.getValue(rt.ROOM_MAP_DATA);if(!this._roomPlaneParser.initializeFromMapData(t))return;const e=this.getLandscapeWidth(),s=this.getLandscapeHeight();let i=0,r=this.object.model.getValue(rt.ROOM_RANDOM_SEED),n=0;for(;n<this._roomPlaneParser.planeCount;){const t=this._roomPlaneParser.getPlaneLocation(n),a=this._roomPlaneParser.getPlaneLeftSide(n),o=this._roomPlaneParser.getPlaneRightSide(n),h=this._roomPlaneParser.getPlaneSecondaryNormals(n),_=this._roomPlaneParser.getPlaneType(n);let d=null;if(!(t&&a&&o))return;{const u=dt.crossProduct(a,o);if(r=7613*r+517,d=null,_===Hh.PLANE_FLOOR){const e=t.x+a.x+.5,s=t.y+o.y+.5,i=Math.trunc(e)-e,n=Math.trunc(s)-s;d=new xy(this.object.getLocation(),t,a,o,xy.TYPE_FLOOR,!0,h,r,-i,-n),0!==u.z?d.color=oD.FLOOR_COLOR:d.color=0!==u.x?oD.FLOOR_COLOR_RIGHT:oD.FLOOR_COLOR_LEFT,this._data&&(d.rasterizer=this._data.floorRasterizer)}else _===Hh.PLANE_WALL?(d=new xy(this.object.getLocation(),t,a,o,xy.TYPE_WALL,!0,h,r),(a.length<1||o.length<1)&&(d.hasTexture=!1),0===u.x&&0===u.y?d.color=oD.WALL_COLOR_BORDER:u.y>0?d.color=oD.WALL_COLOR_TOP:0===u.y?d.color=oD.WALL_COLOR_SIDE:d.color=oD.WALL_COLOR_BOTTOM,this._data&&(d.rasterizer=this._data.wallRasterizer)):_===Hh.PLANE_LANDSCAPE?(d=new xy(this.object.getLocation(),t,a,o,xy.TYPE_LANDSCAPE,!0,h,r,i,0,e,s),u.y>0?d.color=oD.LANDSCAPE_COLOR_TOP:0==u.y?d.color=oD.LANDSCAPE_COLOR_SIDE:d.color=oD.LANDSCAPE_COLOR_BOTTOM,this._data&&(d.rasterizer=this._data.landscapeRasterizer),i+=a.length):_==Hh.PLANE_BILLBOARD&&(d=new xy(this.object.getLocation(),t,a,o,xy.TYPE_WALL,!0,h,r),(a.length<1||o.length<1)&&(d.hasTexture=!1),0==u.x&&0==u.y?d.color=oD.WALL_COLOR_BORDER:u.y>0?d.color=oD.WALL_COLOR_TOP:0==u.y?d.color=oD.WALL_COLOR_SIDE:d.color=oD.WALL_COLOR_BOTTOM);if(d){d.maskManager=this._data.maskManager;let t=0;for(;t<this._roomPlaneParser.getPlaneMaskCount(n);){const e=this._roomPlaneParser.getPlaneMaskLeftSideLoc(n,t),s=this._roomPlaneParser.getPlaneMaskRightSideLoc(n,t),i=this._roomPlaneParser.getPlaneMaskLeftSideLength(n,t),r=this._roomPlaneParser.getPlaneMaskRightSideLength(n,t);d.addRectangleMask(e,s,i,r),t++}this._planes.push(d)}}n++}return this._isPlaneSet=!0,this.defineSprites(),!0}defineSprites(){this.createSprites(this._planes.length);let t=0;for(;t<this._planes.length;){const e=this._planes[t],s=this.getSprite(t);e&&s&&e.leftSide&&e.rightSide&&(e.type===xy.TYPE_WALL&&(e.leftSide.length<1||e.rightSide.length<1)?s.alphaTolerance=Pe.MATCH_NOTHING:s.alphaTolerance=Pe.MATCH_OPAQUE_PIXELS,e.type===xy.TYPE_WALL?s.tag="plane.wall@"+(t+1):e.type===xy.TYPE_FLOOR?s.tag="plane.floor@"+(t+1):s.tag="plane@"+(t+1),s.spriteType=be.ROOM_PLANE),t++}}getLandscapeWidth(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===Hh.PLANE_LANDSCAPE){t+=this._roomPlaneParser.getPlaneLeftSide(e).length}e++}return t}getLandscapeHeight(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===Hh.PLANE_LANDSCAPE){const s=this._roomPlaneParser.getPlaneRightSide(e);s.length>t&&(t=s.length)}e++}return t>5&&(t=5),t}updatePlaneTypes(t,e,s){if(t!==this._floorType?this._floorType=t:t=null,e!==this._wallType?this._wallType=e:e=null,s!==this._landscapeType?this._landscapeType=s:s=null,!t&&!e&&!s)return!1;let i=0;for(;i<this._planes.length;){const r=this._planes[i];r&&(r.type===xy.TYPE_FLOOR&&t?r.id=t:r.type===xy.TYPE_WALL&&e?r.id=e:r.type===xy.TYPE_LANDSCAPE&&s&&(r.id=s)),i++}return!0}updatePlaneVisibility(t,e,s){t===this._typeVisibility[xy.TYPE_FLOOR]&&e===this._typeVisibility[xy.TYPE_WALL]&&s===this._typeVisibility[xy.TYPE_LANDSCAPE]||(this._typeVisibility[xy.TYPE_FLOOR]=t,this._typeVisibility[xy.TYPE_WALL]=e,this._typeVisibility[xy.TYPE_LANDSCAPE]=s,this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[])}updatePlanes(t,e,s){if(!t||!this.object)return;this._assetUpdateCounter++,e&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[]);const i=this._visiblePlanes.length>0;let r=this._visiblePlanes;this._visiblePlanes.length||(r=this._planes);let n=0,a=!1,o=0;for(;o<r.length;){let e=o;i&&(e=this._visiblePlaneSpriteNumbers[o]);const h=this.getSprite(e);if(h){const _=r[o];if(_){if(h.id=_.uniqueId,_.update(t,s)){if(_.visible){n=_.relativeDepth+this.floorRelativeDepth+e/1e3,_.type!==xy.TYPE_FLOOR&&(n=_.relativeDepth+this.wallRelativeDepth+e/1e3,(_.leftSide.length<1||_.rightSide.length<1)&&(n+=.5*oD.ROOM_DEPTH_OFFSET));const s="plane "+e+" "+t.scale;this.updateSprite(h,_,s,n)}a=!0}h.visible!=(_.visible&&this._typeVisibility[_.type])&&(h.visible=!h.visible,a=!0),h.visible&&(i||(this._visiblePlanes.push(_),this._visiblePlaneSpriteNumbers.push(o)))}else h.id=0,h.visible&&(h.visible=!1,a=!0)}o++}return a}updatePlaneMasks(t){if(!t)return;this._roomPlaneBitmapMaskParser.initialize(t);const e=[],s=[];let i=!1,r=0;for(;r<this._planes.length;){const t=this._planes[r];t&&(t.resetBitmapMasks(),t.type===xy.TYPE_LANDSCAPE&&e.push(r)),r++}for(const n of this._roomPlaneBitmapMaskParser.masks.values()){const t=this._roomPlaneBitmapMaskParser.getMaskType(n),e=this._roomPlaneBitmapMaskParser.getMaskLocation(n),r=this._roomPlaneBitmapMaskParser.getMaskCategory(n);if(e){let n=0;for(;n<this._planes.length;){const a=this._planes[n];if((a.type===xy.TYPE_WALL||a.type===xy.TYPE_LANDSCAPE)&&a&&a.location&&a.normal){const o=dt.dif(e,a.location);if(Math.abs(dt.scalarProjection(o,a.normal))<.01&&a.leftSide&&a.rightSide){const e=dt.scalarProjection(o,a.leftSide),h=dt.scalarProjection(o,a.rightSide);a.type===xy.TYPE_WALL||a.type===xy.TYPE_LANDSCAPE&&r===Dy.HOLE?a.addBitmapMask(t,e,h):a.type===xy.TYPE_LANDSCAPE&&(a.canBeVisible||(i=!0),a.canBeVisible=!0,s.push(n))}}n++}}}for(r=0;r<e.length;){const t=e[r];if(s.indexOf(t)<0){this._planes[t].canBeVisible=!1,i=!0}r++}i&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[])}updateSprite(t,e,s,i){const r=e.offset;t.offsetX=-r.x,t.offsetY=-r.y,t.relativeDepth=i,t.color=e.color,t.texture=this.getPlaneBitmap(e,s),t.name=s+"_"+this._assetUpdateCounter}getPlaneBitmap(t,e){return t.bitmapData}getBoundingRectangle(){return this._boundingRectangle||(this._boundingRectangle=super.getBoundingRectangle()),new j.j(this._boundingRectangle.x,this._boundingRectangle.y,this._boundingRectangle.width,this._boundingRectangle.height)}get planes(){const t=[];for(const e of this._visiblePlanes)t.push(e);return t}get floorRelativeDepth(){return oD.ROOM_DEPTH_OFFSET+.1}get wallRelativeDepth(){return oD.ROOM_DEPTH_OFFSET+.5}}oD.LAST_VISUALIZATION=null,oD.RENDER_TEXTURE_CACHE=new Map,oD.FLOOR_COLOR=16777215,oD.FLOOR_COLOR_LEFT=14540253,oD.FLOOR_COLOR_RIGHT=12303291,oD.WALL_COLOR_TOP=16777215,oD.WALL_COLOR_SIDE=13421772,oD.WALL_COLOR_BOTTOM=10066329,oD.WALL_COLOR_BORDER=10066329,oD.LANDSCAPE_COLOR_TOP=16777215,oD.LANDSCAPE_COLOR_SIDE=13421772,oD.LANDSCAPE_COLOR_BOTTOM=10066329,oD.ROOM_DEPTH_OFFSET=1e3;class hD extends xM{constructor(){super(),this._tileHeight=void 0,this._tileHeight=0}getLayerYOffset(t,e,s){return 1===s?(this._tileHeight=this.object.model.getValue(rt.TILE_CURSOR_HEIGHT),32*-this._tileHeight):super.getLayerYOffset(t,e,s)}}class _D{constructor(){this._visualizationDatas=void 0,this._visualizationDatas=new Map}getVisualization(t){const e=this.getVisualizationType(t);return e?new e:null}getVisualizationType(t){if(!t)return null;let e=null;switch(t){case nt.ROOM:e=oD;break;case nt.TILE_CURSOR:e=hD;break;case nt.USER:case nt.BOT:case nt.RENTABLE_BOT:e=RM;break;case nt.PET_ANIMATED:e=yy;break;case nt.FURNITURE_STATIC:e=FM;break;case nt.FURNITURE_ANIMATED:e=xM;break;case nt.FURNITURE_RESETTING_ANIMATED:e=Ey;break;case nt.FURNITURE_BADGE_DISPLAY:e=BM;break;case nt.FURNITURE_BG:e=py;break;case nt.FURNITURE_BB:e=HM;break;case nt.FURNITURE_ISOMETRIC_BB:e=oy;break;case nt.FURNITURE_BOTTLE:e=VM;break;case nt.FURNITURE_BUILDER_PLACEHOLDER:e=jM;break;case nt.FURNITURE_COUNTER_CLOCK:e=kM;break;case nt.FURNITURE_CUBOID:e=YM;break;case nt.FURNITURE_EXTERNAL_IMAGE:e=KM;break;case nt.FURNITURE_FIREWORKS:e=ey;break;case nt.FURNITURE_GIFT_WRAPPED_FIREWORKS:e=sy;break;case nt.FURNITURE_GIFT_WRAPPED:e=iy;break;case nt.FURNITURE_GUILD_CUSTOMIZED:e=ry;break;case nt.FURNITURE_GUILD_ISOMETRIC_BADGE:e=ny;break;case nt.FURNITURE_HABBOWHEEL:e=ay;break;case nt.FURNITURE_MANNEQUIN:e=_y;break;case nt.FURNITURE_PARTY_BEAMER:e=dy;break;case nt.FURNITURE_PLANET_SYSTEM:e=cy;break;case nt.FURNITURE_POSTER:e=ly;break;case nt.FURNITURE_QUEUE_TILE:e=gy;break;case nt.FURNITURE_SCORE_BOARD:e=my;break;case nt.FURNITURE_SOUNDBLOCK:e=Iy;break;case nt.FURNITURE_STICKIE:e=Ty;break;case nt.FURNITURE_VAL_RANDOMIZER:e=Ry;break;case nt.FURNITURE_VOTE_COUNTER:e=fy;break;case nt.FURNITURE_VOTE_MAJORITY:e=Oy;break;case nt.FURNITURE_WATER_AREA:e=vy;break;case nt.FURNITURE_YOUTUBE:e=Ay}return e||(l.log("Unknown Visualization",t),null)}getVisualizationData(t,e,s){const i=this._visualizationDatas.get(t);if(i)return i;let r=null;switch(e){case nt.FURNITURE_STATIC:case nt.FURNITURE_GIFT_WRAPPED:case nt.FURNITURE_BB:case nt.FURNITURE_ISOMETRIC_BB:case nt.FURNITURE_BG:case nt.FURNITURE_STICKIE:case nt.FURNITURE_BUILDER_PLACEHOLDER:r=new bM;break;case nt.FURNITURE_ANIMATED:case nt.FURNITURE_RESETTING_ANIMATED:case nt.FURNITURE_POSTER:case nt.FURNITURE_HABBOWHEEL:case nt.FURNITURE_VAL_RANDOMIZER:case nt.FURNITURE_BOTTLE:case nt.FURNITURE_PLANET_SYSTEM:case nt.FURNITURE_QUEUE_TILE:case nt.FURNITURE_PARTY_BEAMER:case nt.FURNITURE_COUNTER_CLOCK:case nt.FURNITURE_WATER_AREA:case nt.FURNITURE_SCORE_BOARD:case nt.FURNITURE_FIREWORKS:case nt.FURNITURE_GIFT_WRAPPED_FIREWORKS:case nt.FURNITURE_GUILD_CUSTOMIZED:case nt.FURNITURE_GUILD_ISOMETRIC_BADGE:case nt.FURNITURE_VOTE_COUNTER:case nt.FURNITURE_VOTE_MAJORITY:case nt.FURNITURE_SOUNDBLOCK:case nt.FURNITURE_BADGE_DISPLAY:case nt.FURNITURE_EXTERNAL_IMAGE:case nt.FURNITURE_YOUTUBE:case nt.TILE_CURSOR:r=new wM;break;case nt.FURNITURE_MANNEQUIN:r=new hy;break;case nt.ROOM:r=new aD;break;case nt.USER:case nt.BOT:case nt.RENTABLE_BOT:r=new TM;break;case nt.PET_ANIMATED:r=new My}return r?r.initialize(s)?((r instanceof TM||r instanceof hy)&&(r.avatarManager=SU.instance.avatar),_D.CACHING_ENABLED&&this._visualizationDatas.set(t,r),r):(r.dispose(),null):null}}_D.CACHING_ENABLED=!0;class dD{}dD.ROOM_MIN_X="room_min_x",dD.ROOM_MAX_X="room_max_x",dD.ROOM_MIN_Y="room_min_y",dD.ROOM_MAX_Y="room_max_y",dD.ROOM_IS_PUBLIC="room_is_public",dD.ROOM_Z_SCALE="room_z_scale",dD.AD_DISPLAY_DELAY="ad_display_delay",dD.IS_PLAYING_GAME="is_playing_game",dD.RESTRICTS_DRAGGING="restricts_dragging",dD.RESTRICTS_SCALING="restricts_scaling",dD.RESTRICTED_SCALE="room_scale";class uD{constructor(t,e){this._width=void 0,this._height=void 0,this._heights=void 0,this._isNotStackable=void 0,this._isRoomTile=void 0,this._width=t,this._height=e,this._heights=[],this._isNotStackable=[],this._isRoomTile=[];let s=t*e;for(;s>0;)this._heights.push(0),this._isNotStackable.push(!1),this._isRoomTile.push(!1),s--}dispose(){this._width=0,this._height=0,this._height=null,this._isNotStackable=null,this._isRoomTile=null}validPosition(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height}getTileHeight(t,e){return this.validPosition(t,e)?this._heights[e*this._width+t]:0}setTileHeight(t,e,s){this.validPosition(t,e)&&(this._heights[e*this._width+t]=s)}setStackingBlocked(t,e,s){this.validPosition(t,e)&&(this._isNotStackable[e*this._width+t]=s)}setIsRoomTile(t,e,s){this.validPosition(t,e)&&(this._isRoomTile[e*this._width+t]=s)}validateLocation(t,e,s,i,r,n,a,o,h){let _=arguments.length>9&&void 0!==arguments[9]?arguments[9]:-1,d=0,u=0;if(!this.validPosition(t,e)||!this.validPosition(t+s-1,e+i-1))return!1;(r<0||r>=this._width)&&(r=0),(n<0||n>=this._height)&&(n=0),a=Math.min(a,this._width-r),o=Math.min(o,this._height-n),-1===_&&(_=this.getTileHeight(t,e));let c=e;for(;c<e+i;){for(d=t;d<t+s;){if(d<r||d>=r+a||c<n||c>=n+o)if(u=c*this._width+d,h){if(!this._isRoomTile[u])return!1}else if(this._isNotStackable[u]||!this._isRoomTile[u]||Math.abs(this._heights[u]-_)>.01)return!1;d++}c++}return!0}get width(){return this._width}get height(){return this._height}}class cD{constructor(){this._isDisposed=void 0,this._scale=void 0,this._heightMap=void 0,this._width=void 0,this._height=void 0,this._floorHeight=void 0,this._isDisposed=!1,this._scale=64,this._heightMap=[],this._width=0,this._height=0,this._floorHeight=0}get disposed(){return this._isDisposed}get scale(){return this._scale}set scale(t){this._scale=t}dispose(){this.reset(),this._isDisposed=!0}initialize(t,e,s){if(t<=this._width&&e<=this._height)return this._width=t,this._height=e,void(this._floorHeight=s);this.reset();let i=0;for(;i<e;){const e=[];this._heightMap.push(e);let s=0;for(;s<t;)e.push(0),s++;i++}this._width=t,this._height=e,this._floorHeight=s}reset(){this._heightMap=[]}setHeight(t,e,s){if(t<0||t>=this._width||e<0||e>=this._height)return!1;const i=this._heightMap[e];return!!i&&(i[t]=s,!0)}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return 0;const s=this._heightMap[e];return s?s[t]:0}getLocation(t,e,s,i,r){let n,a,o;if(0==t&&0==e)if(t=this._width,e=this._height,n=Math.round(this.scale/10),r==cD.R){for(o=this._width-1;o>=0;){for(a=1;a<this._height;){if(this.getHeight(o,a)<=this._floorHeight){a-1<e&&(t=o,e=a-1);break}a++}o--}i+=this.scale/4-n/2,s+=this.scale/2}else{for(a=this._height-1;a>=0;){for(o=1;o<this._width;){if(this.getHeight(o,a)<=this._floorHeight){o-1<t&&(t=o-1,e=a);break}o++}a--}i+=this.scale/4-n/2,s-=n}let h=t,_=e,d=this.getHeight(t,e);r==cD.R?(h+=s/(this._scale/2)-.5,_+=.5,d-=(i-s/2)/(this._scale/2)):(_+=(this._scale/2-s)/(this._scale/2)-.5,h+=.5,d-=(i-(this._scale/2-s)/2)/(this._scale/2));return new dt(h,_,d)}getLocationOldFormat(t,e,s){let i,r,n,a,o,h=0,_=0;r=Math.ceil(t),h=r-t;let d=0;for(i=0;i<this._width;){if(r>=0&&r<this._height){if(this.getHeight(i,r)<=this._floorHeight){n=i-1,a=r,_=i,s=cD.L;break}if(this.getHeight(i,r+1)<=this._floorHeight){n=i,a=r,_=a-t,s=cD.R;break}}r++,i++}const u=this.scale/2*h;let c=-_*this.scale/2;return c+=18*-e/32*this.scale/2,d=this.getHeight(n,a),o=d*this.scale/2+c,s==cD.R?o+=h*this.scale/4:o+=(1-h)*this.scale/4,this.getLocation(n,a,u,o,s)}getOldLocation(t,e){if(null==t)return null;let s=0,i=0,r=0,n=0,a="",o=0;if(90==e)s=Math.floor(t.x-.5),i=Math.floor(t.y+.5),o=this.getHeight(s,i),r=this._scale/2-(t.y-i+.5)*(this._scale/2),n=(o-t.z)*(this._scale/2)+(this._scale/2-r)/2,a=cD.L;else{if(180!=e)return null;s=Math.floor(t.x+.5),i=Math.floor(t.y-.5),o=this.getHeight(s,i),r=(t.x+.5-s)*(this._scale/2),n=(o-t.z)*(this._scale/2)+r/2,a=cD.R}return[s,i,r,n,a]}getOldLocationString(t,e){const s=this.getOldLocation(t,e);if(null==s)return null;return":w="+Math.trunc(s[0])+","+Math.trunc(s[1])+" l="+Math.trunc(s[2])+","+Math.trunc(s[3])+" "+s[4]}getDirection(t){return t==cD.R?180:90}getFloorAltitude(t,e){const s=this.getHeight(t,e),i=s+1;return s+(Math.trunc(this.getHeight(t-1,e-1))==i||Math.trunc(this.getHeight(t,e-1))==i||Math.trunc(this.getHeight(t+1,e-1))==i||Math.trunc(this.getHeight(t-1,e))==i||Math.trunc(this.getHeight(t+1,e))==i||Math.trunc(this.getHeight(t-1,e+1))==i||Math.trunc(this.getHeight(t,e+1))==i||Math.trunc(this.getHeight(t+1,e+1))==i?.5:0)}isRoomTile(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height&&this._heightMap[e][t]>=0}}cD.DEFAULT_SCALE=32,cD.L="l",cD.R="r";class lD extends c{constructor(t){super(),this._connection=void 0,this._roomCreator=void 0,this._planeParser=void 0,this._latestEntryTileEvent=void 0,this._currentRoomId=void 0,this._ownUserId=void 0,this._initialConnection=void 0,this._guideId=void 0,this._requesterId=void 0,this._connection=null,this._roomCreator=t,this._planeParser=new jh,this._latestEntryTileEvent=null,this._currentRoomId=0,this._ownUserId=0,this._initialConnection=!0,this._guideId=-1,this._requesterId=-1}onDispose(){super.onDispose(),this._connection=null,this._roomCreator=null,this._latestEntryTileEvent=null,this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}setConnection(t){!this._connection&&t&&(this._connection=t,this._connection.addMessageEvent(new Hm(this.onUserInfoEvent.bind(this))),this._connection.addMessageEvent(new Qp(this.onRoomReadyMessageEvent.bind(this))),this._connection.addMessageEvent(new qp(this.onRoomPaintEvent.bind(this))),this._connection.addMessageEvent(new Yp(this.onRoomModelEvent.bind(this))),this._connection.addMessageEvent(new Wp(this.onRoomHeightMapEvent.bind(this))),this._connection.addMessageEvent(new Kp(this.onRoomHeightMapUpdateEvent.bind(this))),this._connection.addMessageEvent(new Zp(this.onRoomThicknessEvent.bind(this))),this._connection.addMessageEvent(new zp(this.onRoomDoorEvent.bind(this))),this._connection.addMessageEvent(new Tp(this.onRoomRollingEvent.bind(this))),this._connection.addMessageEvent(new Ip(this.onObjectsDataUpdateEvent.bind(this))),this._connection.addMessageEvent(new Np(this.onFurnitureAliasesEvent.bind(this))),this._connection.addMessageEvent(new Op(this.onFurnitureFloorAddEvent.bind(this))),this._connection.addMessageEvent(new vp(this.onFurnitureFloorEvent.bind(this))),this._connection.addMessageEvent(new Ap(this.onFurnitureFloorRemoveEvent.bind(this))),this._connection.addMessageEvent(new Sp(this.onFurnitureFloorUpdateEvent.bind(this))),this._connection.addMessageEvent(new xp(this.onFurnitureWallAddEvent.bind(this))),this._connection.addMessageEvent(new Bp(this.onFurnitureWallEvent.bind(this))),this._connection.addMessageEvent(new Gp(this.onFurnitureWallRemoveEvent.bind(this))),this._connection.addMessageEvent(new Hp(this.onFurnitureWallUpdateEvent.bind(this))),this._connection.addMessageEvent(new Mp(this.onFurnitureDataEvent.bind(this))),this._connection.addMessageEvent(new Cp(this.onItemDataUpdateMessageEvent.bind(this))),this._connection.addMessageEvent(new bp(this.onOneWayDoorStatusMessageEvent.bind(this))),this._connection.addMessageEvent(new hm(this.onRoomUnitDanceEvent.bind(this))),this._connection.addMessageEvent(new _m(this.onRoomUnitEffectEvent.bind(this))),this._connection.addMessageEvent(new dm(this.onRoomUnitEvent.bind(this))),this._connection.addMessageEvent(new um(this.onRoomUnitExpressionEvent.bind(this))),this._connection.addMessageEvent(new cm(this.onRoomUnitHandItemEvent.bind(this))),this._connection.addMessageEvent(new gm(this.onRoomUnitIdleEvent.bind(this))),this._connection.addMessageEvent(new Em(this.onRoomUnitInfoEvent.bind(this))),this._connection.addMessageEvent(new pm(this.onRoomUnitNumberEvent.bind(this))),this._connection.addMessageEvent(new mm(this.onRoomUnitRemoveEvent.bind(this))),this._connection.addMessageEvent(new Im(this.onRoomUnitStatusEvent.bind(this))),this._connection.addMessageEvent(new rm(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new nm(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new am(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new om(this.onRoomUnitTypingEvent.bind(this))),this._connection.addMessageEvent(new $p(this.onPetFigureUpdateEvent.bind(this))),this._connection.addMessageEvent(new Jp(this.onPetExperienceEvent.bind(this))),this._connection.addMessageEvent(new em(this.onYouArePlayingGameEvent.bind(this))),this._connection.addMessageEvent(new fp(this.onDiceValueMessageEvent.bind(this))),this._connection.addMessageEvent(new Xm(this.onIgnoreResultEvent.bind(this))),this._connection.addMessageEvent(new Wl(this.onGuideSessionStartedMessageEvent.bind(this))),this._connection.addMessageEvent(new Hl(this.onGuideSessionEndedMessageEvent.bind(this))),this._connection.addMessageEvent(new Vl(this.onGuideSessionErrorMessageEvent.bind(this))))}setRoomId(t){0!==this._currentRoomId&&this._roomCreator&&this._roomCreator.destroyRoom(this._currentRoomId),this._currentRoomId=t,this._latestEntryTileEvent=null}clearRoomId(){this._currentRoomId=0,this._latestEntryTileEvent=null}onUserInfoEvent(t){if(!(t instanceof Hm)||!t.connection)return;const e=t.getParser();e&&(this._ownUserId=e.userInfo.userId)}onRoomReadyMessageEvent(t){const e=t.getParser();if(this._currentRoomId!==e.roomId&&this.setRoomId(e.roomId),this._roomCreator&&this._roomCreator.setRoomInstanceModelName(e.roomId,e.name),this._initialConnection)return t.connection.send(new Yv),void(this._initialConnection=!1);t.connection.send(new gA)}onRoomPaintEvent(t){if(!(t instanceof qp))return;const e=t.getParser();if(!e)return;const s=e.floorType,i=e.wallType,r=e.landscapeType;this._roomCreator&&this._roomCreator.updateRoomInstancePlaneType(this._currentRoomId,s,i,r)}onRoomModelEvent(t){if(!(t instanceof Yp)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!s)return;this._planeParser.reset();const i=e.width,r=e.height;this._planeParser.initializeTileMap(i,r);let n=null;this._latestEntryTileEvent&&(n=this._latestEntryTileEvent.getParser());let a=-1,o=-1,h=0,_=0,d=0;for(;d<r;){let t=0;for(;t<i;){const s=e.getHeight(t,d);(d>0&&d<r-1||t>0&&t<i-1)&&s!=jh.TILE_BLOCKED&&(null==n||t==n.x&&d==n.y)&&(e.getHeight(t,d-1)==jh.TILE_BLOCKED&&e.getHeight(t-1,d)==jh.TILE_BLOCKED&&e.getHeight(t,d+1)==jh.TILE_BLOCKED&&(a=t+.5,o=d,h=s,_=90),e.getHeight(t,d-1)==jh.TILE_BLOCKED&&e.getHeight(t-1,d)==jh.TILE_BLOCKED&&e.getHeight(t+1,d)==jh.TILE_BLOCKED&&(a=t,o=d+.5,h=s,_=180)),this._planeParser.setTileHeight(t,d,s),t++}d++}this._planeParser.setTileHeight(Math.floor(a),Math.floor(o),h),this._planeParser.initializeFromTileData(e.wallHeight),this._planeParser.setTileHeight(Math.floor(a),Math.floor(o),h+this._planeParser.wallHeight),64===e.scale?(this._planeParser.restrictsDragging=!0,this._planeParser.restrictsScaling=!0,this._planeParser.restrictedScale=.5):(this._planeParser.restrictsDragging=!1,this._planeParser.restrictsScaling=!1,this._planeParser.restrictedScale=1),s.scale=cD.DEFAULT_SCALE,s.initialize(i,r,this._planeParser.floorHeight);let u=e.height-1;for(;u>=0;){let t=e.width-1;for(;t>=0;)s.setHeight(t,u,this._planeParser.getTileHeight(t,u)),t--;u--}const c=this._planeParser.getMapData();c.doors.push({x:a,y:o,z:h,dir:_}),this._roomCreator.createRoomInstance(this._currentRoomId,c)}onRoomHeightMapEvent(t){if(!(t instanceof Wp)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.width,i=e.height,r=new uD(s,i);let n=0;for(;n<i;){let t=0;for(;t<s;)r.setTileHeight(t,n,e.getTileHeight(t,n)),r.setStackingBlocked(t,n,e.getStackingBlocked(t,n)),r.setIsRoomTile(t,n,e.isRoomTile(t,n)),t++;n++}this._roomCreator.setFurnitureStackingHeightMap(this._currentRoomId,r)}onRoomHeightMapUpdateEvent(t){if(!(t instanceof Kp)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.getFurnitureStackingHeightMap(this._currentRoomId);if(s){for(;e.next();)s.setTileHeight(e.x,e.y,e.tileHeight()),s.setStackingBlocked(e.x,e.y,e.isStackingBlocked()),s.setIsRoomTile(e.x,e.y,e.isRoomTile());this._roomCreator.refreshTileObjectMap(this._currentRoomId,"RoomMessageHandler.onRoomHeightMapUpdateEvent()")}}onRoomThicknessEvent(t){if(!(t instanceof Zp))return;const e=t.getParser();if(!e)return;const s=!e.hideWalls,i=e.thicknessWall,r=e.thicknessFloor;this._roomCreator&&(this._roomCreator.updateRoomInstancePlaneVisibility(this._currentRoomId,s,true),this._roomCreator.updateRoomInstancePlaneThickness(this._currentRoomId,i,r))}onRoomDoorEvent(t){t instanceof zp&&(this._latestEntryTileEvent=t)}onRoomRollingEvent(t){if(!(t instanceof Tp)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,1,null),this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,2,null);const s=e.itemsRolling;if(s&&s.length)for(const r of s)r&&this._roomCreator.rollRoomObjectFloor(this._currentRoomId,r.id,r.location,r.targetLocation);const i=e.unitRolling;if(i){this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,i.id,i.location,i.targetLocation);const t=this._roomCreator.getRoomObjectUser(this._currentRoomId,i.id);if(t&&t.type!==it.MONSTER_PLANT){let t="std";switch(i.movementType){case hh.MOVE:t="mv";break;case hh.SLIDE:t="std"}this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,i.id,t)}}}onObjectsDataUpdateEvent(t){if(!(t instanceof Ip)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(e)for(const s of e.objects)this._roomCreator.updateRoomObjectFloor(this._currentRoomId,s.id,null,null,s.state,s.data)}onFurnitureAliasesEvent(t){if(!(t instanceof Np)||!t.connection||!this._roomCreator)return;t.getParser().aliases;this._connection.send(new gA)}onFurnitureFloorAddEvent(t){if(!(t instanceof Op)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureFloor(this._currentRoomId,e)}onFurnitureFloorEvent(t){if(!(t instanceof vp)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.items.length;let i=0;for(;i<s;){const t=e.items[i];t&&this.addRoomObjectFurnitureFloor(this._currentRoomId,t),i++}}onFurnitureFloorRemoveEvent(t){if(!(t instanceof Ap)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&(e.delay>0?setTimeout((()=>{this._roomCreator.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0)}),e.delay):this._roomCreator.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0))}onFurnitureFloorUpdateEvent(t){if(!(t instanceof Sp)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;if(!e)return;const s=new dt(e.x,e.y,e.z),i=new dt(e.direction);this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,s,i,e.data.state,e.data,e.extra),this._roomCreator.updateRoomObjectFloorHeight(this._currentRoomId,e.itemId,e.stackHeight),this._roomCreator.updateRoomObjectFloorExpiration(this._currentRoomId,e.itemId,e.expires)}onFurnitureWallAddEvent(t){if(!(t instanceof xp)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureWall(this._currentRoomId,e)}onFurnitureWallEvent(t){if(!(t instanceof Bp)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.items.length;let i=0;for(;i<s;){const t=e.items[i];t&&this.addRoomObjectFurnitureWall(this._currentRoomId,t),i++}}onFurnitureWallRemoveEvent(t){if(!(t instanceof Gp)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.removeRoomObjectWall(this._currentRoomId,e.itemId,e.userId)}onFurnitureWallUpdateEvent(t){if(!(t instanceof Hp)||!t.connection||!this._roomCreator)return;const e=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!e)return;const s=t.getParser().item;if(!s)return;const i=e.getLocation(s.width,s.height,s.localX,s.localY,s.direction),r=new dt(e.getDirection(s.direction));this._roomCreator.updateRoomObjectWall(this._currentRoomId,s.itemId,i,r,s.state,s.stuffData),this._roomCreator.updateRoomObjectWallExpiration(this._currentRoomId,s.itemId,s.secondsToExpiration)}onFurnitureDataEvent(t){if(!(t instanceof Mp)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.furnitureId,null,null,e.objectData.state,e.objectData)}onItemDataUpdateMessageEvent(t){if(!(t instanceof Cp)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectWallItemData(this._currentRoomId,e.furnitureId,e.data)}onOneWayDoorStatusMessageEvent(t){if(!(t instanceof bp)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.state,new la)}onDiceValueMessageEvent(t){if(!(t instanceof fp)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.value,new la)}onRoomUnitDanceEvent(t){t instanceof hm&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,rt.FIGURE_DANCE,t.getParser().danceId)}onRoomUnitEffectEvent(t){t instanceof _m&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserEffect(this._currentRoomId,t.getParser().unitId,t.getParser().effectId,t.getParser().delay)}onRoomUnitEvent(t){if(!(t instanceof dm)||!t.connection||!this._roomCreator)return;const e=t.getParser().users;if(e&&e.length){for(const t of e){if(!t)continue;const e=new dt(t.x,t.y,t.z),s=new dt(t.dir);this._roomCreator.addRoomObjectUser(this._currentRoomId,t.roomIndex,e,s,t.dir,t.userType,t.figure),t.webID===this._ownUserId&&(this._roomCreator.setRoomSessionOwnUser(this._currentRoomId,t.roomIndex),this._roomCreator.updateRoomObjectUserOwn(this._currentRoomId,t.roomIndex)),this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,t.roomIndex,t.figure,t.sex,t.subType,t.isRiding),it.getTypeString(t.userType)===it.PET&&this._roomCreator.getPetTypeId(t.figure)===er.MONSTERPLANT&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,t.roomIndex,t.petPosture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.roomIndex,rt.FIGURE_IS_MUTED,this._roomCreator.sessionDataManager.isUserIgnored(t.name)?1:0)}this.updateGuideMarker()}}onRoomUnitExpressionEvent(t){t instanceof um&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,rt.FIGURE_EXPRESSION,t.getParser().expression)}onRoomUnitHandItemEvent(t){t instanceof cm&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,rt.FIGURE_CARRY_OBJECT,t.getParser().handId)}onRoomUnitIdleEvent(t){t instanceof gm&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,rt.FIGURE_SLEEP,t.getParser().isIdle?1:0)}onRoomUnitInfoEvent(t){t instanceof Em&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,t.getParser().unitId,t.getParser().figure,t.getParser().gender)}onRoomUnitNumberEvent(t){if(!(t instanceof pm)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.unitId,rt.FIGURE_NUMBER_VALUE,e.value)}onRoomUnitRemoveEvent(t){t instanceof mm&&t.connection&&this._roomCreator&&(this._roomCreator.removeRoomObjectUser(this._currentRoomId,t.getParser().unitId),this.updateGuideMarker())}onRoomUnitStatusEvent(t){if(!(t instanceof Im)||!t.connection||!this._roomCreator)return;const e=t.getParser().statuses;if(!e||!e.length)return;const s=this._roomCreator.getRoomInstance(this._currentRoomId);if(!s)return;const i=s.model.getValue(dD.ROOM_Z_SCALE)||1;for(const r of e){if(!r)continue;let t=r.height;t&&(t/=i);const e=new dt(r.x,r.y,r.z+t),s=new dt(r.direction);let n=null;r.didMove&&(n=new dt(r.targetX,r.targetY,r.targetZ)),this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,r.id,e,n,r.canStandUp,t,s,r.headDirection),this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,r.id,null);let a=!0,o=!1,h=rt.STD,_="";if(r.actions&&r.actions.length)for(const i of r.actions)if(i)switch(i.action){case"flatctrl":this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,r.id,i.value);break;case"sign":1===r.actions.length&&(a=!1),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,r.id,rt.FIGURE_SIGN,parseInt(i.value));break;case"gst":1===r.actions.length&&(a=!1),this._roomCreator.updateRoomObjectUserPetGesture(this._currentRoomId,r.id,i.value);break;case"wav":case"mv":default:o=!0,h=i.action,_=i.value;case"trd":}o?this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,r.id,h,_):a&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,r.id,rt.STD,"")}this.updateGuideMarker()}onRoomUnitChatEvent(t){if(!t.connection||!this._roomCreator)return;const e=t.getParser();e&&(this._roomCreator.updateRoomObjectUserGesture(this._currentRoomId,e.roomIndex,e.gesture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.roomIndex,rt.FIGURE_TALK,e.message.length/10))}onRoomUnitTypingEvent(t){t instanceof om&&t.connection&&this._roomCreator&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,rt.FIGURE_IS_TYPING,t.getParser().isTyping?1:0)}onPetFigureUpdateEvent(t){if(!(t instanceof $p)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,e.roomIndex,e.figureData.figuredata,"","",e.isRiding)}onPetExperienceEvent(t){const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.roomIndex,rt.FIGURE_GAINED_EXPERIENCE,e.gainedExperience)}onYouArePlayingGameEvent(t){if(!t)return;const e=t.getParser();e&&this._roomCreator.setRoomEngineGameMode(this._currentRoomId,e.isPlaying)}addRoomObjectFurnitureFloor(t,e){if(!e||!this._roomCreator)return;const s=new dt(e.x,e.y,e.z),i=new dt(e.direction);e.spriteName?this._roomCreator.addFurnitureFloorByTypeName(t,e.itemId,e.spriteName,s,i,e.state,e.data,e.extra,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight):this._roomCreator.addFurnitureFloor(t,e.itemId,e.spriteId,s,i,e.state,e.data,e.extra,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight)}addRoomObjectFurnitureWall(t,e){if(!e||!this._roomCreator)return;const s=this._roomCreator.getLegacyWallGeometry(t);if(!s)return;let i=null;e.isOldFormat||(i=s.getLocation(e.width,e.height,e.localX,e.localY,e.direction));const r=new dt(s.getDirection(e.direction));this._roomCreator.addFurnitureWall(t,e.itemId,e.spriteId,i,r,e.state,e.stuffData,e.secondsToExpiration,e.usagePolicy,e.userId,e.username)}onIgnoreResultEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!s)return;const i=s.userDataManager.getUserDataByName(e.name);if(i)switch(e.result){case 1:case 2:return void this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,rt.FIGURE_IS_MUTED,1);case 3:return void this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,rt.FIGURE_IS_MUTED,0)}}onGuideSessionStartedMessageEvent(t){const e=t.getParser();this._guideId=e.guideUserId,this._requesterId=e.requesterUserId,this.updateGuideMarker()}onGuideSessionEndedMessageEvent(t){this.removeGuideMarker()}onGuideSessionErrorMessageEvent(t){this.removeGuideMarker()}updateGuideMarker(){const t=this._roomCreator.sessionDataManager.userId;this.setUserGuideStatus(this._guideId,this._requesterId===t?_M.GUIDE:_M.NONE),this.setUserGuideStatus(this._requesterId,this._guideId===t?_M.REQUESTER:_M.NONE)}removeGuideMarker(){this.setUserGuideStatus(this._guideId,_M.NONE),this.setUserGuideStatus(this._requesterId,_M.NONE),this._guideId=-1,this._requesterId=-1}setUserGuideStatus(t,e){if(!this._roomCreator||!this._roomCreator.roomSessionManager)return;const s=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!s)return;const i=s.userDataManager.getDataByType(t,E_.USER);i&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,rt.FIGURE_GUIDE_STATUS,e)}get currentRoomId(){return this._currentRoomId}}class gD{}gD.CATALOG="catalog",gD.INVENTORY="inventory";class ED extends DN{constructor(t){super(),this._selected=void 0,this._selected=t}get selected(){return this._selected}}class pD extends DN{constructor(t){super(),this._selected=void 0,this._selected=t}get selected(){return this._selected}}class mD extends Ue{constructor(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(t,null),this._height=void 0,this._sourceEventId=void 0,this._visible=void 0,this._toggleVisibility=void 0,this._height=e,this._visible=s,this._sourceEventId=i,this._toggleVisibility=r}get height(){return this._height}get visible(){return this._visible}get sourceEventId(){return this._sourceEventId}get toggleVisibility(){return this._toggleVisibility}}class ID extends Ue{constructor(t){super(null,null),this._type=void 0,this._type=t}get type(){return this._type}}ID.ENABLED="ROVUM_ENABLED",ID.DISABLED="ROVUM_DISABLED";class TD{}TD.OBJECT_UNDEFINED="OBJECT_UNDEFINED",TD.OBJECT_MOVE="OBJECT_MOVE",TD.OBJECT_PLACE="OBJECT_PLACE",TD.OBJECT_ROTATE_POSITIVE="OBJECT_ROTATE_POSITIVE",TD.OBJECT_ROTATE_NEGATIVE="OBJECT_ROTATE_NEGATIVE",TD.OBJECT_MOVE_TO="OBJECT_MOVE_TO",TD.OBJECT_PLACE_TO="OBJECT_PLACE_TO",TD.OBJECT_PICKUP="OBJECT_PICKUP",TD.OBJECT_PICKUP_BOT="OBJECT_PICKUP_BOT",TD.OBJECT_PICKUP_PET="OBJECT_PICKUP_PET",TD.OBJECT_EJECT="OBJECT_EJECT",TD.OBJECT_SAVE_STUFF_DATA="OBJECT_SAVE_STUFF_DATA";class RD{constructor(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:-1,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null;this._id=0,this._category=0,this._operation="",this._loc=null,this._dir=null,this._typeId=0,this._instanceData=null,this._stuffData=null,this._state=-1,this._animFrame=-1,this._posture=null,this._id=t,this._category=e,this._operation=s,this._loc=new dt,this._loc.assign(i),this._dir=new dt,this._dir.assign(r),this._typeId=n,this._instanceData=a,this._stuffData=o,this._state=h,this._animFrame=_,this._posture=d}get id(){return this._id}get category(){return this._category}get operation(){return this._operation}get loc(){return this._loc}get dir(){return this._dir}get typeId(){return this._typeId}get instanceData(){return this._instanceData}get stuffData(){return this._stuffData}get state(){return this._state}get animFrame(){return this._animFrame}get posture(){return this._posture}dispose(){this._loc=null,this._dir=null}}class fD extends c{constructor(t){super(),this._roomEngine=void 0,this._eventIds=void 0,this._selectedAvatarId=void 0,this._selectedObjectId=void 0,this._selectedObjectCategory=void 0,this._whereYouClickIsWhereYouGo=void 0,this._objectPlacementSource=void 0,this._roomEngine=t,this._eventIds=new Map,this._selectedAvatarId=-1,this._selectedObjectId=-1,this._selectedObjectCategory=-2,this._whereYouClickIsWhereYouGo=!0,this._objectPlacementSource=null,this.onRoomEngineObjectEvent=this.onRoomEngineObjectEvent.bind(this),this._roomEngine.events.addEventListener(sN.ADDED,this.onRoomEngineObjectEvent)}dispose(){this._eventIds&&(this._eventIds=null),this._roomEngine.events.removeEventListener(sN.ADDED,this.onRoomEngineObjectEvent),this._roomEngine=null}onRoomEngineObjectEvent(t){let e=this.getSelectedRoomObjectData(t.roomId);if(e&&e.operation===TD.OBJECT_PLACE&&e.id===t.objectId){const s=this._roomEngine.getRoomObject(t.roomId,e.id,e.category);if(s&&s.model&&e.category===st.FLOOR){const i=s.model.getValue(rt.FURNITURE_ALLOWED_DIRECTIONS);if(i&&i.length){const r=new dt(i[0]);if(s.setDirection(r),this.updateSelectedObjectData(t.roomId,e.id,e.category,e.loc,r,e.operation,e.typeId,e.instanceData,e.stuffData,e.state,e.animFrame,e.posture),e=this.getSelectedRoomObjectData(t.roomId),!e)return}}this.setFurnitureAlphaMultiplier(s,.5)}}processRoomCanvasMouseEvent(t,e,s){if(!t||!e)return;if(ke.isRunning())return;const i=e.type;let r=this._roomEngine.getRoomObjectCategoryForType(i);r===st.ROOM||this._roomEngine.isPlayingGame()&&r===st.UNIT||(r=st.MINIMUM);if(this.getMouseEventId(r,t.type)===t.eventId){if(t.type===ts.MOUSE_CLICK||t.type===ts.DOUBLE_CLICK||t.type===ts.MOUSE_DOWN||t.type===ts.MOUSE_UP||t.type===ts.MOUSE_MOVE)return}else t.eventId&&this.setMouseEventId(r,t.type,t.eventId);e.mouseHandler&&e.mouseHandler.mouseEvent(t,s)}processRoomObjectPlacement(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;this._objectPlacementSource=t;const d=new dt(-100,-100),u=new dt(0);return this.setSelectedRoomObjectData(e,s,i,d,u,TD.OBJECT_PLACE,r,n,a,o,h,_),this._roomEngine&&(this._roomEngine.setObjectMoverIconSprite(r,i,!1,n,a,o,h,_),this._roomEngine.setObjectMoverIconSpriteVisible(!1)),!0}cancelRoomObjectInsert(t){return this.resetSelectedObjectData(t),!0}getMouseEventId(t,e){const s=this._eventIds.get(t);return s&&s.get(e)||null}setMouseEventId(t,e,s){let i=this._eventIds.get(t);i||(i=new Map,this._eventIds.set(t,i)),i.delete(e),i.set(e,s)}handleRoomObjectEvent(t,e){if(t)if(t instanceof De)this.handleRoomObjectMouseEvent(t,e);else switch(t.type){case ON.STATE_CHANGE:case ON.STATE_RANDOM:return void this.onRoomObjectStateChangedEvent(t,e);case cN.DIMMER_STATE:return void this.onRoomObjectDimmerStateUpdateEvent(t,e);case mN.POSITION_CHANGED:case mN.OBJECT_REMOVED:return void this.handleSelectedObjectRemove(t,e);case SN.OPEN_WIDGET:case SN.CLOSE_WIDGET:case SN.OPEN_FURNI_CONTEXT_MENU:case SN.CLOSE_FURNI_CONTEXT_MENU:case SN.PLACEHOLDER:case SN.CREDITFURNI:case SN.STACK_HEIGHT:case SN.EXTERNAL_IMAGE:case SN.STICKIE:case SN.PRESENT:case SN.TROPHY:case SN.TEASER:case SN.ECOTRONBOX:case SN.DIMMER:case SN.WIDGET_REMOVE_DIMMER:case SN.CLOTHING_CHANGE:case SN.JUKEBOX_PLAYLIST_EDITOR:case SN.MANNEQUIN:case SN.PET_PRODUCT_MENU:case SN.GUILD_FURNI_CONTEXT_MENU:case SN.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:case SN.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:case SN.BACKGROUND_COLOR:case SN.MYSTERYBOX_OPEN_DIALOG:case SN.EFFECTBOX_OPEN_DIALOG:case SN.MYSTERYTROPHY_OPEN_DIALOG:case SN.ACHIEVEMENT_RESOLUTION_OPEN:case SN.ACHIEVEMENT_RESOLUTION_ENGRAVING:case SN.ACHIEVEMENT_RESOLUTION_FAILED:case SN.FRIEND_FURNITURE_CONFIRM:case SN.FRIEND_FURNITURE_ENGRAVING:case SN.BADGE_DISPLAY_ENGRAVING:case SN.HIGH_SCORE_DISPLAY:case SN.HIDE_HIGH_SCORE_DISPLAY:case SN.INERNAL_LINK:case SN.ROOM_LINK:case SN.YOUTUBE:return void this.onRoomObjectWidgetRequestEvent(t,e);case gN.DICE_ACTIVATE:case gN.DICE_OFF:case gN.USE_HABBOWHEEL:case gN.STICKIE:case gN.ENTER_ONEWAYDOOR:return void this.onRoomObjectFurnitureActionEvent(t,e);case gN.SOUND_MACHINE_INIT:case gN.SOUND_MACHINE_START:case gN.SOUND_MACHINE_STOP:case gN.SOUND_MACHINE_DISPOSE:return void this.handleObjectSoundMachineEvent(t,e);case gN.JUKEBOX_INIT:case gN.JUKEBOX_START:case gN.JUKEBOX_MACHINE_STOP:case gN.JUKEBOX_DISPOSE:return void this.handleObjectJukeboxEvent(t,e);case lN.ADD_HOLE:case lN.REMOVE_HOLE:return void this.onRoomObjectFloorHoleEvent(t,e);case TN.ROOM_AD_FURNI_CLICK:case TN.ROOM_AD_FURNI_DOUBLE_CLICK:case TN.ROOM_AD_TOOLTIP_SHOW:case TN.ROOM_AD_TOOLTIP_HIDE:case TN.ROOM_AD_LOAD_IMAGE:return void this.onRoomObjectRoomAdEvent(t,e);case dN.LOAD_BADGE:return void this.onRoomObjectBadgeAssetEvent(t,e);case gN.MOUSE_ARROW:case gN.MOUSE_BUTTON:return void this.handleMousePointer(t,e);case IN.PLAY_SOUND:case IN.PLAY_SOUND_AT_PITCH:return void this.handleRoomObjectPlaySoundEvent(t,e);case RN.ROOM_OBJECT_INITIALIZED:case RN.ROOM_OBJECT_DISPOSED:case RN.PLAY_SAMPLE:case RN.CHANGE_PITCH:return void this.handleRoomObjectSamplePlaybackEvent(t,e);case pN.ROOM_BACKGROUND_COLOR:return void this.onHSLColorEnableEvent(t,e);case uN.RODRE_CURRENT_USER_ID:case uN.RODRE_URL_PREFIX:return void this.onRoomObjectDataRequestEvent(t,e);default:return void l.warn("Unhandled Event",t.constructor.name,"Object ID",t.object.id)}}handleRoomObjectMouseEvent(t,e){if(t&&t.type)switch(t.type){case De.CLICK:return void this.handleRoomObjectMouseClickEvent(t,e);case De.MOUSE_MOVE:return void this.handleRoomObjectMouseMoveEvent(t,e);case De.MOUSE_DOWN:return void this.handleRoomObjectMouseDownEvent(t,e);case De.MOUSE_DOWN_LONG:return void this.handleRoomObjectMouseDownLongEvent(t,e);case De.MOUSE_ENTER:return void this.handleRoomObjectMouseEnterEvent(t,e);case De.MOUSE_LEAVE:return void this.handleRoomObjectMouseLeaveEvent(t,e)}}handleRoomObjectMouseClickEvent(t,e){if(!t)return;let s=TD.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);let r=!1,n=!1;this._whereYouClickIsWhereYouGo&&(s&&s!==TD.OBJECT_UNDEFINED||(r=this.handleMoveTargetFurni(e,t)));const a=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case TD.OBJECT_MOVE:a===st.ROOM?i&&this.modifyRoomObject(e,i.id,i.category,TD.OBJECT_MOVE_TO):a===st.UNIT&&(i&&t.objectType===it.MONSTER_PLANT&&this.modifyRoomObject(e,i.id,i.category,TD.OBJECT_MOVE_TO),t.eventId&&this.setMouseEventId(st.ROOM,ts.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(e,t.objectId,a)),n=!0,-1!==t.objectId&&this.setSelectedObject(e,t.objectId,a);break;case TD.OBJECT_PLACE:if(a===st.ROOM)this.placeObject(e,t instanceof vN,t instanceof AN);else if(a===st.UNIT)switch(t.objectType){case it.MONSTER_PLANT:case it.RENTABLE_BOT:this.placeObject(e,t instanceof vN,t instanceof AN);break;default:t.eventId&&this.setMouseEventId(st.ROOM,ts.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(e,t.objectId,a)}break;case TD.OBJECT_UNDEFINED:a===st.ROOM?!r&&t instanceof vN&&this.onRoomObjectTileMouseEvent(e,t):(this.setSelectedObject(e,t.objectId,a),n=!1,a===st.UNIT?(!t.ctrlKey||t.altKey||t.shiftKey||t.objectType!==it.RENTABLE_BOT?!t.ctrlKey||t.altKey||t.shiftKey||t.objectType!==it.MONSTER_PLANT?t.ctrlKey||t.altKey||!t.shiftKey||t.objectType!==it.MONSTER_PLANT||this.modifyRoomObject(e,t.objectId,a,TD.OBJECT_ROTATE_POSITIVE):this.modifyRoomObject(e,t.objectId,a,TD.OBJECT_PICKUP_PET):this.modifyRoomObject(e,t.objectId,a,TD.OBJECT_PICKUP_BOT),this._roomEngine.isPlayingGame()?n=!0:r=!0):a!==st.FLOOR&&a!==st.WALL||(t.altKey||t.ctrlKey||t.shiftKey)&&(t.ctrlKey||t.altKey||!t.shiftKey?!t.ctrlKey||t.altKey||t.shiftKey||this.modifyRoomObject(e,t.objectId,a,TD.OBJECT_PICKUP):a===st.FLOOR&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new sN(sN.REQUEST_ROTATE,e,t.objectId,a)),this._roomEngine.isPlayingGame()?n=!0:r=!0),t.eventId&&(r&&this.setMouseEventId(st.ROOM,ts.MOUSE_CLICK,t.eventId),n&&this.setMouseEventId(st.MINIMUM,ts.MOUSE_CLICK,t.eventId)))}if(a===st.ROOM){const s=this.getMouseEventId(st.MINIMUM,ts.MOUSE_CLICK),i=this.getMouseEventId(st.UNIT,ts.MOUSE_CLICK);s===t.eventId||i===t.eventId||n||(this.deselectObject(e),this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new sN(sN.DESELECTED,e,-1,st.MINIMUM)),this.setSelectedAvatar(e,0,!1))}}handleRoomObjectMouseMoveEvent(t,e){if(!t)return;let s=TD.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const r=this._roomEngine.getRoomObjectCategoryForType(t.objectType);if(this._roomEngine){const s=this._roomEngine.getRoomObjectCursor(e);if(s&&s.logic){let i=null;t instanceof vN?i=this.handleMouseOverTile(t,e):t.object&&-1!==t.object.id?this._whereYouClickIsWhereYouGo&&(i=this.handleMouseOverObject(r,e,t)):i=new mD(null,0,!1,t.eventId),s.processUpdateMessage(i)}}switch(s){case TD.OBJECT_MOVE:return void(r===st.ROOM&&this.handleObjectMove(t,e));case TD.OBJECT_PLACE:return void(r===st.ROOM&&this.handleObjectPlace(t,e))}}handleRoomObjectMouseDownEvent(t,e){if(!t)return;let s=TD.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const r=this._roomEngine.getRoomObjectCategoryForType(t.objectType);s!==TD.OBJECT_UNDEFINED||r!==st.FLOOR&&r!==st.WALL&&t.objectType!==it.MONSTER_PLANT||(t.altKey&&!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new sN(sN.REQUEST_MOVE,e,t.objectId,r))}handleRoomObjectMouseDownLongEvent(t,e){if(!t)return;let s=TD.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const r=this._roomEngine.getRoomObjectCategoryForType(t.objectType);s!==TD.OBJECT_UNDEFINED||r!==st.FLOOR&&r!==st.WALL&&t.objectType!==it.MONSTER_PLANT||(!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new sN(sN.REQUEST_MANIPULATION,e,t.objectId,r))}handleRoomObjectMouseEnterEvent(t,e){const s=t.objectId,i=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new sN(sN.MOUSE_ENTER,e,s,r))}handleRoomObjectMouseLeaveEvent(t,e){const s=t.objectId,i=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(i);if(r!==st.ROOM&&r===st.UNIT){const t=this._roomEngine.getRoomObjectCursor(e);t&&t.processUpdateMessage(new JN(0,null))}this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new sN(sN.MOUSE_LEAVE,e,s,r))}onRoomObjectStateChangedEvent(t,e){if(t)switch(t.type){case ON.STATE_CHANGE:return void this.changeObjectState(e,t.object.id,t.object.type,t.state,!1);case ON.STATE_RANDOM:return void this.changeObjectState(e,t.object.id,t.object.type,t.state,!0)}}onRoomObjectDimmerStateUpdateEvent(t,e){t&&(t.type!==cN.DIMMER_STATE||this._roomEngine.events.dispatchEvent(new eN(e,t.state,t.presetId,t.effectId,t.color,t.brightness)))}handleSelectedObjectRemove(t,e){if(t&&this._roomEngine)switch(t.type){case mN.POSITION_CHANGED:{const s=t.objectId,i=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(i),n=this._roomEngine.getRoomObject(e,s,r),a=this._roomEngine.getRoomObjectSelectionArrow(e);if(n&&a&&a.logic){const t=n.getLocation();a.logic.processUpdateMessage(new Ue(t,null))}return}case mN.OBJECT_REMOVED:return void this.setSelectedAvatar(e,0,!1)}}onRoomObjectWidgetRequestEvent(t,e){if(!t||!this._roomEngine)return;const s=t.objectId,i=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(i),n=this._roomEngine.events;if(n&&!ze.isRoomPreviewerId(e))switch(t.type){case SN.OPEN_WIDGET:return void n.dispatchEvent(new hN(hN.OPEN_WIDGET,e,s,r,t.object.logic.widget));case SN.CLOSE_WIDGET:return void n.dispatchEvent(new hN(hN.CLOSE_WIDGET,e,s,r,t.object.logic.widget));case SN.OPEN_FURNI_CONTEXT_MENU:return void n.dispatchEvent(new hN(hN.OPEN_FURNI_CONTEXT_MENU,e,s,r,t.object.logic.contextMenu));case SN.CLOSE_FURNI_CONTEXT_MENU:return void n.dispatchEvent(new hN(hN.CLOSE_FURNI_CONTEXT_MENU,e,s,r));case SN.PLACEHOLDER:return void n.dispatchEvent(new hN(hN.REQUEST_PLACEHOLDER,e,s,r));case SN.CREDITFURNI:return void n.dispatchEvent(new hN(hN.REQUEST_CREDITFURNI,e,s,r));case SN.STACK_HEIGHT:return void n.dispatchEvent(new hN(hN.REQUEST_STACK_HEIGHT,e,s,r));case SN.EXTERNAL_IMAGE:return void n.dispatchEvent(new hN(hN.REQUEST_EXTERNAL_IMAGE,e,s,r));case SN.STICKIE:return void n.dispatchEvent(new hN(hN.REQUEST_STICKIE,e,s,r));case SN.PRESENT:return void n.dispatchEvent(new hN(hN.REQUEST_PRESENT,e,s,r));case SN.TROPHY:return void n.dispatchEvent(new hN(hN.REQUEST_TROPHY,e,s,r));case SN.TEASER:return void n.dispatchEvent(new hN(hN.REQUEST_TEASER,e,s,r));case SN.ECOTRONBOX:return void n.dispatchEvent(new hN(hN.REQUEST_ECOTRONBOX,e,s,r));case SN.DIMMER:return void n.dispatchEvent(new hN(hN.REQUEST_DIMMER,e,s,r));case SN.WIDGET_REMOVE_DIMMER:return void n.dispatchEvent(new hN(hN.REMOVE_DIMMER,e,s,r));case SN.CLOTHING_CHANGE:return void n.dispatchEvent(new hN(hN.REQUEST_CLOTHING_CHANGE,e,s,r));case SN.JUKEBOX_PLAYLIST_EDITOR:return void n.dispatchEvent(new hN(hN.REQUEST_PLAYLIST_EDITOR,e,s,r));case SN.MANNEQUIN:return void n.dispatchEvent(new hN(hN.REQUEST_MANNEQUIN,e,s,r));case SN.PET_PRODUCT_MENU:return void n.dispatchEvent(new _N(_N.USE_PRODUCT_FROM_ROOM,e,s,r));case SN.GUILD_FURNI_CONTEXT_MENU:return void this._roomEngine.connection.send(new zv(t.objectId,t.object.model.getValue(rt.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID)));case SN.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:return void n.dispatchEvent(new hN(hN.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,e,s,r));case SN.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:return void n.dispatchEvent(new hN(hN.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,e,s,r));case SN.BACKGROUND_COLOR:return void n.dispatchEvent(new hN(hN.REQUEST_BACKGROUND_COLOR,e,s,r));case SN.MYSTERYBOX_OPEN_DIALOG:return void n.dispatchEvent(new hN(hN.REQUEST_MYSTERYBOX_OPEN_DIALOG,e,s,r));case SN.EFFECTBOX_OPEN_DIALOG:return void n.dispatchEvent(new hN(hN.REQUEST_EFFECTBOX_OPEN_DIALOG,e,s,r));case SN.MYSTERYTROPHY_OPEN_DIALOG:return void n.dispatchEvent(new hN(hN.REQUEST_MYSTERYTROPHY_OPEN_DIALOG,e,s,r));case SN.ACHIEVEMENT_RESOLUTION_OPEN:return void this._roomEngine.connection.send(new CT(t.objectId,0));case SN.ACHIEVEMENT_RESOLUTION_ENGRAVING:return void n.dispatchEvent(new hN(hN.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING,e,s,r));case SN.ACHIEVEMENT_RESOLUTION_FAILED:return void n.dispatchEvent(new hN(hN.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,e,s,r));case SN.FRIEND_FURNITURE_CONFIRM:return void n.dispatchEvent(new hN(hN.REQUEST_FRIEND_FURNITURE_CONFIRM,e,s,r));case SN.FRIEND_FURNITURE_ENGRAVING:return void n.dispatchEvent(new hN(hN.REQUEST_FRIEND_FURNITURE_ENGRAVING,e,s,r));case SN.BADGE_DISPLAY_ENGRAVING:return void n.dispatchEvent(new hN(hN.REQUEST_BADGE_DISPLAY_ENGRAVING,e,s,r));case SN.HIGH_SCORE_DISPLAY:return void n.dispatchEvent(new hN(hN.REQUEST_HIGH_SCORE_DISPLAY,e,s,r));case SN.HIDE_HIGH_SCORE_DISPLAY:return void n.dispatchEvent(new hN(hN.REQUEST_HIDE_HIGH_SCORE_DISPLAY,e,s,r));case SN.INERNAL_LINK:return void n.dispatchEvent(new hN(hN.REQUEST_INTERNAL_LINK,e,s,r));case SN.ROOM_LINK:return void n.dispatchEvent(new hN(hN.REQUEST_ROOM_LINK,e,s,r));case SN.YOUTUBE:return void n.dispatchEvent(new hN(hN.REQUEST_YOUTUBE,e,s,r))}}onRoomObjectFurnitureActionEvent(t,e){t&&this.useObject(e,t.object.id,t.object.type,t.type)}handleObjectSoundMachineEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType),i=this.getSelectedRoomObjectData(e);if(!i||i.category!==s||i.id!==t.objectId||i.operation!==TD.OBJECT_PLACE)switch(t.type){case gN.SOUND_MACHINE_INIT:return void this._roomEngine.events.dispatchEvent(new fN(fN.SOUND_MACHINE_INIT,e,t.objectId,s));case gN.SOUND_MACHINE_START:return void this._roomEngine.events.dispatchEvent(new fN(fN.SOUND_MACHINE_SWITCHED_ON,e,t.objectId,s));case gN.SOUND_MACHINE_STOP:return void this._roomEngine.events.dispatchEvent(new fN(fN.SOUND_MACHINE_SWITCHED_OFF,e,t.objectId,s));case gN.SOUND_MACHINE_DISPOSE:return void this._roomEngine.events.dispatchEvent(new fN(fN.SOUND_MACHINE_DISPOSE,e,t.objectId,s))}}handleObjectJukeboxEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType),i=this.getSelectedRoomObjectData(e);if(!i||i.category!==s||i.id!==t.objectId||i.operation!==TD.OBJECT_PLACE)switch(t.type){case gN.JUKEBOX_INIT:return void this._roomEngine.events.dispatchEvent(new fN(fN.JUKEBOX_INIT,e,t.objectId,s));case gN.JUKEBOX_START:return void this._roomEngine.events.dispatchEvent(new fN(fN.JUKEBOX_SWITCHED_ON,e,t.objectId,s));case gN.JUKEBOX_MACHINE_STOP:return void this._roomEngine.events.dispatchEvent(new fN(fN.JUKEBOX_SWITCHED_OFF,e,t.objectId,s));case gN.JUKEBOX_DISPOSE:return void this._roomEngine.events.dispatchEvent(new fN(fN.JUKEBOX_DISPOSE,e,t.objectId,s))}}onRoomObjectFloorHoleEvent(t,e){if(t)switch(t.type){case lN.ADD_HOLE:return void this._roomEngine.addRoomInstanceFloorHole(e,t.objectId);case lN.REMOVE_HOLE:return void this._roomEngine.removeRoomInstanceFloorHole(e,t.objectId)}}onRoomObjectRoomAdEvent(t,e){if(!t)return;let s=null;switch(t.type){case TN.ROOM_AD_FURNI_CLICK:this._roomEngine.events.dispatchEvent(t),t.clickUrl&&t.clickUrl.length>0&&SU.instance.createLinkEvent(t.clickUrl),s=aN.FURNI_CLICK;break;case TN.ROOM_AD_FURNI_DOUBLE_CLICK:if(t.clickUrl&&t.clickUrl.length>0){const e="CATALOG_PAGE";0===t.clickUrl.indexOf(e)&&SU.instance.createLinkEvent(t.clickUrl.substr(e.length))}s=aN.FURNI_DOUBLE_CLICK;break;case TN.ROOM_AD_TOOLTIP_SHOW:s=aN.TOOLTIP_SHOW;break;case TN.ROOM_AD_TOOLTIP_HIDE:s=aN.TOOLTIP_HIDE}s&&this._roomEngine.events.dispatchEvent(new sN(s,e,t.objectId,this._roomEngine.getRoomObjectCategoryForType(t.objectType)))}onRoomObjectBadgeAssetEvent(t,e){if(t&&this._roomEngine)if(t.type!==dN.LOAD_BADGE);else{const s=t.objectId,i=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.loadRoomObjectBadgeImage(e,s,r,t.badgeId,t.groupBadge)}}handleMousePointer(t,e){t&&this._roomEngine.updateMousePointer(t.type,t.objectId,t.objectType)}handleRoomObjectPlaySoundEvent(t,e){const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case IN.PLAY_SOUND:return void this._roomEngine.events.dispatchEvent(new nN(nN.PLAY_SOUND,e,t.objectId,s,t.soundId,t.pitch));case IN.PLAY_SOUND_AT_PITCH:return void this._roomEngine.events.dispatchEvent(new nN(nN.PLAY_SOUND_AT_PITCH,e,t.objectId,s,t.soundId,t.pitch))}}handleRoomObjectSamplePlaybackEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case RN.ROOM_OBJECT_INITIALIZED:this._roomEngine.events.dispatchEvent(new oN(oN.ROOM_OBJECT_INITIALIZED,e,t.objectId,s,t.sampleId,t.pitch));break;case RN.ROOM_OBJECT_DISPOSED:this._roomEngine.events.dispatchEvent(new oN(oN.ROOM_OBJECT_DISPOSED,e,t.objectId,s,t.sampleId,t.pitch));break;case RN.PLAY_SAMPLE:this._roomEngine.events.dispatchEvent(new oN(oN.PLAY_SAMPLE,e,t.objectId,s,t.sampleId,t.pitch));break;case RN.CHANGE_PITCH:this._roomEngine.events.dispatchEvent(new oN(oN.CHANGE_PITCH,e,t.objectId,s,t.sampleId,t.pitch))}}onHSLColorEnableEvent(t,e){t&&this._roomEngine&&(t.type!==pN.ROOM_BACKGROUND_COLOR||this._roomEngine.events.dispatchEvent(new EN(EN.ROOM_BACKGROUND_COLOR,e,t.enable,t.hue,t.saturation,t.lightness)))}onRoomObjectDataRequestEvent(t,e){if(t&&this._roomEngine&&t.object)switch(t.type){case uN.RODRE_CURRENT_USER_ID:return void t.object.model.setValue(rt.SESSION_CURRENT_USER_ID,this._roomEngine.sessionDataManager.userId);case uN.RODRE_URL_PREFIX:return void t.object.model.setValue(rt.SESSION_URL_PREFIX,SU.instance.getConfiguration("url.prefix"))}}onRoomObjectTileMouseEvent(t,e){if(!this._roomEngine||this._roomEngine.isDecorating||!this._roomEngine.roomSessionManager)return;const s=this._roomEngine.roomSessionManager.getSession(t);s&&!s.isSpectator&&this.sendWalkUpdate(e.tileXAsInt,e.tileYAsInt)}handleObjectMove(t,e){if(!t||!this._roomEngine)return;if(!this._roomEngine.events)return;const s=this.getSelectedRoomObjectData(e);if(!s)return;const i=this._roomEngine.getRoomObject(e,s.id,s.category);if(!i)return;let r=!0;if(s.category===st.FLOOR||s.category===st.UNIT){const n=this._roomEngine.getFurnitureStackingHeightMap(e);t instanceof vN&&this.handleFurnitureMove(i,s,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),n)||(this.handleFurnitureMove(i,s,s.loc.x,s.loc.y,n),r=!1)}else if(s.category===st.WALL){if(r=!1,t instanceof AN){const e=t.wallLocation,n=t.wallWidth,a=t.wallHeight,o=t.x,h=t.y,_=t.direction;this.handleWallItemMove(i,s,e,n,a,o,h,_)&&(r=!0)}r||(i.setLocation(s.loc),i.setDirection(s.dir)),this._roomEngine.updateRoomObjectMask(e,s.id,r)}r?(this.setFurnitureAlphaMultiplier(i,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!1)):(this.setFurnitureAlphaMultiplier(i,0),this._roomEngine.setObjectMoverIconSpriteVisible(!0))}handleObjectPlace(t,e){if(!t||!this._roomEngine)return;if(!this._roomEngine.events)return;let s=this.getSelectedRoomObjectData(e);if(!s)return;let i=this._roomEngine.getRoomObject(e,s.id,s.category);if(!i){if(t instanceof vN){if(s.category===st.FLOOR)this._roomEngine.addFurnitureFloor(e,s.id,s.typeId,s.loc,s.dir,0,s.stuffData,parseFloat(s.instanceData),-1,0,0,"",!1);else if(s.category===st.UNIT){this._roomEngine.addRoomObjectUser(e,s.id,new dt,new dt(180),180,s.typeId,s.instanceData);const t=this._roomEngine.getRoomObject(e,s.id,s.category);t&&s.posture&&t.model.setValue(rt.FIGURE_POSTURE,s.posture)}}else t instanceof AN&&s.category===st.WALL&&this._roomEngine.addFurnitureWall(e,s.id,s.typeId,s.loc,s.dir,0,s.instanceData,0);if(i=this._roomEngine.getRoomObject(e,s.id,s.category),i&&s.category===st.FLOOR){const t=i.model.getValue(rt.FURNITURE_ALLOWED_DIRECTIONS);if(t&&t.length){const r=new dt(t[0]);if(i.setDirection(r),this.updateSelectedObjectData(e,s.id,s.category,s.loc,r,s.operation,s.typeId,s.instanceData,s.stuffData,s.state,s.animFrame,s.posture),s=this.getSelectedRoomObjectData(e),!s)return}}this.setFurnitureAlphaMultiplier(i,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!0)}if(i){let r=!0;const n=this._roomEngine.getFurnitureStackingHeightMap(e);if(s.category===st.FLOOR)t instanceof vN&&this.handleFurnitureMove(i,s,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),n)||(this._roomEngine.removeRoomObjectFloor(e,s.id),r=!1);else if(s.category===st.WALL){if(r=!1,t instanceof AN){const e=t.wallLocation,n=t.wallWidth,a=t.wallHeight,o=t.x,h=t.y,_=t.direction;this.handleWallItemMove(i,s,e,n,a,o,h,_)&&(r=!0)}r||this._roomEngine.removeRoomObjectWall(e,s.id),this._roomEngine.updateRoomObjectMask(e,s.id,r)}else s.category===st.UNIT&&(t instanceof vN&&this.handleUserPlace(i,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),this._roomEngine.getLegacyWallGeometry(e))||(this._roomEngine.removeRoomObjectUser(e,s.id),r=!1));this._roomEngine.setObjectMoverIconSpriteVisible(!r)}}handleFurnitureMove(t,e,s,i,r){if(!t||!e)return!1;const n=new dt;n.assign(t.getDirection()),t.setDirection(e.dir);const a=new dt(s,i,0),o=new dt;o.assign(t.getDirection());let h=this.validateFurnitureLocation(t,a,e.loc,e.dir,r);return h||(o.x=this.getValidRoomObjectDirection(t,!0),t.setDirection(o),h=this.validateFurnitureLocation(t,a,e.loc,e.dir,r)),h?(t.setLocation(h),o&&t.setDirection(o),!0):(t.setDirection(n),!1)}handleWallItemMove(t,e,s,i,r,n,a,o){if(!t||!e)return!1;const h=new dt(o),_=this.validateWallItemLocation(t,s,i,r,n,a,e);return!!_&&(t.setLocation(_),t.setDirection(h),!0)}validateFurnitureLocation(t,e,s,i,r){if(!t||!t.model||!e)return null;let n=null;const a=t.getDirection();if(!a)return null;if(!s||!i)return null;if(e.x===s.x&&e.y===s.y&&a.x===i.x)return n=new dt,n.assign(s),n;let o=t.model.getValue(rt.FURNITURE_SIZE_X),h=t.model.getValue(rt.FURNITURE_SIZE_Y);o<1&&(o=1),h<1&&(h=1);const _=s.x,d=s.y;let u=o,c=h,l=0,g=Math.trunc(Math.trunc(a.x+45)%360/90);if(1!==g&&3!==g||(l=o,o=h,h=l),g=Math.trunc(Math.trunc(i.x+45)%360/90),1!==g&&3!==g||(l=u,u=c,c=l),r&&e){const s=1===t.model.getValue(rt.FURNITURE_ALWAYS_STACKABLE);return r.validateLocation(e.x,e.y,o,h,_,d,u,c,s)?new dt(e.x,e.y,r.getTileHeight(e.x,e.y)):null}return null}validateWallItemLocation(t,e,s,i,r,n,a){if(null==t||null==t.model||null==e||null==s||null==i||null==a)return null;const o=t.model.getValue(rt.FURNITURE_SIZE_X),h=t.model.getValue(rt.FURNITURE_SIZE_Z),_=t.model.getValue(rt.FURNITURE_CENTER_Z);if((r<o/2||r>s.length-o/2||n<_||n>i.length-(h-_))&&(r<o/2&&r<=s.length-o/2?r=o/2:r>=o/2&&r>s.length-o/2&&(r=s.length-o/2),n<_&&n<=i.length-(h-_)?n=_:n>=_&&n>i.length-(h-_)&&(n=i.length-(h-_))),r<o/2||r>s.length-o/2||n<_||n>i.length-(h-_))return null;let d=dt.sum(dt.product(s,r/s.length),dt.product(i,n/i.length));return d=dt.sum(e,d),d}changeObjectState(t,e,s,i,r){const n=this._roomEngine.getRoomObjectCategoryForType(s);this.changeRoomObjectState(t,e,n,i,r)}useObject(t,e,s,i){if(this._roomEngine&&this._roomEngine.connection)switch(i){case gN.DICE_ACTIVATE:return void this._roomEngine.connection.send(new Zv(e));case gN.DICE_OFF:return void this._roomEngine.connection.send(new Jv(e));case gN.USE_HABBOWHEEL:return void this._roomEngine.connection.send(new Qv(e));case gN.STICKIE:return void this._roomEngine.connection.send(new Lv(e));case gN.ENTER_ONEWAYDOOR:return void this._roomEngine.connection.send(new eA(e))}}changeRoomObjectState(t,e,s,i,r){return!this._roomEngine||!this._roomEngine.connection||(s===st.FLOOR?r?this._roomEngine.connection.send(new sA(e,i)):this._roomEngine.connection.send(new tA(e,i)):s===st.WALL&&this._roomEngine.connection.send(new rA(e,i)),!0)}sendWalkUpdate(t,e){this._roomEngine&&this._roomEngine.connection&&this._roomEngine.connection.send(new PA(t,e))}handleMouseOverObject(t,e,s){if(t!==st.FLOOR)return null;const i=this._roomEngine.getRoomObject(e,s.objectId,st.FLOOR);if(!i)return null;const r=this.getActiveSurfaceLocation(i,s);if(!r)return null;if(!this._roomEngine.getFurnitureStackingHeightMap(e))return null;const n=r.x,a=r.y,o=r.z;return new mD(new dt(n,a,i.getLocation().z),o,!0,s.eventId)}handleMoveTargetFurni(t,e){if(e.objectType===it.USER||e.objectType===it.PET||e.objectType===it.BOT||e.objectType===it.RENTABLE_BOT||e.objectType===it.MONSTER_PLANT)return;const s=this._roomEngine.getRoomObject(t,e.objectId,st.FLOOR),i=this.getActiveSurfaceLocation(s,e);return!!i&&(this.sendWalkUpdate(i.x,i.y),!0)}getActiveSurfaceLocation(t,e){if(!t||!e)return null;const s=this._roomEngine.sessionDataManager.getFloorItemDataByName(t.type);if(!s)return null;if(!s.canStandOn&&!s.canSitOn&&!s.canLayOn)return null;const i=t.model;if(!i)return null;const r=t.getLocation(),n=t.getDirection();let a=i.getValue(rt.FURNITURE_SIZE_X),o=i.getValue(rt.FURNITURE_SIZE_Y);const h=i.getValue(rt.FURNITURE_SIZE_Z);90!==n.x&&270!==n.x||([a,o]=[o,a]),a<1&&(a=1),o<1&&(o=1);const _=this._roomEngine.getActiveRoomInstanceRenderingCanvas();if(!_)return null;const d=_.geometry.scale,u=s.canSitOn?.5:0,c=(d/2+e.spriteOffsetX+e.localX)/(d/4),l=(e.spriteOffsetY+e.localY+(h-u)*d/2)/(d/4),g=(c+2*l)/4,E=(c-2*l)/4,p=Math.floor(r.x+g),m=Math.floor(r.y-E+1);let I=!1;(p<r.x||p>=r.x+a||m<r.y||m>=r.y+o)&&(I=!0);const T=s.canSitOn?h-.5:h;return I?null:new dt(p,m,T)}handleMouseOverTile(t,e){if(this._whereYouClickIsWhereYouGo)return new mD(new dt(t.tileXAsInt,t.tileYAsInt,t.tileZAsInt),0,!0,t.eventId);const s=this._roomEngine.getRoomObjectCursor(e);if(s&&s.visualization){const s=t.tileXAsInt,i=t.tileYAsInt,r=t.tileZAsInt;if(this._roomEngine.getRoomInstance(e)){const n=this._roomEngine.getRoomTileObjectMap(e);if(n){const a=n.getObjectIntTile(s,i),o=this._roomEngine.getFurnitureStackingHeightMap(e);if(o){if(a&&a.model&&a.model.getValue(rt.FURNITURE_IS_VARIABLE_HEIGHT)>0){const n=o.getTileHeight(s,i),a=this._roomEngine.getLegacyWallGeometry(e).getHeight(s,i);return new mD(new dt(s,i,r),n-a,!0,t.eventId)}return new mD(new dt(s,i,r),0,!0,t.eventId)}}}}return null}placeObject(t,e,s){const i=this.getSelectedRoomObjectData(t);if(!i)return;let r=null,n=i.id;const a=i.category;let o=0,h=0,_=0,d=0,u="";if(this._roomEngine&&this._roomEngine.connection&&(r=this._roomEngine.getRoomObject(t,n,a),r)){const e=r.getLocation();if(d=r.getDirection().x,a===st.FLOOR||a===st.UNIT)o=e.x,h=e.y,_=e.z;else if(a===st.WALL){o=e.x,h=e.y,_=e.z;const s=this._roomEngine.getLegacyWallGeometry(t);s&&(u=s.getOldLocationString(e,d))}d=(d/45%8+8)%8,n<0&&a===st.UNIT&&(n*=-1),this._objectPlacementSource!==gD.CATALOG&&(a===st.UNIT?i.typeId===E_.PET?this._roomEngine.connection.send(new bv(n,Math.trunc(o),Math.trunc(h))):i.typeId===E_.RENTABLE_BOT&&this._roomEngine.connection.send(new Nv(n,Math.trunc(o),Math.trunc(h))):void 0!==r.model.getValue(rt.FURNITURE_IS_STICKIE)?this._roomEngine.connection.send(new qv(n,u)):this._roomEngine.connection.send(new Kv(n,a,u,Math.trunc(o),Math.trunc(h),d)))}if(this._roomEngine.setPlacedRoomObjectData(t,new RD(i.id,i.category,null,i.dir,null)),this.resetSelectedObjectData(t),this._roomEngine&&this._roomEngine.events){const c=r&&r.id===i.id;this._roomEngine.events.dispatchEvent(new iN(sN.PLACED,t,n,a,u,o,h,_,d,c,e,s,i.instanceData))}}modifyRoomObject(t,e,s,i){if(!this._roomEngine)return!1;const r=this._roomEngine.getRoomObject(t,e,s);if(!r)return!1;let n=!0;switch(i){case TD.OBJECT_ROTATE_POSITIVE:case TD.OBJECT_ROTATE_NEGATIVE:if(this._roomEngine.connection){let s=0;s=i==TD.OBJECT_ROTATE_NEGATIVE?this.getValidRoomObjectDirection(r,!1):this.getValidRoomObjectDirection(r,!0);const n=r.getLocation().x,a=r.getLocation().y;if(this.isValidLocation(r,new dt(s),this._roomEngine.getFurnitureStackingHeightMap(t)))if(s=Math.trunc(s/45),r.type===it.MONSTER_PLANT){const i=this._roomEngine.roomSessionManager.getSession(t);if(i){const t=i.userDataManager.getUserDataByIndex(e);t&&this._roomEngine.connection.send(new Pv(t.webID,Math.trunc(n),Math.trunc(a),s))}}else this._roomEngine.connection.send(new kv(e,n,a,s))}break;case TD.OBJECT_EJECT:case TD.OBJECT_PICKUP:this._roomEngine.connection&&this._roomEngine.connection.send(new Wv(s,e));break;case TD.OBJECT_PICKUP_PET:if(this._roomEngine.connection){const s=this._roomEngine.roomSessionManager.getSession(t);if(s){const t=s.userDataManager.getUserDataByIndex(e);s.pickupPet(t.webID)}}break;case TD.OBJECT_PICKUP_BOT:if(this._roomEngine.connection){const s=this._roomEngine.roomSessionManager.getSession(t);if(s){const t=s.userDataManager.getUserDataByIndex(e);s.pickupBot(t.webID)}}break;case TD.OBJECT_MOVE:n=!1,this.setFurnitureAlphaMultiplier(r,.5),this.setSelectedRoomObjectData(t,r.id,s,r.getLocation(),r.getDirection(),i),this._roomEngine.setObjectMoverIconSprite(r.id,s,!0),this._roomEngine.setObjectMoverIconSpriteVisible(!1);break;case TD.OBJECT_MOVE_TO:{const i=this.getSelectedRoomObjectData(t);if(this.updateSelectedObjectData(t,i.id,i.category,i.loc,i.dir,TD.OBJECT_MOVE_TO,i.typeId,i.instanceData,i.stuffData,i.state,i.animFrame,i.posture),this.setFurnitureAlphaMultiplier(r,1),this._roomEngine.removeObjectMoverIconSprite(),this._roomEngine.connection)if(s===st.FLOOR){const t=r.getDirection().x%360,s=r.getLocation(),i=t/45;this._roomEngine.connection.send(new kv(e,s.x,s.y,i))}else if(s===st.WALL){const s=r.getDirection().x%360,i=this._roomEngine.getLegacyWallGeometry(t);if(i){const t=i.getOldLocationString(r.getLocation(),s);t&&this._roomEngine.connection.send(new _A(e,t))}}else if(s===st.UNIT){const s=r.getDirection().x%360,i=r.getLocation(),n=s/45,a=(parseInt(r.model.getValue(rt.RACE)),this._roomEngine.roomSessionManager.getSession(t));if(a){const t=a.userDataManager.getUserDataByIndex(e);t&&this._roomEngine.connection.send(new Pv(t.webID,i.x,i.y,n))}}break}}return n&&this.resetSelectedObjectData(t),!0}modifyRoomObjectDataWithMap(t,e,s,i,r){if(!this._roomEngine)return!1;if(!this._roomEngine.getRoomObject(t,e,s))return!1;if(i===TD.OBJECT_SAVE_STUFF_DATA)this._roomEngine.connection&&this._roomEngine.connection.send(new Bv(e,r));return!0}modifyWallItemData(t,e,s,i){return!(!this._roomEngine||!this._roomEngine.connection)&&(this._roomEngine.connection.send(new xv(e,s,i)),!0)}deleteWallItem(t,e){return!(!this._roomEngine||!this._roomEngine.connection)&&(this._roomEngine.connection.send(new Fv(e)),!0)}getValidRoomObjectDirection(t,e){if(!t||!t.model)return 0;let s=0,i=0,r=[];r=t.type===it.MONSTER_PLANT?t.model.getValue(rt.PET_ALLOWED_DIRECTIONS):t.model.getValue(rt.FURNITURE_ALLOWED_DIRECTIONS);let n=t.getDirection().x;if(r&&r.length){if(s=r.indexOf(n),s<0){for(s=0,i=0;i<r.length&&!(n<=r[i]);)s++,i++;s%=r.length}s=e?(s+1)%r.length:(s-1+r.length)%r.length,n=r[s]}return n}isValidLocation(t,e,s){if(!t||!t.model||!e)return!1;const i=t.getDirection(),r=t.getLocation();if(!i||!r)return!1;if(i.x%180===e.x%180)return!0;let n=t.model.getValue(rt.FURNITURE_SIZE_X),a=t.model.getValue(rt.FURNITURE_SIZE_Y);n<1&&(n=1),a<1&&(a=1);let o=n,h=a,_=Math.trunc(Math.trunc(e.x+45)%360/90);if(1!==_&&3!==_||([n,a]=[a,n]),_=Math.trunc(Math.trunc(i.x+45)%360/90),1!==_&&3!==_||([o,h]=[h,o]),s&&r){const e=1===t.model.getValue(rt.FURNITURE_ALWAYS_STACKABLE);if(s.validateLocation(r.x,r.y,n,a,r.x,r.y,o,h,e,r.z))return!0}return!1}placeObjectOnUser(t,e,s){const i=this.getSelectedRoomObjectData(t);if(!i)return;this._roomEngine.getRoomObject(t,e,s)&&this._roomEngine&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new rN(sN.PLACED_ON_USER,t,e,s,i.id,i.category))}setSelectedObject(t,e,s){if(!this._roomEngine)return;const i=this._roomEngine.events;if(i)switch(s){case st.UNIT:case st.FLOOR:case st.WALL:if(s===st.UNIT)this.deselectObject(t),this.setSelectedAvatar(t,e,!0);else if(this.setSelectedAvatar(t,0,!1),e!==this._selectedObjectId){this.deselectObject(t);const i=this._roomEngine.getRoomObject(t,e,s);i&&i.logic&&(i.logic.processUpdateMessage(new pD(!0)),this._selectedObjectId=e,this._selectedObjectCategory=s)}return void i.dispatchEvent(new sN(sN.SELECTED,t,e,s))}}deselectObject(t){if(-1===this._selectedObjectId)return;const e=this._roomEngine.getRoomObject(t,this._selectedObjectId,this._selectedObjectCategory);e&&e.logic&&(e.logic.processUpdateMessage(new pD(!1)),this._selectedObjectId=-1,this._selectedObjectCategory=st.MINIMUM)}setSelectedAvatar(t,e,s){if(!this._roomEngine)return;const i=st.UNIT,r=this._roomEngine.getRoomObject(t,this._selectedAvatarId,i);r&&r.logic&&(r.logic.processUpdateMessage(new ED(!1)),this._selectedAvatarId=-1);let n=!1;if(s){const s=this._roomEngine.getRoomObject(t,e,i);if(s&&s.logic){s.logic.processUpdateMessage(new ED(!0)),n=!0,this._selectedAvatarId=e;const t=s.getLocation();t&&this._roomEngine.connection.send(new CA(~~t.x,~~t.y))}}const a=this._roomEngine.getRoomObjectSelectionArrow(t);a&&a.logic&&(n&&!this._roomEngine.isPlayingGame()?a.logic.processUpdateMessage(new ID(ID.ENABLED)):a.logic.processUpdateMessage(new ID(ID.DISABLED)))}resetSelectedObjectData(t){if(!this._roomEngine)return;this._roomEngine.removeObjectMoverIconSprite();const e=this.getSelectedRoomObjectData(t);if(e){if(e.operation===TD.OBJECT_MOVE||e.operation===TD.OBJECT_MOVE_TO){const s=this._roomEngine.getRoomObject(t,e.id,e.category);s&&e.operation!==TD.OBJECT_MOVE_TO&&(s.setLocation(e.loc),s.setDirection(e.dir)),this.setFurnitureAlphaMultiplier(s,1),e.category===st.WALL&&this._roomEngine.updateRoomObjectMask(t,e.id,!0),this.updateSelectedObjectData(t,e.id,e.category,e.loc,e.dir,TD.OBJECT_MOVE,e.typeId,e.instanceData,e.stuffData,e.state,e.animFrame,e.posture)}else if(e.operation===TD.OBJECT_PLACE){const s=e.id;switch(e.category){case st.FLOOR:this._roomEngine.removeRoomObjectFloor(t,s);break;case st.WALL:this._roomEngine.removeRoomObjectWall(t,s);break;case st.UNIT:this._roomEngine.removeRoomObjectUser(t,s)}}this._roomEngine.setSelectedRoomObjectData(t,null)}}getSelectedRoomObjectData(t){return this._roomEngine?this._roomEngine.getSelectedRoomObjectData(t):null}setFurnitureAlphaMultiplier(t,e){t&&t.model&&t.model.setValue(rt.FURNITURE_ALPHA_MULTIPLIER,e)}decorateModeMove(t){return this._roomEngine.isDecorating&&!(t.ctrlKey||t.shiftKey)}cancelRoomObjectPlacement(t){return this.resetSelectedObjectData(t),!0}setSelectedRoomObjectData(t,e,s,i,r,n){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:-1,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:-1,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null;if(this.resetSelectedObjectData(t),!this._roomEngine)return;const c=new RD(e,s,n,i,r,a,o,h,_,d,u);this._roomEngine.setSelectedRoomObjectData(t,c)}updateSelectedObjectData(t,e,s,i,r,n){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:-1,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:-1,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null;if(!this._roomEngine)return null;const c=new RD(e,s,n,i,r,a,o,h,_,d,u);this._roomEngine.setSelectedRoomObjectData(t,c)}handleUserPlace(t,e,s,i){return!!i.isRoomTile(e,s)&&(t.setLocation(new dt(e,s,i.getHeight(e,s))),!0)}get engine(){return this._roomEngine}get selectedAvatarId(){return this._selectedAvatarId}}class OD extends we{constructor(){super(),this._liftAmount=void 0,this._location=void 0,this._locationDelta=void 0,this._lastUpdateTime=void 0,this._changeTime=void 0,this._updateInterval=void 0,this._liftAmount=0,this._location=new dt,this._locationDelta=new dt,this._lastUpdateTime=0,this._changeTime=0,this._updateInterval=OD.DEFAULT_UPDATE_INTERVAL}onDispose(){this._liftAmount=0,super.onDispose()}update(t){super.update(t);const e=this.getLocationOffset(),s=this.object&&this.object.model;if(s&&(e?this._liftAmount!==e.z&&(this._liftAmount=e.z,s.setValue(rt.FURNITURE_LIFT_AMOUNT,this._liftAmount)):0!==this._liftAmount&&(this._liftAmount=0,s.setValue(rt.FURNITURE_LIFT_AMOUNT,this._liftAmount))),this._locationDelta.length>0||e){const t=OD.TEMP_VECTOR;let s=this.time-this._changeTime;s===this._updateInterval>>1&&s++,s>this._updateInterval&&(s=this._updateInterval),this._locationDelta.length>0?(t.assign(this._locationDelta),t.multiply(s/this._updateInterval),t.add(this._location)):t.assign(this._location),e&&t.add(e),this.object.setLocation(t),s===this._updateInterval&&(this._locationDelta.x=0,this._locationDelta.y=0,this._locationDelta.z=0)}this._lastUpdateTime=this.time}setObject(t){super.setObject(t),t&&this._location.assign(t.getLocation())}processUpdateMessage(t){if(t)return super.processUpdateMessage(t),t.location&&this._location.assign(t.location),t instanceof qN?this.processMoveMessage(t):void 0}processMoveMessage(t){t&&this.object&&t.location&&(this._changeTime=this._lastUpdateTime,this._locationDelta.assign(t.targetLocation),this._locationDelta.subtract(this._location))}getLocationOffset(){return null}get lastUpdateTime(){return this._lastUpdateTime}set updateInterval(t){t<=0&&(t=1),this._updateInterval=t}}OD.DEFAULT_UPDATE_INTERVAL=500,OD.TEMP_VECTOR=new dt;class vD extends OD{constructor(){super(),this._selected=void 0,this._reportedLocation=void 0,this._effectChangeTimeStamp=void 0,this._newEffect=void 0,this._blinkingStartTimestamp=void 0,this._blinkingEndTimestamp=void 0,this._talkingEndTimestamp=void 0,this._talkingPauseStartTimestamp=void 0,this._talkingPauseEndTimestamp=void 0,this._carryObjectStartTimestamp=void 0,this._carryObjectEndTimestamp=void 0,this._allowUseCarryObject=void 0,this._animationEndTimestamp=void 0,this._signEndTimestamp=void 0,this._gestureEndTimestamp=void 0,this._numberValueEndTimestamp=void 0,this._selected=!1,this._reportedLocation=null,this._effectChangeTimeStamp=0,this._newEffect=0,this._blinkingStartTimestamp=SU.instance.time+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=0,this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0,this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1,this._animationEndTimestamp=0,this._signEndTimestamp=0,this._gestureEndTimestamp=0,this._numberValueEndTimestamp=0}getEventTypes(){const t=[De.CLICK,mN.POSITION_CHANGED,De.MOUSE_ENTER,De.MOUSE_LEAVE,gN.MOUSE_BUTTON,gN.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new mN(mN.OBJECT_REMOVED,this.object)),super.dispose(),this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const t=this.object.getLocation();this._reportedLocation&&this._reportedLocation.x===t.x&&this._reportedLocation.y===t.y&&this._reportedLocation.z===t.z||(this._reportedLocation||(this._reportedLocation=new dt),this._reportedLocation.assign(t),this.eventDispatcher.dispatchEvent(new mN(mN.POSITION_CHANGED,this.object)))}const e=this.object&&this.object.model;e&&this.updateModel(this.time,e)}updateModel(t,e){this._talkingEndTimestamp>0&&(t>this._talkingEndTimestamp?(e.setValue(rt.FIGURE_TALK,0),this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0):this._talkingPauseEndTimestamp||this._talkingPauseStartTimestamp?this._talkingPauseStartTimestamp>0&&t>this._talkingPauseStartTimestamp?(e.setValue(rt.FIGURE_TALK,0),this._talkingPauseStartTimestamp=0):this._talkingPauseEndTimestamp>0&&t>this._talkingPauseEndTimestamp&&(e.setValue(rt.FIGURE_TALK,1),this._talkingPauseEndTimestamp=0):(this._talkingPauseStartTimestamp=t+this.randomTalkingPauseStartTimestamp(),this._talkingPauseEndTimestamp=this._talkingPauseStartTimestamp+this.randomTalkingPauseEndTimestamp())),this._animationEndTimestamp>0&&t>this._animationEndTimestamp&&(e.setValue(rt.FIGURE_EXPRESSION,0),this._animationEndTimestamp=0),this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(rt.FIGURE_GESTURE,0),this._gestureEndTimestamp=0),this._signEndTimestamp>0&&t>this._signEndTimestamp&&(e.setValue(rt.FIGURE_SIGN,-1),this._signEndTimestamp=0),this._carryObjectEndTimestamp>0&&t>this._carryObjectEndTimestamp&&(e.setValue(rt.FIGURE_CARRY_OBJECT,0),e.setValue(rt.FIGURE_USE_OBJECT,0),this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1),this._allowUseCarryObject&&t-this._carryObjectStartTimestamp>5e3&&((t-this._carryObjectStartTimestamp)%1e4<1e3?e.setValue(rt.FIGURE_USE_OBJECT,1):e.setValue(rt.FIGURE_USE_OBJECT,0)),this._blinkingStartTimestamp>-1&&t>this._blinkingStartTimestamp&&(e.setValue(rt.FIGURE_BLINK,1),this._blinkingStartTimestamp=t+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=t+this.randomBlinkEndTimestamp()),this._blinkingEndTimestamp>0&&t>this._blinkingEndTimestamp&&(e.setValue(rt.FIGURE_BLINK,0),this._blinkingEndTimestamp=0),this._effectChangeTimeStamp>0&&t>this._effectChangeTimeStamp&&(e.setValue(rt.FIGURE_EFFECT,this._newEffect),this._effectChangeTimeStamp=0),this._numberValueEndTimestamp>0&&t>this._numberValueEndTimestamp&&(e.setValue(rt.FIGURE_NUMBER_VALUE,0),this._numberValueEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const e=this.object&&this.object.model;if(e){if(t instanceof zN)return e.setValue(rt.FIGURE_POSTURE,t.postureType),void e.setValue(rt.FIGURE_POSTURE_PARAMETER,t.parameter);if(t instanceof LN)return e.setValue(rt.FIGURE_TALK,1),void(this._talkingEndTimestamp=this.time+1e3*t.numberOfWords);if(t instanceof XN)e.setValue(rt.FIGURE_IS_TYPING,t.isTyping?1:0);else if(t instanceof HN)e.setValue(rt.FIGURE_IS_MUTED,t.isMuted?1:0);else if(t instanceof YN)e.setValue(rt.FIGURE_IS_PLAYING_GAME,t.isPlayingGame?1:0);else{if(t instanceof QN)return e.setValue(rt.HEAD_DIRECTION,t.headDirection),e.setValue(rt.FIGURE_CAN_STAND_UP,t.canStandUp),void e.setValue(rt.FIGURE_VERTICAL_OFFSET,t.baseY);if(t instanceof BN)return e.setValue(rt.FIGURE_GESTURE,t.gesture),void(this._gestureEndTimestamp=this.time+3e3);if(t instanceof wN)return e.setValue(rt.FIGURE_EXPRESSION,t.expressionType),this._animationEndTimestamp=Bt.getExpressionTimeout(e.getValue(rt.FIGURE_EXPRESSION)),void(this._animationEndTimestamp>-1&&(this._animationEndTimestamp+=this.time));if(t instanceof UN)e.setValue(rt.FIGURE_DANCE,t.danceStyle);else{if(t instanceof KN)return e.setValue(rt.FIGURE_SLEEP,t.isSleeping?1:0),void(t.isSleeping?this._blinkingStartTimestamp=-1:this._blinkingStartTimestamp=this.time+this.randomBlinkStartTimestamp());if(t instanceof kN)return e.setValue(rt.FIGURE_NUMBER_VALUE,t.value),void(this._numberValueEndTimestamp=this.time+3e3);if(t instanceof PN)this.updateAvatarEffect(t.effect,t.delayMilliseconds,e);else{if(t instanceof CN)return e.setValue(rt.FIGURE_CARRY_OBJECT,t.itemType),e.setValue(rt.FIGURE_USE_OBJECT,0),void(0===t.itemType?(this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1):(this._carryObjectStartTimestamp=this.time,t.itemType<vD.MAX_HAND_ID?(this._carryObjectEndTimestamp=0,this._allowUseCarryObject=t.itemType<=vD.MAX_HAND_USE_ID):(this._carryObjectEndTimestamp=this._carryObjectStartTimestamp+1500,this._allowUseCarryObject=!1)));if(t instanceof ZN)e.setValue(rt.FIGURE_USE_OBJECT,t.itemType);else{if(t instanceof WN)return e.setValue(rt.FIGURE_SIGN,t.signType),void(this._signEndTimestamp=this.time+5e3);if(!(t instanceof xN))return t instanceof FN?(e.setValue(rt.FIGURE,t.figure),void e.setValue(rt.GENDER,t.gender)):t instanceof ED?(this._selected=t.selected,void(this._reportedLocation=null)):void(t instanceof VN&&e.setValue(rt.OWN_USER,1));e.setValue(rt.FIGURE_FLAT_CONTROL,t.level)}}}}}}updateAvatarEffect(t,e,s){if(t===vD.EFFECT_TYPE_SPLASH)this._effectChangeTimeStamp=SU.instance.time+vD.EFFECT_SPLASH_LENGTH,this._newEffect=vD.EFFECT_TYPE_SWIM;else if(t===vD.EFFECT_TYPE_SPLASH_DARK)this._effectChangeTimeStamp=SU.instance.time+vD.EFFECT_SPLASH_LENGTH,this._newEffect=vD.EFFECT_TYPE_SWIM_DARK;else if(s.getValue(rt.FIGURE_EFFECT)===vD.EFFECT_TYPE_SWIM)this._effectChangeTimeStamp=SU.instance.time+vD.EFFECT_SPLASH_LENGTH,this._newEffect=t,t=vD.EFFECT_TYPE_SPLASH;else if(s.getValue(rt.FIGURE_EFFECT)===vD.EFFECT_TYPE_SWIM_DARK)this._effectChangeTimeStamp=SU.instance.time+vD.EFFECT_SPLASH_LENGTH,this._newEffect=t,t=vD.EFFECT_TYPE_SPLASH_DARK;else{if(0!==e)return this._effectChangeTimeStamp=SU.instance.time+e,void(this._newEffect=t);this._effectChangeTimeStamp=0}s.setValue(rt.FIGURE_EFFECT,t)}mouseEvent(t,e){let s=null;switch(t.type){case ts.MOUSE_CLICK:s=De.CLICK;break;case ts.ROLL_OVER:s=De.MOUSE_ENTER,this.object.model&&this.object.model.setValue(rt.FIGURE_HIGHLIGHT,1),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new gN(gN.MOUSE_BUTTON,this.object));break;case ts.ROLL_OUT:s=De.MOUSE_LEAVE,this.object.model&&this.object.model.setValue(rt.FIGURE_HIGHLIGHT,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new gN(gN.MOUSE_ARROW,this.object))}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new De(s,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}randomTalkingPauseStartTimestamp(){return 100+200*Math.random()}randomTalkingPauseEndTimestamp(){return 75+75*Math.random()}randomBlinkStartTimestamp(){return 4500+1e3*Math.random()}randomBlinkEndTimestamp(){return 50+200*Math.random()}}vD.MAX_HAND_ID=999999999,vD.MAX_HAND_USE_ID=999,vD.EFFECT_TYPE_SPLASH=28,vD.EFFECT_SPLASH_LENGTH=500,vD.EFFECT_TYPE_SWIM=29,vD.EFFECT_TYPE_SPLASH_DARK=184,vD.EFFECT_TYPE_SWIM_DARK=185;class AD extends OD{constructor(){super(),this._sizeX=void 0,this._sizeY=void 0,this._sizeZ=void 0,this._centerX=void 0,this._centerY=void 0,this._centerZ=void 0,this._directions=void 0,this._mouseOver=void 0,this._locationOffset=void 0,this._bouncingStep=void 0,this._storedRotateMessage=void 0,this._directionInitialized=void 0,this._sizeX=0,this._sizeY=0,this._sizeZ=0,this._centerX=0,this._centerY=0,this._centerZ=0,this._directions=[],this._mouseOver=!1,this._locationOffset=new dt,this._bouncingStep=0,this._storedRotateMessage=null,this._directionInitialized=!1,-1===AD.BOUNCING_STEPS&&(AD.BOUNCING_STEPS=SU.instance.getConfiguration("furni.rotation.bounce.steps",8)),-1===AD.BOUNCING_Z&&(AD.BOUNCING_Z=SU.instance.getConfiguration("furni.rotation.bounce.height",.0625))}getEventTypes(){const t=[ON.STATE_CHANGE,De.CLICK,De.MOUSE_DOWN,De.MOUSE_DOWN_LONG,TN.ROOM_AD_TOOLTIP_SHOW,TN.ROOM_AD_TOOLTIP_HIDE,TN.ROOM_AD_FURNI_DOUBLE_CLICK,TN.ROOM_AD_FURNI_CLICK];return this.widget&&t.push(SN.OPEN_WIDGET,SN.CLOSE_WIDGET),this.contextMenu&&t.push(SN.OPEN_FURNI_CONTEXT_MENU,SN.CLOSE_FURNI_CONTEXT_MENU),this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(e){if(t.logic){if(t.logic.model){const e=t.logic.model.dimensions;e&&(this._sizeX=e.x,this._sizeY=e.y,this._sizeZ=e.z,this._centerX=this._sizeX/2,this._centerY=this._sizeY/2,this._centerZ=this._sizeZ/2);const s=t.logic.model.directions;if(s&&s.length){for(const t of s)this._directions.push(t);this._directions.sort(((t,e)=>t-e))}}if(t.logic.customVars){const s=t.logic.customVars.variables;s&&s.length&&e.setValue(rt.FURNITURE_CUSTOM_VARIABLES,s)}}e.setValue(rt.FURNITURE_SIZE_X,this._sizeX),e.setValue(rt.FURNITURE_SIZE_Y,this._sizeY),e.setValue(rt.FURNITURE_SIZE_Z,this._sizeZ),e.setValue(rt.FURNITURE_CENTER_X,this._centerX),e.setValue(rt.FURNITURE_CENTER_Y,this._centerY),e.setValue(rt.FURNITURE_CENTER_Z,this._centerZ),e.setValue(rt.FURNITURE_ALLOWED_DIRECTIONS,this._directions),e.setValue(rt.FURNITURE_ALPHA_MULTIPLIER,1)}}onDispose(){this._storedRotateMessage=null,this._directions=null,super.onDispose()}setObject(t){super.setObject(t),t&&t.getLocation().length&&(this._directionInitialized=!0)}getAdClickUrl(t){return t.getValue(rt.FURNITURE_AD_URL)}handleAdClick(t,e,s){this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new TN(TN.ROOM_AD_FURNI_CLICK,this.object))}update(t){super.update(t),this._bouncingStep>0&&(this._bouncingStep++,this._bouncingStep>AD.BOUNCING_STEPS&&(this._bouncingStep=0))}processUpdateMessage(t){if(t instanceof JN)this.processDataUpdateMessage(t);else if(t instanceof tM)this.processObjectHeightUpdateMessage(t);else if(t instanceof eM)this.processItemDataUpdateMessage(t);else{if(this._mouseOver=!1,t.location&&t.direction){if(!(t instanceof qN)){const e=this.object.getDirection(),s=this.object.getLocation();e.x!==t.direction.x&&this._directionInitialized&&s.x===t.location.x&&s.y===t.location.y&&s.z===t.location.z&&(this._bouncingStep=1,this._storedRotateMessage=new Ue(t.location,t.direction),t=null)}this._directionInitialized=!0}if(t instanceof pD&&this.contextMenu&&this.eventDispatcher&&this.object){const e=t.selected?SN.OPEN_FURNI_CONTEXT_MENU:SN.CLOSE_FURNI_CONTEXT_MENU;this.eventDispatcher.dispatchEvent(new SN(e,this.object))}super.processUpdateMessage(t)}}processDataUpdateMessage(t){t&&(this.object.setState(t.state,0),t.data&&t.data.writeRoomObjectModel(this.object.model),null!==t.extra&&this.object.model.setValue(rt.FURNITURE_EXTRAS,t.extra.toString()),this.object.model.setValue(rt.FURNITURE_STATE_UPDATE_TIME,this.lastUpdateTime))}processObjectHeightUpdateMessage(t){t&&this.object.model.setValue(rt.FURNITURE_SIZE_Z,t.height)}processItemDataUpdateMessage(t){t&&this.object.model.setValue(rt.FURNITURE_ITEMDATA,t.data)}mouseEvent(t,e){const s=this.getAdClickUrl(this.object.model);switch(t.type){case ts.MOUSE_MOVE:if(this.eventDispatcher){const e=new De(De.MOUSE_MOVE,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);e.localX=t.localX,e.localY=t.localY,e.spriteOffsetX=t.spriteOffsetX,e.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(e)}return;case ts.ROLL_OVER:if(!this._mouseOver){if(this.eventDispatcher){s&&0===s.indexOf("http")&&this.eventDispatcher.dispatchEvent(new TN(TN.ROOM_AD_TOOLTIP_SHOW,this.object));const e=new De(De.MOUSE_ENTER,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);e.localX=t.localX,e.localY=t.localY,e.spriteOffsetX=t.spriteOffsetX,e.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(e)}this._mouseOver=!0}return;case ts.ROLL_OUT:if(this._mouseOver){if(this.eventDispatcher){s&&0===s.indexOf("http")&&this.eventDispatcher.dispatchEvent(new TN(TN.ROOM_AD_TOOLTIP_HIDE,this.object));const e=new De(De.MOUSE_LEAVE,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);e.localX=t.localX,e.localY=t.localY,e.spriteOffsetX=t.spriteOffsetX,e.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(e)}this._mouseOver=!1}return;case ts.DOUBLE_CLICK:return void this.useObject();case ts.MOUSE_CLICK:if(this.eventDispatcher){const e=new De(De.CLICK,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);e.localX=t.localX,e.localY=t.localY,e.spriteOffsetX=t.spriteOffsetX,e.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(e),s&&0===s.indexOf("http")&&this.eventDispatcher.dispatchEvent(new TN(TN.ROOM_AD_TOOLTIP_HIDE,this.object)),s&&s.length&&this.handleAdClick(this.object.id,this.object.type,s)}return;case ts.MOUSE_DOWN:if(this.eventDispatcher){const e=new De(De.MOUSE_DOWN,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);this.eventDispatcher.dispatchEvent(e)}return;case ts.MOUSE_DOWN_LONG:if(this.eventDispatcher){const e=new De(De.MOUSE_DOWN_LONG,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);this.eventDispatcher.dispatchEvent(e)}return}}getLocationOffset(){return this._bouncingStep<=0?null:(this._locationOffset.x=0,this._locationOffset.y=0,this._bouncingStep<=AD.BOUNCING_STEPS/2?this._locationOffset.z=AD.BOUNCING_Z*this._bouncingStep:this._bouncingStep<=AD.BOUNCING_STEPS&&(this._storedRotateMessage&&(super.processUpdateMessage(this._storedRotateMessage),this._storedRotateMessage=null),this._locationOffset.z=AD.BOUNCING_Z*(AD.BOUNCING_STEPS-this._bouncingStep)),this._locationOffset)}useObject(){if(!this.object||!this.eventDispatcher)return;const t=this.getAdClickUrl(this.object.model);t&&t.length&&this.eventDispatcher.dispatchEvent(new TN(TN.ROOM_AD_FURNI_DOUBLE_CLICK,this.object,null,t)),this.widget&&this.eventDispatcher.dispatchEvent(new SN(SN.OPEN_WIDGET,this.object)),this.eventDispatcher.dispatchEvent(new ON(ON.STATE_CHANGE,this.object))}tearDown(){1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&(this.widget&&this.eventDispatcher.dispatchEvent(new SN(SN.CLOSE_WIDGET,this.object)),this.contextMenu&&this.eventDispatcher.dispatchEvent(new SN(SN.CLOSE_FURNI_CONTEXT_MENU,this.object))),super.tearDown()}}AD.BOUNCING_STEPS=-1,AD.BOUNCING_Z=-1;class SD extends AD{getEventTypes(){const t=[SN.BADGE_DISPLAY_ENGRAVING,dN.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object)if(t instanceof JN){const e=t.data;e instanceof pa&&this.updateBadge(e.getValue(1))}else t instanceof $N&&"loading_icon"!==t.assetName&&(this.object.model.setValue(rt.FURNITURE_BADGE_ASSET_NAME,t.assetName),this.object.model.setValue(rt.FURNITURE_BADGE_IMAGE_STATUS,1),this.update(SU.instance.time))}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.BADGE_DISPLAY_ENGRAVING,this.object))}updateBadge(t){""!==t&&this.eventDispatcher&&(this.object.model.setValue(rt.FURNITURE_BADGE_IMAGE_STATUS,-1),this.eventDispatcher.dispatchEvent(new dN(dN.LOAD_BADGE,this.object,t,!1)))}}class ND extends SD{getEventTypes(){const t=[SN.ACHIEVEMENT_RESOLUTION_OPEN,SN.ACHIEVEMENT_RESOLUTION_ENGRAVING,SN.ACHIEVEMENT_RESOLUTION_FAILED,dN.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof $N&&"loading_icon"!==t.assetName&&this.object.model.setValue(rt.FURNITURE_BADGE_VISIBLE_IN_STATE,ND.BADGE_VISIBLE_IN_STATE),t instanceof pD){if(!this.eventDispatcher||!this.object)return;this.eventDispatcher.dispatchEvent(new SN(SN.CLOSE_FURNI_CONTEXT_MENU,this.object))}}useObject(){if(!this.object||!this.eventDispatcher)return;let t=null;switch(this.object.getState(0)){case ND.STATE_RESOLUTION_NOT_STARTED:case ND.STATE_RESOLUTION_IN_PROGRESS:t=new SN(SN.ACHIEVEMENT_RESOLUTION_OPEN,this.object);break;case ND.STATE_RESOLUTION_ACHIEVED:t=new SN(SN.ACHIEVEMENT_RESOLUTION_ENGRAVING,this.object);break;case ND.STATE_RESOLUTION_FAILED:t=new SN(SN.ACHIEVEMENT_RESOLUTION_FAILED,this.object)}t&&this.eventDispatcher.dispatchEvent(t)}updateBadge(t){t!==ND.ACH_NOT_SET&&super.updateBadge(t)}}ND.STATE_RESOLUTION_NOT_STARTED=0,ND.STATE_RESOLUTION_IN_PROGRESS=1,ND.STATE_RESOLUTION_ACHIEVED=2,ND.STATE_RESOLUTION_FAILED=3,ND.ACH_NOT_SET="ach_0",ND.BADGE_VISIBLE_IN_STATE=2;class MD extends AD{constructor(){super(),this.onRoomToObjectOwnAvatarMoveEvent=this.onRoomToObjectOwnAvatarMoveEvent.bind(this)}initialize(t){super.initialize(t),this.eventDispatcher&&this.eventDispatcher.addEventListener(NN.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent)}tearDown(){this.eventDispatcher&&this.eventDispatcher.removeEventListener(NN.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent),super.tearDown()}onRoomToObjectOwnAvatarMoveEvent(t){if(!t||!this.object)return;const e=this.object.getLocation(),s=t.targetLocation;if(!s)return;let i=this.object.model.getValue(rt.FURNITURE_SIZE_X),r=this.object.model.getValue(rt.FURNITURE_SIZE_Y);const n=(Math.floor(this.object.getDirection().x)+45)%360/90;1!==n&&3!==n||([i,r]=[r,i]),s.x>=e.x&&s.x<e.x+i&&s.y>=e.y&&s.y<e.y+r?this.object.setState(1,0):this.object.setState(0,0)}}class yD extends AD{getEventTypes(){const t=[ON.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;if(t.type===ts.DOUBLE_CLICK){switch(t.spriteTag){case"start_stop":s=new ON(ON.STATE_CHANGE,this.object,1);break;case"reset":s=new ON(ON.STATE_CHANGE,this.object,2)}if(this.eventDispatcher&&s)return void this.eventDispatcher.dispatchEvent(s)}super.mouseEvent(t,e)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new ON(ON.STATE_CHANGE,this.object,1))}}class DD{}DD.INFOSTAND_EXTRA_PARAM="RWEIEP_INFOSTAND_EXTRA_PARAM",DD.JUKEBOX="RWEIEP_JUKEBOX",DD.USABLE_PRODUCT="RWEIEP_USABLE_PRODUCT",DD.SONGDISK="RWEIEP_SONGDISK",DD.CRACKABLE_FURNI="RWEIEP_CRACKABLE_FURNI",DD.BRANDING_OPTIONS="RWEIEP_BRANDING_OPTIONS",DD.USABLE="RWEIEP_USABLE";class CD extends AD{processUpdateMessage(t){super.processUpdateMessage(t),this.object&&1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&this.object.model.setValue(DD.INFOSTAND_EXTRA_PARAM,DD.CRACKABLE_FURNI)}}class LD{}LD.TOUCH_START="touchstart",LD.TOUCH_MOVE="touchmove",LD.TOUCH_CANCEL="touchcancel",LD.TOUCH_END="touchend",LD.TOUCH_LONG="touchlong";class UD{constructor(t){this._ordinal=void 0,this._ordinal=t}get ordinal(){return this._ordinal}equals(t){return t&&t._ordinal==this._ordinal}}UD.NONE=new UD(0),UD.WAVE=new UD(1),UD.BLOW=new UD(2),UD.LAUGH=new UD(3),UD.CRY=new UD(4),UD.IDLE=new UD(5),UD.JUMP=new UD(6),UD.RESPECT=new UD(7);class PD{}PD.DUMMY="DUMMY",PD.FRIEND_FURNITURE="FRIEND_FURNITURE",PD.MONSTERPLANT_SEED="MONSTERPLANT_SEED",PD.MYSTERY_BOX="MYSTERY_BOX",PD.EFFECT_BOX="EFFECT_BOX",PD.MYSTERY_TROPHY="MYSTERY_TROPHY",PD.RANDOM_TELEPORT="RANDOM_TELEPORT",PD.PURCHASABLE_CLOTHING="PURCHASABLE_CLOTHING",PD.GENERIC_USABLE="GENERIC_USABLE";class bD{}bD.LOVE_LOCK=0,bD.CARVE_A_TREE=1,bD.FRIENDS_PORTRAIT=2,bD.WILD_WEST_WANTED=3,bD.HABBOWEEN=4;class wD{}wD.CHAT_WIDGET="RWE_CHAT_WIDGET",wD.INFOSTAND="RWE_INFOSTAND",wD.ME_MENU="RWE_ME_MENU",wD.CHAT_INPUT_WIDGET="RWE_CHAT_INPUT_WIDGET",wD.FURNI_PLACEHOLDER="RWE_FURNI_PLACEHOLDER",wD.FURNI_CREDIT_WIDGET="RWE_FURNI_CREDIT_WIDGET",wD.FURNI_STICKIE_WIDGET="RWE_FURNI_STICKIE_WIDGET",wD.FURNI_TROPHY_WIDGET="RWE_FURNI_TROPHY_WIDGET",wD.FURNI_LOVELOCK_WIDGET="RWE_FURNI_LOVELOCK_WIDGET",wD.FURNI_PRESENT_WIDGET="RWE_FURNI_PRESENT_WIDGET",wD.FURNI_ECOTRONBOX_WIDGET="RWE_FURNI_ECOTRONBOX_WIDGET",wD.FURNI_PET_PACKAGE_WIDGET="RWE_FURNI_PET_PACKAGE_WIDGET",wD.PLAYLIST_EDITOR_WIDGET="RWE_PLAYLIST_EDITOR_WIDGET",wD.DOORBELL="RWE_DOORBELL",wD.LOADINGBAR="RWE_LOADINGBAR",wD.ROOM_QUEUE="RWE_ROOM_QUEUE",wD.ROOM_POLL="RWE_ROOM_POLL",wD.ROOM_VOTE="RWE_ROOM_VOTE",wD.USER_CHOOSER="RWE_USER_CHOOSER",wD.FURNI_CHOOSER="RWE_FURNI_CHOOSER",wD.ROOM_DIMMER="RWE_ROOM_DIMMER",wD.FRIEND_REQUEST="RWE_FRIEND_REQUEST",wD.CLOTHING_CHANGE="RWE_CLOTHING_CHANGE",wD.CONVERSION_TRACKING="RWE_CONVERSION_TRACKING",wD.USER_NOTIFICATION="RWE_USER_NOTIFICATION",wD.FRIENDS_BAR="RWE_FRIENDS_BAR",wD.PURSE_WIDGET="RWE_PURSE_WIDGET",wD.AVATAR_INFO="RWE_AVATAR_INFO",wD.WELCOME_GIFT="RWE_WELCOME_GIFT",wD.SPAMWALL_POSTIT_WIDGET="RWE_SPAMWALL_POSTIT_WIDGET",wD.EFFECTS="RWE_EFFECTS",wD.MANNEQUIN="RWE_MANNEQUIN",wD.FURNITURE_CONTEXT_MENU="RWE_FURNITURE_CONTEXT_MENU",wD.LOCATION_WIDGET="RWE_LOCATION_WIDGET",wD.CAMERA="RWE_CAMERA",wD.ROOM_THUMBNAIL_CAMERA="RWE_ROOM_THUMBNAIL_CAMERA",wD.ROOM_BACKGROUND_COLOR="RWE_ROOM_BACKGROUND_COLOR",wD.CUSTOM_USER_NOTIFICATION="RWE_CUSTOM_USER_NOTIFICATION",wD.FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING="RWE_FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING",wD.FRIEND_FURNI_CONFIRM="RWE_FRIEND_FURNI_CONFIRM",wD.FRIEND_FURNI_ENGRAVING="RWE_FRIEND_FURNI_ENGRAVING",wD.HIGH_SCORE_DISPLAY="RWE_HIGH_SCORE_DISPLAY",wD.INTERNAL_LINK="RWE_INTERNAL_LINK",wD.CUSTOM_STACK_HEIGHT="RWE_CUSTOM_STACK_HEIGHT",wD.YOUTUBE="RWE_YOUTUBE",wD.RENTABLESPACE="RWE_RENTABLESPACE",wD.VIMEO="RWE_VIMEO",wD.ROOM_TOOLS="RWE_ROOM_TOOLS",wD.EXTERNAL_IMAGE="RWE_EXTERNAL_IMAGE",wD.WORD_QUIZZ="RWE_WORD_QUIZZ",wD.UI_HELP_BUBBLE="RWE_UI_HELP_BUBBLE",wD.ROOM_LINK="RWE_ROOM_LINK",wD.CRAFTING="RWE_CRAFTING",wD.ROOMGAME_CHECKERS="RWE_GAME_CHECKERS";class FD{}FD.NOBODY=0,FD.CONTROLLER=1,FD.EVERYBODY=2;class xD{}xD.NORMAL=0,xD.GENERIC=1,xD.BOT=2;class BD extends AD{get widget(){return wD.CRAFTING}}class GD extends AD{getEventTypes(){const t=[SN.CREDITFURNI];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);let e=0;t.logic&&t.logic.credits&&""!==t.logic.credits&&t.logic.credits.length>0&&(e=parseInt(t.logic.credits)),this.object.model.setValue(rt.FURNITURE_CREDIT_VALUE,e)}useObject(){this.object&&this.eventDispatcher&&(this.eventDispatcher.dispatchEvent(new SN(SN.CREDITFURNI,this.object)),super.useObject())}}class HD extends AD{getEventTypes(){const t=[gN.MOUSE_BUTTON,gN.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(t&&e&&this.object){switch(t.type){case ts.ROLL_OVER:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new gN(gN.MOUSE_BUTTON,this.object));break;case ts.ROLL_OUT:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new gN(gN.MOUSE_ARROW,this.object))}super.mouseEvent(t,e)}}}class VD extends HD{getEventTypes(){const t=[SN.STACK_HEIGHT];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(rt.FURNITURE_ALWAYS_STACKABLE,1)}useObject(){this.object&&this.eventDispatcher&&(this.eventDispatcher.dispatchEvent(new SN(SN.STACK_HEIGHT,this.object)),super.useObject())}}class jD extends AD{constructor(){super(),this._noTags=void 0,this._noTagsLastStateActivate=void 0,this._noTags=!1,this._noTagsLastStateActivate=!1}getEventTypes(){const t=[gN.DICE_ACTIVATE,gN.DICE_OFF];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;if(t.type===ts.DOUBLE_CLICK)return this._noTags?this._noTagsLastStateActivate&&0!==this.object.getState(0)&&100!==this.object.getState(0)?(s=new gN(gN.DICE_OFF,this.object),this._noTagsLastStateActivate=!1):(s=new gN(gN.DICE_ACTIVATE,this.object),this._noTagsLastStateActivate=!0):"activate"===t.spriteTag||0===this.object.getState(0)||100===this.object.getState(0)?s=new gN(gN.DICE_ACTIVATE,this.object):"deactivate"===t.spriteTag&&(s=new gN(gN.DICE_OFF,this.object)),void(s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(s));super.mouseEvent(t,e)}}class kD extends AD{getEventTypes(){const t=[SN.ECOTRONBOX];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.ECOTRONBOX,this.object))}}class YD extends AD{constructor(){super(),this._showStateOnceRendered=void 0,this._updateCount=void 0,this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[SN.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&1===t.logic.action.startState&&(this._showStateOnceRendered=!0)}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount>20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(rt.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,e){t&&e&&(t.type===ts.DOUBLE_CLICK&&this.setAutomaticStateIndex(0),super.mouseEvent(t,e))}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.INERNAL_LINK,this.object))}}class zD extends AD{constructor(){super(...arguments),this._timer=void 0}getEventTypes(){const t=[SN.ROOM_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&t.logic.action.link&&""!==t.logic.action.link&&t.logic.action.link.length>0&&this.object&&this.object.model&&this.object.model.setValue(rt.FURNITURE_INTERNAL_LINK,t.logic.action.link)}onDispose(){this._timer&&(clearTimeout(this._timer),this._timer=null),super.onDispose()}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(rt.FURNITURE_AUTOMATIC_STATE_INDEX,t)}useObject(){this.setAutomaticStateIndex(1),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout((()=>{this.setAutomaticStateIndex(0),this._timer=null}),2500),this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.ROOM_LINK,this.object))}}class WD extends AD{constructor(){super(...arguments),this._timer=void 0}getEventTypes(){const t=[SN.EFFECTBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.EFFECTBOX_OPEN_DIALOG,this.object))}get contextMenu(){return PD.EFFECT_BOX}}class KD extends HD{getEventTypes(){const t=[SN.EXTERNAL_IMAGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(super.initialize(t),t&&this.object&&this.object.model){let e="";t.logic&&t.logic.maskType&&""!==t.logic.maskType&&t.logic.maskType.length>0&&(e=t.logic.maskType),this.object.model.setValue(rt.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(rt.FURNITURE_PLANE_MASK_TYPE,e)}}useObject(){this.object&&this.eventDispatcher&&(this.eventDispatcher.dispatchEvent(new SN(SN.EXTERNAL_IMAGE,this.object)),super.useObject())}}class XD extends AD{getEventTypes(){const t=[ON.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.particleSystems&&t.logic.particleSystems.length&&this.object.model.setValue(rt.FURNITURE_FIREWORKS_DATA,t.logic.particleSystems)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;if(t.type===ts.DOUBLE_CLICK){switch(t.spriteTag){case"start_stop":s=new ON(ON.STATE_CHANGE,this.object,1);break;case"reset":s=new ON(ON.STATE_CHANGE,this.object,2)}if(this.eventDispatcher&&s)return void this.eventDispatcher.dispatchEvent(s)}super.mouseEvent(t,e)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new ON(ON.STATE_CHANGE,this.object,0))}}class qD extends HD{constructor(){super(),this._currentState=void 0,this._currentLocation=void 0,this._currentState=-1,this._currentLocation=null}getEventTypes(){const t=[lN.ADD_HOLE,lN.REMOVE_HOLE];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._currentState===qD.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new lN(lN.REMOVE_HOLE,this.object)),super.onDispose()}update(t){super.update(t),this.handleAutomaticStateUpdate()}processUpdateMessage(t){if(super.processUpdateMessage(t),!this.object)return;t instanceof JN&&this.handleStateUpdate(this.object.getState(0));const e=this.object.getLocation();this._currentLocation?e.x===this._currentLocation.x&&e.y===this._currentLocation.y||this._currentState===qD.STATE_HOLE&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new lN(lN.ADD_HOLE,this.object)):this._currentLocation=new dt,this._currentLocation.assign(e)}handleStateUpdate(t){t!==this._currentState&&(this.eventDispatcher&&(t===qD.STATE_HOLE?this.eventDispatcher.dispatchEvent(new lN(lN.ADD_HOLE,this.object)):this._currentState===qD.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new lN(lN.REMOVE_HOLE,this.object))),this._currentState=t)}handleAutomaticStateUpdate(){if(!this.object)return;const t=this.object.model;if(!t)return;const e=t.getValue(rt.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(e)||this.handleStateUpdate(e%2)}}qD.STATE_HOLE=0;class QD extends HD{constructor(){super(...arguments),this._state=-1}initialize(t){super.initialize(t),this.object&&this.object.model.setValue(rt.FURNITURE_FRIENDFURNI_ENGRAVING,this.engravingDialogType)}processUpdateMessage(t){if(t instanceof JN){const e=t.data;this._state=e?e.state:t.state}super.processUpdateMessage(t)}getEventTypes(){const t=[SN.FRIEND_FURNITURE_ENGRAVING];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&(this._state===QD.STATE_LOCKED?this.eventDispatcher.dispatchEvent(new SN(SN.FRIEND_FURNITURE_ENGRAVING,this.object)):super.useObject())}get engravingDialogType(){return 0}get contextMenu(){return this._state===QD.STATE_UNLOCKED?PD.FRIEND_FURNITURE:PD.DUMMY}}QD.STATE_UNINITIALIZED=-1,QD.STATE_UNLOCKED=0,QD.STATE_LOCKED=1;class ZD extends Ue{constructor(t){super(null,null),this._type=void 0,this._type=t}get type(){return this._type}}ZD.IMAGE_LOADED="ROAUM_IMAGE_LOADED",ZD.IMAGE_LOADING_FAILED="ROAUM_IMAGE_FAILED";class JD extends Ue{constructor(t){super(null,null),this._type=void 0,this._mapData=void 0,this._type=JD.UPDATE_MAP,this._mapData=t}get type(){return this._type}get mapData(){return this._mapData}}JD.UPDATE_MAP="RORMUM_UPDATE_MAP";class $D extends HD{getEventTypes(){const t=[dN.LOAD_BADGE,SN.GUILD_FURNI_CONTEXT_MENU,SN.CLOSE_FURNI_CONTEXT_MENU];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof JN){const e=t.data;e instanceof pa&&(this.updateGroupId(e.getValue($D.GROUPID_KEY)),this.updateBadge(e.getValue($D.BADGE_KEY)),this.updateColors(e.getValue($D.COLOR1_KEY),e.getValue($D.COLOR2_KEY)))}else t instanceof $N?"loading_icon"!==t.assetName&&(this.object.model.setValue(rt.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME,t.assetName),this.update(SU.instance.time)):t instanceof pD&&(t.selected||this.eventDispatcher.dispatchEvent(new SN(SN.CLOSE_FURNI_CONTEXT_MENU,this.object)))}updateGroupId(t){this.object.model.setValue(rt.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID,parseInt(t))}updateBadge(t){this.eventDispatcher.dispatchEvent(new dN(dN.LOAD_BADGE,this.object,t,!0))}updateColors(t,e){this.object.model.setValue(rt.FURNITURE_GUILD_CUSTOMIZED_COLOR_1,parseInt(t,16)),this.object.model.setValue(rt.FURNITURE_GUILD_CUSTOMIZED_COLOR_2,parseInt(e,16))}mouseEvent(t,e){if(t&&e&&this.object){if(t.type===ts.MOUSE_CLICK)this.openContextMenu();super.mouseEvent(t,e)}}openContextMenu(){this.eventDispatcher.dispatchEvent(new SN(SN.GUILD_FURNI_CONTEXT_MENU,this.object))}}$D.GROUPID_KEY=1,$D.BADGE_KEY=2,$D.COLOR1_KEY=3,$D.COLOR2_KEY=4;class tC extends $D{getEventTypes(){const t=[SN.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}updateGroupId(t){super.updateGroupId(t),this.object.model.setValue(rt.FURNITURE_INTERNAL_LINK,`groupforum/${t}`)}useObject(){this.object&&this.eventDispatcher&&(this.eventDispatcher.dispatchEvent(new SN(SN.INERNAL_LINK,this.object)),super.useObject())}}class eC extends AD{getEventTypes(){const t=[gN.USE_HABBOWHEEL];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new gN(gN.USE_HABBOWHEEL,this.object))}}class sC extends AD{constructor(){super(...arguments),this._state=-1}getEventTypes(){return[SN.HIGH_SCORE_DISPLAY,SN.HIDE_HIGH_SCORE_DISPLAY]}tearDown(){1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&this.eventDispatcher.dispatchEvent(new SN(SN.HIDE_HIGH_SCORE_DISPLAY,this.object)),super.tearDown()}processUpdateMessage(t){super.processUpdateMessage(t),1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&t instanceof JN&&(t.state===sC.SHOW_WIDGET_IN_STATE?this.eventDispatcher.dispatchEvent(new SN(SN.HIGH_SCORE_DISPLAY,this.object)):this.eventDispatcher.dispatchEvent(new SN(SN.HIDE_HIGH_SCORE_DISPLAY,this.object)),this._state=t.state)}}sC.SHOW_WIDGET_IN_STATE=1;class iC extends AD{getEventTypes(){const t=[ON.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case ts.DOUBLE_CLICK:if("off"===t.spriteTag)s=new ON(ON.STATE_CHANGE,this.object,3);break;case ts.MOUSE_CLICK:switch(t.spriteTag){case"inc":s=new ON(ON.STATE_CHANGE,this.object,2);break;case"dec":s=new ON(ON.STATE_CHANGE,this.object,1)}}this.eventDispatcher&&s?this.eventDispatcher.dispatchEvent(s):super.mouseEvent(t,e)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new ON(ON.STATE_CHANGE,this.object,3))}}class rC{}rC.LOVE_LOCK=0,rC.CARVE_A_TREE=1,rC.FRIENDS_PORTRAIT=2,rC.WILD_WEST_WANTED=3,rC.HABBOWEEN=4;class nC extends QD{get engravingDialogType(){return rC.HABBOWEEN}}class aC extends HD{constructor(){super(),this._nextState=void 0,this._nextStateExtra=void 0,this._nextStateTimestamp=void 0,this._nextState=0,this._nextStateTimestamp=0}update(t){if(this._nextStateTimestamp>0&&t>=this._nextStateTimestamp){this._nextStateTimestamp=0;const t=new la;t.setString(this._nextState.toString()),super.processUpdateMessage(new JN(this._nextState,t,this._nextStateExtra))}super.update(t)}processUpdateMessage(t){t instanceof JN?this.processUpdate(t):super.processUpdateMessage(t)}processUpdate(t){if(!t)return;const e=~~(t.state/1e3),s=~~(t.state%1e3);if(s)this._nextState=e,this._nextStateExtra=t.extra,this._nextStateTimestamp=this.time+s;else{this._nextStateTimestamp=0;const s=new la;s.setString(e.toString()),super.processUpdateMessage(new JN(e,s,t.extra))}}}class oC extends AD{constructor(){super(...arguments),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[SN.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&(this.object.model.setValue(rt.FURNITURE_INTERNAL_LINK,t.logic.action.link),1===t.logic.action.startState&&(this._showStateOnceRendered=!0))}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&20===this._updateCount&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(rt.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,e){t&&e&&(t.type===ts.DOUBLE_CLICK&&this._showStateOnceRendered&&this.setAutomaticStateIndex(0),super.mouseEvent(t,e))}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.INERNAL_LINK,this.object))}}class hC extends HD{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[gN.JUKEBOX_START,gN.JUKEBOX_MACHINE_STOP,gN.JUKEBOX_DISPOSE,gN.JUKEBOX_INIT,SN.JUKEBOX_PLAYLIST_EDITOR];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&(this._isInitialized||this.requestInit(),this.object.model.setValue(DD.INFOSTAND_EXTRA_PARAM,DD.JUKEBOX),t instanceof JN)){const t=this.object.getState(0);t!==this._currentState&&(this._currentState=t,1===t?this.requestPlayList():0===t&&this.requestStopPlaying())}}requestInit(){this.object&&this.eventDispatcher&&(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new gN(gN.JUKEBOX_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){this.object&&this.eventDispatcher&&(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new gN(gN.JUKEBOX_START,this.object)))}requestStopPlaying(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new gN(gN.JUKEBOX_MACHINE_STOP,this.object))}requestDispose(){this._disposeEventsAllowed&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new gN(gN.JUKEBOX_DISPOSE,this.object))}useObject(){this.object&&this.eventDispatcher&&(this.eventDispatcher.dispatchEvent(new SN(SN.JUKEBOX_PLAYLIST_EDITOR,this.object)),this.eventDispatcher.dispatchEvent(new ON(ON.STATE_CHANGE,this.object,-1)))}}class _C extends QD{get engravingDialogType(){return rC.LOVE_LOCK}}class dC extends AD{getEventTypes(){const t=[SN.MANNEQUIN];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof JN&&(t.data.writeRoomObjectModel(this.object.model),this.processObjectData())}processObjectData(){if(!this.object||!this.object.model)return;const t=new ga;t.initializeFromRoomObjectModel(this.object.model),this.object.model.setValue(rt.FURNITURE_MANNEQUIN_GENDER,t.getValue(dC.GENDER)),this.object.model.setValue(rt.FURNITURE_MANNEQUIN_FIGURE,t.getValue(dC.FIGURE)),this.object.model.setValue(rt.FURNITURE_MANNEQUIN_NAME,t.getValue(dC.OUTFIT_NAME))}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.MANNEQUIN,this.object))}}dC.GENDER="GENDER",dC.FIGURE="FIGURE",dC.OUTFIT_NAME="OUTFIT_NAME";class uC extends HD{getEventTypes(){const t=[SN.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return PD.MONSTERPLANT_SEED}}class cC extends HD{initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(rt.FURNITURE_IS_VARIABLE_HEIGHT,1)}}class lC extends HD{getEventTypes(){const t=[SN.MYSTERYBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.MYSTERYBOX_OPEN_DIALOG,this.object))}get contextMenu(){return PD.MYSTERY_BOX}}class gC extends HD{getEventTypes(){const t=[SN.MYSTERYTROPHY_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.MYSTERYTROPHY_OPEN_DIALOG,this.object))}get contextMenu(){return PD.MYSTERY_TROPHY}}class EC extends AD{getEventTypes(){const t=[gN.ENTER_ONEWAYDOOR];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new gN(gN.ENTER_ONEWAYDOOR,this.object))}}class pC extends AD{getEventTypes(){const t=[SN.PET_PRODUCT_MENU];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),this.object&&1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&this.object.model.setValue(DD.INFOSTAND_EXTRA_PARAM,DD.USABLE_PRODUCT)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.PET_PRODUCT_MENU,this.object))}}class mC extends AD{getEventTypes(){const t=[SN.PLACEHOLDER];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.PLACEHOLDER,this.object))}}class IC extends AD{initialize(t){super.initialize(t),t.logic&&t.logic.planetSystems&&this.object.model.setValue(rt.FURNITURE_PLANETSYSTEM_DATA,t.logic.planetSystems)}}class TC extends AD{getEventTypes(){const t=[SN.PRESENT];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.particleSystems&&t.logic.particleSystems.length&&this.object.model.setValue(rt.FURNITURE_FIREWORKS_DATA,t.logic.particleSystems)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof JN&&(t.data.writeRoomObjectModel(this.object.model),this.updateStuffData()),t instanceof sM&&t.numberKey===rt.FURNITURE_DISABLE_PICKING_ANIMATION&&this.object.model.setValue(rt.FURNITURE_DISABLE_PICKING_ANIMATION,t.numberValue)}updateStuffData(){if(!this.object||!this.object.model)return;const t=new ga;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(TC.MESSAGE),s=this.object.model.getValue(rt.FURNITURE_DATA);e||"string"!==typeof s?this.object.model.setValue(rt.FURNITURE_DATA,t.getValue(TC.MESSAGE)):this.object.model.setValue(rt.FURNITURE_DATA,s.substr(1)),this.writeToModel(rt.FURNITURE_TYPE_ID,t.getValue(TC.PRODUCT_CODE)),this.writeToModel(rt.FURNITURE_PURCHASER_NAME,t.getValue(TC.PURCHASER_NAME)),this.writeToModel(rt.FURNITURE_PURCHASER_FIGURE,t.getValue(TC.PURCHASER_FIGURE))}writeToModel(t,e){e&&this.object.model.setValue(t,e)}mouseEvent(t,e){if(t&&e&&this.object){switch(t.type){case ts.ROLL_OVER:this.eventDispatcher.dispatchEvent(new gN(gN.MOUSE_BUTTON,this.object));break;case ts.ROLL_OUT:this.eventDispatcher.dispatchEvent(new gN(gN.MOUSE_ARROW,this.object))}super.mouseEvent(t,e)}}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.PRESENT,this.object))}}TC.MESSAGE="MESSAGE",TC.PRODUCT_CODE="PRODUCT_CODE",TC.EXTRA_PARAM="EXTRA_PARAM",TC.PURCHASER_NAME="PURCHASER_NAME",TC.PURCHASER_FIGURE="PURCHASER_FIGURE";class RC extends HD{getEventTypes(){const t=[SN.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return PD.PURCHASABLE_CLOTHING}}class fC extends HD{constructor(){super(),this._oldLocation=void 0,this.updateInterval=OD.DEFAULT_UPDATE_INTERVAL,this._oldLocation=new dt}processUpdateMessage(t){if(!t)return;const e=t instanceof qN;if(this.object&&!e&&t.location){const e=this.object.getLocation(),s=dt.dif(t.location,e);if(s&&Math.abs(s.x)<2&&Math.abs(s.y)<2){let i=e;return(Math.abs(s.x)>1||Math.abs(s.y)>1)&&(i=dt.sum(e,dt.product(s,.5))),void super.processUpdateMessage(new qN(i,t.location,t.direction))}}if(t.location&&!e&&super.processUpdateMessage(new qN(t.location,t.location,t.direction)),t instanceof JN)return t.state>0?this.updateInterval=OD.DEFAULT_UPDATE_INTERVAL/this.getUpdateIntervalValue(t.state):this.updateInterval=1,void this.handleDataUpdate(t);e&&t.isSlide&&(this.updateInterval=OD.DEFAULT_UPDATE_INTERVAL),super.processUpdateMessage(t)}getUpdateIntervalValue(t){return t/fC.MAX_ANIMATION_COUNT}getAnimationValue(t){return t%fC.MAX_ANIMATION_COUNT}handleDataUpdate(t){const e=this.getAnimationValue(t.state);if(e!==t.state){const s=new la;s.setString(e.toString()),t=new JN(e,s,t.extra)}super.processUpdateMessage(t)}update(t){this.object&&(this._oldLocation.assign(this.object.getLocation()),super.update(t),0===dt.dif(this.object.getLocation(),this._oldLocation).length&&this.object.getState(0)!==fC.ANIMATION_NOT_MOVING&&this.object.setState(fC.ANIMATION_NOT_MOVING,0))}}fC.ANIMATION_NOT_MOVING=0,fC.ANIMATION_MOVING=1,fC.MAX_ANIMATION_COUNT=10;class OC extends AD{getEventTypes(){const t=[ON.STATE_RANDOM];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new ON(ON.STATE_RANDOM,this.object))}}class vC extends HD{get contextMenu(){return PD.RANDOM_TELEPORT}}class AC extends AD{getEventTypes(){const t=[uN.RODRE_CURRENT_USER_ID];return this.mergeTypes(super.getEventTypes(),t)}update(t){if(super.update(t),this.object&&this.object.model){this.object.model.getValue(rt.SESSION_CURRENT_USER_ID)||this.eventDispatcher.dispatchEvent(new uN(uN.RODRE_CURRENT_USER_ID,this.object));const t=this.object.model.getValue(rt.FURNITURE_DATA).getValue("renterId"),e=this.object.model.getValue(rt.SESSION_CURRENT_USER_ID);t?parseInt(t)===e?this.object.setState(2,0):this.object.setState(1,0):this.object.setState(0,0)}}get widget(){return wD.RENTABLESPACE}}class SC extends HD{constructor(){super(),this._roomColorUpdated=void 0,this._roomColorUpdated=!1}getEventTypes(){const t=[SN.BACKGROUND_COLOR,pN.ROOM_BACKGROUND_COLOR];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){if(this._roomColorUpdated){if(this.eventDispatcher&&this.object){1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&this.eventDispatcher.dispatchEvent(new pN(pN.ROOM_BACKGROUND_COLOR,this.object,!1,0,0,0))}this._roomColorUpdated=!1}super.onDispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof JN){t.data.writeRoomObjectModel(this.object.model);1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&this.processColorUpdate()}}processColorUpdate(){if(!this.object||!this.object.model)return;const t=new Ea;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(0),s=t.getValue(1),i=t.getValue(2),r=t.getValue(3);e>-1&&s>-1&&i>-1&&r>-1&&(this.object.model.setValue(rt.FURNITURE_ROOM_BACKGROUND_COLOR_HUE,s),this.object.model.setValue(rt.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION,i),this.object.model.setValue(rt.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS,r),this.object.setState(e,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new pN(pN.ROOM_BACKGROUND_COLOR,this.object,1===e,s,i,r)),this._roomColorUpdated=!0)}mouseEvent(t,e){t&&e&&this.object&&(t.type!==ts.DOUBLE_CLICK?super.mouseEvent(t,e):this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.BACKGROUND_COLOR,this.object)))}}var NC=s(60);class MC extends AD{constructor(){super(),this._disableFurnitureSelection=void 0,this._hasClickUrl=void 0,this._disableFurnitureSelection=!0,this._hasClickUrl=!1}getEventTypes(){const t=[TN.ROOM_AD_LOAD_IMAGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this._disableFurnitureSelection&&this.object.model.setValue(rt.FURNITURE_SELECTION_DISABLED,1)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof JN&&this.processAdDataUpdateMessage(t),t instanceof ZD&&this.processAdUpdate(t)}processAdDataUpdateMessage(t){if(!t)return;const e=new ga;e.initializeFromRoomObjectModel(this.object.model);const s=parseInt(e.getValue(MC.STATE));isNaN(s)||this.object.getState(0)===s||this.object.setState(s,0);const i=e.getValue(MC.IMAGEURL_KEY),r=this.object.model.getValue(rt.FURNITURE_BRANDING_IMAGE_URL);r&&r===i||(this.object.model.setValue(rt.FURNITURE_BRANDING_IMAGE_URL,i),this.object.model.setValue(rt.FURNITURE_BRANDING_IMAGE_STATUS,0),this.downloadBackground());const n=e.getValue(MC.CLICKURL_KEY);if(n){const t=this.object.model.getValue(rt.FURNITURE_BRANDING_URL);t&&t===n||this.object.model&&this.object.model.setValue(rt.FURNITURE_BRANDING_URL,n)}const a=parseInt(e.getValue(MC.OFFSETX_KEY)),o=parseInt(e.getValue(MC.OFFSETY_KEY)),h=parseInt(e.getValue(MC.OFFSETZ_KEY));isNaN(a)||this.object.model.setValue(rt.FURNITURE_BRANDING_OFFSET_X,a),isNaN(o)||this.object.model.setValue(rt.FURNITURE_BRANDING_OFFSET_Y,o),isNaN(h)||this.object.model.setValue(rt.FURNITURE_BRANDING_OFFSET_Z,h);let _=MC.IMAGEURL_KEY+"="+(null!==i?i:"")+"\t";this._hasClickUrl&&(_=_+(MC.CLICKURL_KEY+"=")+(null!==n?n:"")+"\t"),_=_+(MC.OFFSETX_KEY+"=")+a+"\t",_=_+(MC.OFFSETY_KEY+"=")+o+"\t",_=_+(MC.OFFSETZ_KEY+"=")+h+"\t",this.object.model.setValue(DD.INFOSTAND_EXTRA_PARAM,DD.BRANDING_OPTIONS+_)}processAdUpdate(t){if(t&&this.object)switch(t.type){case ZD.IMAGE_LOADED:this.object.model.setValue(rt.FURNITURE_BRANDING_IMAGE_STATUS,1);break;case ZD.IMAGE_LOADING_FAILED:this.object.model.setValue(rt.FURNITURE_BRANDING_IMAGE_STATUS,-1)}}mouseEvent(t,e){t&&e&&t.type!==ts.MOUSE_MOVE&&t.type!==ts.DOUBLE_CLICK&&super.mouseEvent(t,e)}downloadBackground(){const t=this.object&&this.object.model;if(!t)return;const e=t.getValue(rt.FURNITURE_BRANDING_IMAGE_URL),s=t.getValue(rt.FURNITURE_BRANDING_IMAGE_STATUS);if(e&&""!==e&&1!==s)if(e.endsWith(".gif"))this.object.model.setValue(rt.FURNITURE_BRANDING_IS_ANIMATED,!0),fetch(e).then((t=>t.arrayBuffer())).then((t=>Object(NC.parseGIF)(t))).then((t=>{const s=t.lsd.width,r=t.lsd.height,n=s*r,a=Object(NC.decompressFrames)(t,!1),o=[],h=[];let _=new Uint8Array(4*n);for(let e=0;e<a.length;e++){e>0&&(_=_.slice(0));const t=a[e].pixels,n=a[e].colorTable,d=a[e].transparentIndex,u=a[e].dims;for(let e=0;e<u.height;e++)for(let i=0;i<u.width;i++){const r=t[e*u.width+i],a=(e+u.top)*s+(i+u.left);if(d!==r){const t=n[r];_[4*a]=t[0],_[4*a+1]=t[1],_[4*a+2]=t[2],_[4*a+3]=255}}const c=i.c.fromBuffer(_,s,r);o.push(new i.t(c)),h.push(a[e].delay)}SU.instance.roomEngine.roomContentLoader.createGifCollection(e,o,h),this.processUpdateMessage(new ZD(ZD.IMAGE_LOADED))})).catch((t=>{this.processUpdateMessage(new ZD(ZD.IMAGE_LOADING_FAILED))}));else{const t=SU.instance.core&&SU.instance.core.asset;if(!t)return;if(!t.getTexture(e))return void t.downloadAsset(e,(t=>{t?this.processUpdateMessage(new ZD(ZD.IMAGE_LOADED)):this.processUpdateMessage(new ZD(ZD.IMAGE_LOADING_FAILED))}));this.processUpdateMessage(new ZD(ZD.IMAGE_LOADED))}}}MC.STATE="state",MC.IMAGEURL_KEY="imageUrl",MC.CLICKURL_KEY="clickUrl",MC.OFFSETX_KEY="offsetX",MC.OFFSETY_KEY="offsetY",MC.OFFSETZ_KEY="offsetZ";class yC extends MC{getAdClickUrl(t){return null}}class DC{constructor(t){this._data=void 0,this._maxSize=void 0,this._index=void 0,this._data=[],this._maxSize=t,this._index=0}reset(){this._data=[],this._index=0}addValue(t){this._data.length<this._maxSize?this._data.push(t):this._data[this._index]=t,this._index=(this._index+1)%this._maxSize}getMax(){let t=Number.MIN_VALUE,e=0;for(;e<this._maxSize;)this._data[e]>t&&(t=this._data[e]),e++;return t}getMin(){let t=Number.MAX_VALUE,e=0;for(;e<this._maxSize;)this._data[e]<t&&(t=this._data[e]),e++;return t}}class CC{static format(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;return t>s*CC.YEAR?CC.getLocalization("friendlytime.years"+e,Math.round(t/CC.YEAR)):t>s*CC.MONTH?CC.getLocalization("friendlytime.months"+e,Math.round(t/CC.MONTH)):t>s*CC.DAY?CC.getLocalization("friendlytime.days"+e,Math.round(t/CC.DAY)):t>s*CC.HOUR?CC.getLocalization("friendlytime.hours"+e,Math.round(t/CC.HOUR)):t>s*CC.MINUTE?CC.getLocalization("friendlytime.minutes"+e,Math.round(t/CC.MINUTE)):CC.getLocalization("friendlytime.seconds"+e,Math.round(t))}static shortFormat(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;return t>s*CC.YEAR?CC.getLocalization("friendlytime.years.short"+e,Math.round(t/CC.YEAR)):t>s*CC.MONTH?CC.getLocalization("friendlytime.months.short"+e,Math.round(t/CC.MONTH)):t>s*CC.DAY?CC.getLocalization("friendlytime.days.short"+e,Math.round(t/CC.DAY)):t>s*CC.HOUR?CC.getLocalization("friendlytime.hours.short"+e,Math.round(t/CC.HOUR)):t>s*CC.MINUTE?CC.getLocalization("friendlytime.minutes.short"+e,Math.round(t/CC.MINUTE)):CC.getLocalization("friendlytime.seconds.short"+e,Math.round(t))}static getLocalization(t,e){return SU.instance.getLocalizationWithParameter(t,"amount",e.toString())}}CC.MINUTE=60,CC.HOUR=60*CC.MINUTE,CC.DAY=24*CC.HOUR,CC.WEEK=7*CC.DAY,CC.MONTH=30*CC.DAY,CC.YEAR=365*CC.DAY;class LC{static logEventLog(t){try{wS.available&&wS.call("logEventLog",t)}catch(e){l.log("External interface not working, failed to log event log.")}}static openPage(t){try{wS.available?wS.call("openPage",t):l.log("External interface not available, openPage failed.")}catch(e){l.log("Failed to open web page "+t)}}static openWebPage(t){window.open(t)}static sendHeartBeat(){try{wS.available&&wS.call("heartBeat")}catch(t){l.log("Failed to send heartbeat")}}static openWebPageAndMinimizeClient(t){try{wS.available&&LC.openPage(t)}catch(e){l.log("Failed to open web page "+t)}}static closeWebPageAndRestoreClient(){try{wS.available&&wS.call("closeWebPageAndRestoreClient")}catch(t){l.log("Failed to close web page and restore client!")}}static openHabblet(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{wS.available&&wS.call("openHabblet",t,e)}catch(s){l.log("Failed to open Habblet "+t)}}static closeHabblet(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{wS.available&&wS.call("closeHabblet",t,e)}catch(s){l.log("Failed to close Habblet "+t)}}static send(t,e){try{wS.available&&wS.call("disconnect",t,e)}catch(s){l.log("Failed to close send ")}}static showGame(t){try{wS.available&&wS.callGame("showGame",t)}catch(e){l.log("Failed to open game: "+e)}}static hideGame(){try{wS.available&&wS.callGame("hideGame")}catch(t){l.log("Failed to hide game")}}static open(t){try{wS.available?wS.call("openExternalLink",escape(t)):l.log("External interface not available. Could not request to open: "+t)}catch(e){l.log("External interface not working. Could not request to open: "+t)}}static roomVisited(t){try{wS.available?wS.call("roomVisited",t):l.log("External interface not available. Could not store last room visit.")}catch(e){l.log("External interface not working. Could not store last room visit.")}}static openMinimail(t){try{wS.available?wS.call("openMinimail",t):l.log("External interface not available. Could not open minimail.")}catch(e){l.log("External interface not working. Could not open minimail.")}}static openNews(){try{wS.available?wS.call("openNews"):l.log("External interface not available. Could not open news.")}catch(t){l.log("External interface not working. Could not open news.")}}static closeNews(){try{wS.available?wS.call("closeNews"):l.log("External interface not available. Could not close news.")}catch(t){l.log("External interface not working. Could not close news.")}}static openAvatars(){try{wS.available?wS.call("openAvatars"):l.log("External interface not available. Could not open avatars.")}catch(t){l.log("External interface not working. Could not open avatars.")}}static openRoomEnterAd(){try{wS.available?wS.call("openRoomEnterAd"):l.log("External interface not available. Could not open roomenterad.")}catch(t){l.log("External interface not working. Could not open roomenterad.")}}static updateFigure(t){try{wS.available?wS.call("updateFigure",t):l.log("External interface not available. Could not update figure.")}catch(e){l.log("External interface not working. Could not update figure.")}}}LC.ADVERTISEMENT="advertisement",LC.OPENLINK="openlink",LC.OPENROOM="openroom";class UC{static isWebGLAvailable(){return Object(jS.q)()}}class PC extends MC{constructor(){super(),this._hasClickUrl=!0}getAdClickUrl(t){return t.getValue(rt.FURNITURE_BRANDING_URL)}handleAdClick(t,e,s){0!==s.indexOf("http")?this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new TN(TN.ROOM_AD_FURNI_CLICK,this.object,"",s)):LC.openWebPage(s)}}class bC extends AD{constructor(){super(),this._roomColorUpdated=void 0,this._roomColorUpdated=!1}getEventTypes(){const t=[SN.DIMMER,SN.WIDGET_REMOVE_DIMMER,cN.DIMMER_STATE];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){if(this._roomColorUpdated&&this.eventDispatcher&&this.object){1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&(this.eventDispatcher.dispatchEvent(new cN(this.object,0,1,1,16777215,255)),this.eventDispatcher.dispatchEvent(new SN(SN.WIDGET_REMOVE_DIMMER,this.object))),this._roomColorUpdated=!1}super.onDispose()}processUpdateMessage(t){if(t instanceof JN){if(t.data){const e=t.data.getLegacyString();1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&this.processDimmerData(e),super.processUpdateMessage(new JN(this.getStateFromDimmerData(e),t.data))}}else super.processUpdateMessage(t)}getStateFromDimmerData(t){if(!t)return 0;const e=t.split(",");return e.length>=5?parseInt(e[0])-1:0}processDimmerData(t){if(!t)return;const e=t.split(",");if(e.length>=5){const s=this.getStateFromDimmerData(t),i=parseInt(e[1]),r=parseInt(e[2]),n=e[3];let a=parseInt(n.substr(1),16),o=parseInt(e[4]);s||(a=16777215,o=255),this.eventDispatcher&&this.object&&(this.eventDispatcher.dispatchEvent(new cN(this.object,s,i,r,a,o)),this._roomColorUpdated=!0)}}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.DIMMER,this.object))}update(t){super.update(t)}}class wC extends AD{constructor(){super(),this._score=void 0,this._scoreIncreaser=void 0,this._scoreTimer=void 0,this._score=0,this._scoreIncreaser=50,this._scoreTimer=0}processUpdateMessage(t){if(t instanceof JN)return this.updateScore(t.state);super.processUpdateMessage(t)}updateScore(t){this._score=t;const e=this.object.getState(0);if(this._score!==e){let t=this._score-e;t<0&&(t=-t),t*wC.UPDATE_INTERVAL>wC.MAX_UPDATE_TIME?this._scoreIncreaser=wC.MAX_UPDATE_TIME/t:this._scoreIncreaser=wC.UPDATE_INTERVAL,this._scoreTimer=SU.instance.time}}update(t){super.update(t);const e=this.object.getState(0);if(e!==this._score&&t>=this._scoreTimer+this._scoreIncreaser){const s=t-this._scoreTimer;let i=s/this._scoreIncreaser,r=1;this._score<e&&(r=-1),i>r*(this._score-e)&&(i=r*(this._score-e)),this.object.setState(e+r*i,0),this._scoreTimer=t-(s-i*this._scoreIncreaser)}}}wC.UPDATE_INTERVAL=50,wC.MAX_UPDATE_TIME=3e3;class FC extends AD{processUpdateMessage(t){if(super.processUpdateMessage(t),1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)){const t=this.object.model.getValue(rt.FURNITURE_EXTRAS),e=parseInt(t);this.object.model.setValue(DD.INFOSTAND_EXTRA_PARAM,DD.SONGDISK+e)}}}class xC extends HD{constructor(){super(...arguments),this._state=-1,this._sampleId=-1,this._noPitch=!1,this._lastLocZ=0}getEventTypes(){const t=[RN.ROOM_OBJECT_INITIALIZED,RN.ROOM_OBJECT_DISPOSED,RN.PLAY_SAMPLE,RN.CHANGE_PITCH];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.soundSample&&(this._sampleId=t.logic.soundSample.id,this._noPitch=t.logic.soundSample.noPitch),this.object.model.setValue(rt.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,1)}onDispose(){this._state!==xC.STATE_UNINITIALIZED&&this.eventDispatcher.dispatchEvent(new RN(RN.ROOM_OBJECT_DISPOSED,this.object,this._sampleId)),super.onDispose()}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof JN&&this.updateSoundBlockMessage(t)}updateSoundBlockMessage(t){if(!t)return;const e=this.object&&this.object.model,s=this.object&&this.object.location;e&&s&&(this._state===xC.STATE_UNINITIALIZED&&1===e.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new RN(RN.ROOM_OBJECT_INITIALIZED,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==xC.STATE_UNINITIALIZED&&1===e.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&this._lastLocZ!==s.z&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new RN(RN.CHANGE_PITCH,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==xC.STATE_UNINITIALIZED&&t.state!==this._state&&this.playSoundAt(s.z),this._state=t.state)}playSoundAt(t){if(!this.object)return;const e=this.getPitchForHeight(t);this.object.model.setValue(rt.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,e),this.eventDispatcher.dispatchEvent(new RN(RN.PLAY_SAMPLE,this.object,this._sampleId,e))}getPitchForHeight(t){if(this._noPitch)return 1;let e=2*t;return e>xC.HIGHEST_SEMITONE&&(e=Math.min(0,xC.LOWEST_SEMITONE+(e-xC.HIGHEST_SEMITONE-1))),Math.pow(2,e/12)}}xC.HIGHEST_SEMITONE=12,xC.LOWEST_SEMITONE=-12,xC.STATE_UNINITIALIZED=-1;class BC extends HD{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[gN.SOUND_MACHINE_START,gN.SOUND_MACHINE_STOP,gN.SOUND_MACHINE_DISPOSE,gN.SOUND_MACHINE_INIT];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),1===this.object.model.getValue(rt.FURNITURE_REAL_ROOM_OBJECT)&&(this._isInitialized||this.requestInit(),this.object.model.setValue(DD.INFOSTAND_EXTRA_PARAM,DD.JUKEBOX),t instanceof JN)){const t=this.object.getState(0);t!==this._currentState&&(this._currentState=t,1===t?this.requestPlayList():0===t&&this.requestStopPlaying())}}requestInit(){this.object&&this.eventDispatcher&&(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new gN(gN.SOUND_MACHINE_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){this.object&&this.eventDispatcher&&(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new gN(gN.SOUND_MACHINE_START,this.object)))}requestStopPlaying(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new gN(gN.SOUND_MACHINE_STOP,this.object))}requestDispose(){this._disposeEventsAllowed&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new gN(gN.SOUND_MACHINE_DISPOSE,this.object))}}class GC extends AD{getEventTypes(){const t=[SN.STICKIE,gN.STICKIE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.updateColor(),this.object&&this.object.model.setValue(rt.FURNITURE_IS_STICKIE,"")}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof eM&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.STICKIE,this.object)),this.updateColor()}updateColor(){if(!this.object)return;const t=this.object.model.getValue(rt.FURNITURE_DATA);let e=GC.STICKIE_COLORS.indexOf(t);e<0&&(e=3),this.object.model.setValue(rt.FURNITURE_COLOR,e+1)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new gN(gN.STICKIE,this.object))}}GC.STICKIE_COLORS=["9CCEFF","FF9CFF","9CFF9C","FFFF33"];class HC extends AD{getEventTypes(){const t=[SN.TROPHY];return this.mergeTypes(super.getEventTypes(),t)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.TROPHY,this.object))}}class VC extends HD{constructor(){super(),this._total=void 0,this._lastUpdate=void 0,this._interval=void 0,this._total=0,this._lastUpdate=0,this._interval=33}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof JN){const e=t.data;if(!e)return;this.updateTotal(e.result)}}updateTotal(t){if(this._total=t,!this._lastUpdate)return this.object.model.setValue(rt.FURNITURE_VOTE_COUNTER_COUNT,t),void(this._lastUpdate=SU.instance.time);if(this._total!==this.currentTotal){const t=Math.abs(this._total-this.currentTotal);t*VC.UPDATE_INTERVAL>VC.MAX_UPDATE_TIME?this._interval=VC.MAX_UPDATE_TIME/t:this._interval=VC.UPDATE_INTERVAL,this._lastUpdate=SU.instance.time}}update(t){if(super.update(t),this.object&&this.currentTotal!==this._total&&t>=this._lastUpdate+this._interval){const e=t-this._lastUpdate;let s=e/this._interval,i=1;this._total<this.currentTotal&&(i=-1),s>i*(this._total-this.currentTotal)&&(s=i*(this._total-this.currentTotal)),this.object.model.setValue(rt.FURNITURE_VOTE_COUNTER_COUNT,this.currentTotal+i*s),this._lastUpdate=t-(e-s*this._interval)}}get currentTotal(){return this.object.model.getValue(rt.FURNITURE_VOTE_COUNTER_COUNT)}}VC.UPDATE_INTERVAL=33,VC.MAX_UPDATE_TIME=1e3;class jC extends HD{processUpdateMessage(t){if(super.processUpdateMessage(t),this.object&&t instanceof JN){const e=t.data;e instanceof ma&&this.object.model.setValue(rt.FURNITURE_VOTE_MAJORITY_RESULT,e.result)}}}class kC extends HD{mouseEvent(t,e){t&&e&&(t.type===ts.DOUBLE_CLICK&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new ON(ON.STATE_CHANGE,this.object)),super.mouseEvent(t,e))}}class YC extends HD{initialize(t){super.initialize(t);let e="";t.logic&&t.logic.maskType&&""!==t.logic.maskType&&t.logic.maskType.length>0&&(e=t.logic.maskType),this.object.model.setValue(rt.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(rt.FURNITURE_PLANE_MASK_TYPE,e)}}class zC extends AD{getEventTypes(){const t=[SN.YOUTUBE,uN.RODRE_URL_PREFIX];return this.mergeTypes(super.getEventTypes(),t)}update(t){super.update(t),this.object.model.getValue(rt.SESSION_URL_PREFIX)||this.eventDispatcher.dispatchEvent(new uN(uN.RODRE_URL_PREFIX,this.object))}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.YOUTUBE,this.object))}}class WC extends OD{constructor(){super(),this._selected=void 0,this._reportedLocation=void 0,this._postureIndex=void 0,this._gestureIndex=void 0,this._headDirectionDelta=void 0,this._directions=void 0,this._talkingEndTimestamp=void 0,this._gestureEndTimestamp=void 0,this._expressionEndTimestamp=void 0,this._selected=!1,this._reportedLocation=null,this._postureIndex=0,this._gestureIndex=0,this._headDirectionDelta=0,this._directions=[],this._talkingEndTimestamp=0,this._gestureEndTimestamp=0,this._expressionEndTimestamp=0}getEventTypes(){const t=[De.CLICK,mN.POSITION_CHANGED];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(e){if(t.logic&&t.logic.model){const e=t.logic.model.directions;if(e&&e.length){for(const t of e)this._directions.push(t);this._directions.sort()}}e.setValue(rt.PET_ALLOWED_DIRECTIONS,this._directions)}}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new mN(mN.OBJECT_REMOVED,this.object)),this._directions=null,this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const t=this.object.getLocation();this._reportedLocation&&this._reportedLocation.x===t.x&&this._reportedLocation.y===t.y&&this._reportedLocation.z===t.z||(this._reportedLocation||(this._reportedLocation=new dt),this._reportedLocation.assign(t),this.eventDispatcher.dispatchEvent(new mN(mN.POSITION_CHANGED,this.object)))}this.object&&this.object.model&&this.updateModel(t,this.object.model)}updateModel(t,e){this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(rt.FIGURE_GESTURE,null),this._gestureEndTimestamp=0),this._talkingEndTimestamp>0&&t>this._talkingEndTimestamp&&(e.setValue(rt.FIGURE_TALK,0),this._talkingEndTimestamp=0),this._expressionEndTimestamp>0&&t>this._expressionEndTimestamp&&(e.setValue(rt.FIGURE_EXPRESSION,0),this._expressionEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const e=this.object&&this.object.model;if(e)if(t instanceof QN)e.setValue(rt.HEAD_DIRECTION,t.headDirection);else{if(t instanceof FN){const s=new WS(t.figure);return e.setValue(rt.FIGURE,t.figure),e.setValue(rt.RACE,t.subType),e.setValue(rt.PET_PALETTE_INDEX,s.paletteId),e.setValue(rt.PET_COLOR,s.color),e.setValue(rt.PET_TYPE,s.typeId),e.setValue(rt.PET_CUSTOM_LAYER_IDS,s.customLayerIds),e.setValue(rt.PET_CUSTOM_PARTS_IDS,s.customPartIds),e.setValue(rt.PET_CUSTOM_PALETTE_IDS,s.customPaletteIds),void e.setValue(rt.PET_IS_RIDING,t.isRiding?1:0)}if(t instanceof zN)e.setValue(rt.FIGURE_POSTURE,t.postureType);else{if(t instanceof LN)return e.setValue(rt.FIGURE_TALK,1),void(this._talkingEndTimestamp=this.time+1e3*t.numberOfWords);if(!(t instanceof KN))return t instanceof jN?(e.setValue(rt.FIGURE_GESTURE,t.gesture),void(this._gestureEndTimestamp=this.time+3e3)):t instanceof ED?(this._selected=t.selected,void(this._reportedLocation=null)):t instanceof bN?(e.setValue(rt.FIGURE_EXPERIENCE_TIMESTAMP,this.time),void e.setValue(rt.FIGURE_GAINED_EXPERIENCE,t.gainedExperience)):void 0;e.setValue(rt.FIGURE_SLEEP,t.isSleeping?1:0)}}}mouseEvent(t,e){let s=null;switch(t.type){case ts.MOUSE_CLICK:s=De.CLICK;break;case ts.DOUBLE_CLICK:break;case ts.MOUSE_DOWN:this.object.model.getValue(rt.PET_TYPE)===er.MONSTERPLANT&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new De(De.MOUSE_DOWN,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown));break}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new De(s,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}}class KC extends we{constructor(){super(),this._planeParser=void 0,this._planeBitmapMaskParser=void 0,this._color=void 0,this._light=void 0,this._originalColor=void 0,this._originalLight=void 0,this._targetColor=void 0,this._targetLight=void 0,this._colorChangedTime=void 0,this._colorTransitionLength=void 0,this._lastHoleUpdate=void 0,this._needsMapUpdate=void 0,this._skipColorTransition=void 0,this._planeParser=new jh,this._planeBitmapMaskParser=new Ly,this._color=16777215,this._light=255,this._originalColor=16777215,this._originalLight=255,this._targetColor=16777215,this._targetLight=255,this._colorChangedTime=0,this._colorTransitionLength=1500,this._lastHoleUpdate=0,this._needsMapUpdate=!1,this._skipColorTransition=!1}getEventTypes(){const t=[De.MOUSE_MOVE,De.CLICK];return this.mergeTypes(super.getEventTypes(),t)}dispose(){super.dispose(),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null),this._planeBitmapMaskParser&&(this._planeBitmapMaskParser.dispose(),this._planeBitmapMaskParser=null)}initialize(t){t&&this.object&&t instanceof Bh&&this._planeParser.initializeFromMapData(t)&&(this.object.model.setValue(rt.ROOM_MAP_DATA,t),this.object.model.setValue(rt.ROOM_BACKGROUND_COLOR,16777215),this.object.model.setValue(rt.ROOM_FLOOR_VISIBILITY,1),this.object.model.setValue(rt.ROOM_WALL_VISIBILITY,1),this.object.model.setValue(rt.ROOM_LANDSCAPE_VISIBILITY,1),this._skipColorTransition=!0===SU.instance.getConfiguration("room.color.skip.transition"))}update(t){if(super.update(t),this.updateBackgroundColor(t),this._needsMapUpdate){if(this._lastHoleUpdate&&t-this._lastHoleUpdate<5)return;const e=this.object&&this.object.model;if(e){const s=this._planeParser.getMapData();e.setValue(rt.ROOM_MAP_DATA,s),e.setValue(rt.ROOM_FLOOR_HOLE_UPDATE_TIME,t),this._planeParser.initializeFromMapData(s)}this._lastHoleUpdate=0,this._needsMapUpdate=!1}}updateBackgroundColor(t){if(!this.object||!this._colorChangedTime)return;let e=this._color,s=this._light;if(t-this._colorChangedTime>=this._colorTransitionLength)e=this._targetColor,s=this._targetLight,this._colorChangedTime=0;else{let i=this._originalColor>>16&255,r=this._originalColor>>8&255,n=255&this._originalColor;const a=this._targetColor>>16&255,o=this._targetColor>>8&255,h=255&this._targetColor,_=(t-this._colorChangedTime)/this._colorTransitionLength;i+=(a-i)*_,r+=(o-r)*_,n+=(h-n)*_,e=(i<<16)+(r<<8)+n,s=this._originalLight+(this._targetLight-this._originalLight)*_,this._color=e,this._light=s}let i=Ge.rgbToHSL(e);i=(16776960&i)+s,e=Ge.hslToRGB(i),this.object.model&&this.object.model.setValue(rt.ROOM_BACKGROUND_COLOR,e)}processUpdateMessage(t){if(!t||!this.object)return;const e=this.object.model;e&&(t instanceof hM?this.onObjectRoomUpdateMessage(t,e):t instanceof nM?this.onObjectRoomMaskUpdateMessage(t,e):t instanceof oM?this.onObjectRoomPlaneVisibilityUpdateMessage(t,e):t instanceof aM?this.onObjectRoomPlanePropertyUpdateMessage(t,e):t instanceof rM?this.onObjectRoomFloorHoleUpdateMessage(t,e):t instanceof iM?this.onObjectRoomColorUpdateMessage(t,e):t instanceof JD&&this.onObjectRoomMapUpdateMessage(t))}onObjectRoomUpdateMessage(t,e){switch(t.type){case hM.ROOM_FLOOR_UPDATE:return void e.setValue(rt.ROOM_FLOOR_TYPE,t.value);case hM.ROOM_WALL_UPDATE:return void e.setValue(rt.ROOM_WALL_TYPE,t.value);case hM.ROOM_LANDSCAPE_UPDATE:return void e.setValue(rt.ROOM_LANDSCAPE_TYPE,t.value)}}onObjectRoomMaskUpdateMessage(t,e){let s=null,i=!1;switch(t.type){case nM.ADD_MASK:s=Dy.WINDOW,t.maskCategory===nM.HOLE&&(s=Dy.HOLE),this._planeBitmapMaskParser.addMask(t.maskId,t.maskType,t.maskLocation,s),i=!0;break;case nM.REMOVE_MASK:i=this._planeBitmapMaskParser.removeMask(t.maskId)}i&&e.setValue(rt.ROOM_PLANE_MASK_XML,this._planeBitmapMaskParser.getXML())}onObjectRoomPlaneVisibilityUpdateMessage(t,e){let s=0;switch(t.visible&&(s=1),t.type){case oM.FLOOR_VISIBILITY:return void e.setValue(rt.ROOM_FLOOR_VISIBILITY,s);case oM.WALL_VISIBILITY:return e.setValue(rt.ROOM_WALL_VISIBILITY,s),void e.setValue(rt.ROOM_LANDSCAPE_VISIBILITY,s)}}onObjectRoomPlanePropertyUpdateMessage(t,e){switch(t.type){case aM.FLOOR_THICKNESS:return void e.setValue(rt.ROOM_FLOOR_THICKNESS,t.value);case aM.WALL_THICKNESS:return void e.setValue(rt.ROOM_WALL_THICKNESS,t.value)}}onObjectRoomFloorHoleUpdateMessage(t,e){switch(t.type){case rM.ADD:return this._planeParser.addFloorHole(t.id,t.x,t.y,t.width,t.height),void(this._needsMapUpdate=!0);case rM.REMOVE:return this._planeParser.removeFloorHole(t.id),void(this._needsMapUpdate=!0)}this._lastHoleUpdate=this.time}onObjectRoomColorUpdateMessage(t,e){t&&e&&(this._originalColor=this._color,this._originalLight=this._light,this._targetColor=t.color,this._targetLight=t.light,this._colorChangedTime=this.time,this._skipColorTransition?this._colorTransitionLength=0:this._colorTransitionLength=1500,e.setValue(rt.ROOM_COLORIZE_BG_ONLY,t.backgroundOnly))}onObjectRoomMapUpdateMessage(t){t&&t.mapData&&(this.object.model.setValue(rt.ROOM_MAP_DATA,t.mapData),this.object.model.setValue(rt.ROOM_FLOOR_HOLE_UPDATE_TIME,this.time),this._planeParser.initializeFromMapData(t.mapData))}mouseEvent(t,e){if(!t||!e||!this.object||!this.object.model)return;const s=t.spriteTag;let i=0;if(s&&s.indexOf("@")>=0&&(i=parseInt(s.substr(s.indexOf("@")+1))),i<1||i>this._planeParser.planeCount)return void(t.type===ts.ROLL_OUT&&this.object.model.setValue(rt.ROOM_SELECTED_PLANE,0));i--;let r=null;const n=this._planeParser.getPlaneLocation(i),a=this._planeParser.getPlaneLeftSide(i),o=this._planeParser.getPlaneRightSide(i),h=this._planeParser.getPlaneNormalDirection(i),_=this._planeParser.getPlaneType(i);if(null==n||null==a||null==o||null==h)return;const d=a.length,u=o.length;if(0==d||0==u)return;const c=t.screenX,l=t.screenY,g=new j.g(c,l);if(r=e.getPlanePosition(g,n,a,o),!r)return void this.object.model.setValue(rt.ROOM_SELECTED_PLANE,0);const E=dt.product(a,r.x/d);E.add(dt.product(o,r.y/u)),E.add(n);const p=E.x,m=E.y,I=E.z;if(!(r.x>=0&&r.x<d&&r.y>=0&&r.y<u))return void this.object.model.setValue(rt.ROOM_SELECTED_PLANE,0);this.object.model.setValue(rt.ROOM_SELECTED_X,p),this.object.model.setValue(rt.ROOM_SELECTED_Y,m),this.object.model.setValue(rt.ROOM_SELECTED_Z,I),this.object.model.setValue(rt.ROOM_SELECTED_PLANE,i+1);let T=null;switch(t.type===ts.MOUSE_MOVE||t.type===ts.ROLL_OVER?T=De.MOUSE_MOVE:t.type===ts.MOUSE_CLICK&&(T=De.CLICK),t.type){case ts.MOUSE_MOVE:case ts.ROLL_OVER:case ts.MOUSE_CLICK:{let e=null;if(_===Hh.PLANE_FLOOR)e=new vN(T,this.object,t.eventId,p,m,I,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);else if(_===Hh.PLANE_WALL||_===Hh.PLANE_LANDSCAPE){let s=90;h&&(s=h.x+90,s>360&&(s-=360));const i=a.length*r.x/d,_=o.length*r.y/u;e=new AN(T,this.object,t.eventId,n,a,o,i,_,s,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown)}return void(this.eventDispatcher&&this.eventDispatcher.dispatchEvent(e))}}}}class XC extends we{initialize(t){this.object&&(this.object.model.setValue(rt.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(1,0))}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof ID&&this.object)switch(t.type){case ID.ENABLED:return void this.object.setState(0,0);case ID.DISABLED:return void this.object.setState(1,0)}}}class qC extends we{constructor(){super(),this._lastEventId=void 0,this._isHidden=void 0,this._lastEventId=null,this._isHidden=!1}initialize(t){this.object&&(this.object.model.setValue(rt.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(qC.CURSOR_HIDDEN_STATE,0))}processUpdateMessage(t){t instanceof mD&&(this._lastEventId&&this._lastEventId===t.sourceEventId||(t.toggleVisibility&&(this._isHidden=!this._isHidden),super.processUpdateMessage(t),this.object&&(this._isHidden?this.object.setState(qC.CURSOR_HIDDEN_STATE,0):t.visible?(this.object.model.setValue(rt.TILE_CURSOR_HEIGHT,t.height),this.object.setState(t.height>.8?qC.CURSOR_HEIGHT_STATE:qC.CURSOR_VISIBLE_STATE)):this.object.setState(qC.CURSOR_HIDDEN_STATE,0)),this._lastEventId=t.sourceEventId))}}qC.CURSOR_VISIBLE_STATE=0,qC.CURSOR_HIDDEN_STATE=1,qC.CURSOR_HEIGHT_STATE=6;class QC{}QC.FURNITURE_BASIC="furniture_basic",QC.FURNITURE_MULTISTATE="furniture_multistate",QC.FURNITURE_MULTIHEIGHT="furniture_multiheight",QC.FURNITURE_RANDOMSTATE="furniture_randomstate",QC.FURNITURE_PLACEHOLDER="furniture_placeholder",QC.FURNITURE_CREDIT="furniture_credit",QC.FURNITURE_STICKIE="furniture_stickie",QC.FURNITURE_PRESENT="furniture_present",QC.FURNITURE_TROPHY="furniture_trophy",QC.FURNITURE_ECOTRON_BOX="furniture_ecotron_box",QC.FURNITURE_DICE="furniture_dice",QC.FURNITURE_HOCKEY_SCORE="furniture_hockey_score",QC.FURNITURE_HABBOWHEEL="furniture_habbowheel",QC.FURNITURE_ONE_WAY_DOOR="furniture_one_way_door",QC.FURNITURE_PLANET_SYSTEM="furniture_planet_system",QC.FURNITURE_WINDOW="furniture_window",QC.FURNITURE_EXTERNAL_IMAGE_WALLITEM="furniture_external_image_wallitem",QC.FURNITURE_ROOMDIMMER="furniture_roomdimmer",QC.FURNITURE_SOUND_MACHINE="furniture_sound_machine",QC.FURNITURE_JUKEBOX="furniture_jukebox",QC.FURNITURE_CRACKABLE="furniture_crackable",QC.FURNITURE_PUSHABLE="furniture_pushable",QC.FURNITURE_CLOTHING_CHANGE="furniture_clothing_change",QC.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",QC.FURNITURE_SCORE="furniture_score",QC.FURNITURE_ES="furniture_es",QC.FURNITURE_FIREWORKS="furniture_fireworks",QC.FURNITURE_SONG_DISK="furniture_song_disk",QC.FURNITURE_BB="furniture_bb",QC.FURNITURE_BG="furniture_bg",QC.FURNITURE_WELCOME_GIFT="furniture_welcome_gift",QC.FURNITURE_FLOOR_HOLE="furniture_floor_hole",QC.FURNITURE_MANNEQUIN="furniture_mannequin",QC.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",QC.FURNITURE_GROUP_FORUM_TERMINAL="furniture_group_forum_terminal",QC.FURNITURE_PET_CUSTOMIZATION="furniture_pet_customization",QC.FURNITURE_CUCKOO_CLOCK="furniture_cuckoo_clock",QC.FURNITURE_VOTE_COUNTER="furniture_vote_counter",QC.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",QC.FURNITURE_SOUNDBLOCK="furniture_soundblock",QC.FURNITURE_RANDOM_TELEPORT="furniture_random_teleport",QC.FURNITURE_MONSTERPLANT_SEED="furniture_monsterplant_seed",QC.FURNITURE_PURCHASABLE_CLOTHING="furniture_purchasable_clothing",QC.FURNITURE_BACKGROUND_COLOR="furniture_background_color",QC.FURNITURE_MYSTERYBOX="furniture_mysterybox",QC.FURNITURE_EFFECTBOX="furniture_effectbox",QC.FURNITURE_MYSTERYTROPHY="furniture_mysterytrophy",QC.FURNITURE_ACHIEVEMENT_RESOLUTION="furniture_achievement_resolution",QC.FURNITURE_LOVELOCK="furniture_lovelock",QC.FURNITURE_WILDWEST_WANTED="furniture_wildwest_wanted",QC.FURNITURE_HWEEN_LOVELOCK="furniture_hween_lovelock",QC.FURNITURE_BADGE_DISPLAY="furniture_badge_display",QC.FURNITURE_HIGH_SCORE="furniture_high_score",QC.FURNITURE_INTERNAL_LINK="furniture_internal_link",QC.FURNITURE_CUSTOM_STACK_HEIGHT="furniture_custom_stack_height",QC.FURNITURE_YOUTUBE="furniture_youtube",QC.FURNITURE_RENTABLE_SPACE="furniture_rentable_space",QC.FURNITURE_CHANGE_STATE_WHEN_STEP_ON="furniture_change_state_when_step_on",QC.FURNITURE_VIMEO="furniture_vimeo",QC.FURNITURE_EDITABLE_INTERNAL_LINK="furniture_editable_internal_link",QC.FURNITURE_EDITABLE_ROOM_LINK="furniture_editable_room_link",QC.FURNITURE_CRAFTING_GIZMO="furniture_crafting_gizmo",QC.ROOM="room",QC.USER="user",QC.BOT="bot",QC.RENTABLE_BOT="rentable_bot",QC.PET="pet",QC.TILE_CURSOR="tile_cursor",QC.SELECTION_ARROW="selection_arrow",QC.GAME_SNOWBALL="game_snowball",QC.GAME_SNOWSPLASH="game_snowsplash";class ZC extends AD{getEventTypes(){const t=[SN.CLOTHING_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);const e=this.object.model.getValue(rt.FURNITURE_DATA);this.updateClothingData(e)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof JN&&t.data&&this.updateClothingData(t.data.getLegacyString())}updateClothingData(t){if(!t||!t.length)return;const[e,s]=t.split(",");e&&e.length&&this.object.model.setValue(rt.FURNITURE_CLOTHING_BOY,e),s&&s.length&&this.object.model.setValue(rt.FURNITURE_CLOTHING_GIRL,s)}useObject(){this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new SN(SN.CLOTHING_CHANGE,this.object))}}class JC extends HD{constructor(){super(...arguments),this._state=1}getEventTypes(){const t=[IN.PLAY_SOUND_AT_PITCH];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof JN&&(-1!==this._state&&t.state!==this._state&&this.dispatchSoundEvent(this.object.location.z),this._state=t.state)}dispatchSoundEvent(t){const e=Math.pow(2,t-1.2);this.eventDispatcher.dispatchEvent(new IN(IN.PLAY_SOUND_AT_PITCH,this.object,"FURNITURE_cuckoo_clock",e))}}class $C{constructor(){this._events=void 0,this._cachedEvents=void 0,this._registeredEvents=void 0,this._functions=void 0,this._events=new g,this._cachedEvents=new Map,this._registeredEvents=new Map,this._functions=[]}getLogic(t){const e=this.getLogicType(t);if(!e)return null;const s=new e;if(!s)return null;if(s.eventDispatcher=this._events,!this._cachedEvents.get(t)){this._cachedEvents.set(t,!0);const e=s.getEventTypes();for(const t of e)t&&this.registerEventType(t)}return s}registerEventType(t){if(!this._registeredEvents.get(t)){this._registeredEvents.set(t,!0);for(const e of this._functions)e&&this._events.addEventListener(t,e)}}registerEventFunction(t){if(t&&!(this._functions.indexOf(t)>=0)){this._functions.push(t);for(const e of this._registeredEvents.keys())e&&this._events.addEventListener(e,t)}}removeEventFunction(t){if(!t)return;const e=this._functions.indexOf(t);if(-1!==e){this._functions.splice(e,1);for(const e of this._registeredEvents.keys())e&&this._events.removeEventListener(e,t)}}getLogicType(t){if(!t)return null;let e=null;switch(t){case QC.ROOM:e=KC;break;case QC.TILE_CURSOR:e=qC;break;case QC.SELECTION_ARROW:e=XC;break;case QC.USER:case QC.BOT:case QC.RENTABLE_BOT:e=vD;break;case QC.PET:e=WC;break;case QC.FURNITURE_BASIC:e=AD;break;case QC.FURNITURE_BADGE_DISPLAY:e=SD;break;case QC.FURNITURE_CHANGE_STATE_WHEN_STEP_ON:e=MD;break;case QC.FURNITURE_COUNTER_CLOCK:e=yD;break;case QC.FURNITURE_CRACKABLE:e=CD;break;case QC.FURNITURE_CREDIT:e=GD;break;case QC.FURNITURE_CUSTOM_STACK_HEIGHT:e=VD;break;case QC.FURNITURE_DICE:e=jD;break;case QC.FURNITURE_EDITABLE_INTERNAL_LINK:e=YD;break;case QC.FURNITURE_EDITABLE_ROOM_LINK:e=zD;break;case QC.FURNITURE_EXTERNAL_IMAGE_WALLITEM:e=KD;break;case QC.FURNITURE_FIREWORKS:e=XD;break;case QC.FURNITURE_FLOOR_HOLE:e=qD;break;case QC.FURNITURE_GUILD_CUSTOMIZED:e=$D;break;case QC.FURNITURE_HIGH_SCORE:e=sC;break;case QC.FURNITURE_HOCKEY_SCORE:e=iC;break;case QC.FURNITURE_ES:e=aC;break;case QC.FURNITURE_MANNEQUIN:e=dC;break;case QC.FURNITURE_MULTIHEIGHT:e=cC;break;case QC.FURNITURE_MULTISTATE:e=HD;break;case QC.FURNITURE_ONE_WAY_DOOR:e=EC;break;case QC.FURNITURE_PET_CUSTOMIZATION:e=pC;break;case QC.FURNITURE_PRESENT:e=TC;break;case QC.FURNITURE_PURCHASABLE_CLOTHING:e=RC;break;case QC.FURNITURE_PUSHABLE:e=fC;break;case QC.FURNITURE_BACKGROUND_COLOR:e=SC;break;case QC.FURNITURE_BG:e=yC;break;case QC.FURNITURE_BB:e=PC;break;case QC.FURNITURE_ROOMDIMMER:e=bC;break;case QC.FURNITURE_SCORE:e=wC;break;case QC.FURNITURE_SOUNDBLOCK:e=xC;break;case QC.FURNITURE_STICKIE:e=GC;break;case QC.FURNITURE_TROPHY:e=HC;break;case QC.FURNITURE_VOTE_COUNTER:e=VC;break;case QC.FURNITURE_VOTE_MAJORITY:e=jC;break;case QC.FURNITURE_WINDOW:e=YC;break;case QC.FURNITURE_LOVELOCK:e=_C;break;case QC.FURNITURE_YOUTUBE:e=zC;break;case QC.FURNITURE_CRAFTING_GIZMO:e=BD;break;case QC.FURNITURE_RENTABLE_SPACE:e=AC;break;case QC.FURNITURE_EFFECTBOX:e=WD;break;case QC.FURNITURE_MONSTERPLANT_SEED:e=uC;break;case QC.FURNITURE_MYSTERYBOX:e=lC;break;case QC.FURNITURE_MYSTERYTROPHY:e=gC;break;case QC.FURNITURE_RANDOM_TELEPORT:e=vC;break;case QC.FURNITURE_CLOTHING_CHANGE:e=ZC;break;case QC.FURNITURE_CUCKOO_CLOCK:e=JC;break;case QC.FURNITURE_ECOTRON_BOX:e=kD;break;case QC.FURNITURE_GROUP_FORUM_TERMINAL:e=tC;break;case QC.FURNITURE_HWEEN_LOVELOCK:e=nC;break;case QC.FURNITURE_INTERNAL_LINK:e=oC;break;case QC.FURNITURE_JUKEBOX:e=hC;break;case QC.FURNITURE_PLACEHOLDER:e=mC;break;case QC.FURNITURE_PLANET_SYSTEM:e=IC;break;case QC.FURNITURE_RANDOMSTATE:e=OC;break;case QC.FURNITURE_SONG_DISK:e=FC;break;case QC.FURNITURE_SOUND_MACHINE:e=BC;break;case QC.FURNITURE_WELCOME_GIFT:e=kC;break;case QC.FURNITURE_ACHIEVEMENT_RESOLUTION:e=ND;break;case QC.FURNITURE_HABBOWHEEL:e=eC;break;default:e=AD}return e||(l.warn("Unknown Logic",t),null)}get events(){return this._events}}class tL{constructor(t,e){this._roomId=void 0,this._data=void 0,this._floorType=void 0,this._wallType=void 0,this._landscapeType=void 0,this._roomId=t,this._data=e,this._floorType=null,this._wallType=null,this._landscapeType=null}get roomId(){return this._roomId}get data(){return this._data}get floorType(){return this._floorType}set floorType(t){this._floorType=t}get wallType(){return this._wallType}set wallType(t){this._wallType=t}get landscapeType(){return this._landscapeType}set landscapeType(t){this._landscapeType=t}}class eL{constructor(t,e,s,i,r,n,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:NaN,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"",c=!(arguments.length>12&&void 0!==arguments[12])||arguments[12],l=!(arguments.length>13&&void 0!==arguments[13])||arguments[13],g=arguments.length>14&&void 0!==arguments[14]?arguments[14]:-1;this._id=void 0,this._typeId=void 0,this._type=void 0,this._location=void 0,this._direction=void 0,this._state=void 0,this._data=void 0,this._extra=void 0,this._expiryTime=void 0,this._usagePolicy=void 0,this._ownerId=void 0,this._ownerName=void 0,this._synchronized=void 0,this._realRoomObject=void 0,this._sizeZ=void 0,this._id=t,this._typeId=e,this._type=s,this._state=n,this._data=a,this._extra=o,this._expiryTime=h,this._usagePolicy=_,this._ownerId=d,this._ownerName=u,this._synchronized=c,this._realRoomObject=l,this._sizeZ=g,this._location=new dt,this._direction=new dt,this._location.assign(i),this._direction.assign(r)}get id(){return this._id}get typeId(){return this._typeId}get type(){return this._type}get location(){return this._location}get direction(){return this._direction}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}get expiryTime(){return this._expiryTime}get usagePolicy(){return this._usagePolicy}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get synchronized(){return this._synchronized}get realRoomObject(){return this._realRoomObject}get sizeZ(){return this._sizeZ}}class sL{constructor(){this._targetId=-1,this._targetCategory=-2,this._targetLoc=null,this._moveDistance=0,this._previousMoveSpeed=0,this._maintainPreviousMoveSpeed=!1,this._currentLoc=null,this._targetObjectLoc=void 0,this._limitedLocX=!1,this._limitedLocY=!1,this._centeredLocX=!1,this._centeredLocY=!1,this._screenWd=0,this._screenHt=0,this._scale=0,this._roomWd=0,this._roomHt=0,this._geometryUpdateId=-1,this._scaleChanged=!1,this._followDuration=void 0,this._targetObjectLoc=new dt}get location(){return this._currentLoc}get targetId(){return this._targetId}set targetId(t){this._targetId=t}get targetCategory(){return this._targetCategory}set targetCategory(t){this._targetCategory=t}get targetObjectLoc(){return this._targetObjectLoc}set targetObjectLoc(t){this._targetObjectLoc.assign(t)}get limitedLocationX(){return this._limitedLocX}set limitedLocationX(t){this._limitedLocX=t}get limitedLocationY(){return this._limitedLocY}set limitedLocationY(t){this._limitedLocY=t}get centeredLocX(){return this._centeredLocX}set centeredLocX(t){this._centeredLocX=t}get centeredLocY(){return this._centeredLocY}set centeredLocY(t){this._centeredLocY=t}get screenWd(){return this._screenWd}set screenWd(t){this._screenWd=t}get screenHt(){return this._screenHt}set screenHt(t){this._screenHt=t}get scale(){return this._scale}set scale(t){this._scale!=t&&(this._scale=t,this._scaleChanged=!0)}get roomWd(){return this._roomWd}set roomWd(t){this._roomWd=t}get roomHt(){return this._roomHt}set roomHt(t){this._roomHt=t}get geometryUpdateId(){return this._geometryUpdateId}set geometryUpdateId(t){this._geometryUpdateId=t}get isMoving(){return null!=this._targetLoc&&null!=this._currentLoc}set target(t){let e;null==this._targetLoc&&(this._targetLoc=new dt),this._targetLoc.x==t.x&&this._targetLoc.y==t.y&&this._targetLoc.z==t.z||(this._targetLoc.assign(t),e=dt.dif(this._targetLoc,this._currentLoc),this._moveDistance=e.length,this._maintainPreviousMoveSpeed=!0)}dispose(){this._targetLoc=null,this._currentLoc=null}initializeLocation(t){null==this._currentLoc&&(this._currentLoc=new dt,this._currentLoc.assign(t))}resetLocation(t){null==this._currentLoc&&(this._currentLoc=new dt),this._currentLoc.assign(t)}update(t,e){let s,i,r,n,a;if(this._followDuration>0&&null!=this._targetLoc&&null!=this._currentLoc){if(this._scaleChanged)return this._scaleChanged=!1,this._currentLoc=this._targetLoc,void(this._targetLoc=null);s=dt.dif(this._targetLoc,this._currentLoc),s.length>this._moveDistance&&(this._moveDistance=s.length),s.length<=e?(this._currentLoc=this._targetLoc,this._targetLoc=null,this._previousMoveSpeed=0):(i=Math.sin(Math.PI*s.length/this._moveDistance),r=.5*e,n=this._moveDistance/sL.MOVE_SPEED_DENOMINATOR,a=r+(n-r)*i,this._maintainPreviousMoveSpeed&&(a<this._previousMoveSpeed?(a=this._previousMoveSpeed,a>s.length&&(a=s.length)):this._maintainPreviousMoveSpeed=!1),this._previousMoveSpeed=a,s.divide(s.length),s.multiply(a),this._currentLoc=dt.sum(this._currentLoc,s))}}reset(){this._geometryUpdateId=-1}activateFollowing(t){this._followDuration=t}}sL.MOVE_SPEED_DENOMINATOR=12;class iL{constructor(t,e){this._tileObjectMap=void 0,this._width=void 0,this._height=void 0,this._tileObjectMap=new Map;let s=0;for(;s<e;)this._tileObjectMap.set(s,new Map),s++;this._width=t,this._height=e}clear(){for(const t of this._tileObjectMap.values())t&&t.clear();this._tileObjectMap.clear()}populate(t){this.clear();for(const e of t)this.addRoomObject(e)}dispose(){this._tileObjectMap=null,this._width=0,this._height=0}getObjectIntTile(t,e){if(t>=0&&t<this._width&&e>=0&&e<this._height){const s=this._tileObjectMap.get(e);if(s)return s.get(t)}return null}setObjectInTile(t,e,s){if(s.isReady){if(t>=0&&t<this._width&&e>=0&&e<this._height){const i=this._tileObjectMap.get(e);i&&i.set(t,s)}}else l.log("Assigning non initialized object to tile object map!")}addRoomObject(t){if(!t||!t.model||!t.isReady)return;const e=t.getLocation(),s=t.getDirection();if(!e||!s)return;let i=t.model.getValue(rt.FURNITURE_SIZE_X),r=t.model.getValue(rt.FURNITURE_SIZE_Y);i<1&&(i=1),r<1&&(r=1);const n=Math.trunc(s.x+45)%360/90;1!==n&&3!==n||([i,r]=[r,i]);let a=e.y;for(;a<e.y+r;){let s=e.x;for(;s<e.x+i;){const i=this.getObjectIntTile(s,a);(!i||i!==t&&i.getLocation().z<=e.z)&&this.setObjectInTile(s,a,t),s++}a++}}}class rL{constructor(t){this._roomId=void 0,this._modelName=void 0,this._legacyGeometry=void 0,this._tileObjectMap=void 0,this._roomCamera=void 0,this._selectedObject=void 0,this._placedObject=void 0,this._furnitureStackingHeightMap=void 0,this._floorStack=void 0,this._wallStack=void 0,this._mouseButtonCursorOwners=void 0,this._roomId=t,this._modelName=null,this._legacyGeometry=new cD,this._tileObjectMap=null,this._roomCamera=new sL,this._selectedObject=null,this._placedObject=null,this._furnitureStackingHeightMap=null,this._floorStack=new Map,this._wallStack=new Map,this._mouseButtonCursorOwners=[]}dispose(){}setModelName(t){this._modelName=t}setSelectedObject(t){this._selectedObject&&this._selectedObject.dispose(),this._selectedObject=t}setPlacedObject(t){this._placedObject&&this._placedObject.dispose(),this._placedObject=t}setFurnitureStackingHeightMap(t){this._furnitureStackingHeightMap&&this._furnitureStackingHeightMap.dispose(),this._furnitureStackingHeightMap=t,this._tileObjectMap&&this._tileObjectMap.dispose(),this._furnitureStackingHeightMap&&(this._tileObjectMap=new iL(this._furnitureStackingHeightMap.width,this._furnitureStackingHeightMap.height))}addPendingFurnitureFloor(t){t&&(this._floorStack.delete(t.id),this._floorStack.set(t.id,t))}removePendingFunitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getPendingFurnitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getNextPendingFurnitureFloor(){if(!this._floorStack.size)return null;const t=this._floorStack.keys();return this.getPendingFurnitureFloor(t.next().value)}addPendingFurnitureWall(t){t&&(this._wallStack.delete(t.id),this._wallStack.set(t.id,t))}removePendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getPendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getNextPendingFurnitureWall(){if(!this._wallStack.size)return null;const t=this._wallStack.keys();return this.getPendingFurnitureWall(t.next().value)}addButtonMouseCursorOwner(t){return-1===this._mouseButtonCursorOwners.indexOf(t)&&(this._mouseButtonCursorOwners.push(t),!0)}removeButtonMouseCursorOwner(t){const e=this._mouseButtonCursorOwners.indexOf(t);return e>-1&&(this._mouseButtonCursorOwners.splice(e,1),!0)}hasButtonMouseCursorOwners(){return this._mouseButtonCursorOwners.length>0}get roomId(){return this._roomId}get modelName(){return this._modelName}get legacyGeometry(){return this._legacyGeometry}get tileObjectMap(){return this._tileObjectMap}get roomCamera(){return this._roomCamera}get selectedObject(){return this._selectedObject}get placedObject(){return this._placedObject}get furnitureStackingHeightMap(){return this._furnitureStackingHeightMap}}class nL{constructor(t,e){this._object=void 0,this._groupBadge=void 0,this._object=t,this._groupBadge=e}get object(){return this._object}get groupBadge(){return this._groupBadge}}class aL{constructor(){this.maxZ=void 0,this.spriteCount=0,this.externalImageCount=0}static addMannequinSprites(t,e){const s=[];for(const i of t)if(i)if("boutique_mannequin1"===i.type&&0===i.name.indexOf("mannequin_")){const t=e.getRoomObject(e.activeRoomId,i.objectId,st.FLOOR);if(t){const e=t.visualization.getSpriteList();if(e)for(const t of e)t.x=t.x+(i.x+i.width/2+aL.MANNEQUIN_MAGIC_X_OFFSET),t.y=t.y+(i.y+i.height+aL.MANNEQUIN_MAGIC_Y_OFFSET),t.z=t.z+i.z,s.push(t)}}else s.push(i);return s}static sortSpriteDataObjects(t,e){return t.z<e.z?1:(t.z,e.z,-1)}static isSpriteInViewPort(t,e,s){return!0}static sortQuadPoints(t,e,s,i){const r=[];if(t.x==e.x?r.push(t,s,e,i):t.x==s.x?r.push(t,e,s,i):e.x<t.x&&e.y>t.y||e.x>t.x&&e.y<t.y?r.push(t,s,e,i):r.push(t,e,s,i),r[0].x<r[1].x){let t=r[0];r[0]=r[1],r[1]=t,t=r[2],r[2]=r[3],r[3]=t}if(r[0].y<r[2].y){let t=r[0];r[0]=r[2],r[2]=t,t=r[1],r[1]=r[3],r[3]=t}return r}getFurniData(t,e,s,i){const r=[];let n=e.getSortableSpriteList();const a=s.getRoomObjects(s.activeRoomId,st.UNIT);for(const o of a)if(o.id!==i){const t=o.visualization.getSpriteList();if(t){let i=0,r=0;for(const t of n)if(t.name==="avatar_"+o.id){i=t.z,r=t.y+t.height-e.geometry.scale/4;break}const a=s.getRoomObjectScreenLocation(s.activeRoomId,o.id,st.UNIT,e.id);if(a){0===r&&(r=a.y);for(const s of t)s.x=s.x+(a.x-e.screenOffsetX),s.y=s.y+r,s.z=s.z+i,0!==s.name.indexOf("h_std_fx29_")&&0!==s.name.indexOf("h_std_fx185_")||(s.y=s.y+aL.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET),n.push(s)}}}n=aL.addMannequinSprites(n,s),n.sort(aL.sortSpriteDataObjects);for(const o of n)null!==o.name&&o.name.length>0&&0!==o.name.indexOf("tile_cursor_")&&aL.isSpriteInViewPort(o,t,e)&&(i<0||o.objectId!=i)&&(r.push(this.getSpriteDataObject(o,t,e,s)),this.maxZ||(this.maxZ=o.z),this.spriteCount++);return JSON.stringify(r)}getRoomRenderingModifiers(t){return JSON.stringify(new Object)}getSpriteDataObject(t,e,s,i){let r=null,n=[];const a={};let o=t.name;return-1!==t.name.indexOf("@")&&(n=t.name.split("@"),o=n[0],r=n[1]),a.name=o,a.x=t.x-e.x,a.y=t.y-e.y,a.x=a.x+s.screenOffsetX,a.y=a.y+s.screenOffsetY,a.z=t.z,t.alpha&&"255"!==t.alpha.toString()&&(a.alpha=t.alpha),t.flipH&&(a.flipH=t.flipH),t.skew&&(a.skew=t.skew),t.frame&&(a.frame=t.frame),t.color&&t.color.length>0&&(a.color=parseInt(t.color)),t.blendMode&&"normal"!==t.blendMode&&(a.blendMode=t.blendMode),0===o.indexOf("http")&&(a.width=t.width,a.height=t.height,this.externalImageCount++,this.externalImageCount>aL.MAX_EXTERNAL_IMAGE_COUNT&&(a.name="box")),t.posture&&(a.posture=t.posture),a}makeBackgroundPlane(t,e,s){const i=new j.g(0,0),r=new j.g(t.width,0),n=new j.g(0,t.height),a=new j.g(t.width,t.height),o=aL.sortQuadPoints(i,r,n,a);let h=0;s.length>0?(h=s[0].z,this.maxZ&&(h=Math.max(this.maxZ,h))):h=this.maxZ?this.maxZ:0,h+=1.776104*this.spriteCount+2.31743*s.length;const _=new Uy(null,e);return _.cornerPoints=o,_.z=h,_}sortRoomPlanes(t,e,s){const i=new Map;let r=1;this.maxZ&&(r+=this.maxZ);for(const o of t){const t={plane:o,z:r};i.set(o.uniqueId,t)}const n=e.getPlaneSortableSprites();n.sort(((t,e)=>e.z-t.z)),n.reverse();let a=[];for(const o of n){const t=o.sprite;if(t){const e=i.get(t.id);e&&(i.delete(t.id),e.z=o.z,a.push(e))}}return a=a.concat(Array.from(i.values())),a}getRoomPlanes(t,e,s,i){const r=[],n=s.getRoomObject(s.activeRoomId,oL.ROOM_OBJECT_ID,st.ROOM).visualization;if(n){const a=e.geometry,o=this.sortRoomPlanes(n.planes,e,s),h=SU.instance.stage;for(const s of o){const i=s.plane,n=[],o=dt.sum(i.location,i.leftSide),_=a.getScreenPoint(i.location),d=a.getScreenPoint(o),u=a.getScreenPoint(dt.sum(i.location,i.rightSide)),c=a.getScreenPoint(dt.sum(o,i.rightSide));n.push(_,d,u,c);let l=0,g=0;for(const s of n)s.x+=h.width/2,s.y+=h.height/2,s.x+=e.screenOffsetX,s.y+=e.screenOffsetY,s.x+=-t.x,s.y+=-t.y,s.x<0?l--:s.x>=t.width&&l++,s.y<0?g--:s.y>=t.height&&g++;if(4===Math.abs(l)||4===Math.abs(g));else{const t=aL.sortQuadPoints(_,d,u,c);for(const e of i.getDrawingDatas(a))e.cornerPoints=t,e.z=s.z,r.push(e)}}r.unshift(this.makeBackgroundPlane(t,i,r))}return r}}aL.MANNEQUIN_MAGIC_X_OFFSET=1,aL.MANNEQUIN_MAGIC_Y_OFFSET=-16,aL.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET=-52,aL.MAX_EXTERNAL_IMAGE_COUNT=30;class oL extends M{constructor(t){super(),this._communication=void 0,this._roomRendererFactory=void 0,this._roomManager=void 0,this._visualizationFactory=void 0,this._sessionDataManager=void 0,this._roomSessionManager=void 0,this._roomObjectEventHandler=void 0,this._roomMessageHandler=void 0,this._roomContentLoader=void 0,this._ready=void 0,this._roomContentLoaderReady=void 0,this._imageObjectIdBank=void 0,this._imageCallbacks=void 0,this._thumbnailObjectIdBank=void 0,this._thumbnailCallbacks=void 0,this._activeRoomId=void 0,this._activeRoomActiveCanvas=void 0,this._activeRoomActiveCanvasMouseX=void 0,this._activeRoomActiveCanvasMouseY=void 0,this._activeRoomIsDragged=void 0,this._activeRoomWasDragged=void 0,this._activeRoomDragStartX=void 0,this._activeRoomDragStartY=void 0,this._activeRoomDragX=void 0,this._activeRoomDragY=void 0,this._roomDraggingAlwaysCenters=void 0,this._roomAllowsDragging=void 0,this._roomDatas=void 0,this._roomInstanceDatas=void 0,this._skipFurnitureCreationForNextFrame=void 0,this._mouseCursorUpdate=void 0,this._badgeListenerObjects=void 0,this._logicFactory=void 0,this._communication=t,this._sessionDataManager=null,this._roomSessionManager=null,this._roomManager=null,this._roomObjectEventHandler=new fD(this),this._roomMessageHandler=new lD(this),this._roomContentLoader=new ot,this._ready=!1,this._roomContentLoaderReady=!1,this._activeRoomId=-1,this._activeRoomActiveCanvas=-1,this._roomInstanceDatas=new Map,this._roomDatas=new Map,this._roomRendererFactory=new as,this._visualizationFactory=new _D,this._logicFactory=new $C,this._activeRoomActiveCanvasMouseX=0,this._activeRoomActiveCanvasMouseY=0,this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=0,this._activeRoomDragStartY=0,this._activeRoomDragX=0,this._activeRoomDragY=0,this._skipFurnitureCreationForNextFrame=!1,this._mouseCursorUpdate=!1,this._imageObjectIdBank=null,this._imageCallbacks=new Map,this._thumbnailCallbacks=new Map,this._roomDraggingAlwaysCenters=!1,this._roomAllowsDragging=!0,this._badgeListenerObjects=new Map,this.runVisibilityUpdate=this.runVisibilityUpdate.bind(this),this.processRoomObjectEvent=this.processRoomObjectEvent.bind(this),this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.onRoomContentLoaderReadyEvent=this.onRoomContentLoaderReadyEvent.bind(this),this.onBadgeImageReadyEvent=this.onBadgeImageReadyEvent.bind(this)}onInit(){this._ready||(this._imageObjectIdBank=new He(1e3),this._thumbnailObjectIdBank=new He(1e3),this._logicFactory.registerEventFunction(this.processRoomObjectEvent),this._roomManager&&(this._roomManager.setContentLoader(this._roomContentLoader),this._roomManager.addUpdateCategory(st.FLOOR),this._roomManager.addUpdateCategory(st.WALL),this._roomManager.addUpdateCategory(st.UNIT),this._roomManager.addUpdateCategory(st.CURSOR),this._roomManager.addUpdateCategory(st.ROOM)),this._roomMessageHandler.setConnection(this._communication.connection),this._roomContentLoader.initialize(this.events),this._roomContentLoader.setSessionDataManager(this._sessionDataManager),this._roomContentLoader.setIconListener(this),this._roomSessionManager&&(this._roomSessionManager.events.addEventListener(ZS.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.addEventListener(ZS.ENDED,this.onRoomSessionEvent)),this.events.addEventListener(ot.LOADER_READY,this.onRoomContentLoaderReadyEvent),SU.instance.ticker.add(this.update,this),document.addEventListener("visibilitychange",this.runVisibilityUpdate))}onDispose(){if(this._ready){for(const[t,e]of this._roomInstanceDatas)this.removeRoomInstance(t);document.removeEventListener("visibilitychange",this.runVisibilityUpdate),SU.instance.ticker.remove(this.update,this),this._roomObjectEventHandler&&this._roomObjectEventHandler.dispose(),this._roomMessageHandler&&this._roomMessageHandler.dispose(),this._roomContentLoader&&this._roomContentLoader.dispose(),this.events.removeEventListener(ot.LOADER_READY,this.onRoomContentLoaderReadyEvent),this._roomSessionManager&&(this._roomSessionManager.events.removeEventListener(ZS.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.removeEventListener(ZS.ENDED,this.onRoomSessionEvent)),super.onDispose()}}onRoomSessionEvent(t){if(t instanceof ZS)switch(t.type){case ZS.STARTED:return void(this._roomMessageHandler&&this._roomMessageHandler.setRoomId(t.session.roomId));case ZS.ENDED:return void(this._roomMessageHandler&&(this._roomMessageHandler.clearRoomId(),this.removeRoomInstance(t.session.roomId)))}}onRoomContentLoaderReadyEvent(t){this._roomContentLoaderReady=!0,this._roomManager.init()}setActiveRoomId(t){this._activeRoomId=t}destroyRoom(t){this.removeRoomInstance(t)}getRoomInstance(t){return this._roomManager&&this._roomManager.getRoomInstance(this.getRoomId(t))||null}removeRoomInstance(t){this.getRoomInstance(t)&&this._roomManager&&this._roomManager.removeRoomInstance(this.getRoomId(t));const e=this._roomInstanceDatas.get(t);e&&(this._roomInstanceDatas.delete(e.roomId),e.dispose()),this.events.dispatchEvent(new YS(YS.DISPOSED,t))}createRoomInstance(t,e){let s="111",i="201",r="1";if(!this._ready){let n=this._roomDatas.get(t);return n&&(this._roomDatas.delete(t),s=n.floorType,i=n.wallType,r=n.landscapeType),n=new tL(t,e),n.floorType=s,n.wallType=i,n.landscapeType=r,this._roomDatas.set(t,n),void this.logger.warn("Room Engine not initilized yet, can not create room. Room data stored for later initialization.")}if(!e)return void this.logger.warn("Room property messages received before floor height map, will initialize when floor height map received.");const n=this._roomDatas.get(t);n&&(this._roomDatas.delete(t),n.floorType&&(s=n.floorType),n.wallType&&(i=n.wallType),n.landscapeType&&(r=n.landscapeType));this.setupRoomInstance(t,e,s,i,r,this.getRoomInstanceModelName(t))&&(e.restrictsDragging?this._roomAllowsDragging=!1:this._roomAllowsDragging=!0,this.events.dispatchEvent(new YS(YS.INITIALIZED,t)))}setupRoomInstance(t,e,s,i,r,n){if(!this._ready||!this._roomManager)return;const a=this._roomManager.createRoomInstance(this.getRoomId(t));if(!a)return null;const o=st.ROOM,h=a.createRoomObjectAndInitalize(oL.ROOM_OBJECT_ID,oL.ROOM_OBJECT_TYPE,o);if(a.model.setValue(dD.ROOM_IS_PUBLIC,0),a.model.setValue(dD.ROOM_Z_SCALE,1),e){a.model.setValue(dD.RESTRICTS_DRAGGING,e.restrictsDragging),a.model.setValue(dD.RESTRICTS_SCALING,e.restrictsScaling),a.model.setValue(dD.RESTRICTED_SCALE,e.restrictedScale);if(e.dimensions){const t=e.dimensions.minX,s=e.dimensions.maxX,i=e.dimensions.minY,r=e.dimensions.maxY;a.model.setValue(dD.ROOM_MIN_X,t),a.model.setValue(dD.ROOM_MAX_X,s),a.model.setValue(dD.ROOM_MIN_Y,i),a.model.setValue(dD.ROOM_MAX_Y,r);const n=423*t+671*s+913*i+7509*r;h&&h.model&&h.model.setValue(rt.ROOM_RANDOM_SEED,n)}}const _=h&&h.logic||null;if(_&&(_.initialize(e),s&&(_.processUpdateMessage(new hM(hM.ROOM_FLOOR_UPDATE,s)),a.model.setValue(rt.ROOM_FLOOR_TYPE,s)),i&&(_.processUpdateMessage(new hM(hM.ROOM_WALL_UPDATE,i)),a.model.setValue(rt.ROOM_WALL_TYPE,i)),r&&(_.processUpdateMessage(new hM(hM.ROOM_LANDSCAPE_UPDATE,r)),a.model.setValue(rt.ROOM_LANDSCAPE_TYPE,r))),e&&e.doors.length){let t=0;for(;t<e.doors.length;){const s=e.doors[t];if(s){const e=s.x,i=s.y,r=s.z,n=s.dir,o=nM.DOOR,h="door_"+t,d=new dt(e,i,r);_.processUpdateMessage(new nM(nM.ADD_MASK,h,o,d,nM.HOLE)),90!==n&&180!==n||(90===n&&(a.model.setValue(rt.ROOM_DOOR_X,e-.5),a.model.setValue(rt.ROOM_DOOR_Y,i)),180===n&&(a.model.setValue(rt.ROOM_DOOR_X,e),a.model.setValue(rt.ROOM_DOOR_Y,i-.5)),a.model.setValue(rt.ROOM_DOOR_Z,r),a.model.setValue(rt.ROOM_DOOR_DIR,n))}t++}}return a.createRoomObjectAndInitalize(oL.CURSOR_OBJECT_ID,oL.CURSOR_OBJECT_TYPE,st.CURSOR),SU.instance.getConfiguration("enable.avatar.arrow",!1)&&a.createRoomObjectAndInitalize(oL.ARROW_OBJECT_ID,oL.ARROW_OBJECT_TYPE,st.CURSOR),a}getRoomInstanceDisplay(t,e,s,r,n){const a=this.getRoomInstance(t);if(!a)return null;let o=a.renderer;if(!o&&(o=this._roomRendererFactory.createRenderer(),!o))return null;o.roomObjectVariableAccurateZ=rt.OBJECT_ACCURATE_Z_VALUE,a.setRenderer(o);const h=o.createCanvas(e,s,r,n);if(!h)return null;if(a.model.getValue(dD.RESTRICTS_SCALING)){let t=a.model.getValue(dD.RESTRICTED_SCALE);t||(t=1),h.setScale(t),h.restrictsScaling=!0}else h.restrictsScaling=!1;if(h.setMouseListener(this._roomObjectEventHandler),h.geometry){h.geometry.z_scale=a.model.getValue(dD.ROOM_Z_SCALE);const t=a.model.getValue(rt.ROOM_DOOR_X),e=a.model.getValue(rt.ROOM_DOOR_Y),s=a.model.getValue(rt.ROOM_DOOR_Z),r=a.model.getValue(rt.ROOM_DOOR_DIR),n=new dt(t,e,s);let o=null;90===r&&(o=new dt(-2e3,0,0)),180===r&&(o=new dt(0,-2e3,0)),h.geometry.setDisplacement(n,o);const _=h.master;if(_){const t=new W(i.t.EMPTY);t.name=oL.OVERLAY,t.interactive=!1,_.addChild(t)}}return h.master}setRoomInstanceRenderingCanvasMask(t,e,s){const i=this.getRoomInstanceRenderingCanvas(t,e);i&&i.setMask(s)}setRoomInstanceRenderingCanvasScale(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];const o=this.getRoomInstanceRenderingCanvas(t,e);if(o){if(o.restrictsScaling&&!n)return;o.setScale(s,i,r,n,a),this.events.dispatchEvent(new YS(YS.ROOM_ZOOMED,t))}}getRoomInstanceRenderingCanvas(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const s=this.getRoomInstance(t);if(!s)return null;const i=s.renderer;if(!i)return null;-1===e&&(e=this._activeRoomActiveCanvas);const r=i.getCanvas(e);return r||null}getActiveRoomInstanceRenderingCanvas(){return this.getRoomInstanceRenderingCanvas(this._activeRoomId,this._activeRoomActiveCanvas)}getRoomInstanceRenderingCanvasOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;-1===e&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new j.g(s.screenOffsetX,s.screenOffsetY):null}setRoomInstanceRenderingCanvasOffset(t,e,s){const i=this.getRoomInstanceRenderingCanvas(t,e);if(!i||!s)return!1;const r=~~s.x,n=~~s.y;return i.screenOffsetX!==r||i.screenOffsetY!==n?(this.events.dispatchEvent(new tN(t,-(i.screenOffsetX-r),-(i.screenOffsetY-n))),i.screenOffsetX=r,i.screenOffsetY=n,!0):void 0}getRoomInstanceRenderingCanvasScale(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1e3,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;-1e3===t&&(t=this._activeRoomId),-1===e&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?s.scale:1}initializeRoomInstanceRenderingCanvas(t,e,s,i){const r=this.getRoomInstanceRenderingCanvas(t,e);r&&r.initialize(s,i)}getRoomInstanceGeometry(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const s=this.getRoomInstance(t);if(!s)return null;const i=s.renderer;if(!i)return null;-1===e&&(e=this._activeRoomActiveCanvas);const r=i.getCanvas(e);return r?r.geometry:null}getRoomInstanceVariable(t,e){const s=this.getRoomInstance(t);return s&&s.model&&s.model.getValue(e)||null}updateRoomInstancePlaneVisibility(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this.getRoomOwnObject(t);return!!i&&(i.processUpdateMessage(new oM(oM.WALL_VISIBILITY,e)),i.processUpdateMessage(new oM(oM.FLOOR_VISIBILITY,s)),!0)}updateRoomInstancePlaneThickness(t,e,s){const i=this.getRoomOwnObject(t);return!!i&&(i.processUpdateMessage(new aM(aM.WALL_THICKNESS,e)),i.processUpdateMessage(new aM(aM.FLOOR_THICKNESS,s)),!0)}updateRoomInstancePlaneType(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const n=this.getRoomOwnObject(t),a=this.getRoomInstance(t);if(!n){let r=this._roomDatas.get(t);return r||(r=new tL(t,null),this._roomDatas.set(t,r)),e&&(r.floorType=e),s&&(r.wallType=s),i&&(r.landscapeType=i),!0}return e&&(a&&!r&&a.model.setValue(rt.ROOM_FLOOR_TYPE,e),n.processUpdateMessage(new hM(hM.ROOM_FLOOR_UPDATE,e))),s&&(a&&!r&&a.model.setValue(rt.ROOM_WALL_TYPE,s),n.processUpdateMessage(new hM(hM.ROOM_WALL_UPDATE,s))),i&&(a&&!r&&a.model.setValue(rt.ROOM_LANDSCAPE_TYPE,i),n.processUpdateMessage(new hM(hM.ROOM_LANDSCAPE_UPDATE,i))),!0}updateObjectRoomColor(t,e,s,i){const r=this.getRoomOwnObject(t);if(!r||!r.logic)return!1;const n=new iM(iM.BACKGROUND_COLOR,e,s,i);return r.logic.processUpdateMessage(n),this.events.dispatchEvent(new $S(t,e,s,i)),!0}addRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t),i=this.getRoomObjectFloor(t,e);if(s&&s.logic&&i&&i.model){const t=i.getLocation(),r=i.model.getValue(rt.FURNITURE_SIZE_X),n=i.model.getValue(rt.FURNITURE_SIZE_Y);s.processUpdateMessage(new rM(rM.ADD,e,t.x,t.y,r,n))}}removeRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t);s&&s.processUpdateMessage(new rM(rM.REMOVE,e))}setRoomEngineGameMode(t,e){const s=this.getRoomInstance(t);if(!s)return;const i=e?1:0;s.model.setValue(dD.IS_PLAYING_GAME,i),0===i?this.events.dispatchEvent(new YS(YS.NORMAL_MODE,t)):this.events.dispatchEvent(new YS(YS.GAME_MODE,t))}isRoomIdPlayingGame(t){const e=this.getRoomInstance(t);return!!e&&e.model.getValue(dD.IS_PLAYING_GAME)>0}isPlayingGame(){return this.isRoomIdPlayingGame(this._activeRoomId)}disableUpdate(t){t?SU.instance.ticker.remove(this.update,this):(SU.instance.ticker.remove(this.update,this),SU.instance.ticker.add(this.update,this))}runUpdate(){this.update(1)}runVisibilityUpdate(){document.hidden||this.update(1,!0)}update(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._roomManager&&(t=SU.instance.time,ke.turnVisualizationOn(),this.processPendingFurniture(),this._roomManager.update(t,e),this.updateRoomCameras(t),this._mouseCursorUpdate&&this.setPointer(),ke.turnVisualizationOff())}setPointer(){this._mouseCursorUpdate=!1;const t=this.getRoomInstanceData(this._activeRoomId);t&&t.hasButtonMouseCursorOwners()?document.body.style.cursor="pointer":document.body.style.cursor="auto"}processPendingFurniture(){if(this._skipFurnitureCreationForNextFrame)return void(this._skipFurnitureCreationForNextFrame=!1);const t=(new Date).valueOf();for(const e of this._roomInstanceDatas.values()){if(!e)continue;let s=null,i=0,r=!1;for(;s=e.getNextPendingFurnitureFloor();)if(r=this.processPendingFurnitureFloor(e.roomId,s.id,s),!(++i%5)){if((new Date).valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}}for(;!this._skipFurnitureCreationForNextFrame&&(s=e.getNextPendingFurnitureWall());)if(r=this.processPendingFurnitureWall(e.roomId,s.id,s),!(++i%5)){if((new Date).valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}}if(r&&this._roomManager){this._roomManager.getRoomInstance(this.getRoomId(e.roomId)).hasUninitializedObjects()||this.objectsInitialized(e.roomId.toString())}if(this._skipFurnitureCreationForNextFrame)return}}onRoomEngineInitalized(t){if(t){this._ready=!0,this.events.dispatchEvent(new YS(YS.ENGINE_INITIALIZED,0));for(const t of this._roomDatas.values())t&&this.createRoomInstance(t.roomId,t.data)}}processPendingFurnitureFloor(t,e,s){if(!s){const i=this.getRoomInstanceData(t);if(i&&(s=i.getPendingFurnitureFloor(e)),!s)return!1}let i=s.type,r=!1;i||(i=this.getFurnitureFloorName(s.typeId),r=!0);const n=this.createRoomObjectFloor(t,e,i);if(!n)return!1;const a=n.model;if(a&&(a.setValue(rt.FURNITURE_COLOR,this.getFurnitureFloorColorIndex(s.typeId)),a.setValue(rt.FURNITURE_TYPE_ID,s.typeId),a.setValue(rt.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),a.setValue(rt.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),a.setValue(rt.FURNITURE_EXPIRY_TIME,s.expiryTime),a.setValue(rt.FURNITURE_EXPIRTY_TIMESTAMP,SU.instance.time),a.setValue(rt.FURNITURE_USAGE_POLICY,s.usagePolicy),a.setValue(rt.FURNITURE_OWNER_ID,s.ownerId),a.setValue(rt.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectFloor(t,e,s.location,s.direction,s.state,s.data,s.extra))return!1;if(s.sizeZ>=0&&!this.updateRoomObjectFloorHeight(t,e,s.sizeZ))return!1;this.events&&this.events.dispatchEvent(new sN(sN.ADDED,t,e,st.FLOOR));const o=this.getPlacedRoomObjectData(t);return o&&o.id===e&&o.category===st.FLOOR&&this.selectRoomObject(t,e,st.FLOOR),n.isReady&&s.synchronized&&this.addObjectToTileMap(t,n),!0}processPendingFurnitureWall(t,e,s){if(!s){const i=this.getRoomInstanceData(t);if(i&&(s=i.getPendingFurnitureWall(e)),!s)return!1}let i="";s.data&&(i=s.data.getLegacyString());let r=this.getFurnitureWallName(s.typeId,i);r||(r="");const n=this.createRoomObjectWall(t,e,r);if(!n)return!1;const a=n.model;if(a&&(a.setValue(rt.FURNITURE_COLOR,this.getFurnitureWallColorIndex(s.typeId)),a.setValue(rt.FURNITURE_TYPE_ID,s.typeId),a.setValue(rt.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),a.setValue(rt.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),a.setValue(rt.OBJECT_ACCURATE_Z_VALUE,1),a.setValue(rt.FURNITURE_EXPIRY_TIME,s.expiryTime),a.setValue(rt.FURNITURE_EXPIRTY_TIMESTAMP,SU.instance.time),a.setValue(rt.FURNITURE_USAGE_POLICY,s.usagePolicy),a.setValue(rt.FURNITURE_OWNER_ID,s.ownerId),a.setValue(rt.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectWall(t,e,s.location,s.direction,s.state,i))return!1;this.events&&this.events.dispatchEvent(new sN(sN.ADDED,t,e,st.WALL));const o=this.getPlacedRoomObjectData(t);return o&&Math.abs(o.id)===e&&o.category===st.WALL&&this.selectRoomObject(t,e,st.WALL),!0}setRoomSessionOwnUser(t,e){if(!this._roomSessionManager)return;const s=this._roomSessionManager.getSession(t);s&&s.setOwnRoomIndex(e);const i=this.getRoomCamera(t);i&&(i.targetId=e,i.targetCategory=st.UNIT,i.activateFollowing(this.cameraFollowDuration))}get cameraFollowDuration(){return 1e3}updateRoomCameras(t){for(const e of this._roomInstanceDatas.values()){if(!e)continue;const s=e.roomCamera;if(!s)continue;let i=null;const r=this.getRoomObject(e.roomId,s.targetId,s.targetCategory);r&&(i=r.getLocation()),i&&(e.roomId===this._activeRoomId&&this._activeRoomIsDragged||this.updateRoomCamera(e.roomId,1,i,t))}if(this._activeRoomWasDragged){const t=this.getRoomInstanceRenderingCanvas(this._activeRoomId,1);t&&this.setRoomInstanceRenderingCanvasOffset(this._activeRoomId,1,new j.g(t.screenOffsetX+this._activeRoomDragX,t.screenOffsetY+this._activeRoomDragY)),this._activeRoomDragX=0,this._activeRoomDragY=0}}updateRoomCamera(t,e,s,i){const r=this.getRoomInstanceRenderingCanvas(t,e),n=this.getRoomInstanceData(t);if(!r||!n||1!==r.scale)return;const a=r.geometry,o=n.roomCamera,h=this.getRoomInstance(t);if(!a||!o||!h)return;const _=this.getRoomCanvasRectangle(t,e);if(!_)return;let d=Math.floor(s.z)+1;const u=Math.round(_.width),c=Math.round(_.height),l=this.getCanvasBoundingRectangle(e);if(l&&(l.right<0||l.bottom<0||l.left>=u||l.top>=c)&&o.reset(),o.screenWd!==u||o.screenHt!==c||o.scale!==a.scale||o.geometryUpdateId!==a.updateId||!dt.isEqual(s,o.targetObjectLoc)||o.isMoving){o.targetObjectLoc=s;const t=new dt;t.assign(s),t.x=Math.round(t.x),t.y=Math.round(t.y);const e=h.model.getValue(dD.ROOM_MIN_X)-.5,n=h.model.getValue(dD.ROOM_MIN_Y)-.5,g=h.model.getValue(dD.ROOM_MAX_X)+.5,E=h.model.getValue(dD.ROOM_MAX_Y)+.5,p=Math.round((e+g)/2),m=Math.round((n+E)/2),I=2;let T=new j.g(t.x-p,t.y-m);const R=a.scale/Math.sqrt(2),f=R/2,O=new j.d;O.rotate(-(a.direction.x+90)/180*Math.PI),T=O.apply(T),T.y=T.y*(f/R);const v=_.width/2/R-1,A=_.height/2/f-1;let S=0,N=0,M=0,y=0,D=a.getScreenPoint(new dt(p,m,I));if(!D)return;if(D.x=D.x+Math.round(_.width/2),D.y=D.y+Math.round(_.height/2),!l)return void a.adjustLocation(new dt(0,0),25);if(l.x+=-r.screenOffsetX,l.y+=-r.screenOffsetY,!(l.width>1&&l.height>1))return void a.adjustLocation(new dt(-30,-30),25);S=(l.left-D.x-.25*a.scale)/R,M=(l.right-D.x+.25*a.scale)/R,N=(l.top-D.y-.5*a.scale)/f,y=(l.bottom-D.y+.5*a.scale)/f;let C=!1,L=!1,U=!1,P=!1;Math.round((M-S)*R)<_.width?(d=2,T.x=(M+S)/2,U=!0):(T.x>M-v&&(T.x=M-v,C=!0),T.x<S+v&&(T.x=S+v,C=!0));Math.round((y-N)*f)<_.height?(d=2,T.y=(y+N)/2,P=!0):(T.y>y-A&&(T.y=y-A,L=!0),T.y<N+A&&(T.y=N+A,L=!0),L&&(T.y=T.y/(f/R))),O.invert(),T=O.apply(T),T.x=T.x+p,T.y=T.y+m;let b=.35,w=.2,F=.2;const x=10,B=10;if(F*u>100&&(F=100/u),b*c>150&&(b=150/c),w*c>150&&(w=150/c),o.limitedLocationX&&o.screenWd==u&&o.screenHt==c&&(F=0),o.limitedLocationY&&o.screenWd==u&&o.screenHt==c&&(b=0,w=0),_.width=_.width*(1-2*F),_.height=_.height*(1-(b+w)),_.width<x&&(_.width=x),_.height<B&&(_.height=B),b+w>0?(_.x+=-_.width/2,_.y+=-_.height*(w/(b+w))):(_.x+=-_.width/2,_.y+=-_.height/2),D=a.getScreenPoint(t),!D)return;if(D){D.x=D.x+r.screenOffsetX,D.y=D.y+r.screenOffsetY,t.z=d,t.x=Math.round(2*T.x)/2,t.y=Math.round(2*T.y)/2,o.location||(a.location=t,this.useOffsetScrolling?o.initializeLocation(new dt(0,0,0)):o.initializeLocation(t));const e=a.getScreenPoint(t),s=new dt(0,0,0);e&&(s.x=e.x,s.y=e.y),(D.x<_.left||D.x>_.right)&&!o.centeredLocX||(D.y<_.top||D.y>_.bottom)&&!o.centeredLocY||U&&!o.centeredLocX&&o.screenWd!=u||P&&!o.centeredLocY&&o.screenHt!=c||o.roomWd!=l.width||o.roomHt!=l.height||o.screenWd!=u||o.screenHt!=c?(o.limitedLocationX=C,o.limitedLocationY=L,this.useOffsetScrolling?o.target=s:o.target=t):(C||(o.limitedLocationX=!1),L||(o.limitedLocationY=!1))}o.centeredLocX=U,o.centeredLocY=P,o.screenWd=u,o.screenHt=c,o.scale=a.scale,o.geometryUpdateId=a.updateId,o.roomWd=l.width,o.roomHt=l.height,this._sessionDataManager.isCameraFollowDisabled||(this.useOffsetScrolling?o.update(i,8):o.update(i,.5)),this.useOffsetScrolling?this.setRoomInstanceRenderingCanvasOffset(this.activeRoomId,1,new j.g(-o.location.x,-o.location.y)):a.adjustLocation(o.location,25)}else o.limitedLocationX=!1,o.limitedLocationY=!1,o.centeredLocX=!1,o.centeredLocY=!1}getRoomCanvasRectangle(t,e){const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new j.j(0,0,s.width,s.height):null}getRoomObjectBoundingRectangle(t,e,s,i){const r=this.getRoomInstanceGeometry(t,i);if(!r)return null;const n=this.getRoomObject(t,e,s);if(!n)return null;const a=n.visualization;if(!a)return null;const o=a.getBoundingRectangle(),h=this.getRoomInstanceRenderingCanvas(t,i),_=h?h.scale:1,d=r.getScreenPoint(n.getLocation());return d?(d.x=Math.round(d.x),d.y=Math.round(d.y),o.x=o.x*_,o.y=o.y*_,o.width=o.width*_,o.height=o.height*_,d.x=d.x*_,d.y=d.y*_,o.x+=d.x,o.y+=d.y,h?(o.x+=Math.round(h.width/2)+h.screenOffsetX,o.y+=Math.round(h.height/2)+h.screenOffsetY,o):null):null}getCanvasBoundingRectangle(t){return this.getRoomObjectBoundingRectangle(this._activeRoomId,oL.ROOM_OBJECT_ID,st.ROOM,t)}getFurnitureFloorName(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorNameForTypeId(t):null}getFurnitureWallName(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._roomContentLoader?this._roomContentLoader.getFurnitureWallNameForTypeId(t,e):null}getFurnitureFloorColorIndex(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorColorIndex(t):null}getFurnitureWallColorIndex(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallColorIndex(t):null}getRoomInstanceData(t){const e=this._roomInstanceDatas.get(t);if(e)return e;const s=new rL(t);return this._roomInstanceDatas.set(s.roomId,s),s}getRoomInstanceModelName(t){const e=this.getRoomInstanceData(t);return e?e.modelName:null}setRoomInstanceModelName(t,e){const s=this.getRoomInstanceData(t);s&&s.setModelName(e)}getRoomTileObjectMap(t){const e=this.getRoomInstanceData(t);return e?e.tileObjectMap:null}getCurrentRoomCamera(){return this.getRoomCamera(this._activeRoomId)}getRoomCamera(t){const e=this.getRoomInstanceData(t);return e?e.roomCamera:null}getSelectedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.selectedObject:null}setSelectedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setSelectedObject(e),e&&s.setPlacedObject(null)}getPlacedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.placedObject:null}setPlacedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setPlacedObject(e)}cancelRoomObjectPlacement(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectPlacement(this._activeRoomId)}getFurnitureStackingHeightMap(t){const e=this.getRoomInstanceData(t);return e?e.furnitureStackingHeightMap:null}setFurnitureStackingHeightMap(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setFurnitureStackingHeightMap(e)}getLegacyWallGeometry(t){const e=this.getRoomInstanceData(t);return e?e.legacyGeometry:null}createRoomObjectAndInitialize(t,e,s,i){const r=this.getRoomInstance(t);return r?r.createRoomObjectAndInitalize(e,s,i):null}getTotalObjectsForManager(t,e){const s=this.getRoomInstance(t);return s?s.getTotalObjectsForManager(e):0}getRoomObject(t,e,s){if(!this._ready)return null;let i=this.getRoomId(t);return 0===t&&(i=oL.TEMPORARY_ROOM),this.getObject(i,e,s)}getObject(t,e,s){let i=null;if(this._roomManager&&(i=this._roomManager.getRoomInstance(t)),!i)return null;let r=i.getRoomObject(e,s);if(!r)switch(s){case st.FLOOR:this.processPendingFurnitureFloor(this.getRoomIdFromString(t),e,null),r=i.getRoomObject(e,s);break;case st.WALL:this.processPendingFurnitureWall(this.getRoomIdFromString(t),e,null),r=i.getRoomObject(e,s)}return r}getRoomObjectByIndex(t,e,s){const i=this.getRoomInstance(t);return i?i.getRoomObjectByIndex(e,s):null}getRoomObjectCategoryForType(t){return t&&this._roomContentLoader?this._roomContentLoader.getCategoryForType(t):st.MINIMUM}getRoomObjectCursor(t){return this.getObject(this.getRoomId(t),oL.CURSOR_OBJECT_ID,st.CURSOR)}getRoomObjectSelectionArrow(t){return this.getObject(this.getRoomId(t),oL.ARROW_OBJECT_ID,st.CURSOR)}getRoomOwnObject(t){return this.getObject(this.getRoomId(t),oL.ROOM_OBJECT_ID,st.ROOM)}getRoomObjectUser(t,e){return this.getObject(this.getRoomId(t),e,st.UNIT)}removeRoomObjectUser(t,e){return this.removeRoomObject(t,e,st.UNIT)}createRoomObjectUser(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,st.UNIT)}getRoomObjectFloor(t,e){return this.getObject(this.getRoomId(t),e,st.FLOOR)}createRoomObjectFloor(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,st.FLOOR)}removeRoomObjectFloor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=this.getRoomInstanceData(t);if(r&&r.removePendingFunitureFloor(e),this._sessionDataManager&&s===this._sessionDataManager.userId&&!JS.isBuilderClubId(e)){const s=this.getRoomObject(t,e,st.FLOOR);if(s){const i=this.getRoomObjectScreenLocation(t,e,st.FLOOR,this._activeRoomActiveCanvas);if(i){if(!(1===s.model.getValue(rt.FURNITURE_DISABLE_PICKING_ANIMATION))){const t=s.model.getValue(rt.FURNITURE_TYPE_ID),e=s.model.getValue(rt.FURNITURE_EXTRAS),r=s.model.getValue(rt.FURNITURE_DATA_FORMAT),n=Ia.getData(r),a=this.getFurnitureFloorIcon(t,null,e,n).data;if(a){const t=At.generateImage(a);if(this.events){const e=new qS(t,i.x,i.y);e.iconName=KS.INVENTORY,this.events.dispatchEvent(e)}}}}}}this.removeRoomObject(t,e,st.FLOOR),this.setMouseDefault(t,st.FLOOR,e),i&&this.refreshTileObjectMap(t,"RoomEngine.disposeObjectFurniture()")}getRoomObjectWall(t,e){return this.getObject(this.getRoomId(t),e,st.WALL)}removeRoomObjectWall(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this._sessionDataManager&&s===this._sessionDataManager.userId&&!JS.isBuilderClubId(e)){const s=this.getRoomObject(t,e,st.WALL);if(s&&-1===s.type.indexOf("post_it")&&-1===s.type.indexOf("external_image_wallitem")){const i=this.getRoomObjectScreenLocation(t,e,st.WALL,this._activeRoomActiveCanvas);if(i){const t=s.model.getValue(rt.FURNITURE_TYPE_ID),e=s.model.getValue(rt.FURNITURE_DATA),r=this.getFurnitureWallIcon(t,null,e).data;if(r){const t=At.generateImage(r);if(this.events){const e=new qS(t,i.x,i.y);e.iconName=KS.INVENTORY,this.events.dispatchEvent(e)}}}}}this.removeRoomObject(t,e,st.WALL),this.updateRoomObjectMask(t,e,!1),this.setMouseDefault(t,st.WALL,e)}createRoomObjectWall(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,st.WALL)}removeRoomObject(t,e,s){const i=this.getRoomInstance(t);if(!i)return null;i.removeRoomObject(e,s),this.events&&this.events.dispatchEvent(new sN(sN.REMOVED,t,e,s))}addFurnitureFloor(t,e,s,i,r,n,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:NaN,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"",c=!(arguments.length>12&&void 0!==arguments[12])||arguments[12],l=!(arguments.length>13&&void 0!==arguments[13])||arguments[13],g=arguments.length>14&&void 0!==arguments[14]?arguments[14]:-1;const E=this.getRoomInstanceData(t);if(!E)return!1;const p=new eL(e,s,null,i,r,n,a,o,h,_,d,u,c,l,g);return E.addPendingFurnitureFloor(p),!0}addFurnitureFloorByTypeName(t,e,s,i,r,n,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:NaN,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"",c=!(arguments.length>12&&void 0!==arguments[12])||arguments[12],l=!(arguments.length>13&&void 0!==arguments[13])||arguments[13],g=arguments.length>14&&void 0!==arguments[14]?arguments[14]:-1;const E=this.getRoomInstanceData(t);if(!E)return!1;const p=new eL(e,0,s,i,r,n,a,o,h,_,d,u,c,l,g);return E.addPendingFurnitureFloor(p),!0}addFurnitureWall(t,e,s,i,r,n,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",u=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];const c=this.getRoomInstanceData(t);if(!c)return!1;const l=new la;l.setString(a);const g=new eL(e,s,null,i,r,n,l,NaN,o,h,_,d,!0,u);return c.addPendingFurnitureWall(g),!0}updateRoomObjectFloor(t,e,s,i,r,n){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const o=this.getRoomObjectFloor(t,e);return!!o&&(o.processUpdateMessage(new Ue(s,i)),o.processUpdateMessage(new JN(r,n,a)),!0)}updateRoomObjectWall(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;const a=this.getRoomObjectWall(t,e);if(!a||!a.logic)return!1;const o=new Ue(s,i),h=new la,_=new JN(r,h);return h.setString(n),a.logic.processUpdateMessage(o),a.logic.processUpdateMessage(_),this.updateRoomObjectMask(t,e),!0}updateRoomObjectWallItemData(t,e,s){const i=this.getRoomObjectWall(t,e);return!(!i||!i.logic)&&(i.logic.processUpdateMessage(new eM(s)),!0)}updateRoomObjectFloorHeight(t,e,s){const i=this.getRoomObjectFloor(t,e);return!!i&&(i.processUpdateMessage(new tM(null,null,s)),!0)}updateRoomObjectFloorExpiration(t,e,s){const i=this.getRoomObjectFloor(t,e);return!!i&&(i.model.setValue(rt.FURNITURE_EXPIRY_TIME,s),i.model.setValue(rt.FURNITURE_EXPIRTY_TIMESTAMP,SU.instance.time),!0)}updateRoomObjectWallExpiration(t,e,s){const i=this.getRoomObjectWall(t,e);return!!i&&(i.model.setValue(rt.FURNITURE_EXPIRY_TIME,s),i.model.setValue(rt.FURNITURE_EXPIRTY_TIMESTAMP,SU.instance.time),!0)}updateRoomObjectMask(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=st.WALL+"_"+e,r=this.getRoomObjectWall(t,e);let n=null;if(r&&r.model){if(r.model.getValue(rt.FURNITURE_USES_PLANE_MASK)>0){const t=r.model.getValue(rt.FURNITURE_PLANE_MASK_TYPE),e=r.getLocation();n=s?new nM(nM.ADD_MASK,i,t,e):new nM(nM.REMOVE_MASK,i)}}else n=new nM(nM.REMOVE_MASK,i);const a=this.getRoomOwnObject(t);a&&a.logic&&n&&a.logic.processUpdateMessage(n)}rollRoomObjectFloor(t,e,s,i){const r=this.getRoomObjectFloor(t,e);r&&r.processUpdateMessage(new qN(s,i,null,!!i))}updateRoomObjectWallLocation(t,e,s){const i=this.getRoomObjectWall(t,e);return!!i&&(i.logic&&i.logic.processUpdateMessage(new qN(s,null,null)),this.updateRoomObjectMask(t,e),!0)}addRoomObjectUser(t,e,s,i,r,n,a){if(this.getRoomObjectUser(t,e))return!1;let o=it.getTypeString(n);o===it.PET&&(o=this.getPetType(a));const h=this.createRoomObjectUser(t,e,o);return!!h&&(h.processUpdateMessage(new QN(this.fixedUserLocation(t,s),null,i,r,!1,0)),a&&h.processUpdateMessage(new FN(a)),this.events&&this.events.dispatchEvent(new sN(sN.ADDED,t,e,st.UNIT)),!0)}updateRoomObjectUserLocation(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:NaN;const h=this.getRoomObjectUser(t,e);if(!h)return!1;s||(s=h.getLocation()),a||(a=h.getDirection()),isNaN(o)&&(o=h.model.getValue(rt.HEAD_DIRECTION)),h.processUpdateMessage(new QN(this.fixedUserLocation(t,s),this.fixedUserLocation(t,i),a,o,r,n));const _=this._roomSessionManager&&this._roomSessionManager.getSession(t)||null;return _&&_.ownRoomIndex===e&&this._logicFactory.events.dispatchEvent(new NN(NN.ROAME_MOVE_TO,i)),!0}fixedUserLocation(t,e){if(!e)return null;const s=this.getFurnitureStackingHeightMap(t),i=this.getLegacyWallGeometry(t);if(!s||!i)return e;let r=e.z;const n=s.getTileHeight(e.x,e.y),a=i.getHeight(e.x,e.y);return Math.abs(r-n)<.1&&Math.abs(n-a)<.1&&(r=i.getFloorAltitude(e.x,e.y)),new dt(e.x,e.y,r)}updateRoomObjectUserAction(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const n=this.getRoomObjectUser(t,e);if(!n)return!1;let a=null;switch(s){case rt.FIGURE_TALK:a=new LN(i);break;case rt.FIGURE_SLEEP:a=new KN(1===i);break;case rt.FIGURE_IS_TYPING:a=new XN(1===i);break;case rt.FIGURE_IS_MUTED:a=new HN(1===i);break;case rt.FIGURE_CARRY_OBJECT:a=new CN(i,r);break;case rt.FIGURE_USE_OBJECT:a=new ZN(i);break;case rt.FIGURE_DANCE:a=new UN(i);break;case rt.FIGURE_GAINED_EXPERIENCE:a=new bN(i);break;case rt.FIGURE_NUMBER_VALUE:a=new kN(i);break;case rt.FIGURE_SIGN:a=new WN(i);break;case rt.FIGURE_EXPRESSION:a=new wN(i);break;case rt.FIGURE_IS_PLAYING_GAME:a=new YN(1===i);break;case rt.FIGURE_GUIDE_STATUS:a=new GN(i)}return!!a&&(n.processUpdateMessage(a),!0)}updateRoomObjectUserFigure(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const a=this.getRoomObjectUser(t,e);return!!a&&(a.processUpdateMessage(new FN(s,i,r,n)),!0)}updateRoomObjectUserFlatControl(t,e,s){const i=this.getRoomObjectUser(t,e);return!!i&&(i.processUpdateMessage(new xN(parseInt(s))),!0)}updateRoomObjectUserEffect(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=this.getRoomObjectUser(t,e);return!!r&&(r.processUpdateMessage(new PN(s,i)),!0)}updateRoomObjectUserGesture(t,e,s){const i=this.getRoomObjectUser(t,e);return!!i&&(i.processUpdateMessage(new BN(s)),!0)}updateRoomObjectUserPetGesture(t,e,s){const i=this.getRoomObjectUser(t,e);return!!i&&(i.processUpdateMessage(new jN(s)),!0)}updateRoomObjectUserPosture(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.getRoomObjectUser(t,e);return!!r&&(r.processUpdateMessage(new zN(s,i)),!0)}updateRoomObjectUserOwn(t,e){const s=this.getRoomObjectUser(t,e);s&&s.processUpdateMessage(new VN)}useRoomObject(t,e){const s=this.getRoomObject(this._activeRoomId,t,e);if(s){const t=s.logic;if(t)return t.useObject(),!0}return!1}objectInitialized(t,e,s){const i=this.getRoomIdFromString(t);s===st.WALL&&this.updateRoomObjectMask(i,e);const r=this.getRoomObject(i,e,s);if(r&&r.model&&r.logic){const t=r.model.getValue(rt.FURNITURE_DATA_FORMAT);if(!isNaN(t)){const e=Ia.getData(t);e.initializeFromRoomObjectModel(r.model),r.processUpdateMessage(new JN(r.getState(0),e))}this.events.dispatchEvent(new sN(sN.CONTENT_UPDATED,i,e,s))}t!==oL.TEMPORARY_ROOM&&this.addObjectToTileMap(i,r)}changeObjectModelData(t,e,s,i,r){const n=this.getObject(this.getRoomId(t),e,s);if(!n||!n.logic)return!1;const a=new sM(i,r);return n.processUpdateMessage(a),!0}changeObjectState(t,e,s){const i=this.getObject(this.getRoomId(t),e,s);if(!i||!i.model)return;let r=i.model.getValue(rt.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(r)?r=1:r+=1,i.model.setValue(rt.FURNITURE_AUTOMATIC_STATE_INDEX,r);const n=i.model.getValue(rt.FURNITURE_DATA_FORMAT),a=Ia.getData(n);a.initializeFromRoomObjectModel(i.model),i.logic&&i.logic.processUpdateMessage(new JN(r,a))}loadRoomObjectBadgeImage(t,e,s,i){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(!this._sessionDataManager)return;let n=null;if(0===t){const t=this._roomManager.getRoomInstance(oL.TEMPORARY_ROOM);t&&(n=t.getRoomObject(e,s))}else n=this.getRoomObjectFloor(t,e);if(!n||!n.logic)return;let a=r?this._sessionDataManager.loadGroupBadgeImage(i):this._sessionDataManager.loadBadgeImage(i);if(a)this.putBadgeInObjectAssets(n,i,r);else{a="loading_icon",this._badgeListenerObjects||(this._badgeListenerObjects=new Map),this._badgeListenerObjects.size||this._sessionDataManager.events.addEventListener(QS.IMAGE_READY,this.onBadgeImageReadyEvent);let t=this._badgeListenerObjects.get(i);t||(t=[]),t.push(new nL(n,r)),this._badgeListenerObjects.set(i,t)}n.logic.processUpdateMessage(new $N(i,a))}onBadgeImageReadyEvent(t){if(!this._sessionDataManager)return;const e=this._badgeListenerObjects&&this._badgeListenerObjects.get(t.badgeId);if(e){for(const s of e){if(!s)continue;this.putBadgeInObjectAssets(s.object,t.badgeId,s.groupBadge);const e=s.groupBadge?this._sessionDataManager.loadGroupBadgeImage(t.badgeId):this._sessionDataManager.loadBadgeImage(t.badgeId);s.object&&s.object.logic&&s.object.logic.processUpdateMessage(new $N(t.badgeId,e))}this._badgeListenerObjects.delete(t.badgeId),this._badgeListenerObjects.size||this._sessionDataManager.events.removeEventListener(QS.IMAGE_READY,this.onBadgeImageReadyEvent)}}putBadgeInObjectAssets(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._roomContentLoader||!this._sessionDataManager)return;const i=s?this._sessionDataManager.loadGroupBadgeImage(e):this._sessionDataManager.loadBadgeImage(e),r=s?this._sessionDataManager.getGroupBadgeImage(e):this._sessionDataManager.getBadgeImage(e);r&&this._roomContentLoader.addAssetToCollection(t.type,i,r,!1)}dispatchMouseEvent(t,e,s,i,r,n,a,o){const h=this.getRoomInstanceRenderingCanvas(this._activeRoomId,t);if(!h)return;const _=this.getRenderingCanvasOverlay(h),d=this.getOverlayIconSprite(_,oL.OBJECT_ICON_SPRITE);if(d){const t=d.getLocalBounds();d.x=e-t.width/2,d.y=s-t.height/2}if(!this.handleRoomDragging(h,e,s,i,r,n,a)&&!h.handleMouseEvent(e,s,i,r,n,a,o)){let t=null;i===ts.MOUSE_CLICK?(this.events&&this.events.dispatchEvent(new sN(sN.DESELECTED,this._activeRoomId,-1,st.MINIMUM)),t=De.CLICK):i===ts.MOUSE_MOVE?t=De.MOUSE_MOVE:i===ts.MOUSE_DOWN?t=De.MOUSE_DOWN:i===ts.MOUSE_DOWN_LONG?t=De.MOUSE_DOWN_LONG:i===ts.MOUSE_UP&&(t=De.MOUSE_UP),this._roomObjectEventHandler.handleRoomObjectEvent(new De(t,this.getRoomObject(this._activeRoomId,oL.ROOM_OBJECT_ID,st.ROOM),null,r),this._activeRoomId)}this._activeRoomActiveCanvas=t,this._activeRoomActiveCanvasMouseX=e,this._activeRoomActiveCanvasMouseY=s}handleRoomDragging(t,e,s,i,r,n,a){let o=e-this._activeRoomActiveCanvasMouseX,h=s-this._activeRoomActiveCanvasMouseY;if(i===ts.MOUSE_DOWN)r||n||a||this.isDecorating||this._roomAllowsDragging&&(this._activeRoomIsDragged=!0,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=this._activeRoomActiveCanvasMouseX,this._activeRoomDragStartY=this._activeRoomActiveCanvasMouseY);else if(i===ts.MOUSE_UP){if(this._activeRoomIsDragged&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged)){const e=this.getRoomInstanceData(this._activeRoomId);if(e){const s=e.roomCamera;s&&(this.useOffsetScrolling&&(s.isMoving||(s.centeredLocX=!1,s.centeredLocY=!1),s.resetLocation(new dt(-t.screenOffsetX,-t.screenOffsetY))),this._roomDraggingAlwaysCenters&&s.reset())}}}else if(i===ts.MOUSE_MOVE)this._activeRoomIsDragged&&(this._activeRoomWasDragged||(o=e-this._activeRoomDragStartX,h=s-this._activeRoomDragStartY,(o<=-oL.DRAG_THRESHOLD||o>=oL.DRAG_THRESHOLD||h<=-oL.DRAG_THRESHOLD||h>=oL.DRAG_THRESHOLD)&&(this._activeRoomWasDragged=!0),o=0,h=0),0==o&&0==h||(this._activeRoomDragX+=o,this._activeRoomDragY+=h,this._activeRoomWasDragged=!0));else if((i===ts.MOUSE_CLICK||i===ts.DOUBLE_CLICK)&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged))return this._activeRoomWasDragged=!1,!0;return!1}updateMousePointer(t,e,s){const i=this.getRoomObjectCategoryForType(s);t!==gN.MOUSE_BUTTON?this.setMouseDefault(this._activeRoomId,i,e):this.setMouseButton(this._activeRoomId,i,e)}setMouseButton(t,e,s){if(!this._roomSessionManager)return;const i=this._roomSessionManager.getSession(t);if(i&&(e!==st.FLOOR&&e!==st.WALL||i.controllerLevel>=Zo.GUEST)){const i=this.getRoomInstanceData(t);i&&i.addButtonMouseCursorOwner(e+"_"+s)&&(this._mouseCursorUpdate=!0)}}setMouseDefault(t,e,s){if(!this._roomSessionManager)return;const i=this.getRoomInstanceData(t);i&&i.removeButtonMouseCursorOwner(e+"_"+s)&&(this._mouseCursorUpdate=!0)}processRoomObjectOperation(t,e,s){if(!this._roomObjectEventHandler)return!1;this._roomObjectEventHandler.modifyRoomObject(this._activeRoomId,t,e,s)}modifyRoomObjectDataWithMap(t,e,s,i){if(!this._roomObjectEventHandler)return!1;e===st.FLOOR&&this._roomObjectEventHandler.modifyRoomObjectDataWithMap(this._activeRoomId,t,e,s,i)}modifyRoomObjectData(t,e,s,i){if(!this._roomObjectEventHandler)return!1;e===st.WALL&&this._roomObjectEventHandler.modifyWallItemData(this._activeRoomId,t,s,i)}processRoomObjectEvent(t){if(!this._roomObjectEventHandler)return;const e=this.getRoomObjectRoomId(t.object);if(!e)return;const s=this.getRoomIdFromString(e);this._roomObjectEventHandler.handleRoomObjectEvent(t,s)}processRoomObjectPlacement(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;const _=this.getRoomInstance(this._activeRoomId);return!(!_||0!==_.model.getValue(dD.ROOM_IS_PUBLIC))&&(!!this._roomObjectEventHandler&&this._roomObjectEventHandler.processRoomObjectPlacement(t,this._activeRoomId,e,s,i,r,n,a,o,h))}getRoomObjectScreenLocation(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;-1==i&&(i=this._activeRoomActiveCanvas);const r=this.getRoomInstanceGeometry(t,i);if(!r)return null;const n=this.getRoomObject(t,e,s);if(!n)return null;const a=r.getScreenPoint(n.getLocation());if(!a)return null;const o=this.getRoomInstanceRenderingCanvas(t,i);return o?(a.x=a.x*o.scale,a.y=a.y*o.scale,a.x+=o.width/2+o.screenOffsetX,a.y+=o.height/2+o.screenOffsetY,a.x=Math.round(a.x),a.y=Math.round(a.y),a):null}selectRoomObject(t,e,s){this._roomObjectEventHandler&&this._roomObjectEventHandler.setSelectedObject(t,e,s)}setSelectedAvatar(t,e){this._roomObjectEventHandler||this._roomObjectEventHandler.setSelectedAvatar(t,e,!0)}cancelRoomObjectInsert(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectInsert(this._activeRoomId)}addOverlayIconSprite(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!t||!s)return;let r=this.getOverlayIconSprite(t,e);return r?null:(r=new W(s),r.name=e,r.scale.set(i),t.addChild(r),r)}onRoomContentLoaded(t,e,s){if(!this._roomContentLoader||-1===t)return;this._thumbnailObjectIdBank.freeNumber(t-1);const i=this._thumbnailCallbacks.get(e);if(i){this._thumbnailCallbacks.delete(e);const s=this._roomContentLoader.getImage(e);if(s)for(const e of i)e&&e.imageReady(t,null,s)}}setObjectMoverIconSprite(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=null,_=0,d=null;if(s)d=this.getRoomObjectImage(this._activeRoomId,t,e,new dt,1,null);else if(this._roomContentLoader)if(e===st.FLOOR?(h=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),_=this._roomContentLoader.getFurnitureFloorColorIndex(t)):e===st.WALL&&(h=this._roomContentLoader.getFurnitureWallNameForTypeId(t,i),_=this._roomContentLoader.getFurnitureWallColorIndex(t)),e===st.UNIT)if(h=it.getTypeString(t),"pet"===h){h=this.getPetType(i);const t=new WS(i);d=this.getRoomObjectPetImage(t.typeId,t.paletteId,t.color,new dt(180),64,null,!0,0,t.customParts,o)}else d=this.getGenericRoomObjectImage(h,i,new dt(180),64,null,0,null,r,n,a,o);else d=this.getGenericRoomObjectImage(h,_.toString(),new dt,1,null,0,i,r,n,a,o);if(!d||!d.data)return;const u=this.getActiveRoomInstanceRenderingCanvas();if(!u)return;const c=this.getRenderingCanvasOverlay(u);this.removeOverlayIconSprite(c,oL.OBJECT_ICON_SPRITE);const l=this.addOverlayIconSprite(c,oL.OBJECT_ICON_SPRITE,d.data,1);l&&(l.x=this._activeRoomActiveCanvasMouseX-d.data.width/2,l.y=this._activeRoomActiveCanvasMouseY-d.data.height/2)}getRoomObjectImage(t,e,s,i,r,n){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(!this._roomManager)return null;let o=-1,h=null,_=null,d="",u=null;const c=this.getRoomId(t),l=this._roomManager.getRoomInstance(c);if(l){const t=l.getRoomObject(e,s);if(t&&t.model)switch(o=t.id,h=t.type,s){case st.FLOOR:case st.WALL:{d=t.model.getValue(rt.FURNITURE_COLOR).toString(),u=t.model.getValue(rt.FURNITURE_EXTRAS);const e=t.model.getValue(rt.FURNITURE_DATA_FORMAT);e!==la.FORMAT_KEY&&(_=Ia.getData(e),_.initializeFromRoomObjectModel(t.model));break}case st.UNIT:d=t.model.getValue(rt.FIGURE)}}return this.getGenericRoomObjectImage(h,d,i,r,n,a,u,_,-1,-1,null,o)}getFurnitureFloorIconUrl(t){let e=null,s="";return this._roomContentLoader?(e=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),s=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString(),this._roomContentLoader.getAssetIconUrl(e,s)):null}getFurnitureFloorIcon(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this.getFurnitureFloorImage(t,new dt,1,e,0,s,-1,-1,i)}getFurnitureWallIconUrl(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=null,i="";return this._roomContentLoader?(s=this._roomContentLoader.getFurnitureWallNameForTypeId(t,e),i=this._roomContentLoader.getFurnitureWallColorIndex(t).toString(),this._roomContentLoader.getAssetIconUrl(s,i)):null}getFurnitureWallIcon(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getFurnitureWallImage(t,new dt,1,e,0,s)}getFurnitureFloorImage(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,_=null,d="";return this._roomContentLoader&&(_=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),d=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString()),1===s&&i?this.getGenericRoomObjectThumbnail(_,d,i,n,h):this.getGenericRoomObjectImage(_,d,e,s,i,r,n,h,a,o)}getFurnitureWallImage(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1,h=null,_="";return this._roomContentLoader&&(h=this._roomContentLoader.getFurnitureWallNameForTypeId(t),_=this._roomContentLoader.getFurnitureWallColorIndex(t).toString()),1===s&&i?this.getGenericRoomObjectThumbnail(h,_,i,n,null):this.getGenericRoomObjectImage(h,_,e,s,i,r,n,null,a,o)}getRoomObjectPetImage(t,e,s,i,r,n){let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,d=null,u=t+" "+e+" "+s.toString(16);if(a&&(u+=" head"),h){u=u+" "+h.length;for(const t of h)u=u+" "+t.layerId+" "+t.partId+" "+t.paletteId}return this._roomContentLoader&&(d=this._roomContentLoader.getPetNameForType(t)),this.getGenericRoomObjectImage(d,u,i,r,n,o,null,null,-1,-1,_)}getGenericRoomObjectImage(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:-1,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:-1;if(!this._roomManager)return null;const c=new yN;if(c.id=-1,!this._ready||!t)return c;let l=this._roomManager.getRoomInstance(oL.TEMPORARY_ROOM);if(!l&&(l=this._roomManager.createRoomInstance(oL.TEMPORARY_ROOM),!l))return c;let g=this._imageObjectIdBank.reserveNumber();const E=this.getRoomObjectCategoryForType(t);if(g<0)return c;g++;const p=l.createRoomObjectAndInitalize(g,t,E);if(!p||!p.model||!p.logic)return c;const m=p.model;switch(E){case st.FLOOR:case st.WALL:m.setValue(rt.FURNITURE_COLOR,parseInt(e)),m.setValue(rt.FURNITURE_EXTRAS,a);break;case st.UNIT:if(t===it.USER||t===it.BOT||t===it.RENTABLE_BOT||t===it.PET)m.setValue(rt.FIGURE,e);else{const t=new WS(e);m.setValue(rt.PET_PALETTE_INDEX,t.paletteId),m.setValue(rt.PET_COLOR,t.color),t.headOnly&&m.setValue(rt.PET_HEAD_ONLY,1),t.hasCustomParts&&(m.setValue(rt.PET_CUSTOM_LAYER_IDS,t.customLayerIds),m.setValue(rt.PET_CUSTOM_PARTS_IDS,t.customPartIds),m.setValue(rt.PET_CUSTOM_PALETTE_IDS,t.customPaletteIds)),d&&m.setValue(rt.FIGURE_POSTURE,d)}case st.ROOM:}p.setDirection(s);const I=p.visualization;if(!I)return l.removeRoomObject(g,E),c;(h>-1||o)&&(o&&""!==o.getLegacyString()?p.logic.processUpdateMessage(new JN(parseInt(o.getLegacyString()),o)):p.logic.processUpdateMessage(new JN(h,o)));const T=new Ye(i,new dt(-135,30,0),new dt(11,11,5));if(I.update(T,0,!0,!1),_>0){let t=0;for(;t<_;)I.update(T,0,!0,!1),t++}const R=I.getImage(n,u);if(c.data=R,c.id=g,!this.isRoomContentTypeLoaded(t)&&r){let t=this._imageCallbacks.get(g.toString());t||(t=[],this._imageCallbacks.set(g.toString(),t)),t.push(r),m.setValue(rt.IMAGE_QUERY_SCALE,i)}else l.removeRoomObject(g,E),this._imageObjectIdBank.freeNumber(g-1),c.id=0;return T.dispose(),c}getGenericRoomObjectThumbnail(t,e,s){if(!this._roomManager)return null;const i=new yN;if(i.id=-1,!this._ready||!t)return i;let r=this._roomManager.getRoomInstance(oL.TEMPORARY_ROOM);if(!r&&(r=this._roomManager.createRoomInstance(oL.TEMPORARY_ROOM),!r))return i;let n=this._thumbnailObjectIdBank.reserveNumber();this.getRoomObjectCategoryForType(t);if(n<0)return i;n++,i.id=n,i.data=null,i.image=null;const a=[t,e].join("_"),o=this._roomContentLoader.getImage(a);if(!o&&s){let i=this._thumbnailCallbacks.get(a);i||(i=[],this._thumbnailCallbacks.set(a,i),this._roomContentLoader.downloadImage(n,t,e,null)),i.push(s)}else o&&(i.image=o),this._thumbnailObjectIdBank.freeNumber(n-1),i.id=0;return i}initalizeTemporaryObjectsByType(t,e){const s=this._roomManager.getRoomInstance(oL.TEMPORARY_ROOM);if(!s||!this._roomContentLoader)return;const i=this._roomContentLoader.getCategoryForType(t),r=s.getManager(i);let n=null,a=0;if(r&&r.objects.length)for(const o of r.objects.getValues())if(o&&o.model&&o.type===t){const t=o.id,e=o.visualization;let r=null;if(e){const t=o.model.getValue(rt.IMAGE_QUERY_SCALE);n&&a!==t&&(n.dispose(),n=null),n||(a=t,n=new Ye(t,new dt(-135,30,0),new dt(11,11,5))),e.update(n,0,!0,!1),r=e.image}s.removeRoomObject(t,i),this._imageObjectIdBank.freeNumber(t-1);const h=this._imageCallbacks.get(t.toString());if(h){this._imageCallbacks.delete(t.toString());for(const e of h)e&&(r?e.imageReady(t,r):e.imageFailed(t))}}n&&n.dispose()}setObjectMoverIconSpriteVisible(t){const e=this.getActiveRoomInstanceRenderingCanvas();if(!e)return;const s=this.getRenderingCanvasOverlay(e),i=this.getOverlayIconSprite(s,oL.OBJECT_ICON_SPRITE);i&&(i.visible=t)}removeObjectMoverIconSprite(){const t=this.getActiveRoomInstanceRenderingCanvas();if(!t)return;const e=this.getRenderingCanvasOverlay(t);this.removeOverlayIconSprite(e,oL.OBJECT_ICON_SPRITE)}getRenderingCanvasOverlay(t){if(!t)return null;const e=t.master;return e&&e.getChildByName(oL.OVERLAY)||null}removeOverlayIconSprite(t,e){if(!t)return!1;let s=t.children.length-1;for(;s>=0;){const i=t.getChildAt(s);if(i&&i.name===e){if(t.removeChildAt(s),i.children.length){const t=i.getChildAt(0);t.parent.removeChild(t),t.destroy()}return!0}s--}return!1}getOverlayIconSprite(t,e){if(!t)return null;let s=t.children.length-1;for(;s>=0;){const i=t.getChildAt(s);if(i&&i.name===e)return i;s--}return null}getRoomObjects(t,e){if(this._ready){const s=this.getRoomId(t),i=this._roomManager.getRoomInstance(s);if(i)return i.getRoomObjectsForCategory(e)}return[]}addObjectToTileMap(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s.addRoomObject(e)}refreshTileObjectMap(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s.populate(this.getRoomObjects(t,st.FLOOR))}getRenderRoomMessage(t,e){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,n=null;if(n=r>-1?this.getRoomInstanceRenderingCanvas(this._activeRoomId,r):this.getActiveRoomInstanceRenderingCanvas(),!n)return null;i&&n.skipSpriteVisibilityChecking();let a=-1;s||null==this._roomSessionManager.getSession(this._activeRoomId)||(a=this._roomSessionManager.getSession(this._activeRoomId).ownRoomIndex);const o=new aL,h=o.getFurniData(t,n,this,a),_=o.getRoomRenderingModifiers(this),d=o.getRoomPlanes(t,n,this,e);return i&&n.resumeSpriteVisibilityChecking(),console.log(h,_,d),null}createTextureFromRoom(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=null;i=e>-1?this.getRoomInstanceRenderingCanvas(this._activeRoomId,e):this.getActiveRoomInstanceRenderingCanvas();let r=null;return r=s?At.generateTexture(i.master,s):i.getDisplayAsTexture(),r}saveTextureAsScreenshot(t){let e=null;e=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?new EI:new gI,e.assignBitmap(t),this._communication.connection.send(e)}saveBase64AsScreenshot(t){let e=null;e=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?new EI:new gI,e.assignBase64(t),this._communication.connection.send(e)}objectsInitialized(t){const e=this.getRoomIdFromString(t);this.events.dispatchEvent(new YS(YS.OBJECTS_INITIALIZED,e))}getRoomId(t){return t.toString()}getRoomIdFromString(t){if(!t)return-1;const e=t.split("_");return e.length<=0?-1:parseInt(e[0])||0}getRoomObjectRoomId(t){return t&&t.model?t.model.getValue(rt.OBJECT_ROOM_ID):null}getRoomObjectAdUrl(t){return this._roomContentLoader.getRoomObjectAdUrl(t)}getPetTypeId(t){let e=-1;if(t){const s=t.split(" ");s.length>1&&(e=parseInt(s[0]))}return e}getPetType(t){if(!t)return null;const e=t.split(" ");if(e.length>1){const t=parseInt(e[0]);return this._roomContentLoader?this._roomContentLoader.getPetNameForType(t):"pet"}return null}isRoomContentTypeLoaded(t){return!!this._roomContentLoader&&null!==this._roomContentLoader.getCollection(t)}getPetColorResult(t,e){return this._roomContentLoader?this._roomContentLoader.getPetColorResult(t,e):null}getPetColorResultsForTag(t,e){return this._roomContentLoader?this._roomContentLoader.getPetColorResultsForTag(t,e):null}deleteRoomObject(t,e){return!(!this._roomObjectEventHandler||e!==st.WALL)&&this._roomObjectEventHandler.deleteWallItem(this._activeRoomId,t)}get connection(){return this._communication.connection}get sessionDataManager(){return this._sessionDataManager}set sessionDataManager(t){this._sessionDataManager=t}get roomSessionManager(){return this._roomSessionManager}set roomSessionManager(t){this._roomSessionManager=t}get roomManager(){return this._roomManager}set roomManager(t){this._roomManager=t}get objectEventHandler(){return this._roomObjectEventHandler}get roomRendererFactory(){return this._roomRendererFactory}get visualizationFactory(){return this._visualizationFactory}get logicFactory(){return this._logicFactory}get activeRoomId(){return this._activeRoomId}get ready(){return this._ready}get roomContentLoader(){return this._roomContentLoader}get isDecorating(){if(!this._roomSessionManager)return!1;const t=this._roomSessionManager.getSession(this._activeRoomId);return t&&t.isDecorating||!1}get useOffsetScrolling(){return!0}get selectedAvatarId(){return this._roomObjectEventHandler?this._roomObjectEventHandler.selectedAvatarId:-1}getRoomObjectCount(t,e){return null==this._roomManager?0:this._roomManager.getRoomInstance(t.toString()).getRoomObjectsForCategory(e).length}}oL.ROOM_OBJECT_ID=-1,oL.ROOM_OBJECT_TYPE="room",oL.CURSOR_OBJECT_ID=-2,oL.CURSOR_OBJECT_TYPE="tile_cursor",oL.ARROW_OBJECT_ID=-3,oL.ARROW_OBJECT_TYPE="selection_arrow",oL.OVERLAY="overlay",oL.OBJECT_ICON_SPRITE="object_icon_sprite",oL.DRAG_THRESHOLD=15,oL.TEMPORARY_ROOM="temporary_room";class hL{}hL.KICKED_OUT_OF_ROOM=4008,hL.STRIP_LOCKED_FOR_TRADING=-13001;class _L extends ZS{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(t,e),this._message=void 0,this._message=s}get message(){return this._message}}_L.RSEME_KICKED="RSEME_KICKED",_L.RSEME_PETS_FORBIDDEN_IN_HOTEL="RSEME_PETS_FORBIDDEN_IN_HOTEL",_L.RSEME_PETS_FORBIDDEN_IN_FLAT="RSEME_PETS_FORBIDDEN_IN_FLAT",_L.RSEME_MAX_PETS="RSEME_MAX_PETS",_L.RSEME_MAX_NUMBER_OF_OWN_PETS="RSEME_MAX_NUMBER_OF_OWN_PETS",_L.RSEME_NO_FREE_TILES_FOR_PET="RSEME_NO_FREE_TILES_FOR_PET",_L.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET="RSEME_SELECTED_TILE_NOT_FREE_FOR_PET",_L.RSEME_BOTS_FORBIDDEN_IN_HOTEL="RSEME_BOTS_FORBIDDEN_IN_HOTEL",_L.RSEME_BOTS_FORBIDDEN_IN_FLAT="RSEME_BOTS_FORBIDDEN_IN_FLAT",_L.RSEME_BOT_LIMIT_REACHED="RSEME_BOT_LIMIT_REACHED",_L.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT="RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT",_L.RSEME_BOT_NAME_NOT_ACCEPTED="RSEME_BOT_NAME_NOT_ACCEPTED";class dL extends c{constructor(t,e){super(),this._connection=void 0,this._listener=void 0,this._roomId=void 0,this._connection=t,this._listener=e,this._roomId=0}onDispose(){this._connection=null,this._listener=null}setRoomId(t){this._roomId=t}get connection(){return this._connection}get listener(){return this._listener}get roomId(){return this._roomId}}class uL extends dL{constructor(t,e){super(t,e),t.addMessageEvent(new qc(this.onRoomGenericError.bind(this)))}onRoomGenericError(t){if(!(t instanceof qc))return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;e.errorCode===hL.KICKED_OUT_OF_ROOM&&(i=_L.RSEME_KICKED,i&&0!=i.length&&this.listener.events.dispatchEvent(new _L(i,s)))}}class cL extends ZS{constructor(t,e,s){super(t,e),this._id=-1,this._headline=void 0,this._summary=void 0,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._npsPoll=!1,this._id=s}get id(){return this._id}get headline(){return this._headline}set headline(t){this._headline=t}get summary(){return this._summary}set summary(t){this._summary=t}get numQuestions(){return this._numQuestions}set numQuestions(t){this._numQuestions=t}get startMessage(){return this._startMessage}set startMessage(t){this._startMessage=t}get endMessage(){return this._endMessage}set endMessage(t){this._endMessage=t}get questionArray(){return this._questionArray}set questionArray(t){this._questionArray=t}get npsPoll(){return this._npsPoll}set npsPoll(t){this._npsPoll=t}}cL.OFFER="RSPE_POLL_OFFER",cL.ERROR="RSPE_POLL_ERROR",cL.CONTENT="RSPE_POLL_CONTENT";class lL extends dL{constructor(t,e){super(t,e),t.addMessageEvent(new YE(this.onPollContentsEvent.bind(this))),t.addMessageEvent(new WE(this.onPollOfferEvent.bind(this))),t.addMessageEvent(new zE(this.onPollErrorEvent.bind(this)))}onPollContentsEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new cL(cL.CONTENT,e,s.id);i.startMessage=s.startMessage,i.endMessage=s.endMessage,i.numQuestions=s.numQuestions,i.questionArray=s.questionArray,i.npsPoll=s.npsPoll,this.listener.events.dispatchEvent(i)}onPollOfferEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new cL(cL.OFFER,e,s.id);i.summary=s.headline,i.summary=s.summary,this.listener.events.dispatchEvent(i)}onPollErrorEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;if(!t.getParser())return;const s=new cL(cL.ERROR,e,-1);s.headline="???",s.summary="???",this.listener.events.dispatchEvent(s)}}class gL extends ZS{constructor(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1;super(t,e),this._objectId=void 0,this._message=void 0,this._chatType=void 0,this._links=void 0,this._extraParam=void 0,this._style=void 0,this._objectId=s,this._message=i,this._chatType=r,this._links=a,this._extraParam=o,this._style=n}get objectId(){return this._objectId}get message(){return this._message}get chatType(){return this._chatType}get links(){return this._links}get extraParam(){return this._extraParam}get style(){return this._style}}gL.CHAT_EVENT="RSCE_CHAT_EVENT",gL.FLOOD_EVENT="RSCE_FLOOD_EVENT",gL.CHAT_TYPE_SPEAK=0,gL.CHAT_TYPE_WHISPER=1,gL.CHAT_TYPE_SHOUT=2,gL.CHAT_TYPE_RESPECT=3,gL.CHAT_TYPE_PETRESPECT=4,gL.CHAT_TYPE_HAND_ITEM_RECEIVED=5,gL.CHAT_TYPE_PETTREAT=6,gL.CHAT_TYPE_PETREVIVE=7,gL.CHAT_TYPE_PET_REBREED_FERTILIZE=8,gL.CHAT_TYPE_PET_SPEED_FERTILIZE=9,gL.CHAT_TYPE_MUTE_REMAINING=10;class EL extends dL{constructor(t,e){super(t,e),t.addMessageEvent(new rm(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new nm(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new am(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new lm(this.onRoomUnitHandItemReceivedEvent.bind(this))),t.addMessageEvent(new eI(this.onRespectReceivedEvent.bind(this))),t.addMessageEvent(new US(this.onPetRespectNoficationEvent.bind(this))),t.addMessageEvent(new $m(this.onPetSupplementedNotificationEvent.bind(this))),t.addMessageEvent(new sm(this.onFloodControlEvent.bind(this))),t.addMessageEvent(new im(this.onRemainingMuteEvent.bind(this)))}onRoomUnitChatEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;let i=gL.CHAT_TYPE_SPEAK;t instanceof nm?i=gL.CHAT_TYPE_SHOUT:t instanceof am&&(i=gL.CHAT_TYPE_WHISPER);const r=new gL(gL.CHAT_EVENT,e,s.roomIndex,s.message,i,s.bubble);this.listener.events.dispatchEvent(r)}onRoomUnitHandItemReceivedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&this.listener.events.dispatchEvent(new gL(gL.CHAT_EVENT,e,s.giverUserId,"",gL.CHAT_TYPE_HAND_ITEM_RECEIVED,xD.GENERIC,null,s.handItemType))}onRespectReceivedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getUserData(s.userId);i&&this.listener.events.dispatchEvent(new gL(gL.CHAT_EVENT,e,i.roomIndex,"",gL.CHAT_TYPE_RESPECT,xD.GENERIC))}onPetRespectNoficationEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getPetData(s.petData.id);if(!i)return;let r=gL.CHAT_TYPE_PETRESPECT;s.isTreat&&(r=gL.CHAT_TYPE_PETTREAT),this.listener.events.dispatchEvent(new gL(gL.CHAT_EVENT,e,i.roomIndex,"",r,xD.GENERIC))}onPetSupplementedNotificationEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getPetData(s.petId);if(!i)return;let r=-1;const n=e.userDataManager.getUserData(s.userId);n&&(r=n.roomIndex);let a=gL.CHAT_TYPE_PETREVIVE;switch(s.supplementType){case tI.REVIVE:a=gL.CHAT_TYPE_PETREVIVE;break;case tI.REBREED_FERTILIZER:a=gL.CHAT_TYPE_PET_REBREED_FERTILIZE;break;case tI.SPEED_FERTILIZER:a=gL.CHAT_TYPE_PET_SPEED_FERTILIZE}this.listener.events.dispatchEvent(new gL(gL.CHAT_EVENT,e,i.roomIndex,"",a,xD.GENERIC,null,r))}onFloodControlEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=s.seconds;this.listener.events.dispatchEvent(new gL(gL.FLOOD_EVENT,e,-1,i.toString(),0,0))}onRemainingMuteEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&this.listener.events.dispatchEvent(new gL(gL.CHAT_EVENT,e,e.ownRoomIndex,"",gL.CHAT_TYPE_MUTE_REMAINING,xD.GENERIC,null,s.seconds))}}class pL extends ZS{constructor(t,e){super(t,e)}}pL.RSDUE_ALLOW_PETS="RSDUE_ALLOW_PETS";class mL extends dL{constructor(t,e){super(t,e),t.addMessageEvent(new EE(this.onGetGuestRoomResultEvent.bind(this)))}onGetGuestRoomResultEvent(t){if(!(t instanceof EE))return;const e=t.getParser();if(!e)return;if(e.roomForward)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.data;s.tradeMode=i.tradeMode,s.isGuildRoom=0!==i.habboGroupId,s.doorMode=i.doorMode,s.allowPets=i.allowPets,s.moderationSettings=e.moderation,this.listener.events.dispatchEvent(new pL(pL.RSDUE_ALLOW_PETS,s)),this.listener.events.dispatchEvent(new ZS(ZS.ROOM_DATA,s))}}class IL{constructor(t,e,s,i){this._id=void 0,this._type=void 0,this._color=void 0,this._brightness=void 0,this._id=t,this._type=e,this._color=s,this._brightness=i}get id(){return this._id}get type(){return this._type}get color(){return this._color}get brightness(){return this._brightness}}class TL extends ZS{constructor(t,e){super(t,e),this._selectedPresetId=0,this._presets=void 0,this._presets=[]}storePreset(t,e,s,i){this._presets[t-1]=new IL(t,e,s,i)}getPreset(t){return t<0||t>=this._presets.length?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}set selectedPresetId(t){this._selectedPresetId=t}}TL.ROOM_DIMMER_PRESETS="RSDPE_PRESETS";class RL extends dL{constructor(t,e){super(t,e),t.addMessageEvent(new Fp(this.onRoomDimmerPresets.bind(this)))}onRoomDimmerPresets(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=new TL(TL.ROOM_DIMMER_PRESETS,s);i.selectedPresetId=e.selectedPresetId;let r=0;for(;r<e.presetCount;){const t=e.getPreset(r);t&&i.storePreset(t.id,t.type,t.color,t.brightness),r++}this.listener&&this.listener.events.dispatchEvent(i)}}class fL extends dL{constructor(t,e){super(t,e),t.addMessageEvent(new _p(this.onRoomRightsEvent.bind(this))),t.addMessageEvent(new hp(this.onRoomRightsClearEvent.bind(this))),t.addMessageEvent(new dp(this.onRoomRightsOwnerEvent.bind(this)))}onRoomRightsEvent(t){if(!(t instanceof _p))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(t.getParser().controllerLevel)}onRoomRightsClearEvent(t){if(!(t instanceof hp))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(Zo.NONE)}onRoomRightsOwnerEvent(t){if(!(t instanceof dp))return;const e=this.listener.getSession(this.roomId);e&&e.setRoomOwner()}}class OL extends ZS{constructor(t,e,s,i,r,n,a,o,h){super(t,e),this._classId=0,this._itemType="",this._productCode=void 0,this._placedItemId=0,this._placedItemType="",this._placedInRoom=void 0,this._petFigureString=void 0,this._classId=s,this._itemType=i,this._productCode=r,this._placedItemId=n,this._placedItemType=a,this._placedInRoom=o,this._petFigureString=h}get classId(){return this._classId}get itemType(){return this._itemType}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedInRoom(){return this._placedInRoom}get placedItemType(){return this._placedItemType}get petFigureString(){return this._petFigureString}}OL.RSPE_PRESENT_OPENED="RSPE_PRESENT_OPENED";class vL extends dL{constructor(t,e){super(t,e),t&&t.addMessageEvent(new Ig(this.onFurnitureGiftOpenedEvent.bind(this)))}onFurnitureGiftOpenedEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener&&this.listener.events&&this.listener.events.dispatchEvent(new OL(OL.RSPE_PRESENT_OPENED,s,e.classId,e.itemType,e.productCode,e.placedItemId,e.placedItemType,e.placedInRoom,e.petFigureString))}}class AL extends ZS{constructor(t,e,s){super(t,e),this._userName="",this._userName=s}get userName(){return this._userName}}AL.DOORBELL="RSDE_DOORBELL",AL.RSDE_REJECTED="RSDE_REJECTED",AL.RSDE_ACCEPTED="RSDE_ACCEPTED";class SL extends ZS{constructor(t,e){super(t,e)}}SL.SPECTATOR_MODE="RSSME_SPECTATOR_MODE";class NL extends dL{constructor(t,e){super(t,e),t.addMessageEvent(new cp(this.onRoomEnterEvent.bind(this))),t.addMessageEvent(new Qp(this.onRoomReadyMessageEvent.bind(this))),t.addMessageEvent(new Cc(this.onDesktopViewEvent.bind(this))),t.addMessageEvent(new op(this.onRoomDoorbellAcceptedEvent.bind(this))),t.addMessageEvent(new lE(this.onRoomDoorbellRejectedEvent.bind(this))),t.addMessageEvent(new NS(this.onYouAreSpectatorMessageEvent.bind(this)))}onRoomEnterEvent(t){t instanceof cp&&this.listener&&this.listener.sessionUpdate(this.roomId,NL.RS_CONNECTED)}onRoomReadyMessageEvent(t){if(!(t instanceof Qp))return;const e=this.roomId,s=t.getParser().roomId;this.listener&&(this.listener.sessionReinitialize(e,s),this.listener.sessionUpdate(this.roomId,NL.RS_READY))}onDesktopViewEvent(t){t instanceof Cc&&this.listener&&this.listener.sessionUpdate(this.roomId,NL.RS_DISCONNECTED)}onRoomDoorbellAcceptedEvent(t){if(!(t instanceof op)||!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(s&&s.length){if(this.listener.events){const t=this.listener.getSession(this.roomId);if(!t)return;this.listener.events.dispatchEvent(new AL(AL.RSDE_ACCEPTED,t,s))}}else this.connection.send(new IA(this.roomId))}onRoomDoorbellRejectedEvent(t){if(!(t instanceof lE)||!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(s&&s.length){if(this.listener.events){const t=this.listener.getSession(this.roomId);if(!t)return;this.listener.events.dispatchEvent(new AL(AL.RSDE_REJECTED,t,s))}}else this.listener.sessionUpdate(this.roomId,NL.RS_DISCONNECTED)}onYouAreSpectatorMessageEvent(t){if(this.listener){const t=this.listener.getSession(this.roomId);if(!t)return;t.isSpectator=!0,this.listener.events.dispatchEvent(new SL(SL.SPECTATOR_MODE,t))}}}NL.RS_CONNECTED="RS_CONNECTED",NL.RS_READY="RS_READY",NL.RS_DISCONNECTED="RS_DISCONNECTED";class ML extends d{constructor(t,e){super(ML.MYSTERY_BOX_KEYS_UPDATE),this._boxColor=void 0,this._keyColor=void 0,this._boxColor=t,this._keyColor=e}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}}ML.MYSTERY_BOX_KEYS_UPDATE="mbke_update";class yL extends d{constructor(){super(yL.PERKS_UPDATED)}}yL.PERKS_UPDATED="PUE_perks_updated";class DL extends ZS{constructor(t,e,s,i,r,n){super(DL.CONFIRM_PET_BREEDING,t),this._nestId=void 0,this._pet1=void 0,this._pet2=void 0,this._rarityCategories=void 0,this._resultPetTypeId=void 0,this._nestId=e,this._pet1=s,this._pet2=i,this._rarityCategories=r,this._resultPetTypeId=n}get rarityCategories(){return this._rarityCategories}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get resultPetTypeId(){return this._resultPetTypeId}}DL.CONFIRM_PET_BREEDING="RSPFUE_CONFIRM_PET_BREEDING";class CL extends ZS{constructor(t,e,s){super(CL.RSPFUE_CONFIRM_PET_BREEDING_RESULT,t),this._breedingNestStuffId=void 0,this._result=void 0,this._breedingNestStuffId=e,this._result=s}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}}CL.RSPFUE_CONFIRM_PET_BREEDING_RESULT="RSPFUE_CONFIRM_PET_BREEDING_RESULT";class LL extends ZS{constructor(t,e,s){super(LL.RSDE_DANCE,t),this._roomIndex=void 0,this._danceId=void 0,this._roomIndex=e,this._danceId=s}get roomIndex(){return this._roomIndex}get danceId(){return this._danceId}}LL.RSDE_DANCE="RSDE_DANCE";class UL extends ZS{constructor(t,e,s,i,r){super(UL.FAVOURITE_GROUP_UPDATE,t),this._roomIndex=void 0,this._habboGroupId=void 0,this._habboGroupName=void 0,this._status=void 0,this._roomIndex=e,this._habboGroupId=s,this._habboGroupName=r,this._status=i}get roomIndex(){return this._roomIndex}get habboGroupId(){return this._habboGroupId}get habboGroupName(){return this._habboGroupName}get status(){return this._status}}UL.FAVOURITE_GROUP_UPDATE="RSFGUE_FAVOURITE_GROUP_UPDATE";class PL extends ZS{constructor(t,e,s,i){super(PL.RSFRE_FRIEND_REQUEST,t),this._requestId=0,this._userId=0,this._userName=void 0,this._requestId=e,this._userId=s,this._userName=i}get requestId(){return this._requestId}get userId(){return this._userId}get userName(){return this._userName}}PL.RSFRE_FRIEND_REQUEST="RSFRE_FRIEND_REQUEST";class bL extends ZS{constructor(t,e,s){super(bL.NEST_BREEDING_SUCCESS,t),this._rarityCategory=void 0,this._petId=void 0,this._petId=e,this._rarityCategory=s}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}}bL.NEST_BREEDING_SUCCESS="RSPFUE_NEST_BREEDING_SUCCESS";class wL extends ZS{constructor(t,e,s,i){super(wL.PET_BREEDING,t),this._state=void 0,this._ownPetId=void 0,this._otherPetId=void 0,this._state=e,this._ownPetId=s,this._otherPetId=i}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}}wL.PET_BREEDING="RSPFUE_PET_BREEDING";class FL extends ZS{constructor(t,e,s){super(FL.PET_BREEDING_RESULT,t),this._resultData=void 0,this._otherResultData=void 0,this._resultData=e,this._otherResultData=s}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}}FL.PET_BREEDING_RESULT="RSPFUE_PET_BREEDING_RESULT";class xL extends ZS{constructor(t,e,s,i){super(xL.PET_COMMANDS,t),this._petId=void 0,this._allCommandIds=void 0,this._enabledCommandIds=void 0,this._petId=e,this._allCommandIds=s,this._enabledCommandIds=i}get id(){return this._petId}get commands(){return this._allCommandIds}get enabledCommands(){return this._enabledCommandIds}}xL.PET_COMMANDS="RSPIUE_ENABLED_PET_COMMANDS";class BL extends ZS{constructor(t,e,s){super(BL.PET_FIGURE_UPDATE,t),this._petId=void 0,this._figure=void 0,this._petId=e,this._figure=s}get id(){return this._petId}get figure(){return this._figure}}BL.PET_FIGURE_UPDATE="RSPFUE_PET_FIGURE_UPDATE";class GL extends ZS{constructor(t,e){super(GL.PET_INFO,t),this._petInfo=void 0,this._petInfo=e}get petInfo(){return this._petInfo}}GL.PET_INFO="RSPIUE_PET_INFO";class HL extends ZS{constructor(t,e,s){super(HL.PET_LEVEL_UPDATE,t),this._petId=void 0,this._level=void 0,this._petId=e,this._level=s}get petId(){return this._petId}get level(){return this._level}}HL.PET_LEVEL_UPDATE="RSPLUE_PET_LEVEL_UPDATE";class VL extends ZS{constructor(t,e,s,i,r,n){super(t,e),this._objectId=-1,this._figureData=void 0,this._nameValidationStatus=0,this._nameValidationInfo=null,this._objectId=s,this._figureData=i,this._nameValidationStatus=r,this._nameValidationInfo=n}get objectId(){return this._objectId}get figureData(){return this._figureData}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}VL.RSOPPE_OPEN_PET_PACKAGE_REQUESTED="RSOPPE_OPEN_PET_PACKAGE_REQUESTED",VL.RSOPPE_OPEN_PET_PACKAGE_RESULT="RSOPPE_OPEN_PET_PACKAGE_RESULT";class jL extends ZS{constructor(t,e,s,i,r,n){super(jL.PET_STATUS_UPDATE,t),this._petId=void 0,this._canBreed=void 0,this._canHarvest=void 0,this._canRevive=void 0,this._hasBreedingPermission=void 0,this._petId=e,this._canBreed=s,this._canHarvest=i,this._canRevive=r,this._hasBreedingPermission=n}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}}jL.PET_STATUS_UPDATE="RSPFUE_PET_STATUS_UPDATE";class kL extends ZS{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(kL.QUEUE_STATUS,t),this._name=void 0,this._target=void 0,this._queues=void 0,this._isActive=void 0,this._activeQueue=void 0,this._name=e,this._target=s,this._queues=new Map,this._isActive=i}get isActive(){return this._isActive}get queueSetName(){return this._name}get queueSetTarget(){return this._target}get queueTypes(){return Array.from(this._queues.keys())}getQueueSize(t){return this._queues.get(t)}addQueue(t,e){this._queues.set(t,e)}}kL.QUEUE_STATUS="RSQE_QUEUE_STATUS",kL.QUEUE_TYPE_CLUB="c",kL.QUEUE_TYPE_NORMAL="d",kL.QUEUE_TARGET_VISITOR=2,kL.QUEUE_TARGET_SPECTATOR=1;class YL extends ZS{constructor(t,e,s){super(YL.RSUBE_BADGES,t),this._userId=0,this._badges=void 0,this._badges=[],this._userId=e,this._badges=s}get userId(){return this._userId}get badges(){return this._badges}}YL.RSUBE_BADGES="RSUBE_BADGES";class zL extends ZS{constructor(t,e){super(zL.USER_DATA_UPDATED,t),this._addedUsers=void 0,this._addedUsers=e}get addedUsers(){return this._addedUsers}}zL.USER_DATA_UPDATED="RMUDUE_USER_DATA_UPDATED";class WL extends ZS{constructor(t,e,s,i,r,n){super(WL.USER_FIGURE,t),this._roomIndex=0,this._figure="",this._gender="",this._customInfo="",this._achievementScore=void 0,this._roomIndex=e,this._figure=s,this._gender=i,this._customInfo=r,this._achievementScore=n}get roomIndex(){return this._roomIndex}get figure(){return this._figure}get gender(){return this._gender}get customInfo(){return this._customInfo}get activityPoints(){return this._achievementScore}}WL.USER_FIGURE="RSUBE_FIGURE";class KL extends d{constructor(t,e){super(KL.UTRE_USER_TAGS_RECEIVED),this._userId=void 0,this._tags=void 0,this._userId=t,this._tags=e}get userId(){return this._userId}get tags(){return this._tags}}KL.UTRE_USER_TAGS_RECEIVED="UTRE_USER_TAGS_RECEIVED";class XL extends ZS{constructor(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;super(t,e),this._question="",this._choices=void 0,this._SafeStr_7651=void 0,this._SafeStr_7654=0,this._choices=[],this._SafeStr_7651=[],this._question=s,this._choices=i,this._SafeStr_7651=r,null==this._SafeStr_7651&&(this._SafeStr_7651=[]),this._SafeStr_7654=n}get question(){return this._question}get choices(){return this._choices.slice()}get _SafeStr_4173(){return this._SafeStr_7651.slice()}get _SafeStr_4174(){return this._SafeStr_7654}}XL.VOTE_QUESTION="RSPE_VOTE_QUESTION",XL.VOTE_RESULT="RSPE_VOTE_RESULT";class qL extends ZS{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;super(t,e),this._id=-1,this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,this._userId=-1,this._value=void 0,this._answerCounts=void 0,this._id=s}get id(){return this._id}get pollType(){return this._pollType}set pollType(t){this._pollType=t}get pollId(){return this._pollId}set pollId(t){this._pollId=t}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get duration(){return this._duration}set duration(t){this._duration=t}get question(){return this._question}set question(t){this._question=t}get userId(){return this._userId}set userId(t){this._userId=t}get value(){return this._value}set value(t){this._value=t}get answerCounts(){return this._answerCounts}set answerCounts(t){this._answerCounts=t}}qL.QUESTION="RWPUW_NEW_QUESTION",qL.FINISHED="RWPUW_QUESION_FINSIHED",qL.ANSWERED="RWPUW_QUESTION_ANSWERED";class QL extends d{constructor(t){super(QL.UPDATED),this._uiFlags=void 0,this._uiFlags=t}get uiFlags(){return this._uiFlags}}QL.UPDATED="APUE_UPDATED";class ZL extends d{constructor(t){super(ZL.UNUE_NAME_UPDATED),this._name=void 0,this._name=t}get name(){return this._name}}ZL.UNUE_NAME_UPDATED="unue_name_updated";class JL{constructor(){this._id=void 0,this._level=void 0,this._maximumLevel=void 0,this._experience=void 0,this._levelExperienceGoal=void 0,this._energy=void 0,this._maximumEnergy=void 0,this._happyness=void 0,this._maximumHappyness=void 0,this._ownerId=void 0,this._ownerName=void 0,this._respect=void 0,this._age=void 0,this._unknownRarity=void 0,this._saddle=void 0,this._rider=void 0,this._breedable=void 0,this._skillThresholds=void 0,this._publiclyRideable=void 0,this._fullyGrown=void 0,this._dead=void 0,this._maximumTimeToLive=void 0,this._remainingTimeToLive=void 0,this._remainingGrowTime=void 0,this._rarityLevel=void 0,this._publiclyBreedable=void 0,this._adultLevel=7}get id(){return this._id}set id(t){this._id=t}get level(){return this._level}set level(t){this._level=t}get maximumLevel(){return this._maximumLevel}set maximumLevel(t){this._maximumLevel=t}get experience(){return this._experience}set experience(t){this._experience=t}get levelExperienceGoal(){return this._levelExperienceGoal}set levelExperienceGoal(t){this._levelExperienceGoal=t}get energy(){return this._energy}set energy(t){this._energy=t}get maximumEnergy(){return this._maximumEnergy}set maximumEnergy(t){this._maximumEnergy=t}get happyness(){return this._happyness}set happyness(t){this._happyness=t}get maximumHappyness(){return this._maximumHappyness}set maximumHappyness(t){this._maximumHappyness=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get respect(){return this._respect}set respect(t){this._respect=t}get age(){return this._age}set age(t){this._age=t}get unknownRarity(){return this._unknownRarity}set unknownRarity(t){this._unknownRarity=t}get saddle(){return this._saddle}set saddle(t){this._saddle=t}get rider(){return this._rider}set rider(t){this._rider=t}get skillTresholds(){return this._skillThresholds}set skillTresholds(t){this._skillThresholds=t}get publiclyRideable(){return this._publiclyRideable}set publiclyRideable(t){this._publiclyRideable=t}get breedable(){return this._breedable}set breedable(t){this._breedable=t}get fullyGrown(){return this._fullyGrown}set fullyGrown(t){this._fullyGrown=t}get dead(){return this._dead}set dead(t){this._dead=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get maximumTimeToLive(){return this._maximumTimeToLive}set maximumTimeToLive(t){this._maximumTimeToLive=t}get remainingTimeToLive(){return this._remainingTimeToLive}set remainingTimeToLive(t){this._remainingTimeToLive=t}get remainingGrowTime(){return this._remainingGrowTime}set remainingGrowTime(t){this._remainingGrowTime=t}get publiclyBreedable(){return this._publiclyBreedable}set publiclyBreedable(t){this._publiclyBreedable=t}get adultLevel(){return this._adultLevel}}class $L{constructor(t){this._roomIndex=-1,this._name="",this._type=0,this._sex="",this._figure="",this._custom="",this._activityPoints=void 0,this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._ownerId=0,this._ownerName="",this._petLevel=0,this._rarityLevel=0,this._hasSaddle=void 0,this._isRiding=void 0,this._canBreed=void 0,this._canHarvest=void 0,this._canRevive=void 0,this._hasBreedingPermission=void 0,this._botSkills=void 0,this._isModerator=void 0,this._roomIndex=t}get roomIndex(){return this._roomIndex}get activityPoints(){return this._activityPoints}set activityPoints(t){this._activityPoints=t}get name(){return this._name}set name(t){this._name=t}get type(){return this._type}set type(t){this._type=t}get sex(){return this._sex}set sex(t){this._sex=t}get figure(){return this._figure}set figure(t){this._figure=t}get custom(){return this._custom}set custom(t){this._custom=t}get webID(){return this._webID}set webID(t){this._webID=t}get groupId(){return this._groupID}set groupId(t){this._groupID=t}get groupName(){return this._groupName}set groupName(t){this._groupName=t}get groupStatus(){return this._groupStatus}set groupStatus(t){this._groupStatus=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._hasSaddle=t}get isRiding(){return this._isRiding}set isRiding(t){this._isRiding=t}get canBreed(){return this._canBreed}set canBreed(t){this._canBreed=t}get canHarvest(){return this._canHarvest}set canHarvest(t){this._canHarvest=t}get canRevive(){return this._canRevive}set canRevive(t){this._canRevive=t}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._hasBreedingPermission=t}get petLevel(){return this._petLevel}set petLevel(t){this._petLevel=t}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isModerator=t}}class tU extends dL{constructor(t,e){super(t,e),t.addMessageEvent(new dm(this.onRoomUnitEvent.bind(this))),t.addMessageEvent(new Em(this.onRoomUnitInfoEvent.bind(this))),t.addMessageEvent(new mm(this.onRoomUnitRemoveEvent.bind(this))),t.addMessageEvent(new hm(this.onRoomUnitDanceEvent.bind(this))),t.addMessageEvent(new Gm(this.onUserCurrentBadgesEvent.bind(this))),t.addMessageEvent(new dE(this.onRoomDoorbellEvent.bind(this))),t.addMessageEvent(new Vm(this.onUserNameChangeMessageEvent.bind(this))),t.addMessageEvent(new zc(this.onNewFriendRequestEvent.bind(this))),t.addMessageEvent(new tm(this.onPetInfoEvent.bind(this))),t.addMessageEvent(new SS(this.onPetStatusUpdateEvent.bind(this))),t.addMessageEvent(new $p(this.onPetFigureUpdateEvent.bind(this))),t.addMessageEvent(new VE(this.onPetPlacingError.bind(this))),t.addMessageEvent(new bE(this.onBotError.bind(this))),t.addMessageEvent(new AS(this.onFavoriteMembershipUpdateMessageEvent.bind(this)))}onRoomUnitEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser().users,i=[];if(s&&s.length)for(const r of s){if(!r)continue;const t=new $L(r.roomIndex);t.name=r.name,t.custom=r.custom,t.activityPoints=r.activityPoints,t.figure=r.figure,t.type=r.userType,t.webID=r.webID,t.groupId=r.groupID,t.groupName=r.groupName,t.groupStatus=r.groupStatus,t.sex=r.sex,t.ownerId=r.ownerId,t.ownerName=r.ownerName,t.rarityLevel=r.rarityLevel,t.hasSaddle=r.hasSaddle,t.isRiding=r.isRiding,t.canBreed=r.canBreed,t.canHarvest=r.canHarvest,t.canRevive=r.canRevive,t.hasBreedingPermission=r.hasBreedingPermission,t.petLevel=r.petLevel,t.botSkills=r.botSkills,t.isModerator=r.isModerator,e.userDataManager.getUserData(r.roomIndex)||i.push(t),e.userDataManager.updateUserData(t)}this.listener.events.dispatchEvent(new zL(e,i))}onRoomUnitInfoEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&(e.userDataManager.updateFigure(s.unitId,s.figure,s.gender,!1,!1),e.userDataManager.updateMotto(s.unitId,s.motto),e.userDataManager.updateAchievementScore(s.unitId,s.achievementScore),this.listener.events.dispatchEvent(new WL(e,s.unitId,s.figure,s.gender,s.motto,s.achievementScore)))}onRoomUnitRemoveEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);e&&e.userDataManager.removeUserData(t.getParser().unitId)}onRoomUnitDanceEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new LL(s,e.unitId,e.danceId))}onUserCurrentBadgesEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.setUserBadges(e.userId,e.badges),this.listener.events.dispatchEvent(new YL(s,e.userId,e.badges)))}onRoomDoorbellEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new AL(AL.DOORBELL,i,s))}onUserNameChangeMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&s.userDataManager.updateName(e.id,e.newName)}onNewFriendRequestEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.request;this.listener.events.dispatchEvent(new PL(s,i.requestId,i.requesterUserId,i.requesterName))}onPetInfoEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=new JL;i.id=e.id,i.level=e.level,i.maximumLevel=e.maximumLevel,i.experience=e.experience,i.levelExperienceGoal=e.levelExperienceGoal,i.energy=e.energy,i.maximumEnergy=e.maximumEnergy,i.happyness=e.happyness,i.maximumHappyness=e.maximumHappyness,i.ownerId=e.ownerId,i.ownerName=e.ownerName,i.respect=e.respect,i.age=e.age,i.unknownRarity=e.unknownRarity,i.saddle=e.saddle,i.rider=e.rider,i.breedable=e.breedable,i.fullyGrown=e.fullyGrown,i.rarityLevel=e.rarityLevel,i.dead=e.dead,i.skillTresholds=e.skillTresholds,i.publiclyRideable=e.publiclyRideable,i.maximumTimeToLive=e.maximumTimeToLive,i.remainingTimeToLive=e.remainingTimeToLive,i.remainingGrowTime=e.remainingGrowTime,i.publiclyBreedable=e.publiclyBreedable,this.listener.events.dispatchEvent(new GL(s,i))}onPetStatusUpdateEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.updatePetBreedingStatus(e.roomIndex,e.canBreed,e.canHarvest,e.canRevive,e.hasBreedingPermission),this.listener.events.dispatchEvent(new jL(s,e.petId,e.canBreed,e.canHarvest,e.canRevive,e.hasBreedingPermission)))}onPetFigureUpdateEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.figureData.figuredata;s.userDataManager.updateFigure(e.roomIndex,i,"",e.hasSaddle,e.isRiding),this.listener.events.dispatchEvent(new BL(s,e.petId,i))}onPetPlacingError(t){if(!t)return;if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(e.errorCode){case 0:i=_L.RSEME_PETS_FORBIDDEN_IN_HOTEL;break;case 1:i=_L.RSEME_PETS_FORBIDDEN_IN_FLAT;break;case 2:i=_L.RSEME_MAX_PETS;break;case 3:i=_L.RSEME_NO_FREE_TILES_FOR_PET;break;case 4:i=_L.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET;break;case 5:i=_L.RSEME_MAX_NUMBER_OF_OWN_PETS}i&&0!=i.length&&this.listener.events.dispatchEvent(new _L(i,s))}onBotError(t){if(!t)return;if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(e.errorCode){case 0:i=_L.RSEME_BOTS_FORBIDDEN_IN_HOTEL;break;case 1:i=_L.RSEME_BOTS_FORBIDDEN_IN_FLAT;break;case 2:i=_L.RSEME_BOT_LIMIT_REACHED;break;case 3:i=_L.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT;break;case 4:i=_L.RSEME_BOT_NAME_NOT_ACCEPTED}i&&0!=i.length&&this.listener.events.dispatchEvent(new _L(i,s))}onFavoriteMembershipUpdateMessageEvent(t){if(!this.listener)return;const e=t.getParser(),s=this.listener.getSession(this.roomId);if(!s)return;const i=s.userDataManager.getUserDataByIndex(e.roomIndex);i&&(i.groupId=e.groupId,i.groupName=e.groupName,this.listener.events.dispatchEvent(new UL(s,e.roomIndex,e.groupId,e.status,e.groupName)))}}class eU extends dL{constructor(t,e){super(t,e),t.addMessageEvent(new XE(this.onQuestionEvent.bind(this))),t.addMessageEvent(new KE(this.onQuestionAnsweredEvent.bind(this))),t.addMessageEvent(new qE(this.onQuestionFinishedEvent.bind(this)))}onQuestionEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new qL(qL.QUESTION,e,s.pollId);i.question=s.question,i.duration=s.duration,i.pollType=s.pollType,i.questionId=s.questionId,i.pollId=s.pollId,this.listener.events.dispatchEvent(i)}onQuestionAnsweredEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new qL(qL.ANSWERED,e,s.userId);i.value=s.value,i.userId=s.userId,i.answerCounts=s.answerCounts,this.listener.events.dispatchEvent(i)}onQuestionFinishedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new qL(qL.FINISHED,e);i.questionId=s.questionId,i.answerCounts=s.answerCounts,this.listener.events.dispatchEvent(i)}}class sU{static getLocalizationKey(t){switch(t){case sU.FREE_TRADING:return"${trading.mode.free}";case sU.ROOM_CONTROLLER_REQUIRED:return"${trading.mode.controller}";case sU.NO_TRADING:return"${trading.mode.not.allowed}"}return""}}sU.NO_TRADING=0,sU.ROOM_CONTROLLER_REQUIRED=1,sU.FREE_TRADING=2;class iU extends c{constructor(){super(),this._connection=void 0,this._userDataByType=void 0,this._userDataByRoomIndex=void 0,this._userBadges=void 0,this._connection=null,this._userDataByType=new Map,this._userDataByRoomIndex=new Map,this._userBadges=new Map}onDispose(){this._connection=null}setConnection(t){this._connection=t}getUserData(t){return this.getDataByType(t,iU.TYPE_USER)}getPetData(t){return this.getDataByType(t,iU.TYPE_PET)}getBotData(t){return this.getDataByType(t,iU.TYPE_BOT)}getRentableBotData(t){return this.getDataByType(t,iU.TYPE_RENTABLE_BOT)}getDataByType(t,e){const s=this._userDataByType.get(e);if(!s)return null;const i=s.get(t);return i||null}getUserDataByIndex(t){const e=this._userDataByRoomIndex.get(t);return e||null}getUserDataByName(t){for(const e of this._userDataByRoomIndex.values())if(e&&e.name===t)return e;return null}updateUserData(t){if(!t)return;this.removeUserData(t.roomIndex);let e=this._userDataByType.get(t.type);e||(e=new Map,this._userDataByType.set(t.type,e)),e.set(t.webID,t),this._userDataByRoomIndex.set(t.roomIndex,t)}removeUserData(t){const e=this.getUserDataByIndex(t);if(!e)return;this._userDataByRoomIndex.delete(t);const s=this._userDataByType.get(e.type);s&&s.delete(e.webID)}getUserBadges(t){this._connection&&this._connection.send(new iS(t));const e=this._userBadges.get(t);return e||[]}setUserBadges(t,e){this._userBadges.set(t,e)}updateFigure(t,e,s,i,r){const n=this.getUserDataByIndex(t);n&&(n.figure=e,n.sex=s,n.hasSaddle=i,n.isRiding=r)}updateName(t,e){const s=this.getUserDataByIndex(t);s&&(s.name=e)}updateMotto(t,e){const s=this.getUserDataByIndex(t);s&&(s.custom=e)}updateAchievementScore(t,e){const s=this.getUserDataByIndex(t);s&&(s.activityPoints=e)}updatePetLevel(t,e){const s=this.getUserDataByIndex(t);s&&(s.petLevel=e)}updatePetBreedingStatus(t,e,s,i,r){const n=this.getUserDataByIndex(t);n&&(n.canBreed=e,n.canHarvest=s,n.canRevive=i,n.hasBreedingPermission=r)}requestPetInfo(t){if(!this._connection)return;this.getPetData(t)&&this._connection.send(new VO(t))}get connection(){return this._connection}}iU.TYPE_USER=1,iU.TYPE_PET=2,iU.TYPE_BOT=3,iU.TYPE_RENTABLE_BOT=4;class rU extends c{constructor(){super(),this._connection=void 0,this._userData=void 0,this._roomId=void 0,this._password=void 0,this._state=void 0,this._tradeMode=void 0,this._doorMode=void 0,this._allowPets=void 0,this._controllerLevel=void 0,this._ownRoomIndex=void 0,this._isGuildRoom=void 0,this._isRoomOwner=void 0,this._isDecorating=void 0,this._isSpectator=void 0,this._moderationSettings=void 0,this._connection=null,this._userData=new iU,this._roomId=0,this._password=null,this._state=ZS.CREATED,this._tradeMode=sU.NO_TRADING,this._doorMode=0,this._controllerLevel=Zo.NONE,this._ownRoomIndex=-1,this._isGuildRoom=!1,this._isRoomOwner=!1,this._isDecorating=!1,this._isSpectator=!1,this._moderationSettings=null}onDispose(){this._userData&&(this._userData.dispose(),this._userData=null),this._connection=null}setConnection(t){!this._connection&&t&&(this._connection=t,this._userData&&this._userData.setConnection(t))}setControllerLevel(t){t>=Zo.NONE&&t<=Zo.MODERATOR?this._controllerLevel=t:this._controllerLevel=Zo.NONE}setOwnRoomIndex(t){this._ownRoomIndex=t}setRoomOwner(){this._isRoomOwner=!0}start(){return!(this._state!==ZS.CREATED||!this._connection)&&(this._state=ZS.STARTED,this.enterRoom())}enterRoom(){return!!this._connection&&(this._connection.send(new uv(this._roomId,this._password)),!0)}reset(t){t!==this._roomId&&(this._roomId=t)}sendChatMessage(t,e){this._connection.send(new TA(t,e))}sendShoutMessage(t,e){this._connection.send(new RA(t,e))}sendWhisperMessage(t,e,s){this._connection.send(new OA(t,e,s))}sendChatTypingMessage(t){t?this._connection.send(new vA):this._connection.send(new AA)}sendMottoMessage(t){this._connection.send(new nS(t))}sendDanceMessage(t){this._connection.send(new NA(t))}sendExpressionMessage(t){this._connection.send(new SA(t))}sendSignMessage(t){t<0||t>17||this._connection.send(new UA(t))}sendPostureMessage(t){this._connection.send(new LA(t))}sendDoorbellApprovalMessage(t,e){this._connection.send(new dv(t,e))}sendAmbassadorAlertMessage(t){this._connection.send(new lv(t))}sendKickMessage(t){this._connection.send(new mv(t))}sendMuteMessage(t,e){this._connection.send(new Iv(t,e,this._roomId))}sendBanMessage(t,e){this._connection.send(new gv(t,this._roomId,e))}sendGiveRightsMessage(t){this._connection.send(new pv(t))}sendTakeRightsMessage(t){this._connection.send(new Tv(t))}sendPollStartMessage(t){this._connection.send(new KO(t))}sendPollRejectMessage(t){this._connection.send(new WO(t))}sendPollAnswerMessage(t,e,s){this._connection.send(new zO(t,e,s))}updateMoodlightData(t,e,s,i,r){let n="000000"+s.toString(16).toUpperCase();n="#"+n.substring(n.length-6),this.connection.send(new Vv(t,e,n,i,r))}toggleMoodlightState(){this.connection.send(new jv)}pickupPet(t){this._connection&&this._connection.send(new wv(t))}pickupBot(t){this._connection&&this._connection.send(new Mv(t))}requestMoodlightSettings(){this._connection&&this._connection.send(new Hv)}openGift(t){this._connection.send(new oA(t))}mountPet(t){this._connection.send(new xO(t,!0))}dismountPet(t){this._connection.send(new xO(t,!1))}usePetProduct(t,e){this._connection.send(new YO(t,e))}removePetSaddle(t){this._connection.send(new HO(t))}togglePetBreeding(t){this._connection.send(new jO(t))}togglePetRiding(t){this._connection.send(new kO(t))}useMultistateItem(t){this._connection.send(new tA(t))}harvestPet(t){this._connection.send(new Uv(t))}compostPlant(t){this._connection.send(new Cv(t))}get connection(){return this._connection}get userDataManager(){return this._userData}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get password(){return this._password}set password(t){this._password=t}get state(){return this._state}get isPrivateRoom(){return!0}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get controllerLevel(){return this._controllerLevel}get ownRoomIndex(){return this._ownRoomIndex}get isGuildRoom(){return this._isGuildRoom}set isGuildRoom(t){this._isGuildRoom=t}get isRoomOwner(){return this._isRoomOwner}get isDecorating(){return this._isDecorating}set isDecorating(t){this._isDecorating=t}get isSpectator(){return this._isSpectator}set isSpectator(t){this._isSpectator=t}get moderationSettings(){return this._moderationSettings}set moderationSettings(t){this._moderationSettings=t}}class nU extends M{constructor(t,e){super(),this._communication=void 0,this._roomEngine=void 0,this._handlers=void 0,this._sessions=void 0,this._pendingSession=void 0,this._sessionStarting=void 0,this._viewerSession=void 0,this._communication=t,this._roomEngine=e,this._handlers=[],this._sessions=new Map,this._pendingSession=null,this._sessionStarting=!1,this._viewerSession=null,this.onRoomEngineEvent=this.onRoomEngineEvent.bind(this)}onInit(){this.createHandlers(),this.processPendingSession(),this._roomEngine.events.addEventListener(YS.ENGINE_INITIALIZED,this.onRoomEngineEvent)}onDispose(){this._roomEngine.events.removeEventListener(YS.ENGINE_INITIALIZED,this.onRoomEngineEvent),super.onDispose()}createHandlers(){const t=this._communication&&this._communication.connection;t&&this._handlers.push(new EL(t,this),new mL(t,this),new RL(t,this),new fL(t,this),new NL(t,this),new tU(t,this),new vL(t,this),new uL(t,this),new eU(t,this),new lL(t,this))}setHandlers(t){if(this._handlers&&this._handlers.length)for(const e of this._handlers)e&&e.setRoomId(t.roomId)}onRoomEngineEvent(t){this.processPendingSession()}processPendingSession(){this._pendingSession&&this._roomEngine.ready&&(this.addSession(this._pendingSession),this._pendingSession=null)}getSession(t){const e=this._sessions.get(this.getRoomId(t));return e||null}createSession(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=new rU;return s.roomId=t,s.password=e,this.addSession(s)}addSession(t){return this._roomEngine.ready?(this._sessionStarting=!0,this._sessions.get(this.getRoomId(t.roomId))&&this.removeSession(t.roomId,!1),t.setConnection(this._communication.connection),this._sessions.set(this.getRoomId(t.roomId),t),this.events.dispatchEvent(new ZS(ZS.CREATED,t)),this._viewerSession=t,this.startSession(this._viewerSession),!0):(this._pendingSession=t,!1)}startSession(t){return t.state!==ZS.STARTED&&(this._sessionStarting=!1,t.start()?(this.events.dispatchEvent(new ZS(ZS.STARTED,t)),this.setHandlers(t),!0):(this.removeSession(t.roomId),!1))}removeSession(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),this.events.dispatchEvent(new ZS(ZS.ENDED,s,e)),s.dispose())}sessionUpdate(t,e){if(this.getSession(t))switch(e){case NL.RS_CONNECTED:case NL.RS_READY:return;case NL.RS_DISCONNECTED:return void this.removeSession(t)}}sessionReinitialize(t,e){const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),s.reset(e),this._sessions.set(this.getRoomId(e),s),this.setHandlers(s))}getRoomId(t){return"hard_coded_room_id"}get communication(){return this._communication}get roomEngine(){return this._roomEngine}get viewerSession(){return this._viewerSession}}class aU extends d{constructor(){super(aU.SETTINGS_UPDATED),this._volumeSystem=void 0,this._volumeFurni=void 0,this._volumeTrax=void 0,this._oldChat=void 0,this._roomInvites=void 0,this._cameraFollow=void 0,this._flags=void 0,this._chatType=void 0}clone(){const t=new aU;return t._volumeSystem=this._volumeSystem,t._volumeFurni=this._volumeFurni,t._volumeTrax=this._volumeTrax,t._oldChat=this._oldChat,t._roomInvites=this._roomInvites,t._cameraFollow=this._cameraFollow,t._flags=this._flags,t._chatType=this._chatType,t}get volumeSystem(){return this._volumeSystem}set volumeSystem(t){this._volumeSystem=t}get volumeFurni(){return this._volumeFurni}set volumeFurni(t){this._volumeFurni=t}get volumeTrax(){return this._volumeTrax}set volumeTrax(t){this._volumeTrax=t}get oldChat(){return this._oldChat}set oldChat(t){this._oldChat=t}get roomInvites(){return this._roomInvites}set roomInvites(t){this._roomInvites=t}get cameraFollow(){return this._cameraFollow}set cameraFollow(t){this._cameraFollow=t}get flags(){return this._flags}set flags(t){this._flags=t}get chatType(){return this._chatType}set chatType(t){this._chatType=t}}aU.SETTINGS_UPDATED="NSE_SETTINGS_UPDATED";class oU{constructor(t,e){this._image=void 0,this._placeHolder=void 0,this._image=t,this._placeHolder=e}get image(){return this._image}get placeHolder(){return this._placeHolder}}class hU{constructor(t){this._code=void 0,this._parts=void 0,this._code=t,this._parts=[]}get code(){return this._code}get parts(){return this._parts}}class _U{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.type=void 0,this.key=void 0,this.color=void 0,this.position=void 0,this.type=t,this.key=e,this.color=s,this.position=i}get code(){return 0===this.key?null:_U.getCode(this.type,this.key,this.color,this.position)}static getCode(t,e,s,i){return(t===_U.BASE?t:e>=100?_U.SYMBOL_ALT:_U.SYMBOL)+(e<10?"0":"")+(t===_U.BASE?e:e>=100?e-100:e)+(s<10?"0":"")+s+i}calculatePosition(t){const e=this.calculateGridPos(this.position);let s=_U.CELL_WIDTH*e.x+_U.CELL_WIDTH/2-t.width/2,i=_U.CELL_HEIGHT*e.y+_U.CELL_HEIGHT/2-t.height/2;return s<0&&(s=0),s+t.width>_U.IMAGE_WIDTH&&(s=_U.IMAGE_WIDTH-t.width),i<0&&(i=0),i+t.height>_U.IMAGE_HEIGHT&&(i=_U.IMAGE_HEIGHT-t.height),new k(Math.floor(s),Math.floor(i))}calculateGridPos(t){const e=new k;return e.x=Math.floor(t%3),e.y=Math.floor(t/3),e}}_U.BASE="b",_U.SYMBOL="s",_U.SYMBOL_ALT="t",_U.BASE_PART=0,_U.LAYER_PART=1,_U.IMAGE_WIDTH=39,_U.IMAGE_HEIGHT=39,_U.CELL_WIDTH=13,_U.CELL_HEIGHT=13;class dU{constructor(t,e){this._assets=void 0,this._sessionDataManager=void 0,this._messages=void 0,this._groupBases=void 0,this._groupSymbols=void 0,this._groupPartColors=void 0,this._requestedBadges=void 0,this._groupBadgesQueue=void 0,this._readyToGenerateGroupBadges=void 0,this._assets=t,this._sessionDataManager=e,this._groupBases=new Map,this._groupSymbols=new Map,this._groupPartColors=new Map,this._requestedBadges=new Map,this._groupBadgesQueue=new Map,this._readyToGenerateGroupBadges=!1}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new Qc(this.onGroupBadgePartsEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._sessionDataManager=null}getBadgeImage(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dU.NORMAL_BADGE,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.getBadgeTexture(t,e);return!i&&s&&(i=this.getBadgePlaceholder()),i}getBadgeInfo(t){const e=this.getBadgeTexture(t);return e?new oU(e,!1):new oU(this.getBadgePlaceholder(),!0)}loadBadgeImage(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dU.NORMAL_BADGE;return this._assets.getTexture(this.getBadgeUrl(t,e))?t:(this.getBadgeTexture(t,e),null)}getBadgeTexture(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dU.NORMAL_BADGE;const s=this.getBadgeUrl(t,e);if(!s||!s.length)return null;const i=this._assets.getTexture(s);if(i)return i.clone();if(e===dU.NORMAL_BADGE){if(this._requestedBadges.get(t))return null;this._requestedBadges.set(t,!0),this._assets.downloadAsset(s,(e=>{if(e){this._requestedBadges.delete(t);const e=this._assets.getTexture(s);e&&this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new QS(t,e.clone()))}}))}else if(e===dU.GROUP_BADGE){if(this._groupBadgesQueue.get(t))return;this._groupBadgesQueue.set(t,!0),this._readyToGenerateGroupBadges&&this.loadGroupBadge(t)}return null}getBadgePlaceholder(){const t=SU.instance.getConfiguration("images.url")+"/loading_icon.png",e=this._assets.getTexture(t);return e?e.clone():null}getBadgeUrl(t){let e=null;switch(arguments.length>1&&void 0!==arguments[1]?arguments[1]:dU.NORMAL_BADGE){case dU.NORMAL_BADGE:e=SU.instance.getConfiguration("badge.asset.url").replace("%badgename%",t);break;case dU.GROUP_BADGE:e=t}return e}loadGroupBadge(t){const e=new hU(t),s=[...t.matchAll(/[b|s][0-9]{4,6}/g)];for(const i of s){const t=i[0],s=6===t.length,r=t[0],n=parseInt(t.slice(1,s?3:4)),a=parseInt(t.slice(s?3:4,s?5:6)),o=t.length<6?0:parseInt(t.slice(s?5:6,s?6:7)),h=new _U(r,n,a,o);e.parts.push(h)}this.renderGroupBadge(e)}renderGroupBadge(t){const e=new H,s=new W(K.EMPTY);s.width=_U.IMAGE_WIDTH,s.height=_U.IMAGE_HEIGHT,e.addChild(s);for(const r of t.parts){let t=!0;const s="b"===r.type?this._groupBases.get(r.key):this._groupSymbols.get(r.key);if(s)for(const i of s){if(!i||!i.length)continue;const s=this._assets.getTexture(`badgepart_${i}`);if(!s)continue;const{x:n,y:a}=r.calculatePosition(s),o=new W(s);o.position.set(n,a),t&&(o.tint=parseInt(this._groupPartColors.get(r.color),16)),t=!1,e.addChild(o)}}this._requestedBadges.delete(t.code),this._groupBadgesQueue.delete(t.code);const i=At.generateTexture(e);this._assets.setTexture(t.code,i),this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new QS(t.code,i))}onGroupBadgePartsEvent(t){if(!t)return;const e=t.getParser();if(e){e.bases.forEach(((t,e)=>this._groupBases.set(e,t.map((t=>t.replace(".png","").replace(".gif","")))))),e.symbols.forEach(((t,e)=>this._groupSymbols.set(e,t.map((t=>t.replace(".png","").replace(".gif","")))))),this._groupPartColors=e.partColors,this._readyToGenerateGroupBadges=!0;for(const t of this._groupBadgesQueue.keys())this.loadGroupBadge(t)}}get disposed(){return!!this._sessionDataManager}}dU.GROUP_BADGE="group_badge",dU.NORMAL_BADGE="normal_badge";class uU{}uU.OLD_IDENTITY=0,uU.NEW_IDENTITY=1,uU.REAL_NOOB=2;class cU{}cU.SUPER_USER=9,cU.ADMINISTRATOR=8,cU.COMMUNITY=7,cU.PLAYER_SUPPORT=6,cU.MODERATOR=5,cU.EMPLOYEE=4,cU.BUS_PARTNER=3,cU.PARTNER=2,cU.CELEBRITY=1,cU.NONE=0;class lU{constructor(t,e,s,i,r,n,a,o,h,_,d,u,c,l,g,E,p,m,I,T,R,f,O,v,A,S,N,M,y){this._type=void 0,this._id=void 0,this._className=void 0,this._fullName=void 0,this._category=void 0,this._hasIndexedColor=void 0,this._colourIndex=void 0,this._revision=void 0,this._tileSizeX=void 0,this._tileSizeY=void 0,this._tileSizeZ=void 0,this._colors=void 0,this._localizedName=void 0,this._description=void 0,this._adUrl=void 0,this._purchaseOfferId=void 0,this._rentOfferId=void 0,this._customParams=void 0,this._specialType=void 0,this._purchaseCouldBeUsedForBuyout=void 0,this._rentCouldBeUsedForBuyout=void 0,this._availableForBuildersClub=void 0,this._canStandOn=void 0,this._canSitOn=void 0,this._canLayOn=void 0,this._excludedFromDynamic=void 0,this._furniLine=void 0,this._environment=void 0,this._rare=void 0,this._type=t,this._id=e,this._fullName=s,this._className=i,this._category=r,this._revision=o,this._tileSizeX=h,this._tileSizeY=_,this._tileSizeZ=d,this._colors=u,this._hasIndexedColor=c,this._colourIndex=l,this._localizedName=n,this._description=a,this._adUrl=g,this._purchaseOfferId=E,this._purchaseCouldBeUsedForBuyout=p,this._rentOfferId=m,this._rentCouldBeUsedForBuyout=I,this._customParams=R,this._specialType=f,this._availableForBuildersClub=T,this._canStandOn=O,this._canSitOn=v,this._canLayOn=A,this._excludedFromDynamic=S,this._furniLine=N,this._environment=M,this._rare=y}get type(){return this._type}get id(){return this._id}get className(){return this._className}set className(t){this._className=t}get fullName(){return this._fullName}get category(){return this._category}get hasIndexedColor(){return this._hasIndexedColor}get colorIndex(){return this._colourIndex}get revision(){return this._revision}get tileSizeX(){return this._tileSizeX}get tileSizeY(){return this._tileSizeY}get tileSizeZ(){return this._tileSizeZ}get colors(){return this._colors}get name(){return this._localizedName}get description(){return this._description}get adUrl(){return this._adUrl}get purchaseOfferId(){return this._purchaseOfferId}get customParams(){return this._customParams}get specialType(){return this._specialType}get rentOfferId(){return this._rentOfferId}get purchaseCouldBeUsedForBuyout(){return this._purchaseCouldBeUsedForBuyout}get rentCouldBeUsedForBuyout(){return this._rentCouldBeUsedForBuyout}get availableForBuildersClub(){return this._availableForBuildersClub}get canStandOn(){return this._canStandOn}get canSitOn(){return this._canSitOn}get canLayOn(){return this._canLayOn}get isExternalImage(){return!(-1===this._className.indexOf("external_image"))}get excludeDynamic(){return this._excludedFromDynamic}get furniLine(){return this._furniLine}get environment(){return this._environment}get rare(){return this._rare}}class gU extends g{constructor(t,e,s){super(),this._floorItems=void 0,this._wallItems=void 0,this._localization=void 0,this._nitroLogger=void 0,this._floorItems=t,this._wallItems=e,this._localization=s,this._nitroLogger=new l(this.constructor.name)}loadFurnitureData(t){t&&fetch(t).then((t=>t.json())).then((t=>this.onFurnitureDataLoaded(t))).catch((t=>this.onFurnitureDataError(t)))}onFurnitureDataLoaded(t){t&&("undefined"!=typeof t.roomitemtypes&&"undefined"!=typeof t.wallitemtypes||this._nitroLogger.warn("Could not find `roomitemtypes` or `wallitemtypes` in furnidata."),t.roomitemtypes&&this.parseFloorItems(t.roomitemtypes),t.wallitemtypes&&this.parseWallItems(t.wallitemtypes),this.dispatchEvent(new d(gU.FURNITURE_DATA_READY)))}onFurnitureDataError(t){t&&(console.error(t),this.dispatchEvent(new d(gU.FURNITURE_DATA_ERROR)))}parseFloorItems(t){if(t&&t.furnitype)for(const e of t.furnitype){if(!e)continue;const t=[];if(e.partcolors)for(const o of e.partcolors.color){let e=o;"#"===e.charAt(0)?(e=e.replace("#",""),t.push(parseInt(e,16))):t.push(parseInt(e,16))}const s=e.classname.split("*"),i=s[0],r=s.length>1?parseInt(s[1]):0,n=s.length>1,a=new lU(et.FLOOR,e.id,e.classname,i,e.category,e.name,e.description,e.revision,e.xdim,e.ydim,0,t,n,r,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,e.customparams,e.specialtype,e.canstandon,e.cansiton,e.canlayon,e.excludeddynamic,e.furniline,e.environment,e.rare);this._floorItems.set(a.id,a),this.updateLocalizations(a)}}parseWallItems(t){if(t&&t.furnitype)for(const e of t.furnitype){if(!e)continue;const t=new lU(et.WALL,e.id,e.classname,e.classname,e.category,e.name,e.description,e.revision,0,0,0,null,!1,0,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,null,e.specialtype,!1,!1,!1,e.excludeddynamic,e.furniline,e.environment,e.rare);this._wallItems.set(t.id,t),this.updateLocalizations(t)}}updateLocalizations(t){if(this._localization)switch(t.type){case et.FLOOR:return this._localization.setValue("roomItem.name."+t.id,t.name),void this._localization.setValue("roomItem.desc."+t.id,t.description);case et.WALL:return this._localization.setValue("wallItem.name."+t.id,t.name),void this._localization.setValue("wallItem.desc."+t.id,t.description)}}}gU.FURNITURE_DATA_READY="FDP_FURNITURE_DATA_READY",gU.FURNITURE_DATA_ERROR="FDP_FURNITURE_DATA_ERROR";class EU{constructor(t){this._sessionDataManager=void 0,this._groupBadges=void 0,this._messages=void 0,this._sessionDataManager=t,this._groupBadges=new Map}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new Qp(this.onRoomReadyMessageEvent.bind(this)),new Wm(this.onGroupBadgesEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._groupBadges=null,this._sessionDataManager=null}}onRoomReadyMessageEvent(t){this._sessionDataManager.send(new hS)}onGroupBadgesEvent(t){const e=t.getParser();for(const[s,i]of e.badges.entries())this._groupBadges.set(s,i)}getGroupBadge(t){return this._groupBadges.get(t)}get disposed(){return!!this._sessionDataManager}}class pU{constructor(t){this._sessionDataManager=void 0,this._ignoredUsers=void 0,this._messages=void 0,this._sessionDataManager=t,this._ignoredUsers=[]}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new Km(this.onIgnoredUsersEvent.bind(this)),new Xm(this.onIgnoreResultEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._sessionDataManager=null}}requestIgnoredUsers(){this._sessionDataManager.send(new $A(this._sessionDataManager.userName))}onIgnoredUsersEvent(t){if(!t)return;const e=t.getParser();e&&(this._ignoredUsers=e.ignoredUsers)}onIgnoreResultEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=e.name;switch(e.result){case 0:return;case 1:return void this.addUserToIgnoreList(s);case 2:return this.addUserToIgnoreList(s),void this._ignoredUsers.shift();case 3:return void this.removeUserFromIgnoreList(s)}}addUserToIgnoreList(t){this._ignoredUsers.indexOf(t)<0&&this._ignoredUsers.push(t)}removeUserFromIgnoreList(t){const e=this._ignoredUsers.indexOf(t);e>=0&&this._ignoredUsers.splice(e,1)}ignoreUserId(t){this._sessionDataManager.send(new eS(t))}ignoreUser(t){this._sessionDataManager.send(new tS(t))}unignoreUser(t){this._sessionDataManager.send(new sS(t))}isIgnored(t){return this._ignoredUsers.indexOf(t)>=0}get disposed(){return!!this._sessionDataManager}}class mU{constructor(t,e,s){this._type=void 0,this._name=void 0,this._description=void 0,this._type=t,this._name=e,this._description=s}get type(){return this._type}get name(){return this._name}get description(){return this._description}}class IU extends g{constructor(t){super(),this._products=void 0,this._products=t}dispose(){this._products=null}loadProductData(t){t&&fetch(t).then((t=>t.json())).then((t=>this.onProductDataLoadedEvent(t))).catch((t=>this.onProductDataError(t)))}onProductDataLoadedEvent(t){t&&(this.parseProducts(t.productdata),this.dispatchEvent(new d(IU.PDP_PRODUCT_DATA_READY)))}onProductDataError(t){t&&this.dispatchEvent(new d(IU.PDP_PRODUCT_DATA_FAILED))}parseProducts(t){if(t)for(const e of t.product)e&&this._products.set(e.code,new mU(e.code,e.name,e.description))}}IU.PDP_PRODUCT_DATA_READY="PDP_PRODUCT_DATA_READY",IU.PDP_PRODUCT_DATA_FAILED="PDP_PRODUCT_DATA_FAILED";class TU extends M{constructor(t){super(),this._communication=void 0,this._userId=void 0,this._name=void 0,this._figure=void 0,this._gender=void 0,this._realName=void 0,this._respectsReceived=void 0,this._respectsLeft=void 0,this._respectsPetLeft=void 0,this._canChangeName=void 0,this._ignoredUsersManager=void 0,this._groupInformationManager=void 0,this._clubLevel=void 0,this._securityLevel=void 0,this._isAmbassador=void 0,this._noobnessLevel=void 0,this._systemOpen=void 0,this._systemShutdown=void 0,this._isAuthenticHabbo=void 0,this._isRoomCameraFollowDisabled=void 0,this._uiFlags=void 0,this._floorItems=void 0,this._wallItems=void 0,this._products=void 0,this._furnitureData=void 0,this._productData=void 0,this._furnitureReady=void 0,this._productsReady=void 0,this._furnitureListenersNotified=void 0,this._pendingFurnitureListeners=void 0,this._pendingProductListeners=void 0,this._badgeImageManager=void 0,this._communication=t,this.resetUserInfo(),this._ignoredUsersManager=new pU(this),this._groupInformationManager=new EU(this),this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,this._noobnessLevel=-1,this._systemOpen=!1,this._systemShutdown=!1,this._isAuthenticHabbo=!1,this._isRoomCameraFollowDisabled=!1,this._uiFlags=0,this._floorItems=new Map,this._wallItems=new Map,this._products=new Map,this._furnitureData=null,this._furnitureReady=!1,this._productsReady=!1,this._furnitureListenersNotified=!1,this._pendingFurnitureListeners=[],this._pendingProductListeners=[],this._badgeImageManager=null,this.onFurnitureDataReadyEvent=this.onFurnitureDataReadyEvent.bind(this),this.onProductDataReadyEvent=this.onProductDataReadyEvent.bind(this),this.onNitroSettingsEvent=this.onNitroSettingsEvent.bind(this)}onInit(){this.loadFurnitureData(),this.loadProductData(),this.loadBadgeImageManager(),this._ignoredUsersManager&&this._ignoredUsersManager.init(),this._groupInformationManager&&this._groupInformationManager.init(),this._communication.registerMessageEvent(new Pu(this.onUserFigureEvent.bind(this))),this._communication.registerMessageEvent(new Hm(this.onUserInfoEvent.bind(this))),this._communication.registerMessageEvent(new Fm(this.onUserPermissionsEvent.bind(this))),this._communication.registerMessageEvent(new Su(this.onAvailabilityStatusMessageEvent.bind(this))),this._communication.registerMessageEvent(new Lu(this.onChangeNameUpdateEvent.bind(this))),this._communication.registerMessageEvent(new Vm(this.onUserNameChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new Qp(this.onRoomModelNameEvent.bind(this))),this._communication.registerMessageEvent(new qm(this.onInClientLinkEvent.bind(this))),this._communication.registerMessageEvent(new rE(this.onMysteryBoxKeysEvent.bind(this))),this._communication.registerMessageEvent(new Nl(this.onNoobnessLevelMessageEvent.bind(this))),SU.instance.events.addEventListener(aU.SETTINGS_UPDATED,this.onNitroSettingsEvent)}onDispose(){this.destroyFurnitureData(),this._ignoredUsersManager&&(this._ignoredUsersManager.dispose(),this._ignoredUsersManager=null),this._groupInformationManager&&(this._groupInformationManager.dispose(),this._groupInformationManager=null),SU.instance.events.removeEventListener(aU.SETTINGS_UPDATED,this.onNitroSettingsEvent),super.onDispose()}resetUserInfo(){this._userId=0,this._name=null,this._figure=null,this._gender=null,this._realName=null,this._canChangeName=!1}loadFurnitureData(){this.destroyFurnitureData(),this._furnitureData=new gU(this._floorItems,this._wallItems,SU.instance.localization),this._furnitureData.addEventListener(gU.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureData.loadFurnitureData(SU.instance.getConfiguration("furnidata.url"))}loadProductData(){this.destroyProductData(),this._productData=new IU(this._products),this._productData.addEventListener(IU.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productData.loadProductData(SU.instance.getConfiguration("productdata.url"))}loadBadgeImageManager(){this._badgeImageManager||(this._badgeImageManager=new dU(SU.instance.core.asset,this),this._badgeImageManager.init())}hasProductData(t){return!!this._productsReady||(t&&-1===this._pendingProductListeners.indexOf(t)&&this._pendingProductListeners.push(t),!1)}getAllFurnitureData(t){if(!this._furnitureReady)return-1===this._pendingFurnitureListeners.indexOf(t)&&this._pendingFurnitureListeners.push(t),null;const e=[];for(const s of this._floorItems.values())s&&e.push(s);for(const s of this._wallItems.values())s&&e.push(s);return e}removePendingFurniDataListener(t){if(!this._pendingFurnitureListeners)return;const e=this._pendingFurnitureListeners.indexOf(t);-1!==e&&this._pendingFurnitureListeners.splice(e,1)}onUserFigureEvent(t){t&&t.connection&&(this._figure=t.getParser().figure,this._gender=t.getParser().gender,LC.updateFigure(this._figure))}onUserInfoEvent(t){if(!t||!t.connection)return;this.resetUserInfo();const e=t.getParser().userInfo;e&&(this._userId=e.userId,this._name=e.username,this._figure=e.figure,this._gender=e.gender,this._realName=e.realName,this._respectsReceived=e.respectsReceived,this._respectsLeft=e.respectsRemaining,this._respectsPetLeft=e.respectsPetRemaining,this._canChangeName=e.canChangeName,this._ignoredUsersManager&&this._ignoredUsersManager.requestIgnoredUsers())}onUserPermissionsEvent(t){t&&t.connection&&(this._clubLevel=t.getParser().clubLevel,this._securityLevel=t.getParser().securityLevel,this._isAmbassador=t.getParser().isAmbassador)}onAvailabilityStatusMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&(this._systemOpen=e.isOpen,this._systemShutdown=e.onShutdown,this._isAuthenticHabbo=e.isAuthenticUser)}onChangeNameUpdateEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.resultCode===Lu.NAME_OK&&(this._canChangeName=!1,this.events.dispatchEvent(new ZL(e.name)))}onUserNameChangeMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.webId===this.userId&&(this._name=e.newName,this._canChangeName=!1,this.events.dispatchEvent(new ZL(this._name)))}onRoomModelNameEvent(t){if(!t)return;const e=t.getParser();e&&LC.roomVisited(e.roomId)}onFurnitureDataReadyEvent(t){if(this._furnitureData.removeEventListener(gU.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureReady=!0,!this._furnitureListenersNotified&&(this._furnitureListenersNotified=!0,this._pendingFurnitureListeners&&this._pendingFurnitureListeners.length))for(const e of this._pendingFurnitureListeners)e&&e.loadFurnitureData();this._pendingProductListeners=[]}onProductDataReadyEvent(t){this._productData.removeEventListener(IU.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productsReady=!0;for(const e of this._pendingProductListeners)e&&e.loadProductData();this._pendingProductListeners=[]}onInClientLinkEvent(t){if(!t)return;const e=t.getParser();e&&SU.instance.createLinkEvent(e.link)}onMysteryBoxKeysEvent(t){if(!t)return;const e=t.getParser();e&&this.events.dispatchEvent(new ML(e.boxColor,e.keyColor))}onNoobnessLevelMessageEvent(t){this._noobnessLevel=t.getParser().noobnessLevel,this._noobnessLevel!==uU.OLD_IDENTITY&&SU.instance.core.configuration.setValue("new.identity",1)}onNitroSettingsEvent(t){this._isRoomCameraFollowDisabled=t.cameraFollow,this._uiFlags=t.flags,this.events.dispatchEvent(new QL(this._uiFlags))}destroyFurnitureData(){this._furnitureData&&(this._furnitureData.dispose(),this._furnitureData=null)}destroyProductData(){this._productData&&(this._productData.dispose(),this._productData=null)}getFloorItemData(t){const e=this._floorItems.get(t);return e||null}getFloorItemDataByName(t){if(!t||!this._floorItems||!this._floorItems.size)return null;for(const e of this._floorItems.values())if(e&&e.className===t)return e}getWallItemData(t){const e=this._wallItems.get(t);return e||null}getWallItemDataByName(t){if(!t||!this._wallItems||!this._wallItems.size)return null;for(const e of this._wallItems.values())if(e&&e.className===t)return e}getProductData(t){return this._productsReady||this.loadProductData(),this._products.get(t)}getBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t)}getGroupBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t,dU.GROUP_BADGE)}getBadgeImage(t){return this._badgeImageManager.getBadgeImage(t)}getGroupBadgeImage(t){return this._badgeImageManager.getBadgeImage(t,dU.GROUP_BADGE)}loadBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t)}loadGroupBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t,dU.GROUP_BADGE)}hasSecurity(t){return this._securityLevel>=t}giveRespect(t){t<0||this._respectsLeft<=0||(this.send(new pS(t)),this._respectsLeft--)}givePetRespect(t){t<0||this._respectsPetLeft<=0||(this.send(new BO(t)),this._respectsPetLeft--)}sendSpecialCommandMessage(t){this.send(new TA(t))}ignoreUser(t){this._ignoredUsersManager&&this._ignoredUsersManager.ignoreUser(t)}unignoreUser(t){this._ignoredUsersManager&&this._ignoredUsersManager.unignoreUser(t)}isUserIgnored(t){return this._ignoredUsersManager&&this._ignoredUsersManager.isIgnored(t)}getGroupBadge(t){return this._groupInformationManager&&this._groupInformationManager.getGroupBadge(t)}send(t){this._communication.connection.send(t)}get communication(){return this._communication}get userId(){return this._userId}get userName(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get realName(){return this._realName}get ignoredUsersManager(){return this._ignoredUsersManager}get groupInformationManager(){return this._groupInformationManager}get respectsReceived(){return this._respectsReceived}get respectsLeft(){return this._respectsLeft}get respectsPetLeft(){return this._respectsPetLeft}get canChangeName(){return this._canChangeName}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}get isNoob(){return this._noobnessLevel!==uU.OLD_IDENTITY}get isRealNoob(){return this._noobnessLevel===uU.REAL_NOOB}get isSystemOpen(){return this._systemOpen}get isSystemShutdown(){return this._systemShutdown}get isAuthenticHabbo(){return this._isAuthenticHabbo}get isModerator(){return this._securityLevel>=cU.MODERATOR}get isCameraFollowDisabled(){return this._isRoomCameraFollowDisabled}get uiFlags(){return this._uiFlags}}class RU extends d{constructor(t,e){super(t),this._sampleCode=void 0,this._sampleCode=e}get sampleCode(){return this._sampleCode}}RU.PLAY_SOUND="NSOE_PLAY_SOUND";class fU extends d{constructor(t){super(t)}}fU.TRAX_SONG_COMPLETE="SME_TRAX_SONG_COMPLETE";class OU{}OU.PRIORITY_ROOM_PLAYLIST=0,OU.PRIORITY_USER_PLAYLIST=1,OU.PRIORITY_SONG_PLAY=2,OU.PRIORITY_PURCHASE_PREVIEW=3,OU.PRIORITY_COUNT=4;class vU extends M{constructor(){super(),this._timerInstance=void 0,this._songRequestList=void 0,this._requestedSongs=void 0,this._availableSongs=void 0,this._songRequestsPerPriority=void 0,this._currentEntryId=void 0,this._playPosition=void 0,this._isPlaying=void 0,this._timerInstance=null,this._songRequestList=[],this._requestedSongs=new Map,this._availableSongs=new Map,this._songRequestsPerPriority=[],this._currentEntryId=-1,this._playPosition=-1,this._isPlaying=!1,this.onEvent=this.onEvent.bind(this),this._timerInstance=setInterval(this.onTick.bind(this),1e3)}onInit(){SU.instance.communication.connection.addMessageEvent(new lu(this.onEvent)),SU.instance.communication.connection.addMessageEvent(new gu(this.onEvent)),SU.instance.communication.connection.addMessageEvent(new ou(this.onNowPlayingMessageEvent.bind(this))),SU.instance.communication.connection.addMessageEvent(new au(this.onEvent)),SU.instance.communication.connection.addMessageEvent(new nu(this.onEvent)),SU.instance.roomEngine.events.addEventListener(fN.JUKEBOX_INIT,this.onEvent),SU.instance.roomEngine.events.addEventListener(fN.JUKEBOX_DISPOSE,this.onEvent),SU.instance.roomEngine.events.addEventListener(fN.SOUND_MACHINE_INIT,this.onEvent),SU.instance.roomEngine.events.addEventListener(fN.SOUND_MACHINE_DISPOSE,this.onEvent),this.events.addEventListener(fU.TRAX_SONG_COMPLETE,this.onEvent)}onDispose(){this._timerInstance&&(clearInterval(this._timerInstance),this._timerInstance=null),SU.instance.communication.connection.removeMessageEvent(new lu(this.onEvent)),SU.instance.communication.connection.removeMessageEvent(new gu(this.onEvent)),SU.instance.communication.connection.removeMessageEvent(new ou(this.onNowPlayingMessageEvent.bind(this))),SU.instance.communication.connection.removeMessageEvent(new au(this.onEvent)),SU.instance.communication.connection.removeMessageEvent(new nu(this.onEvent)),SU.instance.roomEngine.events.removeEventListener(fN.JUKEBOX_INIT,this.onEvent),SU.instance.roomEngine.events.removeEventListener(fN.JUKEBOX_DISPOSE,this.onEvent),SU.instance.roomEngine.events.removeEventListener(fN.SOUND_MACHINE_INIT,this.onEvent),SU.instance.roomEngine.events.removeEventListener(fN.SOUND_MACHINE_DISPOSE,this.onEvent),this.events.removeEventListener(fU.TRAX_SONG_COMPLETE,this.onEvent)}onEvent(t){}onTraxSongInfoMessageEvent(t){const e=t.getParser();for(const s of e.songs){const t=null!==this._availableSongs.get(s.id);this._requestedSongs.get(s.id);if(!t){const t=new cu(s.id,s.length,s.name,s.creator,s.data);this._availableSongs.set(s.id,t);const e=this.getTopRequestPriority();this.getSongIdRequestedAtPriority(e)}}}onNowPlayingMessageEvent(t){const e=t.getParser();this._isPlaying=-1!==e.currentSongId,e.currentSongId>=0?this.playSong(e.currentSongId,OU.PRIORITY_ROOM_PLAYLIST,e.syncCount/1e3,0,1,1):this.stopPlaying(),e.nextSongId>=0&&this.requestSong(e.nextSongId,!0),this._playPosition=e.currentPosition}onTick(){0!==this._songRequestList.length&&(SU.instance.communication.connection.send(new YA(...this._songRequestList)),this._songRequestList=[])}requestSong(t,e){null===this._requestedSongs.get(t)&&(this._requestedSongs.set(t,e),this._songRequestList.push(t))}playSong(t,e){}stopPlaying(){this._currentEntryId=-1,this._playPosition=-1,this._isPlaying=!1}getTopRequestPriority(){return this._songRequestsPerPriority.length-1}getSongIdRequestedAtPriority(t){return t<0||t>=OU.PRIORITY_COUNT?-1:this._songRequestsPerPriority[t]?this._songRequestsPerPriority[t].songId:-1}get playPosition(){return this._playPosition}set playPosition(t){this._playPosition=t}}vU.SKIP_POSITION_SET=-1,vU.MAXIMUM_NOTIFY_PRIORITY=OU.PRIORITY_ROOM_PLAYLIST;class AU extends M{constructor(){super(),this._volumeSystem=void 0,this._volumeFurni=void 0,this._volumeTrax=void 0,this._internalSamples=void 0,this._furniSamples=void 0,this._furnitureBeingPlayed=void 0,this._musicManager=void 0,this._volumeSystem=.5,this._volumeFurni=.5,this._volumeTrax=.5,this._internalSamples=new U,this._furniSamples=new U,this._furnitureBeingPlayed=new U,this._musicManager=new vU,this.onEvent=this.onEvent.bind(this)}onInit(){this._musicManager.init(),SU.instance.roomEngine.events.addEventListener(oN.PLAY_SAMPLE,this.onEvent),SU.instance.roomEngine.events.addEventListener(sN.REMOVED,this.onEvent),SU.instance.roomEngine.events.addEventListener(YS.DISPOSED,this.onEvent),SU.instance.events.addEventListener(aU.SETTINGS_UPDATED,this.onEvent),SU.instance.events.addEventListener(RU.PLAY_SOUND,this.onEvent)}onDispose(){this._musicManager&&(this._musicManager.dispose(),this._musicManager=null),SU.instance.roomEngine.events.removeEventListener(oN.PLAY_SAMPLE,this.onEvent),SU.instance.roomEngine.events.removeEventListener(sN.REMOVED,this.onEvent),SU.instance.roomEngine.events.removeEventListener(YS.DISPOSED,this.onEvent),SU.instance.events.removeEventListener(aU.SETTINGS_UPDATED,this.onEvent),SU.instance.events.removeEventListener(RU.PLAY_SOUND,this.onEvent)}onEvent(t){switch(t.type){case oN.PLAY_SAMPLE:{const e=t;return void this.playFurniSample(e.objectId,e.sampleId,e.pitch)}case sN.REMOVED:{const e=t;return void this.stopFurniSample(e.objectId)}case YS.DISPOSED:return void this._furnitureBeingPlayed.getKeys().forEach((t=>{this.stopFurniSample(t)}));case aU.SETTINGS_UPDATED:{const e=t,s=e.volumeFurni!==this._volumeFurni;return this._volumeSystem=e.volumeSystem/100,this._volumeFurni=e.volumeFurni/100,this._volumeTrax=e.volumeTrax/100,void(s&&this.updateFurniSamplesVolume(this._volumeFurni))}case RU.PLAY_SOUND:{const e=t;return void this.playInternalSample(e.sampleCode)}}}playSample(t,e){t.volume=e,t.currentTime=0;try{t.play()}catch(s){console.log(s)}}playInternalSample(t){let e=this._internalSamples.getValue(t);if(!e){const s=SU.instance.getConfiguration("sounds.url");e=new Audio(s.replace("%sample%",t)),this._internalSamples.add(t,e)}this.playSample(e,this._volumeSystem)}playFurniSample(t,e,s){let i=this._furniSamples.getValue(e);if(!i){const t=SU.instance.getConfiguration("external.samples.url");i=new Audio(t.replace("%sample%",e.toString())),this._furniSamples.add(e,i)}this._furnitureBeingPlayed.hasKey(t)||this._furnitureBeingPlayed.add(t,e),i.onended=e=>{this.stopFurniSample(t)},i.onpause=e=>{this.stopFurniSample(t)},i.onerror=e=>{this.stopFurniSample(t)},this.playSample(i,this._volumeFurni,s)}stopInternalSample(t){const e=this._internalSamples.getValue(t);if(e)try{e.pause()}catch(s){console.log(s)}}stopFurniSample(t){const e=this._furnitureBeingPlayed.getValue(t);if(!e)return;const s=this._furniSamples.getValue(e);if(this._furnitureBeingPlayed.remove(t),s)try{s.pause()}catch(i){console.log(i)}}updateInternalSamplesVolume(t){this._internalSamples.getValues().forEach((e=>{e.volume=t}))}updateFurniSamplesVolume(t){this._furniSamples.getValues().forEach((e=>{e.volume=t}))}get musicManager(){return this._musicManager}}wS.available,h.b.SCALE_MODE=window.devicePixelRatio%1?o.p.LINEAR:o.p.NEAREST,h.b.ROUND_PIXELS=!0;class SU extends a.a{constructor(t,e){super(e),this._nitroTimer=void 0,this._worker=void 0,this._core=void 0,this._events=void 0,this._communication=void 0,this._localization=void 0,this._avatar=void 0,this._roomEngine=void 0,this._sessionDataManager=void 0,this._roomSessionManager=void 0,this._roomManager=void 0,this._cameraManager=void 0,this._soundManager=void 0,this._linkTrackers=void 0,this._workerTrackers=void 0,this._isReady=void 0,this._isDisposed=void 0,SU.INSTANCE||(SU.INSTANCE=this),this._nitroTimer=new C,this._worker=null,this._core=t,this._events=new g,this._communication=new bS(t.communication),this._localization=new GS(this._communication),this._avatar=new Me,this._roomEngine=new oL(this._communication),this._sessionDataManager=new TU(this._communication),this._roomSessionManager=new nU(this._communication,this._roomEngine),this._roomManager=new lt(this._roomEngine,this._roomEngine.visualizationFactory,this._roomEngine.logicFactory),this._cameraManager=new _s,this._soundManager=new AU,this._linkTrackers=[],this._workerTrackers=[],this._isReady=!1,this._isDisposed=!1,this._core.configuration.events.addEventListener(u.LOADED,this.onConfigurationLoadedEvent.bind(this)),this._roomEngine.events.addEventListener(YS.ENGINE_INITIALIZED,this.onRoomEngineReady.bind(this)),this._worker&&(this._worker.onmessage=this.createWorkerEvent.bind(this))}static bootstrap(){SU.INSTANCE&&(SU.INSTANCE.dispose(),SU.INSTANCE=null);const t=document.createElement("canvas"),e=new this(new D,{autoDensity:!1,resolution:window.devicePixelRatio,width:window.innerWidth,height:window.innerHeight,view:t});t.addEventListener("webglcontextlost",(()=>e.events.dispatchEvent(new d(SU.WEBGL_CONTEXT_LOST))))}init(){if(!this._isReady&&!this._isDisposed){if(this._avatar&&this._avatar.init(),this._soundManager&&this._soundManager.init(),this._roomEngine&&(this._roomEngine.sessionDataManager=this._sessionDataManager,this._roomEngine.roomSessionManager=this._roomSessionManager,this._roomEngine.roomManager=this._roomManager,this._sessionDataManager&&this._sessionDataManager.init(),this._roomSessionManager&&this._roomSessionManager.init(),this._roomEngine.init()),!this._communication.connection)throw new Error("No connection found");new FS(this._communication.connection),this._isReady=!0}}dispose(){this._isDisposed||(this._roomManager&&(this._roomManager.dispose(),this._roomManager=null),this._roomSessionManager&&(this._roomSessionManager.dispose(),this._roomSessionManager=null),this._sessionDataManager&&(this._sessionDataManager.dispose(),this._sessionDataManager=null),this._roomEngine&&(this._roomEngine.dispose(),this._roomEngine=null),this._avatar&&(this._avatar.dispose(),this._avatar=null),this._soundManager&&(this._soundManager.dispose(),this._soundManager=null),this._communication&&(this._communication.dispose(),this._communication=null),super.destroy(),this._isDisposed=!0,this._isReady=!1)}onConfigurationLoadedEvent(t){const e=this.getConfiguration("system.animation.fps",24);this.getConfiguration("system.limits.fps",!0)&&(SU.instance.ticker.maxFPS=e)}onRoomEngineReady(t){this.startSendingHeartBeat()}getConfiguration(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._core.configuration.getValue(t,e)}getLocalization(t){return this._localization.getValue(t)}getLocalizationWithParameter(t,e,s){return this._localization.getValueWithParameter(t,e,s)}getLocalizationWithParameters(t,e,s){return this._localization.getValueWithParameters(t,e,s)}addWorkerEventTracker(t){this._workerTrackers.indexOf(t)>=0||this._workerTrackers.push(t)}removeWorkerEventTracker(t){const e=this._workerTrackers.indexOf(t);-1!==e&&this._workerTrackers.splice(e,1)}createWorkerEvent(t){if(!t)return;const e=t.data;for(const s of this._workerTrackers)s&&s.workerMessageReceived(e)}sendWorkerEvent(t){t&&this._worker&&this._worker.postMessage(t)}addLinkEventTracker(t){this._linkTrackers.indexOf(t)>=0||this._linkTrackers.push(t)}removeLinkEventTracker(t){const e=this._linkTrackers.indexOf(t);-1!==e&&this._linkTrackers.splice(e,1)}createLinkEvent(t){if(t&&""!==t)for(const e of this._linkTrackers){if(!e)continue;const s=e.eventUrlPrefix;s.length>0?t.substr(0,s.length)===s&&e.linkReceived(t):e.linkReceived(t)}}startSendingHeartBeat(){this.sendHeartBeat(),setInterval(this.sendHeartBeat,1e4)}sendHeartBeat(){LC.sendHeartBeat()}setWorker(t){this._worker=t,this._worker.onmessage=this.createWorkerEvent.bind(this)}get nitroTimer(){return this._nitroTimer}get core(){return this._core}get events(){return this._events}get localization(){return this._localization}get communication(){return this._communication}get avatar(){return this._avatar}get roomEngine(){return this._roomEngine}get sessionDataManager(){return this._sessionDataManager}get roomSessionManager(){return this._roomSessionManager}get roomManager(){return this._roomManager}get cameraManager(){return this._cameraManager}get soundManager(){return this._soundManager}get width(){return this.renderer.width}get height(){return this.renderer.height}get ticker(){return _.a.shared}get time(){return this.ticker.lastTime}get isReady(){return this._isReady}get isDisposed(){return this._isDisposed}static get instance(){return this.INSTANCE||null}}SU.WEBGL_CONTEXT_LOST="NE_WEBGL_CONTEXT_LOST",SU.WEBGL_UNAVAILABLE="NE_WEBGL_UNAVAILABLE",SU.READY="NE_READY!",SU.INSTANCE=null;class NU{constructor(t,e){if(this._referenceCount=void 0,this._referenceTimestamp=void 0,this._name=void 0,this._baseTexture=void 0,this._data=void 0,this._textures=void 0,this._assets=void 0,this._palettes=void 0,this._paletteAssetNames=void 0,!t)throw new Error("invalid_collection");this._name=t.name,this._baseTexture=e&&e.baseTexture||null,this._data=t,this._textures=new Map,this._assets=new Map,this._palettes=new Map,this._paletteAssetNames=[],e&&this.addLibraryAsset(e.textures),this.define(t)}dispose(){if(this._palettes){for(const t of this._palettes.values())t.dispose();this._palettes.clear()}if(this._paletteAssetNames&&(this.disposePaletteAssets(),this._paletteAssetNames=null),this._assets){for(const t of this._assets.values())t.recycle();this._assets.clear()}}addReference(){this._referenceCount++,this._referenceTimestamp=SU.instance.time}removeReference(){this._referenceCount--,this._referenceCount<=0&&(this._referenceCount=0,this._referenceTimestamp=SU.instance.time,this.disposePaletteAssets(!1))}define(t){const e=t.assets,s=t.palettes;e&&this.defineAssets(e),s&&this.definePalettes(s)}defineAssets(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=-s.x||0,r=-s.y||0;let n=!1;const a=!1,o=s.usesPalette||!1;let h=s.source||"";s.flipH&&h.length&&(n=!0),h.length||(h=e);const _=this.getLibraryAsset(h);if(!_)continue;let d=this.createAsset(e,h,_,n,a,i,r,o);if(!d){const t=this.getAsset(e);t&&t.name!==t.source&&(d=this.replaceAsset(e,h,_,n,a,i,r,o))}}}definePalettes(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id.toString();if(this._palettes.get(i))continue;let r=16777215,n=16777215,a=s.color1;a&&a.length>0&&(r=parseInt(a,16)),a=s.color2,a&&a.length>0&&(n=parseInt(a,16)),this._palettes.set(i,new qe(s.rgb,r,n))}}createAsset(t,e,s,i,r,n,a,o){if(this._assets.get(t))return!1;const h=Be.createAsset(t,e,s,n,a,i,r,o);return this._assets.set(t,h),!0}replaceAsset(t,e,s,i,r,n,a,o){const h=this._assets.get(t);return h&&(this._assets.delete(t),h.recycle()),this.createAsset(t,e,s,i,r,n,a,o)}getAsset(t){if(!t)return null;const e=this._assets.get(t);return e||null}getAssetWithPalette(t,e){const s=t+"@"+e;let i=this.getAsset(s);if(!i){if(i=this.getAsset(t),!i||!i.usesPalette)return i;const r=this.getPalette(e);if(r){const t=r.applyPalette(i.texture);t&&(this._paletteAssetNames.push(s),this.createAsset(s,i.source+"@"+e,t,i.flipH,i.flipV,i.x,i.y,!1),i=this.getAsset(s))}}return i}getTexture(t){return this._textures.get(t)}getPaletteNames(){return Array.from(this._palettes.keys())}getPaletteColors(t){const e=this.getPalette(t);return e?[e.primaryColor,e.secondaryColor]:null}getPalette(t){if(!t)return null;const e=this._palettes.get(t);return e||null}addAsset(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!t||!e)return!1;const o=this.getLibraryAsset(t);return o?!!s&&(o.baseTexture=e.baseTexture,o.frame=e.frame,o.trim=e.trim,o.updateUvs(),!0):(this._textures.set(t,e),this.createAsset(t,t,e,n,a,i,r,!1))}disposeAsset(t){const e=this._assets.get(t);if(!e)return;this._assets.delete(t);const s=this.getLibraryAsset(e.source);s&&(this._textures.delete(e.source),s.destroy(!0)),e.recycle()}getLibraryAsset(t){if(!t)return null;t=this._name+"_"+t;const e=this._textures.get(t);return e||null}addLibraryAsset(t){if(t)for(const e in t){const s=t[e];s&&this._textures.set(MU.removeFileExtension(e),s)}}disposePaletteAssets(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._paletteAssetNames&&(t||this._paletteAssetNames.length>NU.PALETTE_ASSET_DISPOSE_THRESHOLD)){for(const t of this._paletteAssetNames)this.disposeAsset(t);this._paletteAssetNames=[]}}get referenceCount(){return this._referenceCount}get referenceTimestamp(){return this._referenceTimestamp}get name(){return this._name}get baseTexture(){return this._baseTexture}get data(){return this._data}get textures(){return this._textures}get assets(){return this._assets}}NU.PALETTE_ASSET_DISPOSE_THRESHOLD=10;class MU extends c{constructor(){super(),this._logger=void 0,this._textures=void 0,this._collections=void 0,this._logger=new l(this.constructor.name),this._textures=new Map,this._collections=new Map}static removeFileExtension(t){return t.substring(0,t.lastIndexOf("."))||t}getTexture(t){if(!t)return null;const e=this._textures.get(t);return e||null}setTexture(t,e){t&&e&&this._textures.set(t,e)}getAsset(t){if(!t)return null;for(const e of this._collections.values()){if(!e)continue;const s=e.getAsset(t);if(s)return s}return null}getCollection(t){if(!t)return null;const e=this._collections.get(t);return e||null}createCollection(t,e){if(!t)return null;const s=new NU(t,e);if(s){for(const[t,e]of s.textures.entries())this.setTexture(t,e);this._collections.set(s.name,s)}return s}downloadAsset(t,e){this.downloadAssets([t],e)}downloadAssets(t,e){if(!t||!t.length)return void e(!0);const s=new r.b;for(const i of t)i&&s.add({url:i,crossOrigin:"anonymous",loadType:r.c.LOAD_TYPE.XHR,xhrType:r.c.XHR_RESPONSE_TYPE.BUFFER});let n=t.length;const a=(t,i)=>t?(n--,n?void 0:(s.destroy(),void e(!0))):(this._logger.error("Failed to download asset",i),s.destroy(),void e(!1));s.load(((t,e)=>{for(const s in e){const t=e[s];if(!t||t.error||!t.xhr)return void a(!1,t.url);const r=t.xhr.getResponseHeader("Content-Type")||"application/octet-stream";if("application/octet-stream"!==r)if("image/png"!==r&&"image/jpeg"!==r&&"image/gif"!==r)a(!1,t.url);else{const e=P(t.data),s=new i.c(`data:${r};base64,${e}`);if(s.valid){const e=new i.t(s);this.setTexture(t.name,e),a(!0,t.url)}else s.once("update",(()=>{const e=new i.t(s);this.setTexture(t.name,e),a(!0,t.url)}))}else{const e=new J(t.data);this.processAsset(e.baseTexture,e.jsonFile,(e=>{a(e,t.url)}))}}}))}processAsset(t,e,s){const i=e.spritesheet;if(!t||!i||!Object.keys(i).length)return this.createCollection(e,null),void s(!0);const r=()=>{const r=new n.a(t,i);r.parse((()=>{this.createCollection(e,r),s(!0)}))};t.valid?r():t.once("update",(()=>r()))}get collections(){return this._collections}}class yU{}yU.RENDERER_VERSION="1.3.4",yU.UI_VERSION="";class DU{constructor(t,e){this._effect=void 0,this._alpha=void 0,this._effect=t,this._alpha=e}get effect(){return this._effect}get alpha(){return this._alpha}}class CU{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._roomEngine=void 0,this._planeParser=void 0,this._previewRoomId=1,this._currentPreviewObjectType=0,this._currentPreviewObjectCategory=0,this._currentPreviewObjectData="",this._currentPreviewRectangle=null,this._currentPreviewCanvasWidth=0,this._currentPreviewCanvasHeight=0,this._currentPreviewScale=64,this._currentPreviewNeedsZoomOut=void 0,this._automaticStateChange=void 0,this._previousAutomaticStateChangeTime=void 0,this._addViewOffset=void 0,this._backgroundColor=305148561,this._backgroundSprite=null,this._disableUpdate=!1,this._roomEngine=t,this._planeParser=new jh,this._previewRoomId=ze.makeRoomPreviewerId(e),this._addViewOffset=new j.g(0,0),this.onRoomObjectAdded=this.onRoomObjectAdded.bind(this),this.onRoomInitializedonRoomInitialized=this.onRoomInitializedonRoomInitialized.bind(this),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.addEventListener(sN.ADDED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(sN.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(YS.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this.createRoomForPreview()}dispose(){this.reset(!0),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.removeEventListener(sN.ADDED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(sN.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(YS.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this._backgroundSprite&&(this._backgroundSprite.destroy(),this._backgroundSprite=null),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}createRoomForPreview(){if(this.isRoomEngineReady){const t=7,e=new jh;e.initializeTileMap(t+2,t+2);let s=1;for(;s<1+t;){let i=1;for(;i<1+t;)e.setTileHeight(i,s,0),i++;s++}e.initializeFromTileData(),this._roomEngine.createRoomInstance(this._previewRoomId,e.getMapData()),e.dispose()}}reset(t){this.isRoomEngineReady&&(this._roomEngine.removeRoomObjectFloor(this._previewRoomId,CU.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectWall(this._previewRoomId,CU.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectUser(this._previewRoomId,CU.PREVIEW_OBJECT_ID),t||this.updatePreviewRoomView()),this._currentPreviewObjectCategory=st.MINIMUM}updatePreviewModel(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=new kh;i.flush(),i.parseModel(t,e,s);const r=this._roomEngine.getLegacyWallGeometry(this._previewRoomId);if(!r)return;this._planeParser.reset();const n=i.width,a=i.height;this._planeParser.initializeTileMap(n,a);let o=-1,h=-1,_=0,d=0,u=0;for(;u<a;){let t=0;for(;t<n;){const e=i.getHeight(t,u);(u>0&&u<a-1||t>0&&t<n-1)&&e!=jh.TILE_BLOCKED&&(i.getHeight(t,u-1)==jh.TILE_BLOCKED&&i.getHeight(t-1,u)==jh.TILE_BLOCKED&&i.getHeight(t,u+1)==jh.TILE_BLOCKED&&(o=t+.5,h=u,_=e,d=90),i.getHeight(t,u-1)==jh.TILE_BLOCKED&&i.getHeight(t-1,u)==jh.TILE_BLOCKED&&i.getHeight(t+1,u)==jh.TILE_BLOCKED&&(o=t,h=u+.5,_=e,d=180)),this._planeParser.setTileHeight(t,u,e),t++}u++}this._planeParser.setTileHeight(Math.floor(o),Math.floor(h),_),this._planeParser.initializeFromTileData(i.wallHeight),this._planeParser.setTileHeight(Math.floor(o),Math.floor(h),_+this._planeParser.wallHeight),r.scale=cD.DEFAULT_SCALE,r.initialize(n,a,this._planeParser.floorHeight);let c=i.height-1;for(;c>=0;){let t=i.width-1;for(;t>=0;)r.setHeight(t,c,this._planeParser.getTileHeight(t,c)),t--;c--}const l=this._planeParser.getMapData();l.doors.push({x:o,y:h,z:_,dir:d});const g=this.getRoomPreviewOwnRoomObject();g&&g.processUpdateMessage(new JD(l))}addFurnitureIntoRoom(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(s||(s=new la),this.isRoomEngineReady&&(this.reset(!1),this._currentPreviewObjectType=t,this._currentPreviewObjectCategory=st.FLOOR,this._currentPreviewObjectData="",this._roomEngine.addFurnitureFloor(this._previewRoomId,CU.PREVIEW_OBJECT_ID,t,new dt(CU.PREVIEW_OBJECT_LOCATION_X,CU.PREVIEW_OBJECT_LOCATION_Y,0),e,0,s,NaN,-1,0,-1,"",!0,!1))){this._previousAutomaticStateChangeTime=SU.instance.time,this._automaticStateChange=!0;const t=this._roomEngine.getRoomObject(this._previewRoomId,CU.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);return t&&i&&t.model.setValue(rt.FURNITURE_EXTRAS,i),this.updatePreviewRoomView(),CU.PREVIEW_OBJECT_ID}return-1}addWallItemIntoRoom(t,e,s){if(this.isRoomEngineReady){if(this._currentPreviewObjectCategory===st.WALL&&this._currentPreviewObjectType===t&&this._currentPreviewObjectData===s)return CU.PREVIEW_OBJECT_ID;if(this.reset(!1),this._currentPreviewObjectType=t,this._currentPreviewObjectCategory=st.WALL,this._currentPreviewObjectData=s,this._roomEngine.addFurnitureWall(this._previewRoomId,CU.PREVIEW_OBJECT_ID,t,new dt(.5,2.3,1.8),e,0,s,0,0,-1,"",!1))return this._previousAutomaticStateChangeTime=SU.instance.time,this._automaticStateChange=!0,this.updatePreviewRoomView(),CU.PREVIEW_OBJECT_ID}return-1}addAvatarIntoRoom(t,e){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=st.UNIT,this._currentPreviewObjectData=t,this._roomEngine.addRoomObjectUser(this._previewRoomId,CU.PREVIEW_OBJECT_ID,new dt(CU.PREVIEW_OBJECT_LOCATION_X,CU.PREVIEW_OBJECT_LOCATION_Y,0),new dt(90,0,0),135,it.getTypeNumber(it.USER),t)&&(this._previousAutomaticStateChangeTime=SU.instance.time,this._automaticStateChange=!0,this.updateUserGesture(1),this.updateUserEffect(e),this.updateUserPosture("std")),this.updatePreviewRoomView(),CU.PREVIEW_OBJECT_ID):-1}addPetIntoRoom(t){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=st.UNIT,this._currentPreviewObjectData=t,this._roomEngine.addRoomObjectUser(this._previewRoomId,CU.PREVIEW_OBJECT_ID,new dt(CU.PREVIEW_OBJECT_LOCATION_X,CU.PREVIEW_OBJECT_LOCATION_Y,0),new dt(90,0,0),90,it.getTypeNumber(it.PET),t)&&(this._previousAutomaticStateChangeTime=SU.instance.time,this._automaticStateChange=!1,this.updateUserGesture(1),this.updateUserPosture("std")),this.updatePreviewRoomView(),CU.PREVIEW_OBJECT_ID):-1}updateUserPosture(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserPosture(this._previewRoomId,CU.PREVIEW_OBJECT_ID,t,e)}updateUserGesture(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserGesture(this._previewRoomId,CU.PREVIEW_OBJECT_ID,t)}updateUserEffect(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserEffect(this._previewRoomId,CU.PREVIEW_OBJECT_ID,t)}updateObjectUserFigure(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!!this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserFigure(this._previewRoomId,CU.PREVIEW_OBJECT_ID,t,e,s,i)}updateObjectUserAction(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserAction(this._previewRoomId,CU.PREVIEW_OBJECT_ID,t,e,s)}updateObjectStuffData(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectFloor(this._previewRoomId,CU.PREVIEW_OBJECT_ID,null,null,t.state,t)}changeRoomObjectState(){this.isRoomEngineReady&&(this._automaticStateChange=!1,this._currentPreviewObjectCategory!==st.UNIT&&this._roomEngine.changeObjectState(this._previewRoomId,CU.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}changeRoomObjectDirection(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,CU.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(!t)return;const e=this._roomEngine.objectEventHandler.getValidRoomObjectDirection(t,!0);switch(this._currentPreviewObjectCategory){case st.FLOOR:{const t=new dt(CU.PREVIEW_OBJECT_LOCATION_X,CU.PREVIEW_OBJECT_LOCATION_Y),s=new dt(e,e,e);return void this._roomEngine.updateRoomObjectFloor(this._previewRoomId,CU.PREVIEW_OBJECT_ID,t,s,null,null)}case st.WALL:return}}}checkAutomaticRoomObjectStateChange(){if(this._automaticStateChange){const t=SU.instance.time;t>this._previousAutomaticStateChangeTime+CU.AUTOMATIC_STATE_CHANGE_INTERVAL&&(this._previousAutomaticStateChangeTime=t,this.isRoomEngineReady&&this._roomEngine.changeObjectState(this._previewRoomId,CU.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}}getRoomCanvas(t,e){if(this.isRoomEngineReady){const s=this._roomEngine.getRoomInstanceDisplay(this._previewRoomId,CU.PREVIEW_CANVAS_ID,t,e,this._currentPreviewScale);if(s&&null!==this._backgroundColor){let r=this._backgroundSprite;r||(r=new W(i.t.WHITE),s.addChildAt(r,0)),r.width=t,r.height=e,r.tint=this._backgroundColor}this._roomEngine.setRoomInstanceRenderingCanvasMask(this._previewRoomId,CU.PREVIEW_CANVAS_ID,!0);const r=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,CU.PREVIEW_CANVAS_ID);return r&&r.adjustLocation(new dt(CU.PREVIEW_OBJECT_LOCATION_X,CU.PREVIEW_OBJECT_LOCATION_Y,0),30),this._currentPreviewCanvasWidth=t,this._currentPreviewCanvasHeight=e,s}return null}modifyRoomCanvas(t,e){this.isRoomEngineReady&&(this._currentPreviewCanvasWidth=t,this._currentPreviewCanvasHeight=e,this._backgroundSprite&&(this._backgroundSprite.width=t,this._backgroundSprite.height=e),this._roomEngine.initializeRoomInstanceRenderingCanvas(this._previewRoomId,CU.PREVIEW_CANVAS_ID,t,e))}set addViewOffset(t){this._addViewOffset=t}get addViewOffset(){return this._addViewOffset}updatePreviewObjectBoundingRectangle(t){const e=this._roomEngine.getRoomObjectBoundingRectangle(this._previewRoomId,CU.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,CU.PREVIEW_CANVAS_ID);if(e&&t)if(e.x+=-(this._currentPreviewCanvasWidth>>1),e.y+=-(this._currentPreviewCanvasHeight>>1),e.x+=-t.x,e.y+=-t.y,this._currentPreviewRectangle){const t=this._currentPreviewRectangle.clone().enlarge(e);(t.width-this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth-this._currentPreviewRectangle.width>>1||t.height-this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1||this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)&&(this._currentPreviewRectangle=t)}else this._currentPreviewRectangle=e}validatePreviewSize(t){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return t;if(this.isRoomEngineReady){const e=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,CU.PREVIEW_CANVAS_ID);this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth*(1+CU.ALLOWED_IMAGE_CUT)||this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight*(1+CU.ALLOWED_IMAGE_CUT)?CU.ZOOM_ENABLED?.5!==this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,CU.PREVIEW_CANVAS_ID)&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,CU.PREVIEW_CANVAS_ID,.5,null,null),this._currentPreviewScale=CU.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0,t.x=t.x>>1,t.y=t.y>>1,this._currentPreviewRectangle.x=this._currentPreviewRectangle.x>>2,this._currentPreviewRectangle.y=this._currentPreviewRectangle.y>>2,this._currentPreviewRectangle.width=this._currentPreviewRectangle.width>>2,this._currentPreviewRectangle.height=this._currentPreviewRectangle.height>>2):e.isZoomedIn()&&(e.performZoomOut(),this._currentPreviewScale=CU.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0):this._currentPreviewNeedsZoomOut||(CU.ZOOM_ENABLED?1!==this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,CU.PREVIEW_CANVAS_ID)&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,CU.PREVIEW_CANVAS_ID,1,null,null),this._currentPreviewScale=CU.SCALE_NORMAL):e.isZoomedIn()||(e.performZoomIn(),this._currentPreviewScale=CU.SCALE_NORMAL))}return t}zoomIn(){if(this.isRoomEngineReady)if(CU.ZOOM_ENABLED)this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,CU.PREVIEW_CANVAS_ID,1);else{this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,CU.PREVIEW_CANVAS_ID).performZoomIn()}this._currentPreviewScale=CU.SCALE_NORMAL}zoomOut(){if(this.isRoomEngineReady)if(CU.ZOOM_ENABLED)this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,CU.PREVIEW_CANVAS_ID,.5);else{this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,CU.PREVIEW_CANVAS_ID).performZoomOut()}this._currentPreviewScale=CU.SCALE_SMALL}updateAvatarDirection(t,e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserLocation(this._previewRoomId,CU.PREVIEW_OBJECT_ID,new dt(CU.PREVIEW_OBJECT_LOCATION_X,CU.PREVIEW_OBJECT_LOCATION_Y,0),new dt(CU.PREVIEW_OBJECT_LOCATION_X,CU.PREVIEW_OBJECT_LOCATION_Y,0),!1,0,new dt(45*t,0,0),45*e)}updateObjectRoom(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!!this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,t,e,s,i)}updateRoomWallsAndFloorVisibility(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneVisibility(this._previewRoomId,t,e)}getCanvasOffset(t){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return t;let e=-(this._currentPreviewRectangle.left+this._currentPreviewRectangle.right)>>1,s=-(this._currentPreviewRectangle.top+this._currentPreviewRectangle.bottom)>>1;const i=this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1;i>10?s+=Math.min(15,i-10):this._currentPreviewObjectCategory!==st.UNIT?s+=5-Math.max(0,i/2):s-=5-Math.min(0,i/2),s+=this._addViewOffset.y,e+=this._addViewOffset.x;const r=e-t.x,n=s-t.y;if(0!==r||0!==n){const i=Math.sqrt(r*r+n*n);return i>10&&(e=t.x+10*r/i,s=t.y+10*n/i),new j.g(e,s)}return null}updatePreviewRoomView(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if((!this._disableUpdate||t)&&(this.checkAutomaticRoomObjectStateChange(),this.isRoomEngineReady)){let t=this._roomEngine.getRoomInstanceRenderingCanvasOffset(this._previewRoomId,CU.PREVIEW_CANVAS_ID);if(t&&(this.updatePreviewObjectBoundingRectangle(t),this._currentPreviewRectangle)){const e=this._currentPreviewScale;t=this.validatePreviewSize(t);const s=this.getCanvasOffset(t);s&&this._roomEngine.setRoomInstanceRenderingCanvasOffset(this._previewRoomId,CU.PREVIEW_CANVAS_ID,s),this._currentPreviewScale!==e&&(this._currentPreviewRectangle=null)}}}set disableUpdate(t){this._disableUpdate=t}set disableRoomEngineUpdate(t){this.isRoomEngineReady&&this._roomEngine.disableUpdate(t)}onRoomInitializedonRoomInitialized(t){t&&(t.type!==YS.INITIALIZED||t.roomId===this._previewRoomId&&this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,"110","99999"))}onRoomObjectAdded(t){if(t.roomId===this._previewRoomId&&t.objectId===CU.PREVIEW_OBJECT_ID&&t.category===this._currentPreviewObjectCategory){this._currentPreviewRectangle=null,this._currentPreviewNeedsZoomOut=!1;const e=this._roomEngine.getRoomObject(t.roomId,t.objectId,t.category);if(e&&e.model&&t.category===st.WALL){const s=e.model.getValue(rt.FURNITURE_SIZE_Z),i=e.model.getValue(rt.FURNITURE_CENTER_Z);null===s&&null===i||this._roomEngine.updateRoomObjectWallLocation(t.roomId,t.objectId,new dt(.5,2.3,(3.6-s)/2+i))}}}updateRoomEngine(){this.isRoomEngineReady&&this._roomEngine.runUpdate()}getRenderingCanvas(){const t=this._roomEngine.getRoomInstanceRenderingCanvas(this._previewRoomId,CU.PREVIEW_CANVAS_ID);return t||null}getGenericRoomObjectImage(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1,_=arguments.length>9&&void 0!==arguments[9]?arguments[9]:-1,d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null;return this.isRoomEngineReady?this._roomEngine.getGenericRoomObjectImage(t,e,s,i,r,n,a,o,h,_,d):null}getRoomObjectImage(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.isRoomEngineReady?this._roomEngine.getRoomObjectImage(this._previewRoomId,CU.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,t,e,s,i):null}getRoomObjectCurrentImage(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,CU.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(t&&t.visualization)return t.visualization.getImage(16777215,-1)}return null}getRoomPreviewObject(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,CU.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(t)return t}return null}getRoomPreviewOwnRoomObject(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,oL.ROOM_OBJECT_ID,st.ROOM);if(t)return t}return null}get isRoomEngineReady(){return this._roomEngine&&this._roomEngine.ready}get roomId(){return this._previewRoomId}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t}get width(){return this._currentPreviewCanvasWidth}get height(){return this._currentPreviewCanvasHeight}}CU.SCALE_NORMAL=64,CU.SCALE_SMALL=32,CU.PREVIEW_COUNTER=0,CU.PREVIEW_CANVAS_ID=1,CU.PREVIEW_OBJECT_ID=1,CU.PREVIEW_OBJECT_LOCATION_X=2,CU.PREVIEW_OBJECT_LOCATION_Y=2,CU.ALLOWED_IMAGE_CUT=.25,CU.AUTOMATIC_STATE_CHANGE_INTERVAL=2500,CU.ZOOM_ENABLED=!0;class LU{}LU.NO_CLUB=0,LU.CLUB=1,LU.VIP=2;class UU{constructor(t){this._target=void 0,this._running=void 0,this._complete=!0,this._tag=void 0,this._target=t}get running(){return this._running&&!!this._target}get complete(){return this._complete}set target(t){this._target=t}get target(){return this._target}set tag(t){this._tag=t}get tag(){return this._tag}start(){this._running=!0}update(t){}stop(){this._target=null,this._running=!1}tick(t){}}class PU extends UU{constructor(t){super(t)}tick(t){super.tick(t),this.target&&(this.target.remove(),this.target=null)}}class bU extends UU{constructor(t,e){super(t),this._startTimeMs=void 0,this._duration=void 0,this._complete=!1,this._duration=e}get duration(){return this._duration}start(){super.start(),this._complete=!1,this._startTimeMs=SU.instance.time}tick(t){super.tick(t);const e=(t-this._startTimeMs)/this._duration;e<1?this.update(e):(this.update(1),this._complete=!0)}}class wU extends bU{constructor(t,e,s){super(t,e),this._height=void 0,this._offset=void 0,this._height=s}start(){super.start(),this._offset=0,this.target.style.top=this._offset-this._height+"px"}update(t){super.update(t),this.target.style.top=this._offset-this._height+this.getBounceOffset(t)*this._height+"px"}getBounceOffset(t){return t<.364?7.5625*t*t:t<.727?7.5625*(t-=.545)*t+.75:t<.909?7.5625*(t-=.9091)*t+.9375:7.5625*(t-=.955)*t+.984375}stop(){this.target.style.top=this._offset+"px",super.stop()}}class FU extends bU{constructor(t){super(t.target,t.duration),this._interval=void 0,this._interval=t}start(){super.start(),this._interval.start()}update(t){super.update(t),this._interval.update(t)}stop(){super.stop(),this._interval.stop()}}class xU extends FU{constructor(t,e){super(t),this._rate=void 0,this._rate=e}}class BU extends xU{constructor(t,e){super(t,e)}update(t){this._interval.update(Math.pow(t,1/this._rate))}}class GU extends bU{constructor(t,e,s,i,r,n){super(t,e),this._startX=void 0,this._startY=void 0,this._deltaX=void 0,this._deltaY=void 0,this._height=void 0,this._numJumps=void 0,this._deltaX=s,this._deltaY=i,this._height=-r,this._numJumps=n}start(){super.start(),this._startX=this.target.offsetLeft,this._startY=this.target.offsetTop}update(t){super.update(t),this.target.style.left=this._startX+this._deltaX*t+"px",this.target.style.top=this._startY+this._height*Math.abs(Math.sin(t*Math.PI*this._numJumps))+this._deltaY*t+"px"}}class HU{static get TIMER_TIME(){return 1e3/SU.instance.ticker.FPS}static runMotion(t){return-1===HU._RUNNING_MOTIONS.indexOf(t)&&-1===HU._QUEUED_MOTIONS.indexOf(t)&&(HU._IS_UPDATING?HU._QUEUED_MOTIONS.push(t):(HU._RUNNING_MOTIONS.push(t),t.start()),HU.startTimer()),t}static removeMotion(t){let e=HU._RUNNING_MOTIONS.indexOf(t);e>-1?HU._IS_UPDATING?(e=HU._REMOVED_MOTIONS.indexOf(t),-1==e&&HU._REMOVED_MOTIONS.push(t)):(HU._RUNNING_MOTIONS.splice(e,1),t.running&&t.stop(),HU._RUNNING_MOTIONS.length||HU.stopTimer()):(e=HU._QUEUED_MOTIONS.indexOf(t),e>-1&&HU._QUEUED_MOTIONS.splice(e,1))}static getMotionByTag(t){for(const e of HU._RUNNING_MOTIONS)if(e.tag==t)return e;for(const e of HU._QUEUED_MOTIONS)if(e.tag==t)return e;return null}static getMotionByTarget(t){for(const e of HU._RUNNING_MOTIONS)if(e.target==t)return e;for(const e of HU._QUEUED_MOTIONS)if(e.target==t)return e;return null}static getMotionByTagAndTarget(t,e){for(const s of HU._RUNNING_MOTIONS)if(s.tag==t&&s.target==e)return s;for(const s of HU._QUEUED_MOTIONS)if(s.tag==t&&s.target==e)return s;return null}static get isRunning(){return!!HU._TIMER}static get isUpdating(){return HU._IS_UPDATING}static onTick(){HU._IS_UPDATING=!0;const t=SU.instance.time;let e=null;for(;e=HU._QUEUED_MOTIONS.pop();)HU._RUNNING_MOTIONS.push(e);for(;e=HU._REMOVED_MOTIONS.pop();)HU._RUNNING_MOTIONS.splice(HU._RUNNING_MOTIONS.indexOf(e),1),e.running&&e.stop();for(e of HU._RUNNING_MOTIONS)e.running?(e.tick(t),e.complete&&HU.removeMotion(e)):HU.removeMotion(e);HU._RUNNING_MOTIONS.length||HU.stopTimer(),HU._IS_UPDATING=!1}static startTimer(){HU._TIMER||(HU._TIMER=setInterval(HU.onTick,HU.TIMER_TIME))}static stopTimer(){HU._TIMER&&(clearInterval(HU._TIMER),HU._TIMER=null)}getNumRunningMotions(t){let e=0;for(const s of HU._RUNNING_MOTIONS)s.target===t&&e++;return e}}HU._QUEUED_MOTIONS=[],HU._RUNNING_MOTIONS=[],HU._REMOVED_MOTIONS=[],HU._TIMER=null,HU._IS_UPDATING=!1;class VU extends UU{constructor(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];super(e?e[0].target:null),this._motion=void 0,this._queue=void 0,this._queue=[];for(const i of e)this._queue.push(i);this._motion=e[0],this._complete=!this._motion}get running(){return!(!this._running||!this._motion)&&this._motion.running}start(){super.start(),this._motion.start()}update(t){super.update(t),this._motion.running&&this._motion.update(t)}stop(){super.stop(),this._motion.stop()}tick(t){if(super.tick(t),this._motion.tick(t),this._motion.complete){this._motion.stop();const t=this._queue.indexOf(this._motion);t<this._queue.length-1?(this._motion=this._queue[t+1],this._target=this._motion.target,this._motion.start()):this._complete=!0}}}class jU extends UU{constructor(t){super(null),this._startTimeMs=void 0,this._waitTimeMs=void 0,this._waitTimeMs=t}get running(){return this._running}start(){super.start(),this._complete=!1,this._startTimeMs=SU.instance.time}tick(t){super.tick(t),this._complete=t-this._startTimeMs>=this._waitTimeMs,this._complete&&this.stop()}}}}]);